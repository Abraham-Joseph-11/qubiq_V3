(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var lR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zz(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Kc(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),t}var yy={exports:{}},uc={};var kC;function Fz(){if(kC)return uc;kC=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return uc.Fragment=e,uc.jsx=t,uc.jsxs=t,uc}var MC;function Bz(){return MC||(MC=1,yy.exports=Fz()),yy.exports}var J=Bz(),by={exports:{}};function Lz(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var cR={exports:{}},wn=cR.exports={},Da,Ia;function vb(){throw new Error("setTimeout has not been defined")}function gb(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Da=setTimeout:Da=vb}catch{Da=vb}try{typeof clearTimeout=="function"?Ia=clearTimeout:Ia=gb}catch{Ia=gb}})();function fR(r){if(Da===setTimeout)return setTimeout(r,0);if((Da===vb||!Da)&&setTimeout)return Da=setTimeout,setTimeout(r,0);try{return Da(r,0)}catch{try{return Da.call(null,r,0)}catch{return Da.call(this,r,0)}}}function Uz(r){if(Ia===clearTimeout)return clearTimeout(r);if((Ia===gb||!Ia)&&clearTimeout)return Ia=clearTimeout,clearTimeout(r);try{return Ia(r)}catch{try{return Ia.call(null,r)}catch{return Ia.call(this,r)}}}var gi=[],Lu=!1,us,Tp=-1;function jz(){!Lu||!us||(Lu=!1,us.length?gi=us.concat(gi):Tp=-1,gi.length&&hR())}function hR(){if(!Lu){var r=fR(jz);Lu=!0;for(var e=gi.length;e;){for(us=gi,gi=[];++Tp<e;)us&&us[Tp].run();Tp=-1,e=gi.length}us=null,Lu=!1,Uz(r)}}wn.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];gi.push(new pR(r,e)),gi.length===1&&!Lu&&fR(hR)};function pR(r,e){this.fun=r,this.array=e}pR.prototype.run=function(){this.fun.apply(null,this.array)};wn.title="browser";wn.browser=!0;wn.env={};wn.argv=[];wn.version="";wn.versions={};function _i(){}wn.on=_i;wn.addListener=_i;wn.once=_i;wn.off=_i;wn.removeListener=_i;wn.removeAllListeners=_i;wn.emit=_i;wn.prependListener=_i;wn.prependOnceListener=_i;wn.listeners=function(r){return[]};wn.binding=function(r){throw new Error("process.binding is not supported")};wn.cwd=function(){return"/"};wn.chdir=function(r){throw new Error("process.chdir is not supported")};wn.umask=function(){return 0};var Pz=cR.exports;const Rn=Lz(Pz);var ie={},zC;function Vz(){if(zC)return ie;zC=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.for("react.activity"),m=Symbol.iterator;function g(q){return q===null||typeof q!="object"?null:(q=m&&q[m]||q["@@iterator"],typeof q=="function"?q:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,w={};function b(q,nt,W){this.props=q,this.context=nt,this.refs=w,this.updater=W||y}b.prototype.isReactComponent={},b.prototype.setState=function(q,nt){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,nt,"setState")},b.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function C(){}C.prototype=b.prototype;function A(q,nt,W){this.props=q,this.context=nt,this.refs=w,this.updater=W||y}var T=A.prototype=new C;T.constructor=A,x(T,b.prototype),T.isPureReactComponent=!0;var R=Array.isArray;function D(){}var N={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function k(q,nt,W){var Z=W.ref;return{$$typeof:r,type:q,key:nt,ref:Z!==void 0?Z:null,props:W}}function z(q,nt){return k(q.type,nt,q.props)}function F(q){return typeof q=="object"&&q!==null&&q.$$typeof===r}function B(q){var nt={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(W){return nt[W]})}var V=/\/+/g;function G(q,nt){return typeof q=="object"&&q!==null&&q.key!=null?B(""+q.key):nt.toString(36)}function Q(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(D,D):(q.status="pending",q.then(function(nt){q.status==="pending"&&(q.status="fulfilled",q.value=nt)},function(nt){q.status==="pending"&&(q.status="rejected",q.reason=nt)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function L(q,nt,W,Z,ot){var xt=typeof q;(xt==="undefined"||xt==="boolean")&&(q=null);var Ot=!1;if(q===null)Ot=!0;else switch(xt){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(q.$$typeof){case r:case e:Ot=!0;break;case h:return Ot=q._init,L(Ot(q._payload),nt,W,Z,ot)}}if(Ot)return ot=ot(q),Ot=Z===""?"."+G(q,0):Z,R(ot)?(W="",Ot!=null&&(W=Ot.replace(V,"$&/")+"/"),L(ot,nt,W,"",function(Mt){return Mt})):ot!=null&&(F(ot)&&(ot=z(ot,W+(ot.key==null||q&&q.key===ot.key?"":(""+ot.key).replace(V,"$&/")+"/")+Ot)),nt.push(ot)),1;Ot=0;var zt=Z===""?".":Z+":";if(R(q))for(var _t=0;_t<q.length;_t++)Z=q[_t],xt=zt+G(Z,_t),Ot+=L(Z,nt,W,xt,ot);else if(_t=g(q),typeof _t=="function")for(q=_t.call(q),_t=0;!(Z=q.next()).done;)Z=Z.value,xt=zt+G(Z,_t++),Ot+=L(Z,nt,W,xt,ot);else if(xt==="object"){if(typeof q.then=="function")return L(Q(q),nt,W,Z,ot);throw nt=String(q),Error("Objects are not valid as a React child (found: "+(nt==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":nt)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function X(q,nt,W){if(q==null)return q;var Z=[],ot=0;return L(q,Z,"","",function(xt){return nt.call(W,xt,ot++)}),Z}function $(q){if(q._status===-1){var nt=q._result;nt=nt(),nt.then(function(W){(q._status===0||q._status===-1)&&(q._status=1,q._result=W)},function(W){(q._status===0||q._status===-1)&&(q._status=2,q._result=W)}),q._status===-1&&(q._status=0,q._result=nt)}if(q._status===1)return q._result.default;throw q._result}var it=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var nt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(nt))return}else if(typeof Rn=="object"&&typeof Rn.emit=="function"){Rn.emit("uncaughtException",q);return}console.error(q)},tt={map:X,forEach:function(q,nt,W){X(q,function(){nt.apply(this,arguments)},W)},count:function(q){var nt=0;return X(q,function(){nt++}),nt},toArray:function(q){return X(q,function(nt){return nt})||[]},only:function(q){if(!F(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return ie.Activity=d,ie.Children=tt,ie.Component=b,ie.Fragment=t,ie.Profiler=a,ie.PureComponent=A,ie.StrictMode=n,ie.Suspense=c,ie.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,ie.__COMPILER_RUNTIME={__proto__:null,c:function(q){return N.H.useMemoCache(q)}},ie.cache=function(q){return function(){return q.apply(null,arguments)}},ie.cacheSignal=function(){return null},ie.cloneElement=function(q,nt,W){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var Z=x({},q.props),ot=q.key;if(nt!=null)for(xt in nt.key!==void 0&&(ot=""+nt.key),nt)!O.call(nt,xt)||xt==="key"||xt==="__self"||xt==="__source"||xt==="ref"&&nt.ref===void 0||(Z[xt]=nt[xt]);var xt=arguments.length-2;if(xt===1)Z.children=W;else if(1<xt){for(var Ot=Array(xt),zt=0;zt<xt;zt++)Ot[zt]=arguments[zt+2];Z.children=Ot}return k(q.type,ot,Z)},ie.createContext=function(q){return q={$$typeof:s,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:i,_context:q},q},ie.createElement=function(q,nt,W){var Z,ot={},xt=null;if(nt!=null)for(Z in nt.key!==void 0&&(xt=""+nt.key),nt)O.call(nt,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(ot[Z]=nt[Z]);var Ot=arguments.length-2;if(Ot===1)ot.children=W;else if(1<Ot){for(var zt=Array(Ot),_t=0;_t<Ot;_t++)zt[_t]=arguments[_t+2];ot.children=zt}if(q&&q.defaultProps)for(Z in Ot=q.defaultProps,Ot)ot[Z]===void 0&&(ot[Z]=Ot[Z]);return k(q,xt,ot)},ie.createRef=function(){return{current:null}},ie.forwardRef=function(q){return{$$typeof:u,render:q}},ie.isValidElement=F,ie.lazy=function(q){return{$$typeof:h,_payload:{_status:-1,_result:q},_init:$}},ie.memo=function(q,nt){return{$$typeof:f,type:q,compare:nt===void 0?null:nt}},ie.startTransition=function(q){var nt=N.T,W={};N.T=W;try{var Z=q(),ot=N.S;ot!==null&&ot(W,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(D,it)}catch(xt){it(xt)}finally{nt!==null&&W.types!==null&&(nt.types=W.types),N.T=nt}},ie.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},ie.use=function(q){return N.H.use(q)},ie.useActionState=function(q,nt,W){return N.H.useActionState(q,nt,W)},ie.useCallback=function(q,nt){return N.H.useCallback(q,nt)},ie.useContext=function(q){return N.H.useContext(q)},ie.useDebugValue=function(){},ie.useDeferredValue=function(q,nt){return N.H.useDeferredValue(q,nt)},ie.useEffect=function(q,nt){return N.H.useEffect(q,nt)},ie.useEffectEvent=function(q){return N.H.useEffectEvent(q)},ie.useId=function(){return N.H.useId()},ie.useImperativeHandle=function(q,nt,W){return N.H.useImperativeHandle(q,nt,W)},ie.useInsertionEffect=function(q,nt){return N.H.useInsertionEffect(q,nt)},ie.useLayoutEffect=function(q,nt){return N.H.useLayoutEffect(q,nt)},ie.useMemo=function(q,nt){return N.H.useMemo(q,nt)},ie.useOptimistic=function(q,nt){return N.H.useOptimistic(q,nt)},ie.useReducer=function(q,nt,W){return N.H.useReducer(q,nt,W)},ie.useRef=function(q){return N.H.useRef(q)},ie.useState=function(q){return N.H.useState(q)},ie.useSyncExternalStore=function(q,nt,W){return N.H.useSyncExternalStore(q,nt,W)},ie.useTransition=function(){return N.H.useTransition()},ie.version="19.2.4",ie}var FC;function d1(){return FC||(FC=1,by.exports=Vz()),by.exports}var ht=d1();const qz=zz(ht);var xy={exports:{}},lc={},wy={exports:{}},Sy={};var BC;function Wz(){return BC||(BC=1,(function(r){function e(L,X){var $=L.length;L.push(X);t:for(;0<$;){var it=$-1>>>1,tt=L[it];if(0<a(tt,X))L[it]=X,L[$]=tt,$=it;else break t}}function t(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var X=L[0],$=L.pop();if($!==X){L[0]=$;t:for(var it=0,tt=L.length,q=tt>>>1;it<q;){var nt=2*(it+1)-1,W=L[nt],Z=nt+1,ot=L[Z];if(0>a(W,$))Z<tt&&0>a(ot,W)?(L[it]=ot,L[Z]=$,it=Z):(L[it]=W,L[nt]=$,it=nt);else if(Z<tt&&0>a(ot,$))L[it]=ot,L[Z]=$,it=Z;else break t}}return X}function a(L,X){var $=L.sortIndex-X.sortIndex;return $!==0?$:L.id-X.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,u=s.now();r.unstable_now=function(){return s.now()-u}}var c=[],f=[],h=1,d=null,m=3,g=!1,y=!1,x=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function T(L){for(var X=t(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=L)n(f),X.sortIndex=X.expirationTime,e(c,X);else break;X=t(f)}}function R(L){if(x=!1,T(L),!y)if(t(c)!==null)y=!0,D||(D=!0,B());else{var X=t(f);X!==null&&Q(R,X.startTime-L)}}var D=!1,N=-1,O=5,k=-1;function z(){return w?!0:!(r.unstable_now()-k<O)}function F(){if(w=!1,D){var L=r.unstable_now();k=L;var X=!0;try{t:{y=!1,x&&(x=!1,C(N),N=-1),g=!0;var $=m;try{e:{for(T(L),d=t(c);d!==null&&!(d.expirationTime>L&&z());){var it=d.callback;if(typeof it=="function"){d.callback=null,m=d.priorityLevel;var tt=it(d.expirationTime<=L);if(L=r.unstable_now(),typeof tt=="function"){d.callback=tt,T(L),X=!0;break e}d===t(c)&&n(c),T(L)}else n(c);d=t(c)}if(d!==null)X=!0;else{var q=t(f);q!==null&&Q(R,q.startTime-L),X=!1}}break t}finally{d=null,m=$,g=!1}X=void 0}}finally{X?B():D=!1}}}var B;if(typeof A=="function")B=function(){A(F)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,G=V.port2;V.port1.onmessage=F,B=function(){G.postMessage(null)}}else B=function(){b(F,0)};function Q(L,X){N=b(function(){L(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(L){L.callback=null},r.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<L?Math.floor(1e3/L):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(L){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var $=m;m=X;try{return L()}finally{m=$}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(L,X){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var $=m;m=L;try{return X()}finally{m=$}},r.unstable_scheduleCallback=function(L,X,$){var it=r.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?it+$:it):$=it,L){case 1:var tt=-1;break;case 2:tt=250;break;case 5:tt=1073741823;break;case 4:tt=1e4;break;default:tt=5e3}return tt=$+tt,L={id:h++,callback:X,priorityLevel:L,startTime:$,expirationTime:tt,sortIndex:-1},$>it?(L.sortIndex=$,e(f,L),t(c)===null&&L===t(f)&&(x?(C(N),N=-1):x=!0,Q(R,$-it))):(L.sortIndex=tt,e(c,L),y||g||(y=!0,D||(D=!0,B()))),L},r.unstable_shouldYield=z,r.unstable_wrapCallback=function(L){var X=m;return function(){var $=m;m=X;try{return L.apply(this,arguments)}finally{m=$}}}})(Sy)),Sy}var LC;function Hz(){return LC||(LC=1,wy.exports=Wz()),wy.exports}var Ey={exports:{}},Jn={};var UC;function Gz(){if(UC)return Jn;UC=1;var r=d1();function e(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:d==null?null:""+d,children:c,containerInfo:f,implementation:h}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Jn.createPortal=function(c,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(c,f,null,h)},Jn.flushSync=function(c){var f=s.T,h=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=f,n.p=h,n.d.f()}},Jn.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},Jn.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},Jn.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var h=f.as,d=u(h,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:d,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:d,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Jn.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=u(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},Jn.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,d=u(h,f.crossOrigin);n.d.L(c,h,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Jn.preloadModule=function(c,f){if(typeof c=="string")if(f){var h=u(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},Jn.requestFormReset=function(c){n.d.r(c)},Jn.unstable_batchedUpdates=function(c,f){return c(f)},Jn.useFormState=function(c,f,h){return s.H.useFormState(c,f,h)},Jn.useFormStatus=function(){return s.H.useHostTransitionStatus()},Jn.version="19.2.4",Jn}var jC;function Xz(){if(jC)return Ey.exports;jC=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Ey.exports=Gz(),Ey.exports}var PC;function Kz(){if(PC)return lc;PC=1;var r=Hz(),e=d1(),t=Xz();function n(o){var l="https://react.dev/errors/"+o;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var l=o,p=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(p=l.return),o=l.return;while(o)}return l.tag===3?p:null}function s(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function u(o){if(o.tag===31){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function c(o){if(i(o)!==o)throw Error(n(188))}function f(o){var l=o.alternate;if(!l){if(l=i(o),l===null)throw Error(n(188));return l!==o?null:o}for(var p=o,v=l;;){var S=p.return;if(S===null)break;var E=S.alternate;if(E===null){if(v=S.return,v!==null){p=v;continue}break}if(S.child===E.child){for(E=S.child;E;){if(E===p)return c(S),o;if(E===v)return c(S),l;E=E.sibling}throw Error(n(188))}if(p.return!==v.return)p=S,v=E;else{for(var M=!1,j=S.child;j;){if(j===p){M=!0,p=S,v=E;break}if(j===v){M=!0,v=S,p=E;break}j=j.sibling}if(!M){for(j=E.child;j;){if(j===p){M=!0,p=E,v=S;break}if(j===v){M=!0,v=E,p=S;break}j=j.sibling}if(!M)throw Error(n(189))}}if(p.alternate!==v)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?o:l}function h(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o;for(o=o.child;o!==null;){if(l=h(o),l!==null)return l;o=o.sibling}return null}var d=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),A=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function B(o){return o===null||typeof o!="object"?null:(o=F&&o[F]||o["@@iterator"],typeof o=="function"?o:null)}var V=Symbol.for("react.client.reference");function G(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===V?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case x:return"Fragment";case b:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case D:return"SuspenseList";case k:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case y:return"Portal";case A:return o.displayName||"Context";case C:return(o._context.displayName||"Context")+".Consumer";case T:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case N:return l=o.displayName||null,l!==null?l:G(o.type)||"Memo";case O:l=o._payload,o=o._init;try{return G(o(l))}catch{}}return null}var Q=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},it=[],tt=-1;function q(o){return{current:o}}function nt(o){0>tt||(o.current=it[tt],it[tt]=null,tt--)}function W(o,l){tt++,it[tt]=o.current,o.current=l}var Z=q(null),ot=q(null),xt=q(null),Ot=q(null);function zt(o,l){switch(W(xt,l),W(ot,o),W(Z,null),l.nodeType){case 9:case 11:o=(o=l.documentElement)&&(o=o.namespaceURI)?nC(o):0;break;default:if(o=l.tagName,l=l.namespaceURI)l=nC(l),o=rC(l,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}nt(Z),W(Z,o)}function _t(){nt(Z),nt(ot),nt(xt)}function Mt(o){o.memoizedState!==null&&W(Ot,o);var l=Z.current,p=rC(l,o.type);l!==p&&(W(ot,o),W(Z,p))}function kt(o){ot.current===o&&(nt(Z),nt(ot)),Ot.current===o&&(nt(Ot),ac._currentValue=$)}var Ft,Pt;function Ut(o){if(Ft===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);Ft=l&&l[1]||"",Pt=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ft+o+Pt}var $t=!1;function Wt(o,l){if(!o||$t)return"";$t=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(l){var Rt=function(){throw Error()};if(Object.defineProperty(Rt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Rt,[])}catch(bt){var vt=bt}Reflect.construct(o,[],Rt)}else{try{Rt.call()}catch(bt){vt=bt}o.call(Rt.prototype)}}else{try{throw Error()}catch(bt){vt=bt}(Rt=o())&&typeof Rt.catch=="function"&&Rt.catch(function(){})}}catch(bt){if(bt&&vt&&typeof bt.stack=="string")return[bt.stack,vt.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=v.DetermineComponentFrameRoot(),M=E[0],j=E[1];if(M&&j){var et=M.split(`
`),dt=j.split(`
`);for(S=v=0;v<et.length&&!et[v].includes("DetermineComponentFrameRoot");)v++;for(;S<dt.length&&!dt[S].includes("DetermineComponentFrameRoot");)S++;if(v===et.length||S===dt.length)for(v=et.length-1,S=dt.length-1;1<=v&&0<=S&&et[v]!==dt[S];)S--;for(;1<=v&&0<=S;v--,S--)if(et[v]!==dt[S]){if(v!==1||S!==1)do if(v--,S--,0>S||et[v]!==dt[S]){var Ct=`
`+et[v].replace(" at new "," at ");return o.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",o.displayName)),Ct}while(1<=v&&0<=S);break}}}finally{$t=!1,Error.prepareStackTrace=p}return(p=o?o.displayName||o.name:"")?Ut(p):""}function Ae(o,l){switch(o.tag){case 26:case 27:case 5:return Ut(o.type);case 16:return Ut("Lazy");case 13:return o.child!==l&&l!==null?Ut("Suspense Fallback"):Ut("Suspense");case 19:return Ut("SuspenseList");case 0:case 15:return Wt(o.type,!1);case 11:return Wt(o.type.render,!1);case 1:return Wt(o.type,!0);case 31:return Ut("Activity");default:return""}}function cn(o){try{var l="",p=null;do l+=Ae(o,p),p=o,o=o.return;while(o);return l}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}var Et=Object.prototype.hasOwnProperty,ze=r.unstable_scheduleCallback,Ne=r.unstable_cancelCallback,yn=r.unstable_shouldYield,te=r.unstable_requestPaint,de=r.unstable_now,Re=r.unstable_getCurrentPriorityLevel,tn=r.unstable_ImmediatePriority,Zn=r.unstable_UserBlockingPriority,on=r.unstable_NormalPriority,fn=r.unstable_LowPriority,U=r.unstable_IdlePriority,_=r.log,I=r.unstable_setDisableYieldValue,Y=null,st=null;function mt(o){if(typeof _=="function"&&I(o),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(Y,o)}catch{}}var St=Math.clz32?Math.clz32:He,oe=Math.log,en=Math.LN2;function He(o){return o>>>=0,o===0?32:31-(oe(o)/en|0)|0}var Ve=256,_e=262144,Kf=4194304;function zo(o){var l=o&42;if(l!==0)return l;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Yf(o,l,p){var v=o.pendingLanes;if(v===0)return 0;var S=0,E=o.suspendedLanes,M=o.pingedLanes;o=o.warmLanes;var j=v&134217727;return j!==0?(v=j&~E,v!==0?S=zo(v):(M&=j,M!==0?S=zo(M):p||(p=j&~o,p!==0&&(S=zo(p))))):(j=v&~E,j!==0?S=zo(j):M!==0?S=zo(M):p||(p=v&~o,p!==0&&(S=zo(p)))),S===0?0:l!==0&&l!==S&&(l&E)===0&&(E=S&-S,p=l&-l,E>=p||E===32&&(p&4194048)!==0)?l:S}function gl(o,l){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&l)===0}function Sk(o,l){switch(o){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bw(){var o=Kf;return Kf<<=1,(Kf&62914560)===0&&(Kf=4194304),o}function ov(o){for(var l=[],p=0;31>p;p++)l.push(o);return l}function yl(o,l){o.pendingLanes|=l,l!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Ek(o,l,p,v,S,E){var M=o.pendingLanes;o.pendingLanes=p,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=p,o.entangledLanes&=p,o.errorRecoveryDisabledLanes&=p,o.shellSuspendCounter=0;var j=o.entanglements,et=o.expirationTimes,dt=o.hiddenUpdates;for(p=M&~p;0<p;){var Ct=31-St(p),Rt=1<<Ct;j[Ct]=0,et[Ct]=-1;var vt=dt[Ct];if(vt!==null)for(dt[Ct]=null,Ct=0;Ct<vt.length;Ct++){var bt=vt[Ct];bt!==null&&(bt.lane&=-536870913)}p&=~Rt}v!==0&&Lw(o,v,0),E!==0&&S===0&&o.tag!==0&&(o.suspendedLanes|=E&~(M&~l))}function Lw(o,l,p){o.pendingLanes|=l,o.suspendedLanes&=~l;var v=31-St(l);o.entangledLanes|=l,o.entanglements[v]=o.entanglements[v]|1073741824|p&261930}function Uw(o,l){var p=o.entangledLanes|=l;for(o=o.entanglements;p;){var v=31-St(p),S=1<<v;S&l|o[v]&l&&(o[v]|=l),p&=~S}}function jw(o,l){var p=l&-l;return p=(p&42)!==0?1:sv(p),(p&(o.suspendedLanes|l))!==0?0:p}function sv(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function uv(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Pw(){var o=X.p;return o!==0?o:(o=window.event,o===void 0?32:NC(o.type))}function Vw(o,l){var p=X.p;try{return X.p=o,l()}finally{X.p=p}}var Bi=Math.random().toString(36).slice(2),Wn="__reactFiber$"+Bi,pr="__reactProps$"+Bi,Hs="__reactContainer$"+Bi,lv="__reactEvents$"+Bi,Ck="__reactListeners$"+Bi,Ak="__reactHandles$"+Bi,qw="__reactResources$"+Bi,bl="__reactMarker$"+Bi;function cv(o){delete o[Wn],delete o[pr],delete o[lv],delete o[Ck],delete o[Ak]}function Gs(o){var l=o[Wn];if(l)return l;for(var p=o.parentNode;p;){if(l=p[Hs]||p[Wn]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(o=cC(o);o!==null;){if(p=o[Wn])return p;o=cC(o)}return l}o=p,p=o.parentNode}return null}function Xs(o){if(o=o[Wn]||o[Hs]){var l=o.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return o}return null}function xl(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o.stateNode;throw Error(n(33))}function Ks(o){var l=o[qw];return l||(l=o[qw]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Bn(o){o[bl]=!0}var Ww=new Set,Hw={};function Fo(o,l){Ys(o,l),Ys(o+"Capture",l)}function Ys(o,l){for(Hw[o]=l,o=0;o<l.length;o++)Ww.add(l[o])}var Nk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gw={},Xw={};function Tk(o){return Et.call(Xw,o)?!0:Et.call(Gw,o)?!1:Nk.test(o)?Xw[o]=!0:(Gw[o]=!0,!1)}function $f(o,l,p){if(Tk(l))if(p===null)o.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":o.removeAttribute(l);return;case"boolean":var v=l.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){o.removeAttribute(l);return}}o.setAttribute(l,""+p)}}function Qf(o,l,p){if(p===null)o.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(l);return}o.setAttribute(l,""+p)}}function Ka(o,l,p,v){if(v===null)o.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(p);return}o.setAttributeNS(l,p,""+v)}}function Pr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Kw(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Rk(o,l,p){var v=Object.getOwnPropertyDescriptor(o.constructor.prototype,l);if(!o.hasOwnProperty(l)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var S=v.get,E=v.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return S.call(this)},set:function(M){p=""+M,E.call(this,M)}}),Object.defineProperty(o,l,{enumerable:v.enumerable}),{getValue:function(){return p},setValue:function(M){p=""+M},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function fv(o){if(!o._valueTracker){var l=Kw(o)?"checked":"value";o._valueTracker=Rk(o,l,""+o[l])}}function Yw(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var p=l.getValue(),v="";return o&&(v=Kw(o)?o.checked?"true":"false":o.value),o=v,o!==p?(l.setValue(o),!0):!1}function Zf(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var _k=/[\n"\\]/g;function Vr(o){return o.replace(_k,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function hv(o,l,p,v,S,E,M,j){o.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?o.type=M:o.removeAttribute("type"),l!=null?M==="number"?(l===0&&o.value===""||o.value!=l)&&(o.value=""+Pr(l)):o.value!==""+Pr(l)&&(o.value=""+Pr(l)):M!=="submit"&&M!=="reset"||o.removeAttribute("value"),l!=null?pv(o,M,Pr(l)):p!=null?pv(o,M,Pr(p)):v!=null&&o.removeAttribute("value"),S==null&&E!=null&&(o.defaultChecked=!!E),S!=null&&(o.checked=S&&typeof S!="function"&&typeof S!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?o.name=""+Pr(j):o.removeAttribute("name")}function $w(o,l,p,v,S,E,M,j){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(o.type=E),l!=null||p!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){fv(o);return}p=p!=null?""+Pr(p):"",l=l!=null?""+Pr(l):p,j||l===o.value||(o.value=l),o.defaultValue=l}v=v??S,v=typeof v!="function"&&typeof v!="symbol"&&!!v,o.checked=j?o.checked:!!v,o.defaultChecked=!!v,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(o.name=M),fv(o)}function pv(o,l,p){l==="number"&&Zf(o.ownerDocument)===o||o.defaultValue===""+p||(o.defaultValue=""+p)}function $s(o,l,p,v){if(o=o.options,l){l={};for(var S=0;S<p.length;S++)l["$"+p[S]]=!0;for(p=0;p<o.length;p++)S=l.hasOwnProperty("$"+o[p].value),o[p].selected!==S&&(o[p].selected=S),S&&v&&(o[p].defaultSelected=!0)}else{for(p=""+Pr(p),l=null,S=0;S<o.length;S++){if(o[S].value===p){o[S].selected=!0,v&&(o[S].defaultSelected=!0);return}l!==null||o[S].disabled||(l=o[S])}l!==null&&(l.selected=!0)}}function Qw(o,l,p){if(l!=null&&(l=""+Pr(l),l!==o.value&&(o.value=l),p==null)){o.defaultValue!==l&&(o.defaultValue=l);return}o.defaultValue=p!=null?""+Pr(p):""}function Zw(o,l,p,v){if(l==null){if(v!=null){if(p!=null)throw Error(n(92));if(Q(v)){if(1<v.length)throw Error(n(93));v=v[0]}p=v}p==null&&(p=""),l=p}p=Pr(l),o.defaultValue=p,v=o.textContent,v===p&&v!==""&&v!==null&&(o.value=v),fv(o)}function Qs(o,l){if(l){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=l;return}}o.textContent=l}var Ok=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jw(o,l,p){var v=l.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?v?o.setProperty(l,""):l==="float"?o.cssFloat="":o[l]="":v?o.setProperty(l,p):typeof p!="number"||p===0||Ok.has(l)?l==="float"?o.cssFloat=p:o[l]=(""+p).trim():o[l]=p+"px"}function t2(o,l,p){if(l!=null&&typeof l!="object")throw Error(n(62));if(o=o.style,p!=null){for(var v in p)!p.hasOwnProperty(v)||l!=null&&l.hasOwnProperty(v)||(v.indexOf("--")===0?o.setProperty(v,""):v==="float"?o.cssFloat="":o[v]="");for(var S in l)v=l[S],l.hasOwnProperty(S)&&p[S]!==v&&Jw(o,S,v)}else for(var E in l)l.hasOwnProperty(E)&&Jw(o,E,l[E])}function dv(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ik=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jf(o){return Ik.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function Ya(){}var mv=null;function vv(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Zs=null,Js=null;function e2(o){var l=Xs(o);if(l&&(o=l.stateNode)){var p=o[pr]||null;t:switch(o=l.stateNode,l.type){case"input":if(hv(o,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),l=p.name,p.type==="radio"&&l!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Vr(""+l)+'"][type="radio"]'),l=0;l<p.length;l++){var v=p[l];if(v!==o&&v.form===o.form){var S=v[pr]||null;if(!S)throw Error(n(90));hv(v,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(l=0;l<p.length;l++)v=p[l],v.form===o.form&&Yw(v)}break t;case"textarea":Qw(o,p.value,p.defaultValue);break t;case"select":l=p.value,l!=null&&$s(o,!!p.multiple,l,!1)}}}var gv=!1;function n2(o,l,p){if(gv)return o(l,p);gv=!0;try{var v=o(l);return v}finally{if(gv=!1,(Zs!==null||Js!==null)&&(jh(),Zs&&(l=Zs,o=Js,Js=Zs=null,e2(l),o)))for(l=0;l<o.length;l++)e2(o[l])}}function wl(o,l){var p=o.stateNode;if(p===null)return null;var v=p[pr]||null;if(v===null)return null;p=v[l];t:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break t;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yv=!1;if($a)try{var Sl={};Object.defineProperty(Sl,"passive",{get:function(){yv=!0}}),window.addEventListener("test",Sl,Sl),window.removeEventListener("test",Sl,Sl)}catch{yv=!1}var Li=null,bv=null,th=null;function r2(){if(th)return th;var o,l=bv,p=l.length,v,S="value"in Li?Li.value:Li.textContent,E=S.length;for(o=0;o<p&&l[o]===S[o];o++);var M=p-o;for(v=1;v<=M&&l[p-v]===S[E-v];v++);return th=S.slice(o,1<v?1-v:void 0)}function eh(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function nh(){return!0}function a2(){return!1}function dr(o){function l(p,v,S,E,M){this._reactName=p,this._targetInst=S,this.type=v,this.nativeEvent=E,this.target=M,this.currentTarget=null;for(var j in o)o.hasOwnProperty(j)&&(p=o[j],this[j]=p?p(E):E[j]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?nh:a2,this.isPropagationStopped=a2,this}return d(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=nh)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=nh)},persist:function(){},isPersistent:nh}),l}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rh=dr(Bo),El=d({},Bo,{view:0,detail:0}),kk=dr(El),xv,wv,Cl,ah=d({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ev,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Cl&&(Cl&&o.type==="mousemove"?(xv=o.screenX-Cl.screenX,wv=o.screenY-Cl.screenY):wv=xv=0,Cl=o),xv)},movementY:function(o){return"movementY"in o?o.movementY:wv}}),i2=dr(ah),Mk=d({},ah,{dataTransfer:0}),zk=dr(Mk),Fk=d({},El,{relatedTarget:0}),Sv=dr(Fk),Bk=d({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Lk=dr(Bk),Uk=d({},Bo,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),jk=dr(Uk),Pk=d({},Bo,{data:0}),o2=dr(Pk),Vk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hk(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=Wk[o])?!!l[o]:!1}function Ev(){return Hk}var Gk=d({},El,{key:function(o){if(o.key){var l=Vk[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=eh(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?qk[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ev,charCode:function(o){return o.type==="keypress"?eh(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?eh(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Xk=dr(Gk),Kk=d({},ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s2=dr(Kk),Yk=d({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ev}),$k=dr(Yk),Qk=d({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zk=dr(Qk),Jk=d({},ah,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),tM=dr(Jk),eM=d({},Bo,{newState:0,oldState:0}),nM=dr(eM),rM=[9,13,27,32],Cv=$a&&"CompositionEvent"in window,Al=null;$a&&"documentMode"in document&&(Al=document.documentMode);var aM=$a&&"TextEvent"in window&&!Al,u2=$a&&(!Cv||Al&&8<Al&&11>=Al),l2=" ",c2=!1;function f2(o,l){switch(o){case"keyup":return rM.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h2(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var tu=!1;function iM(o,l){switch(o){case"compositionend":return h2(l);case"keypress":return l.which!==32?null:(c2=!0,l2);case"textInput":return o=l.data,o===l2&&c2?null:o;default:return null}}function oM(o,l){if(tu)return o==="compositionend"||!Cv&&f2(o,l)?(o=r2(),th=bv=Li=null,tu=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return u2&&l.locale!=="ko"?null:l.data;default:return null}}var sM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p2(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!sM[o.type]:l==="textarea"}function d2(o,l,p,v){Zs?Js?Js.push(v):Js=[v]:Zs=v,l=Xh(l,"onChange"),0<l.length&&(p=new rh("onChange","change",null,p,v),o.push({event:p,listeners:l}))}var Nl=null,Tl=null;function uM(o){$E(o,0)}function ih(o){var l=xl(o);if(Yw(l))return o}function m2(o,l){if(o==="change")return l}var v2=!1;if($a){var Av;if($a){var Nv="oninput"in document;if(!Nv){var g2=document.createElement("div");g2.setAttribute("oninput","return;"),Nv=typeof g2.oninput=="function"}Av=Nv}else Av=!1;v2=Av&&(!document.documentMode||9<document.documentMode)}function y2(){Nl&&(Nl.detachEvent("onpropertychange",b2),Tl=Nl=null)}function b2(o){if(o.propertyName==="value"&&ih(Tl)){var l=[];d2(l,Tl,o,vv(o)),n2(uM,l)}}function lM(o,l,p){o==="focusin"?(y2(),Nl=l,Tl=p,Nl.attachEvent("onpropertychange",b2)):o==="focusout"&&y2()}function cM(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return ih(Tl)}function fM(o,l){if(o==="click")return ih(l)}function hM(o,l){if(o==="input"||o==="change")return ih(l)}function pM(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Ar=typeof Object.is=="function"?Object.is:pM;function Rl(o,l){if(Ar(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var p=Object.keys(o),v=Object.keys(l);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var S=p[v];if(!Et.call(l,S)||!Ar(o[S],l[S]))return!1}return!0}function x2(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function w2(o,l){var p=x2(o);o=0;for(var v;p;){if(p.nodeType===3){if(v=o+p.textContent.length,o<=l&&v>=l)return{node:p,offset:l-o};o=v}t:{for(;p;){if(p.nextSibling){p=p.nextSibling;break t}p=p.parentNode}p=void 0}p=x2(p)}}function S2(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?S2(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function E2(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var l=Zf(o.document);l instanceof o.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)o=l.contentWindow;else break;l=Zf(o.document)}return l}function Tv(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}var dM=$a&&"documentMode"in document&&11>=document.documentMode,eu=null,Rv=null,_l=null,_v=!1;function C2(o,l,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;_v||eu==null||eu!==Zf(v)||(v=eu,"selectionStart"in v&&Tv(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),_l&&Rl(_l,v)||(_l=v,v=Xh(Rv,"onSelect"),0<v.length&&(l=new rh("onSelect","select",null,l,p),o.push({event:l,listeners:v}),l.target=eu)))}function Lo(o,l){var p={};return p[o.toLowerCase()]=l.toLowerCase(),p["Webkit"+o]="webkit"+l,p["Moz"+o]="moz"+l,p}var nu={animationend:Lo("Animation","AnimationEnd"),animationiteration:Lo("Animation","AnimationIteration"),animationstart:Lo("Animation","AnimationStart"),transitionrun:Lo("Transition","TransitionRun"),transitionstart:Lo("Transition","TransitionStart"),transitioncancel:Lo("Transition","TransitionCancel"),transitionend:Lo("Transition","TransitionEnd")},Ov={},A2={};$a&&(A2=document.createElement("div").style,"AnimationEvent"in window||(delete nu.animationend.animation,delete nu.animationiteration.animation,delete nu.animationstart.animation),"TransitionEvent"in window||delete nu.transitionend.transition);function Uo(o){if(Ov[o])return Ov[o];if(!nu[o])return o;var l=nu[o],p;for(p in l)if(l.hasOwnProperty(p)&&p in A2)return Ov[o]=l[p];return o}var N2=Uo("animationend"),T2=Uo("animationiteration"),R2=Uo("animationstart"),mM=Uo("transitionrun"),vM=Uo("transitionstart"),gM=Uo("transitioncancel"),_2=Uo("transitionend"),O2=new Map,Dv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dv.push("scrollEnd");function ra(o,l){O2.set(o,l),Fo(l,[o])}var oh=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(l))return}else if(typeof Rn=="object"&&typeof Rn.emit=="function"){Rn.emit("uncaughtException",o);return}console.error(o)},qr=[],ru=0,Iv=0;function sh(){for(var o=ru,l=Iv=ru=0;l<o;){var p=qr[l];qr[l++]=null;var v=qr[l];qr[l++]=null;var S=qr[l];qr[l++]=null;var E=qr[l];if(qr[l++]=null,v!==null&&S!==null){var M=v.pending;M===null?S.next=S:(S.next=M.next,M.next=S),v.pending=S}E!==0&&D2(p,S,E)}}function uh(o,l,p,v){qr[ru++]=o,qr[ru++]=l,qr[ru++]=p,qr[ru++]=v,Iv|=v,o.lanes|=v,o=o.alternate,o!==null&&(o.lanes|=v)}function kv(o,l,p,v){return uh(o,l,p,v),lh(o)}function jo(o,l){return uh(o,null,null,l),lh(o)}function D2(o,l,p){o.lanes|=p;var v=o.alternate;v!==null&&(v.lanes|=p);for(var S=!1,E=o.return;E!==null;)E.childLanes|=p,v=E.alternate,v!==null&&(v.childLanes|=p),E.tag===22&&(o=E.stateNode,o===null||o._visibility&1||(S=!0)),o=E,E=E.return;return o.tag===3?(E=o.stateNode,S&&l!==null&&(S=31-St(p),o=E.hiddenUpdates,v=o[S],v===null?o[S]=[l]:v.push(l),l.lane=p|536870912),E):null}function lh(o){if(50<Ql)throw Ql=0,Vg=null,Error(n(185));for(var l=o.return;l!==null;)o=l,l=o.return;return o.tag===3?o.stateNode:null}var au={};function yM(o,l,p,v){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(o,l,p,v){return new yM(o,l,p,v)}function Mv(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Qa(o,l){var p=o.alternate;return p===null?(p=Nr(o.tag,l,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=l,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&65011712,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,l=o.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p.refCleanup=o.refCleanup,p}function I2(o,l){o.flags&=65011714;var p=o.alternate;return p===null?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=p.childLanes,o.lanes=p.lanes,o.child=p.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=p.memoizedProps,o.memoizedState=p.memoizedState,o.updateQueue=p.updateQueue,o.type=p.type,l=p.dependencies,o.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),o}function ch(o,l,p,v,S,E){var M=0;if(v=o,typeof o=="function")Mv(o)&&(M=1);else if(typeof o=="string")M=Ez(o,p,Z.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case k:return o=Nr(31,p,l,S),o.elementType=k,o.lanes=E,o;case x:return Po(p.children,S,E,l);case w:M=8,S|=24;break;case b:return o=Nr(12,p,l,S|2),o.elementType=b,o.lanes=E,o;case R:return o=Nr(13,p,l,S),o.elementType=R,o.lanes=E,o;case D:return o=Nr(19,p,l,S),o.elementType=D,o.lanes=E,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case A:M=10;break t;case C:M=9;break t;case T:M=11;break t;case N:M=14;break t;case O:M=16,v=null;break t}M=29,p=Error(n(130,o===null?"null":typeof o,"")),v=null}return l=Nr(M,p,l,S),l.elementType=o,l.type=v,l.lanes=E,l}function Po(o,l,p,v){return o=Nr(7,o,v,l),o.lanes=p,o}function zv(o,l,p){return o=Nr(6,o,null,l),o.lanes=p,o}function k2(o){var l=Nr(18,null,null,0);return l.stateNode=o,l}function Fv(o,l,p){return l=Nr(4,o.children!==null?o.children:[],o.key,l),l.lanes=p,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}var M2=new WeakMap;function Wr(o,l){if(typeof o=="object"&&o!==null){var p=M2.get(o);return p!==void 0?p:(l={value:o,source:l,stack:cn(l)},M2.set(o,l),l)}return{value:o,source:l,stack:cn(l)}}var iu=[],ou=0,fh=null,Ol=0,Hr=[],Gr=0,Ui=null,Na=1,Ta="";function Za(o,l){iu[ou++]=Ol,iu[ou++]=fh,fh=o,Ol=l}function z2(o,l,p){Hr[Gr++]=Na,Hr[Gr++]=Ta,Hr[Gr++]=Ui,Ui=o;var v=Na;o=Ta;var S=32-St(v)-1;v&=~(1<<S),p+=1;var E=32-St(l)+S;if(30<E){var M=S-S%5;E=(v&(1<<M)-1).toString(32),v>>=M,S-=M,Na=1<<32-St(l)+S|p<<S|v,Ta=E+o}else Na=1<<E|p<<S|v,Ta=o}function Bv(o){o.return!==null&&(Za(o,1),z2(o,1,0))}function Lv(o){for(;o===fh;)fh=iu[--ou],iu[ou]=null,Ol=iu[--ou],iu[ou]=null;for(;o===Ui;)Ui=Hr[--Gr],Hr[Gr]=null,Ta=Hr[--Gr],Hr[Gr]=null,Na=Hr[--Gr],Hr[Gr]=null}function F2(o,l){Hr[Gr++]=Na,Hr[Gr++]=Ta,Hr[Gr++]=Ui,Na=l.id,Ta=l.overflow,Ui=o}var Hn=null,Ke=null,Se=!1,ji=null,Xr=!1,Uv=Error(n(519));function Pi(o){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Dl(Wr(l,o)),Uv}function B2(o){var l=o.stateNode,p=o.type,v=o.memoizedProps;switch(l[Wn]=o,l[pr]=v,p){case"dialog":ve("cancel",l),ve("close",l);break;case"iframe":case"object":case"embed":ve("load",l);break;case"video":case"audio":for(p=0;p<Jl.length;p++)ve(Jl[p],l);break;case"source":ve("error",l);break;case"img":case"image":case"link":ve("error",l),ve("load",l);break;case"details":ve("toggle",l);break;case"input":ve("invalid",l),$w(l,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0);break;case"select":ve("invalid",l);break;case"textarea":ve("invalid",l),Zw(l,v.value,v.defaultValue,v.children)}p=v.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||l.textContent===""+p||v.suppressHydrationWarning===!0||tC(l.textContent,p)?(v.popover!=null&&(ve("beforetoggle",l),ve("toggle",l)),v.onScroll!=null&&ve("scroll",l),v.onScrollEnd!=null&&ve("scrollend",l),v.onClick!=null&&(l.onclick=Ya),l=!0):l=!1,l||Pi(o,!0)}function L2(o){for(Hn=o.return;Hn;)switch(Hn.tag){case 5:case 31:case 13:Xr=!1;return;case 27:case 3:Xr=!0;return;default:Hn=Hn.return}}function su(o){if(o!==Hn)return!1;if(!Se)return L2(o),Se=!0,!1;var l=o.tag,p;if((p=l!==3&&l!==27)&&((p=l===5)&&(p=o.type,p=!(p!=="form"&&p!=="button")||ry(o.type,o.memoizedProps)),p=!p),p&&Ke&&Pi(o),L2(o),l===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));Ke=lC(o)}else if(l===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));Ke=lC(o)}else l===27?(l=Ke,eo(o.type)?(o=uy,uy=null,Ke=o):Ke=l):Ke=Hn?Yr(o.stateNode.nextSibling):null;return!0}function Vo(){Ke=Hn=null,Se=!1}function jv(){var o=ji;return o!==null&&(yr===null?yr=o:yr.push.apply(yr,o),ji=null),o}function Dl(o){ji===null?ji=[o]:ji.push(o)}var Pv=q(null),qo=null,Ja=null;function Vi(o,l,p){W(Pv,l._currentValue),l._currentValue=p}function ti(o){o._currentValue=Pv.current,nt(Pv)}function Vv(o,l,p){for(;o!==null;){var v=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,v!==null&&(v.childLanes|=l)):v!==null&&(v.childLanes&l)!==l&&(v.childLanes|=l),o===p)break;o=o.return}}function qv(o,l,p,v){var S=o.child;for(S!==null&&(S.return=o);S!==null;){var E=S.dependencies;if(E!==null){var M=S.child;E=E.firstContext;t:for(;E!==null;){var j=E;E=S;for(var et=0;et<l.length;et++)if(j.context===l[et]){E.lanes|=p,j=E.alternate,j!==null&&(j.lanes|=p),Vv(E.return,p,o),v||(M=null);break t}E=j.next}}else if(S.tag===18){if(M=S.return,M===null)throw Error(n(341));M.lanes|=p,E=M.alternate,E!==null&&(E.lanes|=p),Vv(M,p,o),M=null}else M=S.child;if(M!==null)M.return=S;else for(M=S;M!==null;){if(M===o){M=null;break}if(S=M.sibling,S!==null){S.return=M.return,M=S;break}M=M.return}S=M}}function uu(o,l,p,v){o=null;for(var S=l,E=!1;S!==null;){if(!E){if((S.flags&524288)!==0)E=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var M=S.alternate;if(M===null)throw Error(n(387));if(M=M.memoizedProps,M!==null){var j=S.type;Ar(S.pendingProps.value,M.value)||(o!==null?o.push(j):o=[j])}}else if(S===Ot.current){if(M=S.alternate,M===null)throw Error(n(387));M.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(o!==null?o.push(ac):o=[ac])}S=S.return}o!==null&&qv(l,o,p,v),l.flags|=262144}function hh(o){for(o=o.firstContext;o!==null;){if(!Ar(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Wo(o){qo=o,Ja=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Gn(o){return U2(qo,o)}function ph(o,l){return qo===null&&Wo(o),U2(o,l)}function U2(o,l){var p=l._currentValue;if(l={context:l,memoizedValue:p,next:null},Ja===null){if(o===null)throw Error(n(308));Ja=l,o.dependencies={lanes:0,firstContext:l},o.flags|=524288}else Ja=Ja.next=l;return p}var bM=typeof AbortController<"u"?AbortController:function(){var o=[],l=this.signal={aborted:!1,addEventListener:function(p,v){o.push(v)}};this.abort=function(){l.aborted=!0,o.forEach(function(p){return p()})}},xM=r.unstable_scheduleCallback,wM=r.unstable_NormalPriority,En={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wv(){return{controller:new bM,data:new Map,refCount:0}}function Il(o){o.refCount--,o.refCount===0&&xM(wM,function(){o.controller.abort()})}var kl=null,Hv=0,lu=0,cu=null;function SM(o,l){if(kl===null){var p=kl=[];Hv=0,lu=Kg(),cu={status:"pending",value:void 0,then:function(v){p.push(v)}}}return Hv++,l.then(j2,j2),l}function j2(){if(--Hv===0&&kl!==null){cu!==null&&(cu.status="fulfilled");var o=kl;kl=null,lu=0,cu=null;for(var l=0;l<o.length;l++)(0,o[l])()}}function EM(o,l){var p=[],v={status:"pending",value:null,reason:null,then:function(S){p.push(S)}};return o.then(function(){v.status="fulfilled",v.value=l;for(var S=0;S<p.length;S++)(0,p[S])(l)},function(S){for(v.status="rejected",v.reason=S,S=0;S<p.length;S++)(0,p[S])(void 0)}),v}var P2=L.S;L.S=function(o,l){CE=de(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&SM(o,l),P2!==null&&P2(o,l)};var Ho=q(null);function Gv(){var o=Ho.current;return o!==null?o:qe.pooledCache}function dh(o,l){l===null?W(Ho,Ho.current):W(Ho,l.pool)}function V2(){var o=Gv();return o===null?null:{parent:En._currentValue,pool:o}}var fu=Error(n(460)),Xv=Error(n(474)),mh=Error(n(542)),vh={then:function(){}};function q2(o){return o=o.status,o==="fulfilled"||o==="rejected"}function W2(o,l,p){switch(p=o[p],p===void 0?o.push(l):p!==l&&(l.then(Ya,Ya),l=p),l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,G2(o),o;default:if(typeof l.status=="string")l.then(Ya,Ya);else{if(o=qe,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=l,o.status="pending",o.then(function(v){if(l.status==="pending"){var S=l;S.status="fulfilled",S.value=v}},function(v){if(l.status==="pending"){var S=l;S.status="rejected",S.reason=v}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,G2(o),o}throw Xo=l,fu}}function Go(o){try{var l=o._init;return l(o._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Xo=p,fu):p}}var Xo=null;function H2(){if(Xo===null)throw Error(n(459));var o=Xo;return Xo=null,o}function G2(o){if(o===fu||o===mh)throw Error(n(483))}var hu=null,Ml=0;function gh(o){var l=Ml;return Ml+=1,hu===null&&(hu=[]),W2(hu,o,l)}function zl(o,l){l=l.props.ref,o.ref=l!==void 0?l:null}function yh(o,l){throw l.$$typeof===m?Error(n(525)):(o=Object.prototype.toString.call(l),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o)))}function X2(o){function l(ct,ut){if(o){var pt=ct.deletions;pt===null?(ct.deletions=[ut],ct.flags|=16):pt.push(ut)}}function p(ct,ut){if(!o)return null;for(;ut!==null;)l(ct,ut),ut=ut.sibling;return null}function v(ct){for(var ut=new Map;ct!==null;)ct.key!==null?ut.set(ct.key,ct):ut.set(ct.index,ct),ct=ct.sibling;return ut}function S(ct,ut){return ct=Qa(ct,ut),ct.index=0,ct.sibling=null,ct}function E(ct,ut,pt){return ct.index=pt,o?(pt=ct.alternate,pt!==null?(pt=pt.index,pt<ut?(ct.flags|=67108866,ut):pt):(ct.flags|=67108866,ut)):(ct.flags|=1048576,ut)}function M(ct){return o&&ct.alternate===null&&(ct.flags|=67108866),ct}function j(ct,ut,pt,Tt){return ut===null||ut.tag!==6?(ut=zv(pt,ct.mode,Tt),ut.return=ct,ut):(ut=S(ut,pt),ut.return=ct,ut)}function et(ct,ut,pt,Tt){var Yt=pt.type;return Yt===x?Ct(ct,ut,pt.props.children,Tt,pt.key):ut!==null&&(ut.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===O&&Go(Yt)===ut.type)?(ut=S(ut,pt.props),zl(ut,pt),ut.return=ct,ut):(ut=ch(pt.type,pt.key,pt.props,null,ct.mode,Tt),zl(ut,pt),ut.return=ct,ut)}function dt(ct,ut,pt,Tt){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==pt.containerInfo||ut.stateNode.implementation!==pt.implementation?(ut=Fv(pt,ct.mode,Tt),ut.return=ct,ut):(ut=S(ut,pt.children||[]),ut.return=ct,ut)}function Ct(ct,ut,pt,Tt,Yt){return ut===null||ut.tag!==7?(ut=Po(pt,ct.mode,Tt,Yt),ut.return=ct,ut):(ut=S(ut,pt),ut.return=ct,ut)}function Rt(ct,ut,pt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return ut=zv(""+ut,ct.mode,pt),ut.return=ct,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case g:return pt=ch(ut.type,ut.key,ut.props,null,ct.mode,pt),zl(pt,ut),pt.return=ct,pt;case y:return ut=Fv(ut,ct.mode,pt),ut.return=ct,ut;case O:return ut=Go(ut),Rt(ct,ut,pt)}if(Q(ut)||B(ut))return ut=Po(ut,ct.mode,pt,null),ut.return=ct,ut;if(typeof ut.then=="function")return Rt(ct,gh(ut),pt);if(ut.$$typeof===A)return Rt(ct,ph(ct,ut),pt);yh(ct,ut)}return null}function vt(ct,ut,pt,Tt){var Yt=ut!==null?ut.key:null;if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return Yt!==null?null:j(ct,ut,""+pt,Tt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case g:return pt.key===Yt?et(ct,ut,pt,Tt):null;case y:return pt.key===Yt?dt(ct,ut,pt,Tt):null;case O:return pt=Go(pt),vt(ct,ut,pt,Tt)}if(Q(pt)||B(pt))return Yt!==null?null:Ct(ct,ut,pt,Tt,null);if(typeof pt.then=="function")return vt(ct,ut,gh(pt),Tt);if(pt.$$typeof===A)return vt(ct,ut,ph(ct,pt),Tt);yh(ct,pt)}return null}function bt(ct,ut,pt,Tt,Yt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return ct=ct.get(pt)||null,j(ut,ct,""+Tt,Yt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case g:return ct=ct.get(Tt.key===null?pt:Tt.key)||null,et(ut,ct,Tt,Yt);case y:return ct=ct.get(Tt.key===null?pt:Tt.key)||null,dt(ut,ct,Tt,Yt);case O:return Tt=Go(Tt),bt(ct,ut,pt,Tt,Yt)}if(Q(Tt)||B(Tt))return ct=ct.get(pt)||null,Ct(ut,ct,Tt,Yt,null);if(typeof Tt.then=="function")return bt(ct,ut,pt,gh(Tt),Yt);if(Tt.$$typeof===A)return bt(ct,ut,pt,ph(ut,Tt),Yt);yh(ut,Tt)}return null}function qt(ct,ut,pt,Tt){for(var Yt=null,Oe=null,Xt=ut,ce=ut=0,xe=null;Xt!==null&&ce<pt.length;ce++){Xt.index>ce?(xe=Xt,Xt=null):xe=Xt.sibling;var De=vt(ct,Xt,pt[ce],Tt);if(De===null){Xt===null&&(Xt=xe);break}o&&Xt&&De.alternate===null&&l(ct,Xt),ut=E(De,ut,ce),Oe===null?Yt=De:Oe.sibling=De,Oe=De,Xt=xe}if(ce===pt.length)return p(ct,Xt),Se&&Za(ct,ce),Yt;if(Xt===null){for(;ce<pt.length;ce++)Xt=Rt(ct,pt[ce],Tt),Xt!==null&&(ut=E(Xt,ut,ce),Oe===null?Yt=Xt:Oe.sibling=Xt,Oe=Xt);return Se&&Za(ct,ce),Yt}for(Xt=v(Xt);ce<pt.length;ce++)xe=bt(Xt,ct,ce,pt[ce],Tt),xe!==null&&(o&&xe.alternate!==null&&Xt.delete(xe.key===null?ce:xe.key),ut=E(xe,ut,ce),Oe===null?Yt=xe:Oe.sibling=xe,Oe=xe);return o&&Xt.forEach(function(oo){return l(ct,oo)}),Se&&Za(ct,ce),Yt}function Qt(ct,ut,pt,Tt){if(pt==null)throw Error(n(151));for(var Yt=null,Oe=null,Xt=ut,ce=ut=0,xe=null,De=pt.next();Xt!==null&&!De.done;ce++,De=pt.next()){Xt.index>ce?(xe=Xt,Xt=null):xe=Xt.sibling;var oo=vt(ct,Xt,De.value,Tt);if(oo===null){Xt===null&&(Xt=xe);break}o&&Xt&&oo.alternate===null&&l(ct,Xt),ut=E(oo,ut,ce),Oe===null?Yt=oo:Oe.sibling=oo,Oe=oo,Xt=xe}if(De.done)return p(ct,Xt),Se&&Za(ct,ce),Yt;if(Xt===null){for(;!De.done;ce++,De=pt.next())De=Rt(ct,De.value,Tt),De!==null&&(ut=E(De,ut,ce),Oe===null?Yt=De:Oe.sibling=De,Oe=De);return Se&&Za(ct,ce),Yt}for(Xt=v(Xt);!De.done;ce++,De=pt.next())De=bt(Xt,ct,ce,De.value,Tt),De!==null&&(o&&De.alternate!==null&&Xt.delete(De.key===null?ce:De.key),ut=E(De,ut,ce),Oe===null?Yt=De:Oe.sibling=De,Oe=De);return o&&Xt.forEach(function(Mz){return l(ct,Mz)}),Se&&Za(ct,ce),Yt}function Pe(ct,ut,pt,Tt){if(typeof pt=="object"&&pt!==null&&pt.type===x&&pt.key===null&&(pt=pt.props.children),typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case g:t:{for(var Yt=pt.key;ut!==null;){if(ut.key===Yt){if(Yt=pt.type,Yt===x){if(ut.tag===7){p(ct,ut.sibling),Tt=S(ut,pt.props.children),Tt.return=ct,ct=Tt;break t}}else if(ut.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===O&&Go(Yt)===ut.type){p(ct,ut.sibling),Tt=S(ut,pt.props),zl(Tt,pt),Tt.return=ct,ct=Tt;break t}p(ct,ut);break}else l(ct,ut);ut=ut.sibling}pt.type===x?(Tt=Po(pt.props.children,ct.mode,Tt,pt.key),Tt.return=ct,ct=Tt):(Tt=ch(pt.type,pt.key,pt.props,null,ct.mode,Tt),zl(Tt,pt),Tt.return=ct,ct=Tt)}return M(ct);case y:t:{for(Yt=pt.key;ut!==null;){if(ut.key===Yt)if(ut.tag===4&&ut.stateNode.containerInfo===pt.containerInfo&&ut.stateNode.implementation===pt.implementation){p(ct,ut.sibling),Tt=S(ut,pt.children||[]),Tt.return=ct,ct=Tt;break t}else{p(ct,ut);break}else l(ct,ut);ut=ut.sibling}Tt=Fv(pt,ct.mode,Tt),Tt.return=ct,ct=Tt}return M(ct);case O:return pt=Go(pt),Pe(ct,ut,pt,Tt)}if(Q(pt))return qt(ct,ut,pt,Tt);if(B(pt)){if(Yt=B(pt),typeof Yt!="function")throw Error(n(150));return pt=Yt.call(pt),Qt(ct,ut,pt,Tt)}if(typeof pt.then=="function")return Pe(ct,ut,gh(pt),Tt);if(pt.$$typeof===A)return Pe(ct,ut,ph(ct,pt),Tt);yh(ct,pt)}return typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint"?(pt=""+pt,ut!==null&&ut.tag===6?(p(ct,ut.sibling),Tt=S(ut,pt),Tt.return=ct,ct=Tt):(p(ct,ut),Tt=zv(pt,ct.mode,Tt),Tt.return=ct,ct=Tt),M(ct)):p(ct,ut)}return function(ct,ut,pt,Tt){try{Ml=0;var Yt=Pe(ct,ut,pt,Tt);return hu=null,Yt}catch(Xt){if(Xt===fu||Xt===mh)throw Xt;var Oe=Nr(29,Xt,null,ct.mode);return Oe.lanes=Tt,Oe.return=ct,Oe}}}var Ko=X2(!0),K2=X2(!1),qi=!1;function Kv(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yv(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Wi(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Hi(o,l,p){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(ke&2)!==0){var S=v.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),v.pending=l,l=lh(o),D2(o,null,p),l}return uh(o,v,l,p),lh(o)}function Fl(o,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194048)!==0)){var v=l.lanes;v&=o.pendingLanes,p|=v,l.lanes=p,Uw(o,p)}}function $v(o,l){var p=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var S=null,E=null;if(p=p.firstBaseUpdate,p!==null){do{var M={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};E===null?S=E=M:E=E.next=M,p=p.next}while(p!==null);E===null?S=E=l:E=E.next=l}else S=E=l;p={baseState:v.baseState,firstBaseUpdate:S,lastBaseUpdate:E,shared:v.shared,callbacks:v.callbacks},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=l:o.next=l,p.lastBaseUpdate=l}var Qv=!1;function Bl(){if(Qv){var o=cu;if(o!==null)throw o}}function Ll(o,l,p,v){Qv=!1;var S=o.updateQueue;qi=!1;var E=S.firstBaseUpdate,M=S.lastBaseUpdate,j=S.shared.pending;if(j!==null){S.shared.pending=null;var et=j,dt=et.next;et.next=null,M===null?E=dt:M.next=dt,M=et;var Ct=o.alternate;Ct!==null&&(Ct=Ct.updateQueue,j=Ct.lastBaseUpdate,j!==M&&(j===null?Ct.firstBaseUpdate=dt:j.next=dt,Ct.lastBaseUpdate=et))}if(E!==null){var Rt=S.baseState;M=0,Ct=dt=et=null,j=E;do{var vt=j.lane&-536870913,bt=vt!==j.lane;if(bt?(be&vt)===vt:(v&vt)===vt){vt!==0&&vt===lu&&(Qv=!0),Ct!==null&&(Ct=Ct.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});t:{var qt=o,Qt=j;vt=l;var Pe=p;switch(Qt.tag){case 1:if(qt=Qt.payload,typeof qt=="function"){Rt=qt.call(Pe,Rt,vt);break t}Rt=qt;break t;case 3:qt.flags=qt.flags&-65537|128;case 0:if(qt=Qt.payload,vt=typeof qt=="function"?qt.call(Pe,Rt,vt):qt,vt==null)break t;Rt=d({},Rt,vt);break t;case 2:qi=!0}}vt=j.callback,vt!==null&&(o.flags|=64,bt&&(o.flags|=8192),bt=S.callbacks,bt===null?S.callbacks=[vt]:bt.push(vt))}else bt={lane:vt,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Ct===null?(dt=Ct=bt,et=Rt):Ct=Ct.next=bt,M|=vt;if(j=j.next,j===null){if(j=S.shared.pending,j===null)break;bt=j,j=bt.next,bt.next=null,S.lastBaseUpdate=bt,S.shared.pending=null}}while(!0);Ct===null&&(et=Rt),S.baseState=et,S.firstBaseUpdate=dt,S.lastBaseUpdate=Ct,E===null&&(S.shared.lanes=0),$i|=M,o.lanes=M,o.memoizedState=Rt}}function Y2(o,l){if(typeof o!="function")throw Error(n(191,o));o.call(l)}function $2(o,l){var p=o.callbacks;if(p!==null)for(o.callbacks=null,o=0;o<p.length;o++)Y2(p[o],l)}var pu=q(null),bh=q(0);function Q2(o,l){o=li,W(bh,o),W(pu,l),li=o|l.baseLanes}function Zv(){W(bh,li),W(pu,pu.current)}function Jv(){li=bh.current,nt(pu),nt(bh)}var Tr=q(null),Kr=null;function Gi(o){var l=o.alternate;W(bn,bn.current&1),W(Tr,o),Kr===null&&(l===null||pu.current!==null||l.memoizedState!==null)&&(Kr=o)}function tg(o){W(bn,bn.current),W(Tr,o),Kr===null&&(Kr=o)}function Z2(o){o.tag===22?(W(bn,bn.current),W(Tr,o),Kr===null&&(Kr=o)):Xi()}function Xi(){W(bn,bn.current),W(Tr,Tr.current)}function Rr(o){nt(Tr),Kr===o&&(Kr=null),nt(bn)}var bn=q(0);function xh(o){for(var l=o;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||oy(p)||sy(p)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ei=0,ue=null,Ue=null,Cn=null,wh=!1,du=!1,Yo=!1,Sh=0,Ul=0,mu=null,CM=0;function hn(){throw Error(n(321))}function eg(o,l){if(l===null)return!1;for(var p=0;p<l.length&&p<o.length;p++)if(!Ar(o[p],l[p]))return!1;return!0}function ng(o,l,p,v,S,E){return ei=E,ue=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,L.H=o===null||o.memoizedState===null?zS:gg,Yo=!1,E=p(v,S),Yo=!1,du&&(E=tS(l,p,v,S)),J2(o),E}function J2(o){L.H=Vl;var l=Ue!==null&&Ue.next!==null;if(ei=0,Cn=Ue=ue=null,wh=!1,Ul=0,mu=null,l)throw Error(n(300));o===null||An||(o=o.dependencies,o!==null&&hh(o)&&(An=!0))}function tS(o,l,p,v){ue=o;var S=0;do{if(du&&(mu=null),Ul=0,du=!1,25<=S)throw Error(n(301));if(S+=1,Cn=Ue=null,o.updateQueue!=null){var E=o.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}L.H=FS,E=l(p,v)}while(du);return E}function AM(){var o=L.H,l=o.useState()[0];return l=typeof l.then=="function"?jl(l):l,o=o.useState()[0],(Ue!==null?Ue.memoizedState:null)!==o&&(ue.flags|=1024),l}function rg(){var o=Sh!==0;return Sh=0,o}function ag(o,l,p){l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~p}function ig(o){if(wh){for(o=o.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}wh=!1}ei=0,Cn=Ue=ue=null,du=!1,Ul=Sh=0,mu=null}function rr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?ue.memoizedState=Cn=o:Cn=Cn.next=o,Cn}function xn(){if(Ue===null){var o=ue.alternate;o=o!==null?o.memoizedState:null}else o=Ue.next;var l=Cn===null?ue.memoizedState:Cn.next;if(l!==null)Cn=l,Ue=o;else{if(o===null)throw ue.alternate===null?Error(n(467)):Error(n(310));Ue=o,o={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},Cn===null?ue.memoizedState=Cn=o:Cn=Cn.next=o}return Cn}function Eh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jl(o){var l=Ul;return Ul+=1,mu===null&&(mu=[]),o=W2(mu,o,l),l=ue,(Cn===null?l.memoizedState:Cn.next)===null&&(l=l.alternate,L.H=l===null||l.memoizedState===null?zS:gg),o}function Ch(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return jl(o);if(o.$$typeof===A)return Gn(o)}throw Error(n(438,String(o)))}function og(o){var l=null,p=ue.updateQueue;if(p!==null&&(l=p.memoCache),l==null){var v=ue.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(l={data:v.data.map(function(S){return S.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),p===null&&(p=Eh(),ue.updateQueue=p),p.memoCache=l,p=l.data[l.index],p===void 0)for(p=l.data[l.index]=Array(o),v=0;v<o;v++)p[v]=z;return l.index++,p}function ni(o,l){return typeof l=="function"?l(o):l}function Ah(o){var l=xn();return sg(l,Ue,o)}function sg(o,l,p){var v=o.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=p;var S=o.baseQueue,E=v.pending;if(E!==null){if(S!==null){var M=S.next;S.next=E.next,E.next=M}l.baseQueue=S=E,v.pending=null}if(E=o.baseState,S===null)o.memoizedState=E;else{l=S.next;var j=M=null,et=null,dt=l,Ct=!1;do{var Rt=dt.lane&-536870913;if(Rt!==dt.lane?(be&Rt)===Rt:(ei&Rt)===Rt){var vt=dt.revertLane;if(vt===0)et!==null&&(et=et.next={lane:0,revertLane:0,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),Rt===lu&&(Ct=!0);else if((ei&vt)===vt){dt=dt.next,vt===lu&&(Ct=!0);continue}else Rt={lane:0,revertLane:dt.revertLane,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},et===null?(j=et=Rt,M=E):et=et.next=Rt,ue.lanes|=vt,$i|=vt;Rt=dt.action,Yo&&p(E,Rt),E=dt.hasEagerState?dt.eagerState:p(E,Rt)}else vt={lane:Rt,revertLane:dt.revertLane,gesture:dt.gesture,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},et===null?(j=et=vt,M=E):et=et.next=vt,ue.lanes|=Rt,$i|=Rt;dt=dt.next}while(dt!==null&&dt!==l);if(et===null?M=E:et.next=j,!Ar(E,o.memoizedState)&&(An=!0,Ct&&(p=cu,p!==null)))throw p;o.memoizedState=E,o.baseState=M,o.baseQueue=et,v.lastRenderedState=E}return S===null&&(v.lanes=0),[o.memoizedState,v.dispatch]}function ug(o){var l=xn(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=o;var v=p.dispatch,S=p.pending,E=l.memoizedState;if(S!==null){p.pending=null;var M=S=S.next;do E=o(E,M.action),M=M.next;while(M!==S);Ar(E,l.memoizedState)||(An=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),p.lastRenderedState=E}return[E,v]}function eS(o,l,p){var v=ue,S=xn(),E=Se;if(E){if(p===void 0)throw Error(n(407));p=p()}else p=l();var M=!Ar((Ue||S).memoizedState,p);if(M&&(S.memoizedState=p,An=!0),S=S.queue,fg(aS.bind(null,v,S,o),[o]),S.getSnapshot!==l||M||Cn!==null&&Cn.memoizedState.tag&1){if(v.flags|=2048,vu(9,{destroy:void 0},rS.bind(null,v,S,p,l),null),qe===null)throw Error(n(349));E||(ei&127)!==0||nS(v,l,p)}return p}function nS(o,l,p){o.flags|=16384,o={getSnapshot:l,value:p},l=ue.updateQueue,l===null?(l=Eh(),ue.updateQueue=l,l.stores=[o]):(p=l.stores,p===null?l.stores=[o]:p.push(o))}function rS(o,l,p,v){l.value=p,l.getSnapshot=v,iS(l)&&oS(o)}function aS(o,l,p){return p(function(){iS(l)&&oS(o)})}function iS(o){var l=o.getSnapshot;o=o.value;try{var p=l();return!Ar(o,p)}catch{return!0}}function oS(o){var l=jo(o,2);l!==null&&br(l,o,2)}function lg(o){var l=rr();if(typeof o=="function"){var p=o;if(o=p(),Yo){mt(!0);try{p()}finally{mt(!1)}}}return l.memoizedState=l.baseState=o,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:o},l}function sS(o,l,p,v){return o.baseState=p,sg(o,Ue,typeof v=="function"?v:ni)}function NM(o,l,p,v,S){if(Rh(o))throw Error(n(485));if(o=l.action,o!==null){var E={payload:S,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){E.listeners.push(M)}};L.T!==null?p(!0):E.isTransition=!1,v(E),p=l.pending,p===null?(E.next=l.pending=E,uS(l,E)):(E.next=p.next,l.pending=p.next=E)}}function uS(o,l){var p=l.action,v=l.payload,S=o.state;if(l.isTransition){var E=L.T,M={};L.T=M;try{var j=p(S,v),et=L.S;et!==null&&et(M,j),lS(o,l,j)}catch(dt){cg(o,l,dt)}finally{E!==null&&M.types!==null&&(E.types=M.types),L.T=E}}else try{E=p(S,v),lS(o,l,E)}catch(dt){cg(o,l,dt)}}function lS(o,l,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(v){cS(o,l,v)},function(v){return cg(o,l,v)}):cS(o,l,p)}function cS(o,l,p){l.status="fulfilled",l.value=p,fS(l),o.state=p,l=o.pending,l!==null&&(p=l.next,p===l?o.pending=null:(p=p.next,l.next=p,uS(o,p)))}function cg(o,l,p){var v=o.pending;if(o.pending=null,v!==null){v=v.next;do l.status="rejected",l.reason=p,fS(l),l=l.next;while(l!==v)}o.action=null}function fS(o){o=o.listeners;for(var l=0;l<o.length;l++)(0,o[l])()}function hS(o,l){return l}function pS(o,l){if(Se){var p=qe.formState;if(p!==null){t:{var v=ue;if(Se){if(Ke){e:{for(var S=Ke,E=Xr;S.nodeType!==8;){if(!E){S=null;break e}if(S=Yr(S.nextSibling),S===null){S=null;break e}}E=S.data,S=E==="F!"||E==="F"?S:null}if(S){Ke=Yr(S.nextSibling),v=S.data==="F!";break t}}Pi(v)}v=!1}v&&(l=p[0])}}return p=rr(),p.memoizedState=p.baseState=l,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hS,lastRenderedState:l},p.queue=v,p=IS.bind(null,ue,v),v.dispatch=p,v=lg(!1),E=vg.bind(null,ue,!1,v.queue),v=rr(),S={state:l,dispatch:null,action:o,pending:null},v.queue=S,p=NM.bind(null,ue,S,E,p),S.dispatch=p,v.memoizedState=o,[l,p,!1]}function dS(o){var l=xn();return mS(l,Ue,o)}function mS(o,l,p){if(l=sg(o,l,hS)[0],o=Ah(ni)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var v=jl(l)}catch(M){throw M===fu?mh:M}else v=l;l=xn();var S=l.queue,E=S.dispatch;return p!==l.memoizedState&&(ue.flags|=2048,vu(9,{destroy:void 0},TM.bind(null,S,p),null)),[v,E,o]}function TM(o,l){o.action=l}function vS(o){var l=xn(),p=Ue;if(p!==null)return mS(l,p,o);xn(),l=l.memoizedState,p=xn();var v=p.queue.dispatch;return p.memoizedState=o,[l,v,!1]}function vu(o,l,p,v){return o={tag:o,create:p,deps:v,inst:l,next:null},l=ue.updateQueue,l===null&&(l=Eh(),ue.updateQueue=l),p=l.lastEffect,p===null?l.lastEffect=o.next=o:(v=p.next,p.next=o,o.next=v,l.lastEffect=o),o}function gS(){return xn().memoizedState}function Nh(o,l,p,v){var S=rr();ue.flags|=o,S.memoizedState=vu(1|l,{destroy:void 0},p,v===void 0?null:v)}function Th(o,l,p,v){var S=xn();v=v===void 0?null:v;var E=S.memoizedState.inst;Ue!==null&&v!==null&&eg(v,Ue.memoizedState.deps)?S.memoizedState=vu(l,E,p,v):(ue.flags|=o,S.memoizedState=vu(1|l,E,p,v))}function yS(o,l){Nh(8390656,8,o,l)}function fg(o,l){Th(2048,8,o,l)}function RM(o){ue.flags|=4;var l=ue.updateQueue;if(l===null)l=Eh(),ue.updateQueue=l,l.events=[o];else{var p=l.events;p===null?l.events=[o]:p.push(o)}}function bS(o){var l=xn().memoizedState;return RM({ref:l,nextImpl:o}),function(){if((ke&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function xS(o,l){return Th(4,2,o,l)}function wS(o,l){return Th(4,4,o,l)}function SS(o,l){if(typeof l=="function"){o=o();var p=l(o);return function(){typeof p=="function"?p():l(null)}}if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function ES(o,l,p){p=p!=null?p.concat([o]):null,Th(4,4,SS.bind(null,l,o),p)}function hg(){}function CS(o,l){var p=xn();l=l===void 0?null:l;var v=p.memoizedState;return l!==null&&eg(l,v[1])?v[0]:(p.memoizedState=[o,l],o)}function AS(o,l){var p=xn();l=l===void 0?null:l;var v=p.memoizedState;if(l!==null&&eg(l,v[1]))return v[0];if(v=o(),Yo){mt(!0);try{o()}finally{mt(!1)}}return p.memoizedState=[v,l],v}function pg(o,l,p){return p===void 0||(ei&1073741824)!==0&&(be&261930)===0?o.memoizedState=l:(o.memoizedState=p,o=NE(),ue.lanes|=o,$i|=o,p)}function NS(o,l,p,v){return Ar(p,l)?p:pu.current!==null?(o=pg(o,p,v),Ar(o,l)||(An=!0),o):(ei&42)===0||(ei&1073741824)!==0&&(be&261930)===0?(An=!0,o.memoizedState=p):(o=NE(),ue.lanes|=o,$i|=o,l)}function TS(o,l,p,v,S){var E=X.p;X.p=E!==0&&8>E?E:8;var M=L.T,j={};L.T=j,vg(o,!1,l,p);try{var et=S(),dt=L.S;if(dt!==null&&dt(j,et),et!==null&&typeof et=="object"&&typeof et.then=="function"){var Ct=EM(et,v);Pl(o,l,Ct,Dr(o))}else Pl(o,l,v,Dr(o))}catch(Rt){Pl(o,l,{then:function(){},status:"rejected",reason:Rt},Dr())}finally{X.p=E,M!==null&&j.types!==null&&(M.types=j.types),L.T=M}}function _M(){}function dg(o,l,p,v){if(o.tag!==5)throw Error(n(476));var S=RS(o).queue;TS(o,S,l,$,p===null?_M:function(){return _S(o),p(v)})}function RS(o){var l=o.memoizedState;if(l!==null)return l;l={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:$},next:null};var p={};return l.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:p},next:null},o.memoizedState=l,o=o.alternate,o!==null&&(o.memoizedState=l),l}function _S(o){var l=RS(o);l.next===null&&(l=o.alternate.memoizedState),Pl(o,l.next.queue,{},Dr())}function mg(){return Gn(ac)}function OS(){return xn().memoizedState}function DS(){return xn().memoizedState}function OM(o){for(var l=o.return;l!==null;){switch(l.tag){case 24:case 3:var p=Dr();o=Wi(p);var v=Hi(l,o,p);v!==null&&(br(v,l,p),Fl(v,l,p)),l={cache:Wv()},o.payload=l;return}l=l.return}}function DM(o,l,p){var v=Dr();p={lane:v,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Rh(o)?kS(l,p):(p=kv(o,l,p,v),p!==null&&(br(p,o,v),MS(p,l,v)))}function IS(o,l,p){var v=Dr();Pl(o,l,p,v)}function Pl(o,l,p,v){var S={lane:v,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Rh(o))kS(l,S);else{var E=o.alternate;if(o.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var M=l.lastRenderedState,j=E(M,p);if(S.hasEagerState=!0,S.eagerState=j,Ar(j,M))return uh(o,l,S,0),qe===null&&sh(),!1}catch{}if(p=kv(o,l,S,v),p!==null)return br(p,o,v),MS(p,l,v),!0}return!1}function vg(o,l,p,v){if(v={lane:2,revertLane:Kg(),gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},Rh(o)){if(l)throw Error(n(479))}else l=kv(o,p,v,2),l!==null&&br(l,o,2)}function Rh(o){var l=o.alternate;return o===ue||l!==null&&l===ue}function kS(o,l){du=wh=!0;var p=o.pending;p===null?l.next=l:(l.next=p.next,p.next=l),o.pending=l}function MS(o,l,p){if((p&4194048)!==0){var v=l.lanes;v&=o.pendingLanes,p|=v,l.lanes=p,Uw(o,p)}}var Vl={readContext:Gn,use:Ch,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};Vl.useEffectEvent=hn;var zS={readContext:Gn,use:Ch,useCallback:function(o,l){return rr().memoizedState=[o,l===void 0?null:l],o},useContext:Gn,useEffect:yS,useImperativeHandle:function(o,l,p){p=p!=null?p.concat([o]):null,Nh(4194308,4,SS.bind(null,l,o),p)},useLayoutEffect:function(o,l){return Nh(4194308,4,o,l)},useInsertionEffect:function(o,l){Nh(4,2,o,l)},useMemo:function(o,l){var p=rr();l=l===void 0?null:l;var v=o();if(Yo){mt(!0);try{o()}finally{mt(!1)}}return p.memoizedState=[v,l],v},useReducer:function(o,l,p){var v=rr();if(p!==void 0){var S=p(l);if(Yo){mt(!0);try{p(l)}finally{mt(!1)}}}else S=l;return v.memoizedState=v.baseState=S,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:S},v.queue=o,o=o.dispatch=DM.bind(null,ue,o),[v.memoizedState,o]},useRef:function(o){var l=rr();return o={current:o},l.memoizedState=o},useState:function(o){o=lg(o);var l=o.queue,p=IS.bind(null,ue,l);return l.dispatch=p,[o.memoizedState,p]},useDebugValue:hg,useDeferredValue:function(o,l){var p=rr();return pg(p,o,l)},useTransition:function(){var o=lg(!1);return o=TS.bind(null,ue,o.queue,!0,!1),rr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,l,p){var v=ue,S=rr();if(Se){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),qe===null)throw Error(n(349));(be&127)!==0||nS(v,l,p)}S.memoizedState=p;var E={value:p,getSnapshot:l};return S.queue=E,yS(aS.bind(null,v,E,o),[o]),v.flags|=2048,vu(9,{destroy:void 0},rS.bind(null,v,E,p,l),null),p},useId:function(){var o=rr(),l=qe.identifierPrefix;if(Se){var p=Ta,v=Na;p=(v&~(1<<32-St(v)-1)).toString(32)+p,l="_"+l+"R_"+p,p=Sh++,0<p&&(l+="H"+p.toString(32)),l+="_"}else p=CM++,l="_"+l+"r_"+p.toString(32)+"_";return o.memoizedState=l},useHostTransitionStatus:mg,useFormState:pS,useActionState:pS,useOptimistic:function(o){var l=rr();l.memoizedState=l.baseState=o;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=p,l=vg.bind(null,ue,!0,p),p.dispatch=l,[o,l]},useMemoCache:og,useCacheRefresh:function(){return rr().memoizedState=OM.bind(null,ue)},useEffectEvent:function(o){var l=rr(),p={impl:o};return l.memoizedState=p,function(){if((ke&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}},gg={readContext:Gn,use:Ch,useCallback:CS,useContext:Gn,useEffect:fg,useImperativeHandle:ES,useInsertionEffect:xS,useLayoutEffect:wS,useMemo:AS,useReducer:Ah,useRef:gS,useState:function(){return Ah(ni)},useDebugValue:hg,useDeferredValue:function(o,l){var p=xn();return NS(p,Ue.memoizedState,o,l)},useTransition:function(){var o=Ah(ni)[0],l=xn().memoizedState;return[typeof o=="boolean"?o:jl(o),l]},useSyncExternalStore:eS,useId:OS,useHostTransitionStatus:mg,useFormState:dS,useActionState:dS,useOptimistic:function(o,l){var p=xn();return sS(p,Ue,o,l)},useMemoCache:og,useCacheRefresh:DS};gg.useEffectEvent=bS;var FS={readContext:Gn,use:Ch,useCallback:CS,useContext:Gn,useEffect:fg,useImperativeHandle:ES,useInsertionEffect:xS,useLayoutEffect:wS,useMemo:AS,useReducer:ug,useRef:gS,useState:function(){return ug(ni)},useDebugValue:hg,useDeferredValue:function(o,l){var p=xn();return Ue===null?pg(p,o,l):NS(p,Ue.memoizedState,o,l)},useTransition:function(){var o=ug(ni)[0],l=xn().memoizedState;return[typeof o=="boolean"?o:jl(o),l]},useSyncExternalStore:eS,useId:OS,useHostTransitionStatus:mg,useFormState:vS,useActionState:vS,useOptimistic:function(o,l){var p=xn();return Ue!==null?sS(p,Ue,o,l):(p.baseState=o,[o,p.queue.dispatch])},useMemoCache:og,useCacheRefresh:DS};FS.useEffectEvent=bS;function yg(o,l,p,v){l=o.memoizedState,p=p(v,l),p=p==null?l:d({},l,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var bg={enqueueSetState:function(o,l,p){o=o._reactInternals;var v=Dr(),S=Wi(v);S.payload=l,p!=null&&(S.callback=p),l=Hi(o,S,v),l!==null&&(br(l,o,v),Fl(l,o,v))},enqueueReplaceState:function(o,l,p){o=o._reactInternals;var v=Dr(),S=Wi(v);S.tag=1,S.payload=l,p!=null&&(S.callback=p),l=Hi(o,S,v),l!==null&&(br(l,o,v),Fl(l,o,v))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var p=Dr(),v=Wi(p);v.tag=2,l!=null&&(v.callback=l),l=Hi(o,v,p),l!==null&&(br(l,o,p),Fl(l,o,p))}};function BS(o,l,p,v,S,E,M){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,E,M):l.prototype&&l.prototype.isPureReactComponent?!Rl(p,v)||!Rl(S,E):!0}function LS(o,l,p,v){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,v),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,v),l.state!==o&&bg.enqueueReplaceState(l,l.state,null)}function $o(o,l){var p=l;if("ref"in l){p={};for(var v in l)v!=="ref"&&(p[v]=l[v])}if(o=o.defaultProps){p===l&&(p=d({},p));for(var S in o)p[S]===void 0&&(p[S]=o[S])}return p}function US(o){oh(o)}function jS(o){console.error(o)}function PS(o){oh(o)}function _h(o,l){try{var p=o.onUncaughtError;p(l.value,{componentStack:l.stack})}catch(v){setTimeout(function(){throw v})}}function VS(o,l,p){try{var v=o.onCaughtError;v(p.value,{componentStack:p.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function xg(o,l,p){return p=Wi(p),p.tag=3,p.payload={element:null},p.callback=function(){_h(o,l)},p}function qS(o){return o=Wi(o),o.tag=3,o}function WS(o,l,p,v){var S=p.type.getDerivedStateFromError;if(typeof S=="function"){var E=v.value;o.payload=function(){return S(E)},o.callback=function(){VS(l,p,v)}}var M=p.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(o.callback=function(){VS(l,p,v),typeof S!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var j=v.stack;this.componentDidCatch(v.value,{componentStack:j!==null?j:""})})}function IM(o,l,p,v,S){if(p.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(l=p.alternate,l!==null&&uu(l,p,S,!0),p=Tr.current,p!==null){switch(p.tag){case 31:case 13:return Kr===null?Ph():p.alternate===null&&pn===0&&(pn=3),p.flags&=-257,p.flags|=65536,p.lanes=S,v===vh?p.flags|=16384:(l=p.updateQueue,l===null?p.updateQueue=new Set([v]):l.add(v),Hg(o,v,S)),!1;case 22:return p.flags|=65536,v===vh?p.flags|=16384:(l=p.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([v])},p.updateQueue=l):(p=l.retryQueue,p===null?l.retryQueue=new Set([v]):p.add(v)),Hg(o,v,S)),!1}throw Error(n(435,p.tag))}return Hg(o,v,S),Ph(),!1}if(Se)return l=Tr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=S,v!==Uv&&(o=Error(n(422),{cause:v}),Dl(Wr(o,p)))):(v!==Uv&&(l=Error(n(423),{cause:v}),Dl(Wr(l,p))),o=o.current.alternate,o.flags|=65536,S&=-S,o.lanes|=S,v=Wr(v,p),S=xg(o.stateNode,v,S),$v(o,S),pn!==4&&(pn=2)),!1;var E=Error(n(520),{cause:v});if(E=Wr(E,p),$l===null?$l=[E]:$l.push(E),pn!==4&&(pn=2),l===null)return!0;v=Wr(v,p),p=l;do{switch(p.tag){case 3:return p.flags|=65536,o=S&-S,p.lanes|=o,o=xg(p.stateNode,v,o),$v(p,o),!1;case 1:if(l=p.type,E=p.stateNode,(p.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qi===null||!Qi.has(E))))return p.flags|=65536,S&=-S,p.lanes|=S,S=qS(S),WS(S,o,p,v),$v(p,S),!1}p=p.return}while(p!==null);return!1}var wg=Error(n(461)),An=!1;function Xn(o,l,p,v){l.child=o===null?K2(l,null,p,v):Ko(l,o.child,p,v)}function HS(o,l,p,v,S){p=p.render;var E=l.ref;if("ref"in v){var M={};for(var j in v)j!=="ref"&&(M[j]=v[j])}else M=v;return Wo(l),v=ng(o,l,p,M,E,S),j=rg(),o!==null&&!An?(ag(o,l,S),ri(o,l,S)):(Se&&j&&Bv(l),l.flags|=1,Xn(o,l,v,S),l.child)}function GS(o,l,p,v,S){if(o===null){var E=p.type;return typeof E=="function"&&!Mv(E)&&E.defaultProps===void 0&&p.compare===null?(l.tag=15,l.type=E,XS(o,l,E,v,S)):(o=ch(p.type,null,v,l,l.mode,S),o.ref=l.ref,o.return=l,l.child=o)}if(E=o.child,!_g(o,S)){var M=E.memoizedProps;if(p=p.compare,p=p!==null?p:Rl,p(M,v)&&o.ref===l.ref)return ri(o,l,S)}return l.flags|=1,o=Qa(E,v),o.ref=l.ref,o.return=l,l.child=o}function XS(o,l,p,v,S){if(o!==null){var E=o.memoizedProps;if(Rl(E,v)&&o.ref===l.ref)if(An=!1,l.pendingProps=v=E,_g(o,S))(o.flags&131072)!==0&&(An=!0);else return l.lanes=o.lanes,ri(o,l,S)}return Sg(o,l,p,v,S)}function KS(o,l,p,v){var S=v.children,E=o!==null?o.memoizedState:null;if(o===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),v.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|p:p,o!==null){for(v=l.child=o.child,S=0;v!==null;)S=S|v.lanes|v.childLanes,v=v.sibling;v=S&~E}else v=0,l.child=null;return YS(o,l,E,p,v)}if((p&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},o!==null&&dh(l,E!==null?E.cachePool:null),E!==null?Q2(l,E):Zv(),Z2(l);else return v=l.lanes=536870912,YS(o,l,E!==null?E.baseLanes|p:p,p,v)}else E!==null?(dh(l,E.cachePool),Q2(l,E),Xi(),l.memoizedState=null):(o!==null&&dh(l,null),Zv(),Xi());return Xn(o,l,S,p),l.child}function ql(o,l){return o!==null&&o.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function YS(o,l,p,v,S){var E=Gv();return E=E===null?null:{parent:En._currentValue,pool:E},l.memoizedState={baseLanes:p,cachePool:E},o!==null&&dh(l,null),Zv(),Z2(l),o!==null&&uu(o,l,v,!0),l.childLanes=S,null}function Oh(o,l){return l=Ih({mode:l.mode,children:l.children},o.mode),l.ref=o.ref,o.child=l,l.return=o,l}function $S(o,l,p){return Ko(l,o.child,null,p),o=Oh(l,l.pendingProps),o.flags|=2,Rr(l),l.memoizedState=null,o}function kM(o,l,p){var v=l.pendingProps,S=(l.flags&128)!==0;if(l.flags&=-129,o===null){if(Se){if(v.mode==="hidden")return o=Oh(l,v),l.lanes=536870912,ql(null,o);if(tg(l),(o=Ke)?(o=uC(o,Xr),o=o!==null&&o.data==="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:Ui!==null?{id:Na,overflow:Ta}:null,retryLane:536870912,hydrationErrors:null},p=k2(o),p.return=l,l.child=p,Hn=l,Ke=null)):o=null,o===null)throw Pi(l);return l.lanes=536870912,null}return Oh(l,v)}var E=o.memoizedState;if(E!==null){var M=E.dehydrated;if(tg(l),S)if(l.flags&256)l.flags&=-257,l=$S(o,l,p);else if(l.memoizedState!==null)l.child=o.child,l.flags|=128,l=null;else throw Error(n(558));else if(An||uu(o,l,p,!1),S=(p&o.childLanes)!==0,An||S){if(v=qe,v!==null&&(M=jw(v,p),M!==0&&M!==E.retryLane))throw E.retryLane=M,jo(o,M),br(v,o,M),wg;Ph(),l=$S(o,l,p)}else o=E.treeContext,Ke=Yr(M.nextSibling),Hn=l,Se=!0,ji=null,Xr=!1,o!==null&&F2(l,o),l=Oh(l,v),l.flags|=4096;return l}return o=Qa(o.child,{mode:v.mode,children:v.children}),o.ref=l.ref,l.child=o,o.return=l,o}function Dh(o,l){var p=l.ref;if(p===null)o!==null&&o.ref!==null&&(l.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(o===null||o.ref!==p)&&(l.flags|=4194816)}}function Sg(o,l,p,v,S){return Wo(l),p=ng(o,l,p,v,void 0,S),v=rg(),o!==null&&!An?(ag(o,l,S),ri(o,l,S)):(Se&&v&&Bv(l),l.flags|=1,Xn(o,l,p,S),l.child)}function QS(o,l,p,v,S,E){return Wo(l),l.updateQueue=null,p=tS(l,v,p,S),J2(o),v=rg(),o!==null&&!An?(ag(o,l,E),ri(o,l,E)):(Se&&v&&Bv(l),l.flags|=1,Xn(o,l,p,E),l.child)}function ZS(o,l,p,v,S){if(Wo(l),l.stateNode===null){var E=au,M=p.contextType;typeof M=="object"&&M!==null&&(E=Gn(M)),E=new p(v,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=bg,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=v,E.state=l.memoizedState,E.refs={},Kv(l),M=p.contextType,E.context=typeof M=="object"&&M!==null?Gn(M):au,E.state=l.memoizedState,M=p.getDerivedStateFromProps,typeof M=="function"&&(yg(l,p,M,v),E.state=l.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(M=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),M!==E.state&&bg.enqueueReplaceState(E,E.state,null),Ll(l,v,E,S),Bl(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),v=!0}else if(o===null){E=l.stateNode;var j=l.memoizedProps,et=$o(p,j);E.props=et;var dt=E.context,Ct=p.contextType;M=au,typeof Ct=="object"&&Ct!==null&&(M=Gn(Ct));var Rt=p.getDerivedStateFromProps;Ct=typeof Rt=="function"||typeof E.getSnapshotBeforeUpdate=="function",j=l.pendingProps!==j,Ct||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(j||dt!==M)&&LS(l,E,v,M),qi=!1;var vt=l.memoizedState;E.state=vt,Ll(l,v,E,S),Bl(),dt=l.memoizedState,j||vt!==dt||qi?(typeof Rt=="function"&&(yg(l,p,Rt,v),dt=l.memoizedState),(et=qi||BS(l,p,et,v,vt,dt,M))?(Ct||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=v,l.memoizedState=dt),E.props=v,E.state=dt,E.context=M,v=et):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),v=!1)}else{E=l.stateNode,Yv(o,l),M=l.memoizedProps,Ct=$o(p,M),E.props=Ct,Rt=l.pendingProps,vt=E.context,dt=p.contextType,et=au,typeof dt=="object"&&dt!==null&&(et=Gn(dt)),j=p.getDerivedStateFromProps,(dt=typeof j=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(M!==Rt||vt!==et)&&LS(l,E,v,et),qi=!1,vt=l.memoizedState,E.state=vt,Ll(l,v,E,S),Bl();var bt=l.memoizedState;M!==Rt||vt!==bt||qi||o!==null&&o.dependencies!==null&&hh(o.dependencies)?(typeof j=="function"&&(yg(l,p,j,v),bt=l.memoizedState),(Ct=qi||BS(l,p,Ct,v,vt,bt,et)||o!==null&&o.dependencies!==null&&hh(o.dependencies))?(dt||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(v,bt,et),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(v,bt,et)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||M===o.memoizedProps&&vt===o.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&vt===o.memoizedState||(l.flags|=1024),l.memoizedProps=v,l.memoizedState=bt),E.props=v,E.state=bt,E.context=et,v=Ct):(typeof E.componentDidUpdate!="function"||M===o.memoizedProps&&vt===o.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&vt===o.memoizedState||(l.flags|=1024),v=!1)}return E=v,Dh(o,l),v=(l.flags&128)!==0,E||v?(E=l.stateNode,p=v&&typeof p.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,o!==null&&v?(l.child=Ko(l,o.child,null,S),l.child=Ko(l,null,p,S)):Xn(o,l,p,S),l.memoizedState=E.state,o=l.child):o=ri(o,l,S),o}function JS(o,l,p,v){return Vo(),l.flags|=256,Xn(o,l,p,v),l.child}var Eg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cg(o){return{baseLanes:o,cachePool:V2()}}function Ag(o,l,p){return o=o!==null?o.childLanes&~p:0,l&&(o|=Or),o}function tE(o,l,p){var v=l.pendingProps,S=!1,E=(l.flags&128)!==0,M;if((M=E)||(M=o!==null&&o.memoizedState===null?!1:(bn.current&2)!==0),M&&(S=!0,l.flags&=-129),M=(l.flags&32)!==0,l.flags&=-33,o===null){if(Se){if(S?Gi(l):Xi(),(o=Ke)?(o=uC(o,Xr),o=o!==null&&o.data!=="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:Ui!==null?{id:Na,overflow:Ta}:null,retryLane:536870912,hydrationErrors:null},p=k2(o),p.return=l,l.child=p,Hn=l,Ke=null)):o=null,o===null)throw Pi(l);return sy(o)?l.lanes=32:l.lanes=536870912,null}var j=v.children;return v=v.fallback,S?(Xi(),S=l.mode,j=Ih({mode:"hidden",children:j},S),v=Po(v,S,p,null),j.return=l,v.return=l,j.sibling=v,l.child=j,v=l.child,v.memoizedState=Cg(p),v.childLanes=Ag(o,M,p),l.memoizedState=Eg,ql(null,v)):(Gi(l),Ng(l,j))}var et=o.memoizedState;if(et!==null&&(j=et.dehydrated,j!==null)){if(E)l.flags&256?(Gi(l),l.flags&=-257,l=Tg(o,l,p)):l.memoizedState!==null?(Xi(),l.child=o.child,l.flags|=128,l=null):(Xi(),j=v.fallback,S=l.mode,v=Ih({mode:"visible",children:v.children},S),j=Po(j,S,p,null),j.flags|=2,v.return=l,j.return=l,v.sibling=j,l.child=v,Ko(l,o.child,null,p),v=l.child,v.memoizedState=Cg(p),v.childLanes=Ag(o,M,p),l.memoizedState=Eg,l=ql(null,v));else if(Gi(l),sy(j)){if(M=j.nextSibling&&j.nextSibling.dataset,M)var dt=M.dgst;M=dt,v=Error(n(419)),v.stack="",v.digest=M,Dl({value:v,source:null,stack:null}),l=Tg(o,l,p)}else if(An||uu(o,l,p,!1),M=(p&o.childLanes)!==0,An||M){if(M=qe,M!==null&&(v=jw(M,p),v!==0&&v!==et.retryLane))throw et.retryLane=v,jo(o,v),br(M,o,v),wg;oy(j)||Ph(),l=Tg(o,l,p)}else oy(j)?(l.flags|=192,l.child=o.child,l=null):(o=et.treeContext,Ke=Yr(j.nextSibling),Hn=l,Se=!0,ji=null,Xr=!1,o!==null&&F2(l,o),l=Ng(l,v.children),l.flags|=4096);return l}return S?(Xi(),j=v.fallback,S=l.mode,et=o.child,dt=et.sibling,v=Qa(et,{mode:"hidden",children:v.children}),v.subtreeFlags=et.subtreeFlags&65011712,dt!==null?j=Qa(dt,j):(j=Po(j,S,p,null),j.flags|=2),j.return=l,v.return=l,v.sibling=j,l.child=v,ql(null,v),v=l.child,j=o.child.memoizedState,j===null?j=Cg(p):(S=j.cachePool,S!==null?(et=En._currentValue,S=S.parent!==et?{parent:et,pool:et}:S):S=V2(),j={baseLanes:j.baseLanes|p,cachePool:S}),v.memoizedState=j,v.childLanes=Ag(o,M,p),l.memoizedState=Eg,ql(o.child,v)):(Gi(l),p=o.child,o=p.sibling,p=Qa(p,{mode:"visible",children:v.children}),p.return=l,p.sibling=null,o!==null&&(M=l.deletions,M===null?(l.deletions=[o],l.flags|=16):M.push(o)),l.child=p,l.memoizedState=null,p)}function Ng(o,l){return l=Ih({mode:"visible",children:l},o.mode),l.return=o,o.child=l}function Ih(o,l){return o=Nr(22,o,null,l),o.lanes=0,o}function Tg(o,l,p){return Ko(l,o.child,null,p),o=Ng(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function eE(o,l,p){o.lanes|=l;var v=o.alternate;v!==null&&(v.lanes|=l),Vv(o.return,l,p)}function Rg(o,l,p,v,S,E){var M=o.memoizedState;M===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:S,treeForkCount:E}:(M.isBackwards=l,M.rendering=null,M.renderingStartTime=0,M.last=v,M.tail=p,M.tailMode=S,M.treeForkCount=E)}function nE(o,l,p){var v=l.pendingProps,S=v.revealOrder,E=v.tail;v=v.children;var M=bn.current,j=(M&2)!==0;if(j?(M=M&1|2,l.flags|=128):M&=1,W(bn,M),Xn(o,l,v,p),v=Se?Ol:0,!j&&o!==null&&(o.flags&128)!==0)t:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&eE(o,p,l);else if(o.tag===19)eE(o,p,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break t;for(;o.sibling===null;){if(o.return===null||o.return===l)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(S){case"forwards":for(p=l.child,S=null;p!==null;)o=p.alternate,o!==null&&xh(o)===null&&(S=p),p=p.sibling;p=S,p===null?(S=l.child,l.child=null):(S=p.sibling,p.sibling=null),Rg(l,!1,S,p,E,v);break;case"backwards":case"unstable_legacy-backwards":for(p=null,S=l.child,l.child=null;S!==null;){if(o=S.alternate,o!==null&&xh(o)===null){l.child=S;break}o=S.sibling,S.sibling=p,p=S,S=o}Rg(l,!0,p,null,E,v);break;case"together":Rg(l,!1,null,null,void 0,v);break;default:l.memoizedState=null}return l.child}function ri(o,l,p){if(o!==null&&(l.dependencies=o.dependencies),$i|=l.lanes,(p&l.childLanes)===0)if(o!==null){if(uu(o,l,p,!1),(p&l.childLanes)===0)return null}else return null;if(o!==null&&l.child!==o.child)throw Error(n(153));if(l.child!==null){for(o=l.child,p=Qa(o,o.pendingProps),l.child=p,p.return=l;o.sibling!==null;)o=o.sibling,p=p.sibling=Qa(o,o.pendingProps),p.return=l;p.sibling=null}return l.child}function _g(o,l){return(o.lanes&l)!==0?!0:(o=o.dependencies,!!(o!==null&&hh(o)))}function MM(o,l,p){switch(l.tag){case 3:zt(l,l.stateNode.containerInfo),Vi(l,En,o.memoizedState.cache),Vo();break;case 27:case 5:Mt(l);break;case 4:zt(l,l.stateNode.containerInfo);break;case 10:Vi(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,tg(l),null;break;case 13:var v=l.memoizedState;if(v!==null)return v.dehydrated!==null?(Gi(l),l.flags|=128,null):(p&l.child.childLanes)!==0?tE(o,l,p):(Gi(l),o=ri(o,l,p),o!==null?o.sibling:null);Gi(l);break;case 19:var S=(o.flags&128)!==0;if(v=(p&l.childLanes)!==0,v||(uu(o,l,p,!1),v=(p&l.childLanes)!==0),S){if(v)return nE(o,l,p);l.flags|=128}if(S=l.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),W(bn,bn.current),v)break;return null;case 22:return l.lanes=0,KS(o,l,p,l.pendingProps);case 24:Vi(l,En,o.memoizedState.cache)}return ri(o,l,p)}function rE(o,l,p){if(o!==null)if(o.memoizedProps!==l.pendingProps)An=!0;else{if(!_g(o,p)&&(l.flags&128)===0)return An=!1,MM(o,l,p);An=(o.flags&131072)!==0}else An=!1,Se&&(l.flags&1048576)!==0&&z2(l,Ol,l.index);switch(l.lanes=0,l.tag){case 16:t:{var v=l.pendingProps;if(o=Go(l.elementType),l.type=o,typeof o=="function")Mv(o)?(v=$o(o,v),l.tag=1,l=ZS(null,l,o,v,p)):(l.tag=0,l=Sg(null,l,o,v,p));else{if(o!=null){var S=o.$$typeof;if(S===T){l.tag=11,l=HS(null,l,o,v,p);break t}else if(S===N){l.tag=14,l=GS(null,l,o,v,p);break t}}throw l=G(o)||o,Error(n(306,l,""))}}return l;case 0:return Sg(o,l,l.type,l.pendingProps,p);case 1:return v=l.type,S=$o(v,l.pendingProps),ZS(o,l,v,S,p);case 3:t:{if(zt(l,l.stateNode.containerInfo),o===null)throw Error(n(387));v=l.pendingProps;var E=l.memoizedState;S=E.element,Yv(o,l),Ll(l,v,null,p);var M=l.memoizedState;if(v=M.cache,Vi(l,En,v),v!==E.cache&&qv(l,[En],p,!0),Bl(),v=M.element,E.isDehydrated)if(E={element:v,isDehydrated:!1,cache:M.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=JS(o,l,v,p);break t}else if(v!==S){S=Wr(Error(n(424)),l),Dl(S),l=JS(o,l,v,p);break t}else for(o=l.stateNode.containerInfo,o.nodeType===9?o=o.body:o=o.nodeName==="HTML"?o.ownerDocument.body:o,Ke=Yr(o.firstChild),Hn=l,Se=!0,ji=null,Xr=!0,p=K2(l,null,v,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Vo(),v===S){l=ri(o,l,p);break t}Xn(o,l,v,p)}l=l.child}return l;case 26:return Dh(o,l),o===null?(p=dC(l.type,null,l.pendingProps,null))?l.memoizedState=p:Se||(p=l.type,o=l.pendingProps,v=Kh(xt.current).createElement(p),v[Wn]=l,v[pr]=o,Kn(v,p,o),Bn(v),l.stateNode=v):l.memoizedState=dC(l.type,o.memoizedProps,l.pendingProps,o.memoizedState),null;case 27:return Mt(l),o===null&&Se&&(v=l.stateNode=fC(l.type,l.pendingProps,xt.current),Hn=l,Xr=!0,S=Ke,eo(l.type)?(uy=S,Ke=Yr(v.firstChild)):Ke=S),Xn(o,l,l.pendingProps.children,p),Dh(o,l),o===null&&(l.flags|=4194304),l.child;case 5:return o===null&&Se&&((S=v=Ke)&&(v=cz(v,l.type,l.pendingProps,Xr),v!==null?(l.stateNode=v,Hn=l,Ke=Yr(v.firstChild),Xr=!1,S=!0):S=!1),S||Pi(l)),Mt(l),S=l.type,E=l.pendingProps,M=o!==null?o.memoizedProps:null,v=E.children,ry(S,E)?v=null:M!==null&&ry(S,M)&&(l.flags|=32),l.memoizedState!==null&&(S=ng(o,l,AM,null,null,p),ac._currentValue=S),Dh(o,l),Xn(o,l,v,p),l.child;case 6:return o===null&&Se&&((o=p=Ke)&&(p=fz(p,l.pendingProps,Xr),p!==null?(l.stateNode=p,Hn=l,Ke=null,o=!0):o=!1),o||Pi(l)),null;case 13:return tE(o,l,p);case 4:return zt(l,l.stateNode.containerInfo),v=l.pendingProps,o===null?l.child=Ko(l,null,v,p):Xn(o,l,v,p),l.child;case 11:return HS(o,l,l.type,l.pendingProps,p);case 7:return Xn(o,l,l.pendingProps,p),l.child;case 8:return Xn(o,l,l.pendingProps.children,p),l.child;case 12:return Xn(o,l,l.pendingProps.children,p),l.child;case 10:return v=l.pendingProps,Vi(l,l.type,v.value),Xn(o,l,v.children,p),l.child;case 9:return S=l.type._context,v=l.pendingProps.children,Wo(l),S=Gn(S),v=v(S),l.flags|=1,Xn(o,l,v,p),l.child;case 14:return GS(o,l,l.type,l.pendingProps,p);case 15:return XS(o,l,l.type,l.pendingProps,p);case 19:return nE(o,l,p);case 31:return kM(o,l,p);case 22:return KS(o,l,p,l.pendingProps);case 24:return Wo(l),v=Gn(En),o===null?(S=Gv(),S===null&&(S=qe,E=Wv(),S.pooledCache=E,E.refCount++,E!==null&&(S.pooledCacheLanes|=p),S=E),l.memoizedState={parent:v,cache:S},Kv(l),Vi(l,En,S)):((o.lanes&p)!==0&&(Yv(o,l),Ll(l,null,null,p),Bl()),S=o.memoizedState,E=l.memoizedState,S.parent!==v?(S={parent:v,cache:v},l.memoizedState=S,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=S),Vi(l,En,v)):(v=E.cache,Vi(l,En,v),v!==S.cache&&qv(l,[En],p,!0))),Xn(o,l,l.pendingProps.children,p),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function ai(o){o.flags|=4}function Og(o,l,p,v,S){if((l=(o.mode&32)!==0)&&(l=!1),l){if(o.flags|=16777216,(S&335544128)===S)if(o.stateNode.complete)o.flags|=8192;else if(OE())o.flags|=8192;else throw Xo=vh,Xv}else o.flags&=-16777217}function aE(o,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!bC(l))if(OE())o.flags|=8192;else throw Xo=vh,Xv}function kh(o,l){l!==null&&(o.flags|=4),o.flags&16384&&(l=o.tag!==22?Bw():536870912,o.lanes|=l,xu|=l)}function Wl(o,l){if(!Se)switch(o.tailMode){case"hidden":l=o.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Ye(o){var l=o.alternate!==null&&o.alternate.child===o.child,p=0,v=0;if(l)for(var S=o.child;S!==null;)p|=S.lanes|S.childLanes,v|=S.subtreeFlags&65011712,v|=S.flags&65011712,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)p|=S.lanes|S.childLanes,v|=S.subtreeFlags,v|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=v,o.childLanes=p,l}function zM(o,l,p){var v=l.pendingProps;switch(Lv(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ye(l),null;case 1:return Ye(l),null;case 3:return p=l.stateNode,v=null,o!==null&&(v=o.memoizedState.cache),l.memoizedState.cache!==v&&(l.flags|=2048),ti(En),_t(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(o===null||o.child===null)&&(su(l)?ai(l):o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,jv())),Ye(l),null;case 26:var S=l.type,E=l.memoizedState;return o===null?(ai(l),E!==null?(Ye(l),aE(l,E)):(Ye(l),Og(l,S,null,v,p))):E?E!==o.memoizedState?(ai(l),Ye(l),aE(l,E)):(Ye(l),l.flags&=-16777217):(o=o.memoizedProps,o!==v&&ai(l),Ye(l),Og(l,S,o,v,p)),null;case 27:if(kt(l),p=xt.current,S=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==v&&ai(l);else{if(!v){if(l.stateNode===null)throw Error(n(166));return Ye(l),null}o=Z.current,su(l)?B2(l):(o=fC(S,v,p),l.stateNode=o,ai(l))}return Ye(l),null;case 5:if(kt(l),S=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==v&&ai(l);else{if(!v){if(l.stateNode===null)throw Error(n(166));return Ye(l),null}if(E=Z.current,su(l))B2(l);else{var M=Kh(xt.current);switch(E){case 1:E=M.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:E=M.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":E=M.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":E=M.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":E=M.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof v.is=="string"?M.createElement("select",{is:v.is}):M.createElement("select"),v.multiple?E.multiple=!0:v.size&&(E.size=v.size);break;default:E=typeof v.is=="string"?M.createElement(S,{is:v.is}):M.createElement(S)}}E[Wn]=l,E[pr]=v;t:for(M=l.child;M!==null;){if(M.tag===5||M.tag===6)E.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===l)break t;for(;M.sibling===null;){if(M.return===null||M.return===l)break t;M=M.return}M.sibling.return=M.return,M=M.sibling}l.stateNode=E;t:switch(Kn(E,S,v),S){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break t;case"img":v=!0;break t;default:v=!1}v&&ai(l)}}return Ye(l),Og(l,l.type,o===null?null:o.memoizedProps,l.pendingProps,p),null;case 6:if(o&&l.stateNode!=null)o.memoizedProps!==v&&ai(l);else{if(typeof v!="string"&&l.stateNode===null)throw Error(n(166));if(o=xt.current,su(l)){if(o=l.stateNode,p=l.memoizedProps,v=null,S=Hn,S!==null)switch(S.tag){case 27:case 5:v=S.memoizedProps}o[Wn]=l,o=!!(o.nodeValue===p||v!==null&&v.suppressHydrationWarning===!0||tC(o.nodeValue,p)),o||Pi(l,!0)}else o=Kh(o).createTextNode(v),o[Wn]=l,l.stateNode=o}return Ye(l),null;case 31:if(p=l.memoizedState,o===null||o.memoizedState!==null){if(v=su(l),p!==null){if(o===null){if(!v)throw Error(n(318));if(o=l.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(557));o[Wn]=l}else Vo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ye(l),o=!1}else p=jv(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=p),o=!0;if(!o)return l.flags&256?(Rr(l),l):(Rr(l),null);if((l.flags&128)!==0)throw Error(n(558))}return Ye(l),null;case 13:if(v=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(S=su(l),v!==null&&v.dehydrated!==null){if(o===null){if(!S)throw Error(n(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Wn]=l}else Vo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ye(l),S=!1}else S=jv(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=S),S=!0;if(!S)return l.flags&256?(Rr(l),l):(Rr(l),null)}return Rr(l),(l.flags&128)!==0?(l.lanes=p,l):(p=v!==null,o=o!==null&&o.memoizedState!==null,p&&(v=l.child,S=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(S=v.alternate.memoizedState.cachePool.pool),E=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(E=v.memoizedState.cachePool.pool),E!==S&&(v.flags|=2048)),p!==o&&p&&(l.child.flags|=8192),kh(l,l.updateQueue),Ye(l),null);case 4:return _t(),o===null&&Zg(l.stateNode.containerInfo),Ye(l),null;case 10:return ti(l.type),Ye(l),null;case 19:if(nt(bn),v=l.memoizedState,v===null)return Ye(l),null;if(S=(l.flags&128)!==0,E=v.rendering,E===null)if(S)Wl(v,!1);else{if(pn!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(E=xh(o),E!==null){for(l.flags|=128,Wl(v,!1),o=E.updateQueue,l.updateQueue=o,kh(l,o),l.subtreeFlags=0,o=p,p=l.child;p!==null;)I2(p,o),p=p.sibling;return W(bn,bn.current&1|2),Se&&Za(l,v.treeForkCount),l.child}o=o.sibling}v.tail!==null&&de()>Lh&&(l.flags|=128,S=!0,Wl(v,!1),l.lanes=4194304)}else{if(!S)if(o=xh(E),o!==null){if(l.flags|=128,S=!0,o=o.updateQueue,l.updateQueue=o,kh(l,o),Wl(v,!0),v.tail===null&&v.tailMode==="hidden"&&!E.alternate&&!Se)return Ye(l),null}else 2*de()-v.renderingStartTime>Lh&&p!==536870912&&(l.flags|=128,S=!0,Wl(v,!1),l.lanes=4194304);v.isBackwards?(E.sibling=l.child,l.child=E):(o=v.last,o!==null?o.sibling=E:l.child=E,v.last=E)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=de(),o.sibling=null,p=bn.current,W(bn,S?p&1|2:p&1),Se&&Za(l,v.treeForkCount),o):(Ye(l),null);case 22:case 23:return Rr(l),Jv(),v=l.memoizedState!==null,o!==null?o.memoizedState!==null!==v&&(l.flags|=8192):v&&(l.flags|=8192),v?(p&536870912)!==0&&(l.flags&128)===0&&(Ye(l),l.subtreeFlags&6&&(l.flags|=8192)):Ye(l),p=l.updateQueue,p!==null&&kh(l,p.retryQueue),p=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),v=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(v=l.memoizedState.cachePool.pool),v!==p&&(l.flags|=2048),o!==null&&nt(Ho),null;case 24:return p=null,o!==null&&(p=o.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),ti(En),Ye(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function FM(o,l){switch(Lv(l),l.tag){case 1:return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return ti(En),_t(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 26:case 27:case 5:return kt(l),null;case 31:if(l.memoizedState!==null){if(Rr(l),l.alternate===null)throw Error(n(340));Vo()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 13:if(Rr(l),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(n(340));Vo()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return nt(bn),null;case 4:return _t(),null;case 10:return ti(l.type),null;case 22:case 23:return Rr(l),Jv(),o!==null&&nt(Ho),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 24:return ti(En),null;case 25:return null;default:return null}}function iE(o,l){switch(Lv(l),l.tag){case 3:ti(En),_t();break;case 26:case 27:case 5:kt(l);break;case 4:_t();break;case 31:l.memoizedState!==null&&Rr(l);break;case 13:Rr(l);break;case 19:nt(bn);break;case 10:ti(l.type);break;case 22:case 23:Rr(l),Jv(),o!==null&&nt(Ho);break;case 24:ti(En)}}function Hl(o,l){try{var p=l.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var S=v.next;p=S;do{if((p.tag&o)===o){v=void 0;var E=p.create,M=p.inst;v=E(),M.destroy=v}p=p.next}while(p!==S)}}catch(j){Be(l,l.return,j)}}function Ki(o,l,p){try{var v=l.updateQueue,S=v!==null?v.lastEffect:null;if(S!==null){var E=S.next;v=E;do{if((v.tag&o)===o){var M=v.inst,j=M.destroy;if(j!==void 0){M.destroy=void 0,S=l;var et=p,dt=j;try{dt()}catch(Ct){Be(S,et,Ct)}}}v=v.next}while(v!==E)}}catch(Ct){Be(l,l.return,Ct)}}function oE(o){var l=o.updateQueue;if(l!==null){var p=o.stateNode;try{$2(l,p)}catch(v){Be(o,o.return,v)}}}function sE(o,l,p){p.props=$o(o.type,o.memoizedProps),p.state=o.memoizedState;try{p.componentWillUnmount()}catch(v){Be(o,l,v)}}function Gl(o,l){try{var p=o.ref;if(p!==null){switch(o.tag){case 26:case 27:case 5:var v=o.stateNode;break;case 30:v=o.stateNode;break;default:v=o.stateNode}typeof p=="function"?o.refCleanup=p(v):p.current=v}}catch(S){Be(o,l,S)}}function Ra(o,l){var p=o.ref,v=o.refCleanup;if(p!==null)if(typeof v=="function")try{v()}catch(S){Be(o,l,S)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(S){Be(o,l,S)}else p.current=null}function uE(o){var l=o.type,p=o.memoizedProps,v=o.stateNode;try{t:switch(l){case"button":case"input":case"select":case"textarea":p.autoFocus&&v.focus();break t;case"img":p.src?v.src=p.src:p.srcSet&&(v.srcset=p.srcSet)}}catch(S){Be(o,o.return,S)}}function Dg(o,l,p){try{var v=o.stateNode;az(v,o.type,p,l),v[pr]=l}catch(S){Be(o,o.return,S)}}function lE(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&eo(o.type)||o.tag===4}function Ig(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||lE(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&eo(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function kg(o,l,p){var v=o.tag;if(v===5||v===6)o=o.stateNode,l?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(o,l):(l=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,l.appendChild(o),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=Ya));else if(v!==4&&(v===27&&eo(o.type)&&(p=o.stateNode,l=null),o=o.child,o!==null))for(kg(o,l,p),o=o.sibling;o!==null;)kg(o,l,p),o=o.sibling}function Mh(o,l,p){var v=o.tag;if(v===5||v===6)o=o.stateNode,l?p.insertBefore(o,l):p.appendChild(o);else if(v!==4&&(v===27&&eo(o.type)&&(p=o.stateNode),o=o.child,o!==null))for(Mh(o,l,p),o=o.sibling;o!==null;)Mh(o,l,p),o=o.sibling}function cE(o){var l=o.stateNode,p=o.memoizedProps;try{for(var v=o.type,S=l.attributes;S.length;)l.removeAttributeNode(S[0]);Kn(l,v,p),l[Wn]=o,l[pr]=p}catch(E){Be(o,o.return,E)}}var ii=!1,Nn=!1,Mg=!1,fE=typeof WeakSet=="function"?WeakSet:Set,Ln=null;function BM(o,l){if(o=o.containerInfo,ey=ep,o=E2(o),Tv(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else t:{p=(p=o.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var S=v.anchorOffset,E=v.focusNode;v=v.focusOffset;try{p.nodeType,E.nodeType}catch{p=null;break t}var M=0,j=-1,et=-1,dt=0,Ct=0,Rt=o,vt=null;e:for(;;){for(var bt;Rt!==p||S!==0&&Rt.nodeType!==3||(j=M+S),Rt!==E||v!==0&&Rt.nodeType!==3||(et=M+v),Rt.nodeType===3&&(M+=Rt.nodeValue.length),(bt=Rt.firstChild)!==null;)vt=Rt,Rt=bt;for(;;){if(Rt===o)break e;if(vt===p&&++dt===S&&(j=M),vt===E&&++Ct===v&&(et=M),(bt=Rt.nextSibling)!==null)break;Rt=vt,vt=Rt.parentNode}Rt=bt}p=j===-1||et===-1?null:{start:j,end:et}}else p=null}p=p||{start:0,end:0}}else p=null;for(ny={focusedElem:o,selectionRange:p},ep=!1,Ln=l;Ln!==null;)if(l=Ln,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,Ln=o;else for(;Ln!==null;){switch(l=Ln,E=l.alternate,o=l.flags,l.tag){case 0:if((o&4)!==0&&(o=l.updateQueue,o=o!==null?o.events:null,o!==null))for(p=0;p<o.length;p++)S=o[p],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&E!==null){o=void 0,p=l,S=E.memoizedProps,E=E.memoizedState,v=p.stateNode;try{var qt=$o(p.type,S);o=v.getSnapshotBeforeUpdate(qt,E),v.__reactInternalSnapshotBeforeUpdate=o}catch(Qt){Be(p,p.return,Qt)}}break;case 3:if((o&1024)!==0){if(o=l.stateNode.containerInfo,p=o.nodeType,p===9)iy(o);else if(p===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":iy(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=l.sibling,o!==null){o.return=l.return,Ln=o;break}Ln=l.return}}function hE(o,l,p){var v=p.flags;switch(p.tag){case 0:case 11:case 15:si(o,p),v&4&&Hl(5,p);break;case 1:if(si(o,p),v&4)if(o=p.stateNode,l===null)try{o.componentDidMount()}catch(M){Be(p,p.return,M)}else{var S=$o(p.type,l.memoizedProps);l=l.memoizedState;try{o.componentDidUpdate(S,l,o.__reactInternalSnapshotBeforeUpdate)}catch(M){Be(p,p.return,M)}}v&64&&oE(p),v&512&&Gl(p,p.return);break;case 3:if(si(o,p),v&64&&(o=p.updateQueue,o!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=p.child.stateNode;break;case 1:l=p.child.stateNode}try{$2(o,l)}catch(M){Be(p,p.return,M)}}break;case 27:l===null&&v&4&&cE(p);case 26:case 5:si(o,p),l===null&&v&4&&uE(p),v&512&&Gl(p,p.return);break;case 12:si(o,p);break;case 31:si(o,p),v&4&&mE(o,p);break;case 13:si(o,p),v&4&&vE(o,p),v&64&&(o=p.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(p=GM.bind(null,p),hz(o,p))));break;case 22:if(v=p.memoizedState!==null||ii,!v){l=l!==null&&l.memoizedState!==null||Nn,S=ii;var E=Nn;ii=v,(Nn=l)&&!E?ui(o,p,(p.subtreeFlags&8772)!==0):si(o,p),ii=S,Nn=E}break;case 30:break;default:si(o,p)}}function pE(o){var l=o.alternate;l!==null&&(o.alternate=null,pE(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&cv(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var nn=null,mr=!1;function oi(o,l,p){for(p=p.child;p!==null;)dE(o,l,p),p=p.sibling}function dE(o,l,p){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(Y,p)}catch{}switch(p.tag){case 26:Nn||Ra(p,l),oi(o,l,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Nn||Ra(p,l);var v=nn,S=mr;eo(p.type)&&(nn=p.stateNode,mr=!1),oi(o,l,p),ec(p.stateNode),nn=v,mr=S;break;case 5:Nn||Ra(p,l);case 6:if(v=nn,S=mr,nn=null,oi(o,l,p),nn=v,mr=S,nn!==null)if(mr)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(p.stateNode)}catch(E){Be(p,l,E)}else try{nn.removeChild(p.stateNode)}catch(E){Be(p,l,E)}break;case 18:nn!==null&&(mr?(o=nn,oC(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,p.stateNode),Ru(o)):oC(nn,p.stateNode));break;case 4:v=nn,S=mr,nn=p.stateNode.containerInfo,mr=!0,oi(o,l,p),nn=v,mr=S;break;case 0:case 11:case 14:case 15:Ki(2,p,l),Nn||Ki(4,p,l),oi(o,l,p);break;case 1:Nn||(Ra(p,l),v=p.stateNode,typeof v.componentWillUnmount=="function"&&sE(p,l,v)),oi(o,l,p);break;case 21:oi(o,l,p);break;case 22:Nn=(v=Nn)||p.memoizedState!==null,oi(o,l,p),Nn=v;break;default:oi(o,l,p)}}function mE(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{Ru(o)}catch(p){Be(l,l.return,p)}}}function vE(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Ru(o)}catch(p){Be(l,l.return,p)}}function LM(o){switch(o.tag){case 31:case 13:case 19:var l=o.stateNode;return l===null&&(l=o.stateNode=new fE),l;case 22:return o=o.stateNode,l=o._retryCache,l===null&&(l=o._retryCache=new fE),l;default:throw Error(n(435,o.tag))}}function zh(o,l){var p=LM(o);l.forEach(function(v){if(!p.has(v)){p.add(v);var S=XM.bind(null,o,v);v.then(S,S)}})}function vr(o,l){var p=l.deletions;if(p!==null)for(var v=0;v<p.length;v++){var S=p[v],E=o,M=l,j=M;t:for(;j!==null;){switch(j.tag){case 27:if(eo(j.type)){nn=j.stateNode,mr=!1;break t}break;case 5:nn=j.stateNode,mr=!1;break t;case 3:case 4:nn=j.stateNode.containerInfo,mr=!0;break t}j=j.return}if(nn===null)throw Error(n(160));dE(E,M,S),nn=null,mr=!1,E=S.alternate,E!==null&&(E.return=null),S.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)gE(l,o),l=l.sibling}var aa=null;function gE(o,l){var p=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:vr(l,o),gr(o),v&4&&(Ki(3,o,o.return),Hl(3,o),Ki(5,o,o.return));break;case 1:vr(l,o),gr(o),v&512&&(Nn||p===null||Ra(p,p.return)),v&64&&ii&&(o=o.updateQueue,o!==null&&(v=o.callbacks,v!==null&&(p=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=p===null?v:p.concat(v))));break;case 26:var S=aa;if(vr(l,o),gr(o),v&512&&(Nn||p===null||Ra(p,p.return)),v&4){var E=p!==null?p.memoizedState:null;if(v=o.memoizedState,p===null)if(v===null)if(o.stateNode===null){t:{v=o.type,p=o.memoizedProps,S=S.ownerDocument||S;e:switch(v){case"title":E=S.getElementsByTagName("title")[0],(!E||E[bl]||E[Wn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=S.createElement(v),S.head.insertBefore(E,S.querySelector("head > title"))),Kn(E,v,p),E[Wn]=o,Bn(E),v=E;break t;case"link":var M=gC("link","href",S).get(v+(p.href||""));if(M){for(var j=0;j<M.length;j++)if(E=M[j],E.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&E.getAttribute("rel")===(p.rel==null?null:p.rel)&&E.getAttribute("title")===(p.title==null?null:p.title)&&E.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){M.splice(j,1);break e}}E=S.createElement(v),Kn(E,v,p),S.head.appendChild(E);break;case"meta":if(M=gC("meta","content",S).get(v+(p.content||""))){for(j=0;j<M.length;j++)if(E=M[j],E.getAttribute("content")===(p.content==null?null:""+p.content)&&E.getAttribute("name")===(p.name==null?null:p.name)&&E.getAttribute("property")===(p.property==null?null:p.property)&&E.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&E.getAttribute("charset")===(p.charSet==null?null:p.charSet)){M.splice(j,1);break e}}E=S.createElement(v),Kn(E,v,p),S.head.appendChild(E);break;default:throw Error(n(468,v))}E[Wn]=o,Bn(E),v=E}o.stateNode=v}else yC(S,o.type,o.stateNode);else o.stateNode=vC(S,v,o.memoizedProps);else E!==v?(E===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):E.count--,v===null?yC(S,o.type,o.stateNode):vC(S,v,o.memoizedProps)):v===null&&o.stateNode!==null&&Dg(o,o.memoizedProps,p.memoizedProps)}break;case 27:vr(l,o),gr(o),v&512&&(Nn||p===null||Ra(p,p.return)),p!==null&&v&4&&Dg(o,o.memoizedProps,p.memoizedProps);break;case 5:if(vr(l,o),gr(o),v&512&&(Nn||p===null||Ra(p,p.return)),o.flags&32){S=o.stateNode;try{Qs(S,"")}catch(qt){Be(o,o.return,qt)}}v&4&&o.stateNode!=null&&(S=o.memoizedProps,Dg(o,S,p!==null?p.memoizedProps:S)),v&1024&&(Mg=!0);break;case 6:if(vr(l,o),gr(o),v&4){if(o.stateNode===null)throw Error(n(162));v=o.memoizedProps,p=o.stateNode;try{p.nodeValue=v}catch(qt){Be(o,o.return,qt)}}break;case 3:if(Qh=null,S=aa,aa=Yh(l.containerInfo),vr(l,o),aa=S,gr(o),v&4&&p!==null&&p.memoizedState.isDehydrated)try{Ru(l.containerInfo)}catch(qt){Be(o,o.return,qt)}Mg&&(Mg=!1,yE(o));break;case 4:v=aa,aa=Yh(o.stateNode.containerInfo),vr(l,o),gr(o),aa=v;break;case 12:vr(l,o),gr(o);break;case 31:vr(l,o),gr(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,zh(o,v)));break;case 13:vr(l,o),gr(o),o.child.flags&8192&&o.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Bh=de()),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,zh(o,v)));break;case 22:S=o.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,dt=ii,Ct=Nn;if(ii=dt||S,Nn=Ct||et,vr(l,o),Nn=Ct,ii=dt,gr(o),v&8192)t:for(l=o.stateNode,l._visibility=S?l._visibility&-2:l._visibility|1,S&&(p===null||et||ii||Nn||Qo(o)),p=null,l=o;;){if(l.tag===5||l.tag===26){if(p===null){et=p=l;try{if(E=et.stateNode,S)M=E.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{j=et.stateNode;var Rt=et.memoizedProps.style,vt=Rt!=null&&Rt.hasOwnProperty("display")?Rt.display:null;j.style.display=vt==null||typeof vt=="boolean"?"":(""+vt).trim()}}catch(qt){Be(et,et.return,qt)}}}else if(l.tag===6){if(p===null){et=l;try{et.stateNode.nodeValue=S?"":et.memoizedProps}catch(qt){Be(et,et.return,qt)}}}else if(l.tag===18){if(p===null){et=l;try{var bt=et.stateNode;S?sC(bt,!0):sC(et.stateNode,!1)}catch(qt){Be(et,et.return,qt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break t;for(;l.sibling===null;){if(l.return===null||l.return===o)break t;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}v&4&&(v=o.updateQueue,v!==null&&(p=v.retryQueue,p!==null&&(v.retryQueue=null,zh(o,p))));break;case 19:vr(l,o),gr(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,zh(o,v)));break;case 30:break;case 21:break;default:vr(l,o),gr(o)}}function gr(o){var l=o.flags;if(l&2){try{for(var p,v=o.return;v!==null;){if(lE(v)){p=v;break}v=v.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var S=p.stateNode,E=Ig(o);Mh(o,E,S);break;case 5:var M=p.stateNode;p.flags&32&&(Qs(M,""),p.flags&=-33);var j=Ig(o);Mh(o,j,M);break;case 3:case 4:var et=p.stateNode.containerInfo,dt=Ig(o);kg(o,dt,et);break;default:throw Error(n(161))}}catch(Ct){Be(o,o.return,Ct)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function yE(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var l=o;yE(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),o=o.sibling}}function si(o,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)hE(o,l.alternate,l),l=l.sibling}function Qo(o){for(o=o.child;o!==null;){var l=o;switch(l.tag){case 0:case 11:case 14:case 15:Ki(4,l,l.return),Qo(l);break;case 1:Ra(l,l.return);var p=l.stateNode;typeof p.componentWillUnmount=="function"&&sE(l,l.return,p),Qo(l);break;case 27:ec(l.stateNode);case 26:case 5:Ra(l,l.return),Qo(l);break;case 22:l.memoizedState===null&&Qo(l);break;case 30:Qo(l);break;default:Qo(l)}o=o.sibling}}function ui(o,l,p){for(p=p&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var v=l.alternate,S=o,E=l,M=E.flags;switch(E.tag){case 0:case 11:case 15:ui(S,E,p),Hl(4,E);break;case 1:if(ui(S,E,p),v=E,S=v.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(dt){Be(v,v.return,dt)}if(v=E,S=v.updateQueue,S!==null){var j=v.stateNode;try{var et=S.shared.hiddenCallbacks;if(et!==null)for(S.shared.hiddenCallbacks=null,S=0;S<et.length;S++)Y2(et[S],j)}catch(dt){Be(v,v.return,dt)}}p&&M&64&&oE(E),Gl(E,E.return);break;case 27:cE(E);case 26:case 5:ui(S,E,p),p&&v===null&&M&4&&uE(E),Gl(E,E.return);break;case 12:ui(S,E,p);break;case 31:ui(S,E,p),p&&M&4&&mE(S,E);break;case 13:ui(S,E,p),p&&M&4&&vE(S,E);break;case 22:E.memoizedState===null&&ui(S,E,p),Gl(E,E.return);break;case 30:break;default:ui(S,E,p)}l=l.sibling}}function zg(o,l){var p=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),o=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(o=l.memoizedState.cachePool.pool),o!==p&&(o!=null&&o.refCount++,p!=null&&Il(p))}function Fg(o,l){o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Il(o))}function ia(o,l,p,v){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)bE(o,l,p,v),l=l.sibling}function bE(o,l,p,v){var S=l.flags;switch(l.tag){case 0:case 11:case 15:ia(o,l,p,v),S&2048&&Hl(9,l);break;case 1:ia(o,l,p,v);break;case 3:ia(o,l,p,v),S&2048&&(o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Il(o)));break;case 12:if(S&2048){ia(o,l,p,v),o=l.stateNode;try{var E=l.memoizedProps,M=E.id,j=E.onPostCommit;typeof j=="function"&&j(M,l.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(et){Be(l,l.return,et)}}else ia(o,l,p,v);break;case 31:ia(o,l,p,v);break;case 13:ia(o,l,p,v);break;case 23:break;case 22:E=l.stateNode,M=l.alternate,l.memoizedState!==null?E._visibility&2?ia(o,l,p,v):Xl(o,l):E._visibility&2?ia(o,l,p,v):(E._visibility|=2,gu(o,l,p,v,(l.subtreeFlags&10256)!==0||!1)),S&2048&&zg(M,l);break;case 24:ia(o,l,p,v),S&2048&&Fg(l.alternate,l);break;default:ia(o,l,p,v)}}function gu(o,l,p,v,S){for(S=S&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=o,M=l,j=p,et=v,dt=M.flags;switch(M.tag){case 0:case 11:case 15:gu(E,M,j,et,S),Hl(8,M);break;case 23:break;case 22:var Ct=M.stateNode;M.memoizedState!==null?Ct._visibility&2?gu(E,M,j,et,S):Xl(E,M):(Ct._visibility|=2,gu(E,M,j,et,S)),S&&dt&2048&&zg(M.alternate,M);break;case 24:gu(E,M,j,et,S),S&&dt&2048&&Fg(M.alternate,M);break;default:gu(E,M,j,et,S)}l=l.sibling}}function Xl(o,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var p=o,v=l,S=v.flags;switch(v.tag){case 22:Xl(p,v),S&2048&&zg(v.alternate,v);break;case 24:Xl(p,v),S&2048&&Fg(v.alternate,v);break;default:Xl(p,v)}l=l.sibling}}var Kl=8192;function yu(o,l,p){if(o.subtreeFlags&Kl)for(o=o.child;o!==null;)xE(o,l,p),o=o.sibling}function xE(o,l,p){switch(o.tag){case 26:yu(o,l,p),o.flags&Kl&&o.memoizedState!==null&&Cz(p,aa,o.memoizedState,o.memoizedProps);break;case 5:yu(o,l,p);break;case 3:case 4:var v=aa;aa=Yh(o.stateNode.containerInfo),yu(o,l,p),aa=v;break;case 22:o.memoizedState===null&&(v=o.alternate,v!==null&&v.memoizedState!==null?(v=Kl,Kl=16777216,yu(o,l,p),Kl=v):yu(o,l,p));break;default:yu(o,l,p)}}function wE(o){var l=o.alternate;if(l!==null&&(o=l.child,o!==null)){l.child=null;do l=o.sibling,o.sibling=null,o=l;while(o!==null)}}function Yl(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var v=l[p];Ln=v,EE(v,o)}wE(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)SE(o),o=o.sibling}function SE(o){switch(o.tag){case 0:case 11:case 15:Yl(o),o.flags&2048&&Ki(9,o,o.return);break;case 3:Yl(o);break;case 12:Yl(o);break;case 22:var l=o.stateNode;o.memoizedState!==null&&l._visibility&2&&(o.return===null||o.return.tag!==13)?(l._visibility&=-3,Fh(o)):Yl(o);break;default:Yl(o)}}function Fh(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var v=l[p];Ln=v,EE(v,o)}wE(o)}for(o=o.child;o!==null;){switch(l=o,l.tag){case 0:case 11:case 15:Ki(8,l,l.return),Fh(l);break;case 22:p=l.stateNode,p._visibility&2&&(p._visibility&=-3,Fh(l));break;default:Fh(l)}o=o.sibling}}function EE(o,l){for(;Ln!==null;){var p=Ln;switch(p.tag){case 0:case 11:case 15:Ki(8,p,l);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var v=p.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:Il(p.memoizedState.cache)}if(v=p.child,v!==null)v.return=p,Ln=v;else t:for(p=o;Ln!==null;){v=Ln;var S=v.sibling,E=v.return;if(pE(v),v===p){Ln=null;break t}if(S!==null){S.return=E,Ln=S;break t}Ln=E}}}var UM={getCacheForType:function(o){var l=Gn(En),p=l.data.get(o);return p===void 0&&(p=o(),l.data.set(o,p)),p},cacheSignal:function(){return Gn(En).controller.signal}},jM=typeof WeakMap=="function"?WeakMap:Map,ke=0,qe=null,me=null,be=0,Fe=0,_r=null,Yi=!1,bu=!1,Bg=!1,li=0,pn=0,$i=0,Zo=0,Lg=0,Or=0,xu=0,$l=null,yr=null,Ug=!1,Bh=0,CE=0,Lh=1/0,Uh=null,Qi=null,Mn=0,Zi=null,wu=null,ci=0,jg=0,Pg=null,AE=null,Ql=0,Vg=null;function Dr(){return(ke&2)!==0&&be!==0?be&-be:L.T!==null?Kg():Pw()}function NE(){if(Or===0)if((be&536870912)===0||Se){var o=_e;_e<<=1,(_e&3932160)===0&&(_e=262144),Or=o}else Or=536870912;return o=Tr.current,o!==null&&(o.flags|=32),Or}function br(o,l,p){(o===qe&&(Fe===2||Fe===9)||o.cancelPendingCommit!==null)&&(Su(o,0),Ji(o,be,Or,!1)),yl(o,p),((ke&2)===0||o!==qe)&&(o===qe&&((ke&2)===0&&(Zo|=p),pn===4&&Ji(o,be,Or,!1)),_a(o))}function TE(o,l,p){if((ke&6)!==0)throw Error(n(327));var v=!p&&(l&127)===0&&(l&o.expiredLanes)===0||gl(o,l),S=v?qM(o,l):Wg(o,l,!0),E=v;do{if(S===0){bu&&!v&&Ji(o,l,0,!1);break}else{if(p=o.current.alternate,E&&!PM(p)){S=Wg(o,l,!1),E=!1;continue}if(S===2){if(E=l,o.errorRecoveryDisabledLanes&E)var M=0;else M=o.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){l=M;t:{var j=o;S=$l;var et=j.current.memoizedState.isDehydrated;if(et&&(Su(j,M).flags|=256),M=Wg(j,M,!1),M!==2){if(Bg&&!et){j.errorRecoveryDisabledLanes|=E,Zo|=E,S=4;break t}E=yr,yr=S,E!==null&&(yr===null?yr=E:yr.push.apply(yr,E))}S=M}if(E=!1,S!==2)continue}}if(S===1){Su(o,0),Ji(o,l,0,!0);break}t:{switch(v=o,E=S,E){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Ji(v,l,Or,!Yi);break t;case 2:yr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(S=Bh+300-de(),10<S)){if(Ji(v,l,Or,!Yi),Yf(v,0,!0)!==0)break t;ci=l,v.timeoutHandle=aC(RE.bind(null,v,p,yr,Uh,Ug,l,Or,Zo,xu,Yi,E,"Throttled",-0,0),S);break t}RE(v,p,yr,Uh,Ug,l,Or,Zo,xu,Yi,E,null,-0,0)}}break}while(!0);_a(o)}function RE(o,l,p,v,S,E,M,j,et,dt,Ct,Rt,vt,bt){if(o.timeoutHandle=-1,Rt=l.subtreeFlags,Rt&8192||(Rt&16785408)===16785408){Rt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ya},xE(l,E,Rt);var qt=(E&62914560)===E?Bh-de():(E&4194048)===E?CE-de():0;if(qt=Az(Rt,qt),qt!==null){ci=E,o.cancelPendingCommit=qt(FE.bind(null,o,l,E,p,v,S,M,j,et,Ct,Rt,null,vt,bt)),Ji(o,E,M,!dt);return}}FE(o,l,E,p,v,S,M,j,et)}function PM(o){for(var l=o;;){var p=l.tag;if((p===0||p===11||p===15)&&l.flags&16384&&(p=l.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var v=0;v<p.length;v++){var S=p[v],E=S.getSnapshot;S=S.value;try{if(!Ar(E(),S))return!1}catch{return!1}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ji(o,l,p,v){l&=~Lg,l&=~Zo,o.suspendedLanes|=l,o.pingedLanes&=~l,v&&(o.warmLanes|=l),v=o.expirationTimes;for(var S=l;0<S;){var E=31-St(S),M=1<<E;v[E]=-1,S&=~M}p!==0&&Lw(o,p,l)}function jh(){return(ke&6)===0?(Zl(0),!1):!0}function qg(){if(me!==null){if(Fe===0)var o=me.return;else o=me,Ja=qo=null,ig(o),hu=null,Ml=0,o=me;for(;o!==null;)iE(o.alternate,o),o=o.return;me=null}}function Su(o,l){var p=o.timeoutHandle;p!==-1&&(o.timeoutHandle=-1,sz(p)),p=o.cancelPendingCommit,p!==null&&(o.cancelPendingCommit=null,p()),ci=0,qg(),qe=o,me=p=Qa(o.current,null),be=l,Fe=0,_r=null,Yi=!1,bu=gl(o,l),Bg=!1,xu=Or=Lg=Zo=$i=pn=0,yr=$l=null,Ug=!1,(l&8)!==0&&(l|=l&32);var v=o.entangledLanes;if(v!==0)for(o=o.entanglements,v&=l;0<v;){var S=31-St(v),E=1<<S;l|=o[S],v&=~E}return li=l,sh(),p}function _E(o,l){ue=null,L.H=Vl,l===fu||l===mh?(l=H2(),Fe=3):l===Xv?(l=H2(),Fe=4):Fe=l===wg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,_r=l,me===null&&(pn=1,_h(o,Wr(l,o.current)))}function OE(){var o=Tr.current;return o===null?!0:(be&4194048)===be?Kr===null:(be&62914560)===be||(be&536870912)!==0?o===Kr:!1}function DE(){var o=L.H;return L.H=Vl,o===null?Vl:o}function IE(){var o=L.A;return L.A=UM,o}function Ph(){pn=4,Yi||(be&4194048)!==be&&Tr.current!==null||(bu=!0),($i&134217727)===0&&(Zo&134217727)===0||qe===null||Ji(qe,be,Or,!1)}function Wg(o,l,p){var v=ke;ke|=2;var S=DE(),E=IE();(qe!==o||be!==l)&&(Uh=null,Su(o,l)),l=!1;var M=pn;t:do try{if(Fe!==0&&me!==null){var j=me,et=_r;switch(Fe){case 8:qg(),M=6;break t;case 3:case 2:case 9:case 6:Tr.current===null&&(l=!0);var dt=Fe;if(Fe=0,_r=null,Eu(o,j,et,dt),p&&bu){M=0;break t}break;default:dt=Fe,Fe=0,_r=null,Eu(o,j,et,dt)}}VM(),M=pn;break}catch(Ct){_E(o,Ct)}while(!0);return l&&o.shellSuspendCounter++,Ja=qo=null,ke=v,L.H=S,L.A=E,me===null&&(qe=null,be=0,sh()),M}function VM(){for(;me!==null;)kE(me)}function qM(o,l){var p=ke;ke|=2;var v=DE(),S=IE();qe!==o||be!==l?(Uh=null,Lh=de()+500,Su(o,l)):bu=gl(o,l);t:do try{if(Fe!==0&&me!==null){l=me;var E=_r;e:switch(Fe){case 1:Fe=0,_r=null,Eu(o,l,E,1);break;case 2:case 9:if(q2(E)){Fe=0,_r=null,ME(l);break}l=function(){Fe!==2&&Fe!==9||qe!==o||(Fe=7),_a(o)},E.then(l,l);break t;case 3:Fe=7;break t;case 4:Fe=5;break t;case 7:q2(E)?(Fe=0,_r=null,ME(l)):(Fe=0,_r=null,Eu(o,l,E,7));break;case 5:var M=null;switch(me.tag){case 26:M=me.memoizedState;case 5:case 27:var j=me;if(M?bC(M):j.stateNode.complete){Fe=0,_r=null;var et=j.sibling;if(et!==null)me=et;else{var dt=j.return;dt!==null?(me=dt,Vh(dt)):me=null}break e}}Fe=0,_r=null,Eu(o,l,E,5);break;case 6:Fe=0,_r=null,Eu(o,l,E,6);break;case 8:qg(),pn=6;break t;default:throw Error(n(462))}}WM();break}catch(Ct){_E(o,Ct)}while(!0);return Ja=qo=null,L.H=v,L.A=S,ke=p,me!==null?0:(qe=null,be=0,sh(),pn)}function WM(){for(;me!==null&&!yn();)kE(me)}function kE(o){var l=rE(o.alternate,o,li);o.memoizedProps=o.pendingProps,l===null?Vh(o):me=l}function ME(o){var l=o,p=l.alternate;switch(l.tag){case 15:case 0:l=QS(p,l,l.pendingProps,l.type,void 0,be);break;case 11:l=QS(p,l,l.pendingProps,l.type.render,l.ref,be);break;case 5:ig(l);default:iE(p,l),l=me=I2(l,li),l=rE(p,l,li)}o.memoizedProps=o.pendingProps,l===null?Vh(o):me=l}function Eu(o,l,p,v){Ja=qo=null,ig(l),hu=null,Ml=0;var S=l.return;try{if(IM(o,S,l,p,be)){pn=1,_h(o,Wr(p,o.current)),me=null;return}}catch(E){if(S!==null)throw me=S,E;pn=1,_h(o,Wr(p,o.current)),me=null;return}l.flags&32768?(Se||v===1?o=!0:bu||(be&536870912)!==0?o=!1:(Yi=o=!0,(v===2||v===9||v===3||v===6)&&(v=Tr.current,v!==null&&v.tag===13&&(v.flags|=16384))),zE(l,o)):Vh(l)}function Vh(o){var l=o;do{if((l.flags&32768)!==0){zE(l,Yi);return}o=l.return;var p=zM(l.alternate,l,li);if(p!==null){me=p;return}if(l=l.sibling,l!==null){me=l;return}me=l=o}while(l!==null);pn===0&&(pn=5)}function zE(o,l){do{var p=FM(o.alternate,o);if(p!==null){p.flags&=32767,me=p;return}if(p=o.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!l&&(o=o.sibling,o!==null)){me=o;return}me=o=p}while(o!==null);pn=6,me=null}function FE(o,l,p,v,S,E,M,j,et){o.cancelPendingCommit=null;do qh();while(Mn!==0);if((ke&6)!==0)throw Error(n(327));if(l!==null){if(l===o.current)throw Error(n(177));if(E=l.lanes|l.childLanes,E|=Iv,Ek(o,p,E,M,j,et),o===qe&&(me=qe=null,be=0),wu=l,Zi=o,ci=p,jg=E,Pg=S,AE=v,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,KM(on,function(){return PE(),null})):(o.callbackNode=null,o.callbackPriority=0),v=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||v){v=L.T,L.T=null,S=X.p,X.p=2,M=ke,ke|=4;try{BM(o,l,p)}finally{ke=M,X.p=S,L.T=v}}Mn=1,BE(),LE(),UE()}}function BE(){if(Mn===1){Mn=0;var o=Zi,l=wu,p=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||p){p=L.T,L.T=null;var v=X.p;X.p=2;var S=ke;ke|=4;try{gE(l,o);var E=ny,M=E2(o.containerInfo),j=E.focusedElem,et=E.selectionRange;if(M!==j&&j&&j.ownerDocument&&S2(j.ownerDocument.documentElement,j)){if(et!==null&&Tv(j)){var dt=et.start,Ct=et.end;if(Ct===void 0&&(Ct=dt),"selectionStart"in j)j.selectionStart=dt,j.selectionEnd=Math.min(Ct,j.value.length);else{var Rt=j.ownerDocument||document,vt=Rt&&Rt.defaultView||window;if(vt.getSelection){var bt=vt.getSelection(),qt=j.textContent.length,Qt=Math.min(et.start,qt),Pe=et.end===void 0?Qt:Math.min(et.end,qt);!bt.extend&&Qt>Pe&&(M=Pe,Pe=Qt,Qt=M);var ct=w2(j,Qt),ut=w2(j,Pe);if(ct&&ut&&(bt.rangeCount!==1||bt.anchorNode!==ct.node||bt.anchorOffset!==ct.offset||bt.focusNode!==ut.node||bt.focusOffset!==ut.offset)){var pt=Rt.createRange();pt.setStart(ct.node,ct.offset),bt.removeAllRanges(),Qt>Pe?(bt.addRange(pt),bt.extend(ut.node,ut.offset)):(pt.setEnd(ut.node,ut.offset),bt.addRange(pt))}}}}for(Rt=[],bt=j;bt=bt.parentNode;)bt.nodeType===1&&Rt.push({element:bt,left:bt.scrollLeft,top:bt.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Rt.length;j++){var Tt=Rt[j];Tt.element.scrollLeft=Tt.left,Tt.element.scrollTop=Tt.top}}ep=!!ey,ny=ey=null}finally{ke=S,X.p=v,L.T=p}}o.current=l,Mn=2}}function LE(){if(Mn===2){Mn=0;var o=Zi,l=wu,p=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||p){p=L.T,L.T=null;var v=X.p;X.p=2;var S=ke;ke|=4;try{hE(o,l.alternate,l)}finally{ke=S,X.p=v,L.T=p}}Mn=3}}function UE(){if(Mn===4||Mn===3){Mn=0,te();var o=Zi,l=wu,p=ci,v=AE;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Mn=5:(Mn=0,wu=Zi=null,jE(o,o.pendingLanes));var S=o.pendingLanes;if(S===0&&(Qi=null),uv(p),l=l.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(Y,l,void 0,(l.current.flags&128)===128)}catch{}if(v!==null){l=L.T,S=X.p,X.p=2,L.T=null;try{for(var E=o.onRecoverableError,M=0;M<v.length;M++){var j=v[M];E(j.value,{componentStack:j.stack})}}finally{L.T=l,X.p=S}}(ci&3)!==0&&qh(),_a(o),S=o.pendingLanes,(p&261930)!==0&&(S&42)!==0?o===Vg?Ql++:(Ql=0,Vg=o):Ql=0,Zl(0)}}function jE(o,l){(o.pooledCacheLanes&=l)===0&&(l=o.pooledCache,l!=null&&(o.pooledCache=null,Il(l)))}function qh(){return BE(),LE(),UE(),PE()}function PE(){if(Mn!==5)return!1;var o=Zi,l=jg;jg=0;var p=uv(ci),v=L.T,S=X.p;try{X.p=32>p?32:p,L.T=null,p=Pg,Pg=null;var E=Zi,M=ci;if(Mn=0,wu=Zi=null,ci=0,(ke&6)!==0)throw Error(n(331));var j=ke;if(ke|=4,SE(E.current),bE(E,E.current,M,p),ke=j,Zl(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(Y,E)}catch{}return!0}finally{X.p=S,L.T=v,jE(o,l)}}function VE(o,l,p){l=Wr(p,l),l=xg(o.stateNode,l,2),o=Hi(o,l,2),o!==null&&(yl(o,2),_a(o))}function Be(o,l,p){if(o.tag===3)VE(o,o,p);else for(;l!==null;){if(l.tag===3){VE(l,o,p);break}else if(l.tag===1){var v=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Qi===null||!Qi.has(v))){o=Wr(p,o),p=qS(2),v=Hi(l,p,2),v!==null&&(WS(p,v,l,o),yl(v,2),_a(v));break}}l=l.return}}function Hg(o,l,p){var v=o.pingCache;if(v===null){v=o.pingCache=new jM;var S=new Set;v.set(l,S)}else S=v.get(l),S===void 0&&(S=new Set,v.set(l,S));S.has(p)||(Bg=!0,S.add(p),o=HM.bind(null,o,l,p),l.then(o,o))}function HM(o,l,p){var v=o.pingCache;v!==null&&v.delete(l),o.pingedLanes|=o.suspendedLanes&p,o.warmLanes&=~p,qe===o&&(be&p)===p&&(pn===4||pn===3&&(be&62914560)===be&&300>de()-Bh?(ke&2)===0&&Su(o,0):Lg|=p,xu===be&&(xu=0)),_a(o)}function qE(o,l){l===0&&(l=Bw()),o=jo(o,l),o!==null&&(yl(o,l),_a(o))}function GM(o){var l=o.memoizedState,p=0;l!==null&&(p=l.retryLane),qE(o,p)}function XM(o,l){var p=0;switch(o.tag){case 31:case 13:var v=o.stateNode,S=o.memoizedState;S!==null&&(p=S.retryLane);break;case 19:v=o.stateNode;break;case 22:v=o.stateNode._retryCache;break;default:throw Error(n(314))}v!==null&&v.delete(l),qE(o,p)}function KM(o,l){return ze(o,l)}var Wh=null,Cu=null,Gg=!1,Hh=!1,Xg=!1,to=0;function _a(o){o!==Cu&&o.next===null&&(Cu===null?Wh=Cu=o:Cu=Cu.next=o),Hh=!0,Gg||(Gg=!0,$M())}function Zl(o,l){if(!Xg&&Hh){Xg=!0;do for(var p=!1,v=Wh;v!==null;){if(o!==0){var S=v.pendingLanes;if(S===0)var E=0;else{var M=v.suspendedLanes,j=v.pingedLanes;E=(1<<31-St(42|o)+1)-1,E&=S&~(M&~j),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(p=!0,XE(v,E))}else E=be,E=Yf(v,v===qe?E:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(E&3)===0||gl(v,E)||(p=!0,XE(v,E));v=v.next}while(p);Xg=!1}}function YM(){WE()}function WE(){Hh=Gg=!1;var o=0;to!==0&&oz()&&(o=to);for(var l=de(),p=null,v=Wh;v!==null;){var S=v.next,E=HE(v,l);E===0?(v.next=null,p===null?Wh=S:p.next=S,S===null&&(Cu=p)):(p=v,(o!==0||(E&3)!==0)&&(Hh=!0)),v=S}Mn!==0&&Mn!==5||Zl(o),to!==0&&(to=0)}function HE(o,l){for(var p=o.suspendedLanes,v=o.pingedLanes,S=o.expirationTimes,E=o.pendingLanes&-62914561;0<E;){var M=31-St(E),j=1<<M,et=S[M];et===-1?((j&p)===0||(j&v)!==0)&&(S[M]=Sk(j,l)):et<=l&&(o.expiredLanes|=j),E&=~j}if(l=qe,p=be,p=Yf(o,o===l?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v=o.callbackNode,p===0||o===l&&(Fe===2||Fe===9)||o.cancelPendingCommit!==null)return v!==null&&v!==null&&Ne(v),o.callbackNode=null,o.callbackPriority=0;if((p&3)===0||gl(o,p)){if(l=p&-p,l===o.callbackPriority)return l;switch(v!==null&&Ne(v),uv(p)){case 2:case 8:p=Zn;break;case 32:p=on;break;case 268435456:p=U;break;default:p=on}return v=GE.bind(null,o),p=ze(p,v),o.callbackPriority=l,o.callbackNode=p,l}return v!==null&&v!==null&&Ne(v),o.callbackPriority=2,o.callbackNode=null,2}function GE(o,l){if(Mn!==0&&Mn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var p=o.callbackNode;if(qh()&&o.callbackNode!==p)return null;var v=be;return v=Yf(o,o===qe?v:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v===0?null:(TE(o,v,l),HE(o,de()),o.callbackNode!=null&&o.callbackNode===p?GE.bind(null,o):null)}function XE(o,l){if(qh())return null;TE(o,l,!0)}function $M(){uz(function(){(ke&6)!==0?ze(tn,YM):WE()})}function Kg(){if(to===0){var o=lu;o===0&&(o=Ve,Ve<<=1,(Ve&261888)===0&&(Ve=256)),to=o}return to}function KE(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Jf(""+o)}function YE(o,l){var p=l.ownerDocument.createElement("input");return p.name=l.name,p.value=l.value,o.id&&p.setAttribute("form",o.id),l.parentNode.insertBefore(p,l),o=new FormData(o),p.parentNode.removeChild(p),o}function QM(o,l,p,v,S){if(l==="submit"&&p&&p.stateNode===S){var E=KE((S[pr]||null).action),M=v.submitter;M&&(l=(l=M[pr]||null)?KE(l.formAction):M.getAttribute("formAction"),l!==null&&(E=l,M=null));var j=new rh("action","action",null,v,S);o.push({event:j,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(to!==0){var et=M?YE(S,M):new FormData(S);dg(p,{pending:!0,data:et,method:S.method,action:E},null,et)}}else typeof E=="function"&&(j.preventDefault(),et=M?YE(S,M):new FormData(S),dg(p,{pending:!0,data:et,method:S.method,action:E},E,et))},currentTarget:S}]})}}for(var Yg=0;Yg<Dv.length;Yg++){var $g=Dv[Yg],ZM=$g.toLowerCase(),JM=$g[0].toUpperCase()+$g.slice(1);ra(ZM,"on"+JM)}ra(N2,"onAnimationEnd"),ra(T2,"onAnimationIteration"),ra(R2,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(mM,"onTransitionRun"),ra(vM,"onTransitionStart"),ra(gM,"onTransitionCancel"),ra(_2,"onTransitionEnd"),Ys("onMouseEnter",["mouseout","mouseover"]),Ys("onMouseLeave",["mouseout","mouseover"]),Ys("onPointerEnter",["pointerout","pointerover"]),Ys("onPointerLeave",["pointerout","pointerover"]),Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tz=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jl));function $E(o,l){l=(l&4)!==0;for(var p=0;p<o.length;p++){var v=o[p],S=v.event;v=v.listeners;t:{var E=void 0;if(l)for(var M=v.length-1;0<=M;M--){var j=v[M],et=j.instance,dt=j.currentTarget;if(j=j.listener,et!==E&&S.isPropagationStopped())break t;E=j,S.currentTarget=dt;try{E(S)}catch(Ct){oh(Ct)}S.currentTarget=null,E=et}else for(M=0;M<v.length;M++){if(j=v[M],et=j.instance,dt=j.currentTarget,j=j.listener,et!==E&&S.isPropagationStopped())break t;E=j,S.currentTarget=dt;try{E(S)}catch(Ct){oh(Ct)}S.currentTarget=null,E=et}}}}function ve(o,l){var p=l[lv];p===void 0&&(p=l[lv]=new Set);var v=o+"__bubble";p.has(v)||(QE(l,o,2,!1),p.add(v))}function Qg(o,l,p){var v=0;l&&(v|=4),QE(p,o,v,l)}var Gh="_reactListening"+Math.random().toString(36).slice(2);function Zg(o){if(!o[Gh]){o[Gh]=!0,Ww.forEach(function(p){p!=="selectionchange"&&(tz.has(p)||Qg(p,!1,o),Qg(p,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[Gh]||(l[Gh]=!0,Qg("selectionchange",!1,l))}}function QE(o,l,p,v){switch(NC(l)){case 2:var S=Rz;break;case 8:S=_z;break;default:S=py}p=S.bind(null,l,p,o),S=void 0,!yv||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(S=!0),v?S!==void 0?o.addEventListener(l,p,{capture:!0,passive:S}):o.addEventListener(l,p,!0):S!==void 0?o.addEventListener(l,p,{passive:S}):o.addEventListener(l,p,!1)}function Jg(o,l,p,v,S){var E=v;if((l&1)===0&&(l&2)===0&&v!==null)t:for(;;){if(v===null)return;var M=v.tag;if(M===3||M===4){var j=v.stateNode.containerInfo;if(j===S)break;if(M===4)for(M=v.return;M!==null;){var et=M.tag;if((et===3||et===4)&&M.stateNode.containerInfo===S)return;M=M.return}for(;j!==null;){if(M=Gs(j),M===null)return;if(et=M.tag,et===5||et===6||et===26||et===27){v=E=M;continue t}j=j.parentNode}}v=v.return}n2(function(){var dt=E,Ct=vv(p),Rt=[];t:{var vt=O2.get(o);if(vt!==void 0){var bt=rh,qt=o;switch(o){case"keypress":if(eh(p)===0)break t;case"keydown":case"keyup":bt=Xk;break;case"focusin":qt="focus",bt=Sv;break;case"focusout":qt="blur",bt=Sv;break;case"beforeblur":case"afterblur":bt=Sv;break;case"click":if(p.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":bt=i2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":bt=zk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":bt=$k;break;case N2:case T2:case R2:bt=Lk;break;case _2:bt=Zk;break;case"scroll":case"scrollend":bt=kk;break;case"wheel":bt=tM;break;case"copy":case"cut":case"paste":bt=jk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":bt=s2;break;case"toggle":case"beforetoggle":bt=nM}var Qt=(l&4)!==0,Pe=!Qt&&(o==="scroll"||o==="scrollend"),ct=Qt?vt!==null?vt+"Capture":null:vt;Qt=[];for(var ut=dt,pt;ut!==null;){var Tt=ut;if(pt=Tt.stateNode,Tt=Tt.tag,Tt!==5&&Tt!==26&&Tt!==27||pt===null||ct===null||(Tt=wl(ut,ct),Tt!=null&&Qt.push(tc(ut,Tt,pt))),Pe)break;ut=ut.return}0<Qt.length&&(vt=new bt(vt,qt,null,p,Ct),Rt.push({event:vt,listeners:Qt}))}}if((l&7)===0){t:{if(vt=o==="mouseover"||o==="pointerover",bt=o==="mouseout"||o==="pointerout",vt&&p!==mv&&(qt=p.relatedTarget||p.fromElement)&&(Gs(qt)||qt[Hs]))break t;if((bt||vt)&&(vt=Ct.window===Ct?Ct:(vt=Ct.ownerDocument)?vt.defaultView||vt.parentWindow:window,bt?(qt=p.relatedTarget||p.toElement,bt=dt,qt=qt?Gs(qt):null,qt!==null&&(Pe=i(qt),Qt=qt.tag,qt!==Pe||Qt!==5&&Qt!==27&&Qt!==6)&&(qt=null)):(bt=null,qt=dt),bt!==qt)){if(Qt=i2,Tt="onMouseLeave",ct="onMouseEnter",ut="mouse",(o==="pointerout"||o==="pointerover")&&(Qt=s2,Tt="onPointerLeave",ct="onPointerEnter",ut="pointer"),Pe=bt==null?vt:xl(bt),pt=qt==null?vt:xl(qt),vt=new Qt(Tt,ut+"leave",bt,p,Ct),vt.target=Pe,vt.relatedTarget=pt,Tt=null,Gs(Ct)===dt&&(Qt=new Qt(ct,ut+"enter",qt,p,Ct),Qt.target=pt,Qt.relatedTarget=Pe,Tt=Qt),Pe=Tt,bt&&qt)e:{for(Qt=ez,ct=bt,ut=qt,pt=0,Tt=ct;Tt;Tt=Qt(Tt))pt++;Tt=0;for(var Yt=ut;Yt;Yt=Qt(Yt))Tt++;for(;0<pt-Tt;)ct=Qt(ct),pt--;for(;0<Tt-pt;)ut=Qt(ut),Tt--;for(;pt--;){if(ct===ut||ut!==null&&ct===ut.alternate){Qt=ct;break e}ct=Qt(ct),ut=Qt(ut)}Qt=null}else Qt=null;bt!==null&&ZE(Rt,vt,bt,Qt,!1),qt!==null&&Pe!==null&&ZE(Rt,Pe,qt,Qt,!0)}}t:{if(vt=dt?xl(dt):window,bt=vt.nodeName&&vt.nodeName.toLowerCase(),bt==="select"||bt==="input"&&vt.type==="file")var Oe=m2;else if(p2(vt))if(v2)Oe=hM;else{Oe=cM;var Xt=lM}else bt=vt.nodeName,!bt||bt.toLowerCase()!=="input"||vt.type!=="checkbox"&&vt.type!=="radio"?dt&&dv(dt.elementType)&&(Oe=m2):Oe=fM;if(Oe&&(Oe=Oe(o,dt))){d2(Rt,Oe,p,Ct);break t}Xt&&Xt(o,vt,dt),o==="focusout"&&dt&&vt.type==="number"&&dt.memoizedProps.value!=null&&pv(vt,"number",vt.value)}switch(Xt=dt?xl(dt):window,o){case"focusin":(p2(Xt)||Xt.contentEditable==="true")&&(eu=Xt,Rv=dt,_l=null);break;case"focusout":_l=Rv=eu=null;break;case"mousedown":_v=!0;break;case"contextmenu":case"mouseup":case"dragend":_v=!1,C2(Rt,p,Ct);break;case"selectionchange":if(dM)break;case"keydown":case"keyup":C2(Rt,p,Ct)}var ce;if(Cv)t:{switch(o){case"compositionstart":var xe="onCompositionStart";break t;case"compositionend":xe="onCompositionEnd";break t;case"compositionupdate":xe="onCompositionUpdate";break t}xe=void 0}else tu?f2(o,p)&&(xe="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(xe="onCompositionStart");xe&&(u2&&p.locale!=="ko"&&(tu||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&tu&&(ce=r2()):(Li=Ct,bv="value"in Li?Li.value:Li.textContent,tu=!0)),Xt=Xh(dt,xe),0<Xt.length&&(xe=new o2(xe,o,null,p,Ct),Rt.push({event:xe,listeners:Xt}),ce?xe.data=ce:(ce=h2(p),ce!==null&&(xe.data=ce)))),(ce=aM?iM(o,p):oM(o,p))&&(xe=Xh(dt,"onBeforeInput"),0<xe.length&&(Xt=new o2("onBeforeInput","beforeinput",null,p,Ct),Rt.push({event:Xt,listeners:xe}),Xt.data=ce)),QM(Rt,o,dt,p,Ct)}$E(Rt,l)})}function tc(o,l,p){return{instance:o,listener:l,currentTarget:p}}function Xh(o,l){for(var p=l+"Capture",v=[];o!==null;){var S=o,E=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||E===null||(S=wl(o,p),S!=null&&v.unshift(tc(o,S,E)),S=wl(o,l),S!=null&&v.push(tc(o,S,E))),o.tag===3)return v;o=o.return}return[]}function ez(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function ZE(o,l,p,v,S){for(var E=l._reactName,M=[];p!==null&&p!==v;){var j=p,et=j.alternate,dt=j.stateNode;if(j=j.tag,et!==null&&et===v)break;j!==5&&j!==26&&j!==27||dt===null||(et=dt,S?(dt=wl(p,E),dt!=null&&M.unshift(tc(p,dt,et))):S||(dt=wl(p,E),dt!=null&&M.push(tc(p,dt,et)))),p=p.return}M.length!==0&&o.push({event:l,listeners:M})}var nz=/\r\n?/g,rz=/\u0000|\uFFFD/g;function JE(o){return(typeof o=="string"?o:""+o).replace(nz,`
`).replace(rz,"")}function tC(o,l){return l=JE(l),JE(o)===l}function je(o,l,p,v,S,E){switch(p){case"children":typeof v=="string"?l==="body"||l==="textarea"&&v===""||Qs(o,v):(typeof v=="number"||typeof v=="bigint")&&l!=="body"&&Qs(o,""+v);break;case"className":Qf(o,"class",v);break;case"tabIndex":Qf(o,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Qf(o,p,v);break;case"style":t2(o,v,E);break;case"data":if(l!=="object"){Qf(o,"data",v);break}case"src":case"href":if(v===""&&(l!=="a"||p!=="href")){o.removeAttribute(p);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(p);break}v=Jf(""+v),o.setAttribute(p,v);break;case"action":case"formAction":if(typeof v=="function"){o.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(p==="formAction"?(l!=="input"&&je(o,l,"name",S.name,S,null),je(o,l,"formEncType",S.formEncType,S,null),je(o,l,"formMethod",S.formMethod,S,null),je(o,l,"formTarget",S.formTarget,S,null)):(je(o,l,"encType",S.encType,S,null),je(o,l,"method",S.method,S,null),je(o,l,"target",S.target,S,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(p);break}v=Jf(""+v),o.setAttribute(p,v);break;case"onClick":v!=null&&(o.onclick=Ya);break;case"onScroll":v!=null&&ve("scroll",o);break;case"onScrollEnd":v!=null&&ve("scrollend",o);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(S.children!=null)throw Error(n(60));o.innerHTML=p}}break;case"multiple":o.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":o.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){o.removeAttribute("xlink:href");break}p=Jf(""+v),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(p,""+v):o.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(p,""):o.removeAttribute(p);break;case"capture":case"download":v===!0?o.setAttribute(p,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(p,v):o.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?o.setAttribute(p,v):o.removeAttribute(p);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?o.removeAttribute(p):o.setAttribute(p,v);break;case"popover":ve("beforetoggle",o),ve("toggle",o),$f(o,"popover",v);break;case"xlinkActuate":Ka(o,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Ka(o,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Ka(o,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Ka(o,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Ka(o,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Ka(o,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Ka(o,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Ka(o,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Ka(o,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":$f(o,"is",v);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Dk.get(p)||p,$f(o,p,v))}}function ty(o,l,p,v,S,E){switch(p){case"style":t2(o,v,E);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(S.children!=null)throw Error(n(60));o.innerHTML=p}}break;case"children":typeof v=="string"?Qs(o,v):(typeof v=="number"||typeof v=="bigint")&&Qs(o,""+v);break;case"onScroll":v!=null&&ve("scroll",o);break;case"onScrollEnd":v!=null&&ve("scrollend",o);break;case"onClick":v!=null&&(o.onclick=Ya);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hw.hasOwnProperty(p))t:{if(p[0]==="o"&&p[1]==="n"&&(S=p.endsWith("Capture"),l=p.slice(2,S?p.length-7:void 0),E=o[pr]||null,E=E!=null?E[p]:null,typeof E=="function"&&o.removeEventListener(l,E,S),typeof v=="function")){typeof E!="function"&&E!==null&&(p in o?o[p]=null:o.hasAttribute(p)&&o.removeAttribute(p)),o.addEventListener(l,v,S);break t}p in o?o[p]=v:v===!0?o.setAttribute(p,""):$f(o,p,v)}}}function Kn(o,l,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ve("error",o),ve("load",o);var v=!1,S=!1,E;for(E in p)if(p.hasOwnProperty(E)){var M=p[E];if(M!=null)switch(E){case"src":v=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:je(o,l,E,M,p,null)}}S&&je(o,l,"srcSet",p.srcSet,p,null),v&&je(o,l,"src",p.src,p,null);return;case"input":ve("invalid",o);var j=E=M=S=null,et=null,dt=null;for(v in p)if(p.hasOwnProperty(v)){var Ct=p[v];if(Ct!=null)switch(v){case"name":S=Ct;break;case"type":M=Ct;break;case"checked":et=Ct;break;case"defaultChecked":dt=Ct;break;case"value":E=Ct;break;case"defaultValue":j=Ct;break;case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(n(137,l));break;default:je(o,l,v,Ct,p,null)}}$w(o,E,j,et,dt,M,S,!1);return;case"select":ve("invalid",o),v=M=E=null;for(S in p)if(p.hasOwnProperty(S)&&(j=p[S],j!=null))switch(S){case"value":E=j;break;case"defaultValue":M=j;break;case"multiple":v=j;default:je(o,l,S,j,p,null)}l=E,p=M,o.multiple=!!v,l!=null?$s(o,!!v,l,!1):p!=null&&$s(o,!!v,p,!0);return;case"textarea":ve("invalid",o),E=S=v=null;for(M in p)if(p.hasOwnProperty(M)&&(j=p[M],j!=null))switch(M){case"value":v=j;break;case"defaultValue":S=j;break;case"children":E=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(91));break;default:je(o,l,M,j,p,null)}Zw(o,v,S,E);return;case"option":for(et in p)p.hasOwnProperty(et)&&(v=p[et],v!=null)&&(et==="selected"?o.selected=v&&typeof v!="function"&&typeof v!="symbol":je(o,l,et,v,p,null));return;case"dialog":ve("beforetoggle",o),ve("toggle",o),ve("cancel",o),ve("close",o);break;case"iframe":case"object":ve("load",o);break;case"video":case"audio":for(v=0;v<Jl.length;v++)ve(Jl[v],o);break;case"image":ve("error",o),ve("load",o);break;case"details":ve("toggle",o);break;case"embed":case"source":case"link":ve("error",o),ve("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in p)if(p.hasOwnProperty(dt)&&(v=p[dt],v!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:je(o,l,dt,v,p,null)}return;default:if(dv(l)){for(Ct in p)p.hasOwnProperty(Ct)&&(v=p[Ct],v!==void 0&&ty(o,l,Ct,v,p,void 0));return}}for(j in p)p.hasOwnProperty(j)&&(v=p[j],v!=null&&je(o,l,j,v,p,null))}function az(o,l,p,v){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,E=null,M=null,j=null,et=null,dt=null,Ct=null;for(bt in p){var Rt=p[bt];if(p.hasOwnProperty(bt)&&Rt!=null)switch(bt){case"checked":break;case"value":break;case"defaultValue":et=Rt;default:v.hasOwnProperty(bt)||je(o,l,bt,null,v,Rt)}}for(var vt in v){var bt=v[vt];if(Rt=p[vt],v.hasOwnProperty(vt)&&(bt!=null||Rt!=null))switch(vt){case"type":E=bt;break;case"name":S=bt;break;case"checked":dt=bt;break;case"defaultChecked":Ct=bt;break;case"value":M=bt;break;case"defaultValue":j=bt;break;case"children":case"dangerouslySetInnerHTML":if(bt!=null)throw Error(n(137,l));break;default:bt!==Rt&&je(o,l,vt,bt,v,Rt)}}hv(o,M,j,et,dt,Ct,E,S);return;case"select":bt=M=j=vt=null;for(E in p)if(et=p[E],p.hasOwnProperty(E)&&et!=null)switch(E){case"value":break;case"multiple":bt=et;default:v.hasOwnProperty(E)||je(o,l,E,null,v,et)}for(S in v)if(E=v[S],et=p[S],v.hasOwnProperty(S)&&(E!=null||et!=null))switch(S){case"value":vt=E;break;case"defaultValue":j=E;break;case"multiple":M=E;default:E!==et&&je(o,l,S,E,v,et)}l=j,p=M,v=bt,vt!=null?$s(o,!!p,vt,!1):!!v!=!!p&&(l!=null?$s(o,!!p,l,!0):$s(o,!!p,p?[]:"",!1));return;case"textarea":bt=vt=null;for(j in p)if(S=p[j],p.hasOwnProperty(j)&&S!=null&&!v.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:je(o,l,j,null,v,S)}for(M in v)if(S=v[M],E=p[M],v.hasOwnProperty(M)&&(S!=null||E!=null))switch(M){case"value":vt=S;break;case"defaultValue":bt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==E&&je(o,l,M,S,v,E)}Qw(o,vt,bt);return;case"option":for(var qt in p)vt=p[qt],p.hasOwnProperty(qt)&&vt!=null&&!v.hasOwnProperty(qt)&&(qt==="selected"?o.selected=!1:je(o,l,qt,null,v,vt));for(et in v)vt=v[et],bt=p[et],v.hasOwnProperty(et)&&vt!==bt&&(vt!=null||bt!=null)&&(et==="selected"?o.selected=vt&&typeof vt!="function"&&typeof vt!="symbol":je(o,l,et,vt,v,bt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qt in p)vt=p[Qt],p.hasOwnProperty(Qt)&&vt!=null&&!v.hasOwnProperty(Qt)&&je(o,l,Qt,null,v,vt);for(dt in v)if(vt=v[dt],bt=p[dt],v.hasOwnProperty(dt)&&vt!==bt&&(vt!=null||bt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(n(137,l));break;default:je(o,l,dt,vt,v,bt)}return;default:if(dv(l)){for(var Pe in p)vt=p[Pe],p.hasOwnProperty(Pe)&&vt!==void 0&&!v.hasOwnProperty(Pe)&&ty(o,l,Pe,void 0,v,vt);for(Ct in v)vt=v[Ct],bt=p[Ct],!v.hasOwnProperty(Ct)||vt===bt||vt===void 0&&bt===void 0||ty(o,l,Ct,vt,v,bt);return}}for(var ct in p)vt=p[ct],p.hasOwnProperty(ct)&&vt!=null&&!v.hasOwnProperty(ct)&&je(o,l,ct,null,v,vt);for(Rt in v)vt=v[Rt],bt=p[Rt],!v.hasOwnProperty(Rt)||vt===bt||vt==null&&bt==null||je(o,l,Rt,vt,v,bt)}function eC(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function iz(){if(typeof performance.getEntriesByType=="function"){for(var o=0,l=0,p=performance.getEntriesByType("resource"),v=0;v<p.length;v++){var S=p[v],E=S.transferSize,M=S.initiatorType,j=S.duration;if(E&&j&&eC(M)){for(M=0,j=S.responseEnd,v+=1;v<p.length;v++){var et=p[v],dt=et.startTime;if(dt>j)break;var Ct=et.transferSize,Rt=et.initiatorType;Ct&&eC(Rt)&&(et=et.responseEnd,M+=Ct*(et<j?1:(j-dt)/(et-dt)))}if(--v,l+=8*(E+M)/(S.duration/1e3),o++,10<o)break}}if(0<o)return l/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var ey=null,ny=null;function Kh(o){return o.nodeType===9?o:o.ownerDocument}function nC(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rC(o,l){if(o===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&l==="foreignObject"?0:o}function ry(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ay=null;function oz(){var o=window.event;return o&&o.type==="popstate"?o===ay?!1:(ay=o,!0):(ay=null,!1)}var aC=typeof setTimeout=="function"?setTimeout:void 0,sz=typeof clearTimeout=="function"?clearTimeout:void 0,iC=typeof Promise=="function"?Promise:void 0,uz=typeof queueMicrotask=="function"?queueMicrotask:typeof iC<"u"?function(o){return iC.resolve(null).then(o).catch(lz)}:aC;function lz(o){setTimeout(function(){throw o})}function eo(o){return o==="head"}function oC(o,l){var p=l,v=0;do{var S=p.nextSibling;if(o.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"||p==="/&"){if(v===0){o.removeChild(S),Ru(l);return}v--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")v++;else if(p==="html")ec(o.ownerDocument.documentElement);else if(p==="head"){p=o.ownerDocument.head,ec(p);for(var E=p.firstChild;E;){var M=E.nextSibling,j=E.nodeName;E[bl]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&E.rel.toLowerCase()==="stylesheet"||p.removeChild(E),E=M}}else p==="body"&&ec(o.ownerDocument.body);p=S}while(p);Ru(l)}function sC(o,l){var p=o;o=0;do{var v=p.nextSibling;if(p.nodeType===1?l?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(l?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),v&&v.nodeType===8)if(p=v.data,p==="/$"){if(o===0)break;o--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||o++;p=v}while(p)}function iy(o){var l=o.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var p=l;switch(l=l.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":iy(p),cv(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}o.removeChild(p)}}function cz(o,l,p,v){for(;o.nodeType===1;){var S=p;if(o.nodeName.toLowerCase()!==l.toLowerCase()){if(!v&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(v){if(!o[bl])switch(l){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(E=o.getAttribute("rel"),E==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(E!==S.rel||o.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||o.getAttribute("title")!==(S.title==null?null:S.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(E=o.getAttribute("src"),(E!==(S.src==null?null:S.src)||o.getAttribute("type")!==(S.type==null?null:S.type)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&E&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(l==="input"&&o.type==="hidden"){var E=S.name==null?null:""+S.name;if(S.type==="hidden"&&o.getAttribute("name")===E)return o}else return o;if(o=Yr(o.nextSibling),o===null)break}return null}function fz(o,l,p){if(l==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!p||(o=Yr(o.nextSibling),o===null))return null;return o}function uC(o,l){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!l||(o=Yr(o.nextSibling),o===null))return null;return o}function oy(o){return o.data==="$?"||o.data==="$~"}function sy(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function hz(o,l){var p=o.ownerDocument;if(o.data==="$~")o._reactRetry=l;else if(o.data!=="$?"||p.readyState!=="loading")l();else{var v=function(){l(),p.removeEventListener("DOMContentLoaded",v)};p.addEventListener("DOMContentLoaded",v),o._reactRetry=v}}function Yr(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return o}var uy=null;function lC(o){o=o.nextSibling;for(var l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="/$"||p==="/&"){if(l===0)return Yr(o.nextSibling);l--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||l++}o=o.nextSibling}return null}function cC(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(l===0)return o;l--}else p!=="/$"&&p!=="/&"||l++}o=o.previousSibling}return null}function fC(o,l,p){switch(l=Kh(p),o){case"html":if(o=l.documentElement,!o)throw Error(n(452));return o;case"head":if(o=l.head,!o)throw Error(n(453));return o;case"body":if(o=l.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function ec(o){for(var l=o.attributes;l.length;)o.removeAttributeNode(l[0]);cv(o)}var $r=new Map,hC=new Set;function Yh(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var fi=X.d;X.d={f:pz,r:dz,D:mz,C:vz,L:gz,m:yz,X:xz,S:bz,M:wz};function pz(){var o=fi.f(),l=jh();return o||l}function dz(o){var l=Xs(o);l!==null&&l.tag===5&&l.type==="form"?_S(l):fi.r(o)}var Au=typeof document>"u"?null:document;function pC(o,l,p){var v=Au;if(v&&typeof l=="string"&&l){var S=Vr(l);S='link[rel="'+o+'"][href="'+S+'"]',typeof p=="string"&&(S+='[crossorigin="'+p+'"]'),hC.has(S)||(hC.add(S),o={rel:o,crossOrigin:p,href:l},v.querySelector(S)===null&&(l=v.createElement("link"),Kn(l,"link",o),Bn(l),v.head.appendChild(l)))}}function mz(o){fi.D(o),pC("dns-prefetch",o,null)}function vz(o,l){fi.C(o,l),pC("preconnect",o,l)}function gz(o,l,p){fi.L(o,l,p);var v=Au;if(v&&o&&l){var S='link[rel="preload"][as="'+Vr(l)+'"]';l==="image"&&p&&p.imageSrcSet?(S+='[imagesrcset="'+Vr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(S+='[imagesizes="'+Vr(p.imageSizes)+'"]')):S+='[href="'+Vr(o)+'"]';var E=S;switch(l){case"style":E=Nu(o);break;case"script":E=Tu(o)}$r.has(E)||(o=d({rel:"preload",href:l==="image"&&p&&p.imageSrcSet?void 0:o,as:l},p),$r.set(E,o),v.querySelector(S)!==null||l==="style"&&v.querySelector(nc(E))||l==="script"&&v.querySelector(rc(E))||(l=v.createElement("link"),Kn(l,"link",o),Bn(l),v.head.appendChild(l)))}}function yz(o,l){fi.m(o,l);var p=Au;if(p&&o){var v=l&&typeof l.as=="string"?l.as:"script",S='link[rel="modulepreload"][as="'+Vr(v)+'"][href="'+Vr(o)+'"]',E=S;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Tu(o)}if(!$r.has(E)&&(o=d({rel:"modulepreload",href:o},l),$r.set(E,o),p.querySelector(S)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(rc(E)))return}v=p.createElement("link"),Kn(v,"link",o),Bn(v),p.head.appendChild(v)}}}function bz(o,l,p){fi.S(o,l,p);var v=Au;if(v&&o){var S=Ks(v).hoistableStyles,E=Nu(o);l=l||"default";var M=S.get(E);if(!M){var j={loading:0,preload:null};if(M=v.querySelector(nc(E)))j.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":l},p),(p=$r.get(E))&&ly(o,p);var et=M=v.createElement("link");Bn(et),Kn(et,"link",o),et._p=new Promise(function(dt,Ct){et.onload=dt,et.onerror=Ct}),et.addEventListener("load",function(){j.loading|=1}),et.addEventListener("error",function(){j.loading|=2}),j.loading|=4,$h(M,l,v)}M={type:"stylesheet",instance:M,count:1,state:j},S.set(E,M)}}}function xz(o,l){fi.X(o,l);var p=Au;if(p&&o){var v=Ks(p).hoistableScripts,S=Tu(o),E=v.get(S);E||(E=p.querySelector(rc(S)),E||(o=d({src:o,async:!0},l),(l=$r.get(S))&&cy(o,l),E=p.createElement("script"),Bn(E),Kn(E,"link",o),p.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},v.set(S,E))}}function wz(o,l){fi.M(o,l);var p=Au;if(p&&o){var v=Ks(p).hoistableScripts,S=Tu(o),E=v.get(S);E||(E=p.querySelector(rc(S)),E||(o=d({src:o,async:!0,type:"module"},l),(l=$r.get(S))&&cy(o,l),E=p.createElement("script"),Bn(E),Kn(E,"link",o),p.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},v.set(S,E))}}function dC(o,l,p,v){var S=(S=xt.current)?Yh(S):null;if(!S)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(l=Nu(p.href),p=Ks(S).hoistableStyles,v=p.get(l),v||(v={type:"style",instance:null,count:0,state:null},p.set(l,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){o=Nu(p.href);var E=Ks(S).hoistableStyles,M=E.get(o);if(M||(S=S.ownerDocument||S,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(o,M),(E=S.querySelector(nc(o)))&&!E._p&&(M.instance=E,M.state.loading=5),$r.has(o)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},$r.set(o,p),E||Sz(S,o,p,M.state))),l&&v===null)throw Error(n(528,""));return M}if(l&&v!==null)throw Error(n(529,""));return null;case"script":return l=p.async,p=p.src,typeof p=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Tu(p),p=Ks(S).hoistableScripts,v=p.get(l),v||(v={type:"script",instance:null,count:0,state:null},p.set(l,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Nu(o){return'href="'+Vr(o)+'"'}function nc(o){return'link[rel="stylesheet"]['+o+"]"}function mC(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function Sz(o,l,p,v){o.querySelector('link[rel="preload"][as="style"]['+l+"]")?v.loading=1:(l=o.createElement("link"),v.preload=l,l.addEventListener("load",function(){return v.loading|=1}),l.addEventListener("error",function(){return v.loading|=2}),Kn(l,"link",p),Bn(l),o.head.appendChild(l))}function Tu(o){return'[src="'+Vr(o)+'"]'}function rc(o){return"script[async]"+o}function vC(o,l,p){if(l.count++,l.instance===null)switch(l.type){case"style":var v=o.querySelector('style[data-href~="'+Vr(p.href)+'"]');if(v)return l.instance=v,Bn(v),v;var S=d({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return v=(o.ownerDocument||o).createElement("style"),Bn(v),Kn(v,"style",S),$h(v,p.precedence,o),l.instance=v;case"stylesheet":S=Nu(p.href);var E=o.querySelector(nc(S));if(E)return l.state.loading|=4,l.instance=E,Bn(E),E;v=mC(p),(S=$r.get(S))&&ly(v,S),E=(o.ownerDocument||o).createElement("link"),Bn(E);var M=E;return M._p=new Promise(function(j,et){M.onload=j,M.onerror=et}),Kn(E,"link",v),l.state.loading|=4,$h(E,p.precedence,o),l.instance=E;case"script":return E=Tu(p.src),(S=o.querySelector(rc(E)))?(l.instance=S,Bn(S),S):(v=p,(S=$r.get(E))&&(v=d({},p),cy(v,S)),o=o.ownerDocument||o,S=o.createElement("script"),Bn(S),Kn(S,"link",v),o.head.appendChild(S),l.instance=S);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(v=l.instance,l.state.loading|=4,$h(v,p.precedence,o));return l.instance}function $h(o,l,p){for(var v=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=v.length?v[v.length-1]:null,E=S,M=0;M<v.length;M++){var j=v[M];if(j.dataset.precedence===l)E=j;else if(E!==S)break}E?E.parentNode.insertBefore(o,E.nextSibling):(l=p.nodeType===9?p.head:p,l.insertBefore(o,l.firstChild))}function ly(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.title==null&&(o.title=l.title)}function cy(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.integrity==null&&(o.integrity=l.integrity)}var Qh=null;function gC(o,l,p){if(Qh===null){var v=new Map,S=Qh=new Map;S.set(p,v)}else S=Qh,v=S.get(p),v||(v=new Map,S.set(p,v));if(v.has(o))return v;for(v.set(o,null),p=p.getElementsByTagName(o),S=0;S<p.length;S++){var E=p[S];if(!(E[bl]||E[Wn]||o==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var M=E.getAttribute(l)||"";M=o+M;var j=v.get(M);j?j.push(E):v.set(M,[E])}}return v}function yC(o,l,p){o=o.ownerDocument||o,o.head.insertBefore(p,l==="title"?o.querySelector("head > title"):null)}function Ez(o,l,p){if(p===1||l.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(o=l.disabled,typeof l.precedence=="string"&&o==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function bC(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function Cz(o,l,p,v){if(p.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var S=Nu(v.href),E=l.querySelector(nc(S));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(o.count++,o=Zh.bind(o),l.then(o,o)),p.state.loading|=4,p.instance=E,Bn(E);return}E=l.ownerDocument||l,v=mC(v),(S=$r.get(S))&&ly(v,S),E=E.createElement("link"),Bn(E);var M=E;M._p=new Promise(function(j,et){M.onload=j,M.onerror=et}),Kn(E,"link",v),p.instance=E}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(p,l),(l=p.state.preload)&&(p.state.loading&3)===0&&(o.count++,p=Zh.bind(o),l.addEventListener("load",p),l.addEventListener("error",p))}}var fy=0;function Az(o,l){return o.stylesheets&&o.count===0&&tp(o,o.stylesheets),0<o.count||0<o.imgCount?function(p){var v=setTimeout(function(){if(o.stylesheets&&tp(o,o.stylesheets),o.unsuspend){var E=o.unsuspend;o.unsuspend=null,E()}},6e4+l);0<o.imgBytes&&fy===0&&(fy=62500*iz());var S=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&tp(o,o.stylesheets),o.unsuspend)){var E=o.unsuspend;o.unsuspend=null,E()}},(o.imgBytes>fy?50:800)+l);return o.unsuspend=p,function(){o.unsuspend=null,clearTimeout(v),clearTimeout(S)}}:null}function Zh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)tp(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Jh=null;function tp(o,l){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Jh=new Map,l.forEach(Nz,o),Jh=null,Zh.call(o))}function Nz(o,l){if(!(l.state.loading&4)){var p=Jh.get(o);if(p)var v=p.get(null);else{p=new Map,Jh.set(o,p);for(var S=o.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<S.length;E++){var M=S[E];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(p.set(M.dataset.precedence,M),v=M)}v&&p.set(null,v)}S=l.instance,M=S.getAttribute("data-precedence"),E=p.get(M)||v,E===v&&p.set(null,S),p.set(M,S),this.count++,v=Zh.bind(this),S.addEventListener("load",v),S.addEventListener("error",v),E?E.parentNode.insertBefore(S,E.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(S,o.firstChild)),l.state.loading|=4}}var ac={$$typeof:A,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function Tz(o,l,p,v,S,E,M,j,et){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ov(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ov(0),this.hiddenUpdates=ov(null),this.identifierPrefix=v,this.onUncaughtError=S,this.onCaughtError=E,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=et,this.incompleteTransitions=new Map}function xC(o,l,p,v,S,E,M,j,et,dt,Ct,Rt){return o=new Tz(o,l,p,M,et,dt,Ct,Rt,j),l=1,E===!0&&(l|=24),E=Nr(3,null,null,l),o.current=E,E.stateNode=o,l=Wv(),l.refCount++,o.pooledCache=l,l.refCount++,E.memoizedState={element:v,isDehydrated:p,cache:l},Kv(E),o}function wC(o){return o?(o=au,o):au}function SC(o,l,p,v,S,E){S=wC(S),v.context===null?v.context=S:v.pendingContext=S,v=Wi(l),v.payload={element:p},E=E===void 0?null:E,E!==null&&(v.callback=E),p=Hi(o,v,l),p!==null&&(br(p,o,l),Fl(p,o,l))}function EC(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<l?p:l}}function hy(o,l){EC(o,l),(o=o.alternate)&&EC(o,l)}function CC(o){if(o.tag===13||o.tag===31){var l=jo(o,67108864);l!==null&&br(l,o,67108864),hy(o,67108864)}}function AC(o){if(o.tag===13||o.tag===31){var l=Dr();l=sv(l);var p=jo(o,l);p!==null&&br(p,o,l),hy(o,l)}}var ep=!0;function Rz(o,l,p,v){var S=L.T;L.T=null;var E=X.p;try{X.p=2,py(o,l,p,v)}finally{X.p=E,L.T=S}}function _z(o,l,p,v){var S=L.T;L.T=null;var E=X.p;try{X.p=8,py(o,l,p,v)}finally{X.p=E,L.T=S}}function py(o,l,p,v){if(ep){var S=dy(v);if(S===null)Jg(o,l,v,np,p),TC(o,v);else if(Dz(S,o,l,p,v))v.stopPropagation();else if(TC(o,v),l&4&&-1<Oz.indexOf(o)){for(;S!==null;){var E=Xs(S);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var M=zo(E.pendingLanes);if(M!==0){var j=E;for(j.pendingLanes|=2,j.entangledLanes|=2;M;){var et=1<<31-St(M);j.entanglements[1]|=et,M&=~et}_a(E),(ke&6)===0&&(Lh=de()+500,Zl(0))}}break;case 31:case 13:j=jo(E,2),j!==null&&br(j,E,2),jh(),hy(E,2)}if(E=dy(v),E===null&&Jg(o,l,v,np,p),E===S)break;S=E}S!==null&&v.stopPropagation()}else Jg(o,l,v,null,p)}}function dy(o){return o=vv(o),my(o)}var np=null;function my(o){if(np=null,o=Gs(o),o!==null){var l=i(o);if(l===null)o=null;else{var p=l.tag;if(p===13){if(o=s(l),o!==null)return o;o=null}else if(p===31){if(o=u(l),o!==null)return o;o=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null)}}return np=o,null}function NC(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Re()){case tn:return 2;case Zn:return 8;case on:case fn:return 32;case U:return 268435456;default:return 32}default:return 32}}var vy=!1,no=null,ro=null,ao=null,ic=new Map,oc=new Map,io=[],Oz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function TC(o,l){switch(o){case"focusin":case"focusout":no=null;break;case"dragenter":case"dragleave":ro=null;break;case"mouseover":case"mouseout":ao=null;break;case"pointerover":case"pointerout":ic.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":oc.delete(l.pointerId)}}function sc(o,l,p,v,S,E){return o===null||o.nativeEvent!==E?(o={blockedOn:l,domEventName:p,eventSystemFlags:v,nativeEvent:E,targetContainers:[S]},l!==null&&(l=Xs(l),l!==null&&CC(l)),o):(o.eventSystemFlags|=v,l=o.targetContainers,S!==null&&l.indexOf(S)===-1&&l.push(S),o)}function Dz(o,l,p,v,S){switch(l){case"focusin":return no=sc(no,o,l,p,v,S),!0;case"dragenter":return ro=sc(ro,o,l,p,v,S),!0;case"mouseover":return ao=sc(ao,o,l,p,v,S),!0;case"pointerover":var E=S.pointerId;return ic.set(E,sc(ic.get(E)||null,o,l,p,v,S)),!0;case"gotpointercapture":return E=S.pointerId,oc.set(E,sc(oc.get(E)||null,o,l,p,v,S)),!0}return!1}function RC(o){var l=Gs(o.target);if(l!==null){var p=i(l);if(p!==null){if(l=p.tag,l===13){if(l=s(p),l!==null){o.blockedOn=l,Vw(o.priority,function(){AC(p)});return}}else if(l===31){if(l=u(p),l!==null){o.blockedOn=l,Vw(o.priority,function(){AC(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function rp(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var p=dy(o.nativeEvent);if(p===null){p=o.nativeEvent;var v=new p.constructor(p.type,p);mv=v,p.target.dispatchEvent(v),mv=null}else return l=Xs(p),l!==null&&CC(l),o.blockedOn=p,!1;l.shift()}return!0}function _C(o,l,p){rp(o)&&p.delete(l)}function Iz(){vy=!1,no!==null&&rp(no)&&(no=null),ro!==null&&rp(ro)&&(ro=null),ao!==null&&rp(ao)&&(ao=null),ic.forEach(_C),oc.forEach(_C)}function ap(o,l){o.blockedOn===l&&(o.blockedOn=null,vy||(vy=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Iz)))}var ip=null;function OC(o){ip!==o&&(ip=o,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){ip===o&&(ip=null);for(var l=0;l<o.length;l+=3){var p=o[l],v=o[l+1],S=o[l+2];if(typeof v!="function"){if(my(v||p)===null)continue;break}var E=Xs(p);E!==null&&(o.splice(l,3),l-=3,dg(E,{pending:!0,data:S,method:p.method,action:v},v,S))}}))}function Ru(o){function l(et){return ap(et,o)}no!==null&&ap(no,o),ro!==null&&ap(ro,o),ao!==null&&ap(ao,o),ic.forEach(l),oc.forEach(l);for(var p=0;p<io.length;p++){var v=io[p];v.blockedOn===o&&(v.blockedOn=null)}for(;0<io.length&&(p=io[0],p.blockedOn===null);)RC(p),p.blockedOn===null&&io.shift();if(p=(o.ownerDocument||o).$$reactFormReplay,p!=null)for(v=0;v<p.length;v+=3){var S=p[v],E=p[v+1],M=S[pr]||null;if(typeof E=="function")M||OC(p);else if(M){var j=null;if(E&&E.hasAttribute("formAction")){if(S=E,M=E[pr]||null)j=M.formAction;else if(my(S)!==null)continue}else j=M.action;typeof j=="function"?p[v+1]=j:(p.splice(v,3),v-=3),OC(p)}}}function DC(){function o(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(M){return S=M})},focusReset:"manual",scroll:"manual"})}function l(){S!==null&&(S(),S=null),v||setTimeout(p,20)}function p(){if(!v&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var v=!1,S=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(p,100),function(){v=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),S!==null&&(S(),S=null)}}}function gy(o){this._internalRoot=o}op.prototype.render=gy.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(n(409));var p=l.current,v=Dr();SC(p,v,o,l,null,null)},op.prototype.unmount=gy.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;SC(o.current,2,null,o,null,null),jh(),l[Hs]=null}};function op(o){this._internalRoot=o}op.prototype.unstable_scheduleHydration=function(o){if(o){var l=Pw();o={blockedOn:null,target:o,priority:l};for(var p=0;p<io.length&&l!==0&&l<io[p].priority;p++);io.splice(p,0,o),p===0&&RC(o)}};var IC=e.version;if(IC!=="19.2.4")throw Error(n(527,IC,"19.2.4"));X.findDOMNode=function(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=f(l),o=o!==null?h(o):null,o=o===null?null:o.stateNode,o};var kz={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sp.isDisabled&&sp.supportsFiber)try{Y=sp.inject(kz),st=sp}catch{}}return lc.createRoot=function(o,l){if(!a(o))throw Error(n(299));var p=!1,v="",S=US,E=jS,M=PS;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(S=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError)),l=xC(o,1,!1,null,null,p,v,null,S,E,M,DC),o[Hs]=l.current,Zg(o),new gy(l)},lc.hydrateRoot=function(o,l,p){if(!a(o))throw Error(n(299));var v=!1,S="",E=US,M=jS,j=PS,et=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onUncaughtError!==void 0&&(E=p.onUncaughtError),p.onCaughtError!==void 0&&(M=p.onCaughtError),p.onRecoverableError!==void 0&&(j=p.onRecoverableError),p.formState!==void 0&&(et=p.formState)),l=xC(o,1,!0,l,p??null,v,S,et,E,M,j,DC),l.context=wC(null),p=l.current,v=Dr(),v=sv(v),S=Wi(v),S.callback=null,Hi(p,S,v),p=v,l.current.lanes=p,yl(l,p),_a(l),o[Hs]=l.current,Zg(o),new op(l)},lc.version="19.2.4",lc}var VC;function Yz(){if(VC)return xy.exports;VC=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),xy.exports=Kz(),xy.exports}var $z=Yz();const qC=globalThis||void 0||self;var WC="popstate";function Qz(r={}){function e(n,a){let{pathname:i,search:s,hash:u}=n.location;return yb("",{pathname:i,search:s,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){return typeof a=="string"?a:Ic(a)}return Jz(e,t,null,r)}function ln(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function ja(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Zz(){return Math.random().toString(36).substring(2,10)}function HC(r,e){return{usr:r.state,key:r.key,idx:e}}function yb(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?tl(e):e,state:t,key:e&&e.key||n||Zz()}}function Ic({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function tl(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function Jz(r,e,t,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,u="POP",c=null,f=h();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function h(){return(s.state||{idx:null}).idx}function d(){u="POP";let w=h(),b=w==null?null:w-f;f=w,c&&c({action:u,location:x.location,delta:b})}function m(w,b){u="PUSH";let C=yb(x.location,w,b);f=h()+1;let A=HC(C,f),T=x.createHref(C);try{s.pushState(A,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(T)}i&&c&&c({action:u,location:x.location,delta:1})}function g(w,b){u="REPLACE";let C=yb(x.location,w,b);f=h();let A=HC(C,f),T=x.createHref(C);s.replaceState(A,"",T),i&&c&&c({action:u,location:x.location,delta:0})}function y(w){return t4(w)}let x={get action(){return u},get location(){return r(a,s)},listen(w){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(WC,d),c=w,()=>{a.removeEventListener(WC,d),c=null}},createHref(w){return e(a,w)},createURL:y,encodeLocation(w){let b=y(w);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:g,go(w){return s.go(w)}};return x}function t4(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ln(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:Ic(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function dR(r,e,t="/"){return e4(r,e,t,!1)}function e4(r,e,t,n){let a=typeof e=="string"?tl(e):e,i=Ei(a.pathname||"/",t);if(i==null)return null;let s=mR(r);n4(s);let u=null;for(let c=0;u==null&&c<s.length;++c){let f=p4(i);u=f4(s[c],f,n)}return u}function mR(r,e=[],t=[],n="",a=!1){let i=(s,u,c=a,f)=>{let h={relativePath:f===void 0?s.path||"":f,caseSensitive:s.caseSensitive===!0,childrenIndex:u,route:s};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&c)return;ln(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let d=yi([n,h.relativePath]),m=t.concat(h);s.children&&s.children.length>0&&(ln(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),mR(s.children,e,m,d,c)),!(s.path==null&&!s.index)&&e.push({path:d,score:l4(d,s.index),routesMeta:m})};return r.forEach((s,u)=>{if(s.path===""||!s.path?.includes("?"))i(s,u);else for(let c of vR(s.path))i(s,u,!0,c)}),e}function vR(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=vR(n.join("/")),u=[];return u.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&u.push(...s),u.map(c=>r.startsWith("/")&&c===""?"/":c)}function n4(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:c4(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var r4=/^:[\w-]+$/,a4=3,i4=2,o4=1,s4=10,u4=-2,GC=r=>r==="*";function l4(r,e){let t=r.split("/"),n=t.length;return t.some(GC)&&(n+=u4),e&&(n+=i4),t.filter(a=>!GC(a)).reduce((a,i)=>a+(r4.test(i)?a4:i===""?o4:s4),n)}function c4(r,e){return r.length===e.length&&r.slice(0,-1).every((n,a)=>n===e[a])?r[r.length-1]-e[e.length-1]:0}function f4(r,e,t=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let u=0;u<n.length;++u){let c=n[u],f=u===n.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=Jp({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),m=c.route;if(!d&&f&&t&&!n[n.length-1].route.index&&(d=Jp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!d)return null;Object.assign(a,d.params),s.push({params:a,pathname:yi([i,d.pathname]),pathnameBase:g4(yi([i,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(i=yi([i,d.pathnameBase]))}return s}function Jp(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=h4(r.path,r.caseSensitive,r.end),a=e.match(t);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:d},m)=>{if(h==="*"){let y=u[m]||"";s=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const g=u[m];return d&&!g?f[h]=void 0:f[h]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:r}}function h4(r,e=!1,t=!0){ja(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,u,c)=>(n.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function p4(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ja(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Ei(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}var d4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function m4(r,e="/"){let{pathname:t,search:n="",hash:a=""}=typeof r=="string"?tl(r):r,i;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?i=XC(t.substring(1),"/"):i=XC(t,e)):i=e,{pathname:i,search:y4(n),hash:b4(a)}}function XC(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Cy(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function v4(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function gR(r){let e=v4(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function yR(r,e,t,n=!1){let a;typeof r=="string"?a=tl(r):(a={...r},ln(!a.pathname||!a.pathname.includes("?"),Cy("?","pathname","search",a)),ln(!a.pathname||!a.pathname.includes("#"),Cy("#","pathname","hash",a)),ln(!a.search||!a.search.includes("#"),Cy("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,u;if(s==null)u=t;else{let d=e.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),d-=1;a.pathname=m.join("/")}u=d>=0?e[d]:"/"}let c=m4(a,u),f=s&&s!=="/"&&s.endsWith("/"),h=(i||s===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var yi=r=>r.join("/").replace(/\/\/+/g,"/"),g4=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),y4=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,b4=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,x4=class{constructor(r,e,t,n=!1){this.status=r,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function w4(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function S4(r){return r.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var bR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function xR(r,e){let t=r;if(typeof t!="string"||!d4.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,a=!1;if(bR)try{let i=new URL(window.location.href),s=t.startsWith("//")?new URL(i.protocol+t):new URL(t),u=Ei(s.pathname,e);s.origin===i.origin&&u!=null?t=u+s.search+s.hash:a=!0}catch{ja(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wR=["POST","PUT","PATCH","DELETE"];new Set(wR);var E4=["GET",...wR];new Set(E4);var el=ht.createContext(null);el.displayName="DataRouter";var Td=ht.createContext(null);Td.displayName="DataRouterState";var C4=ht.createContext(!1),SR=ht.createContext({isTransitioning:!1});SR.displayName="ViewTransition";var A4=ht.createContext(new Map);A4.displayName="Fetchers";var N4=ht.createContext(null);N4.displayName="Await";var ea=ht.createContext(null);ea.displayName="Navigation";var Yc=ht.createContext(null);Yc.displayName="Location";var Oi=ht.createContext({outlet:null,matches:[],isDataRoute:!1});Oi.displayName="Route";var m1=ht.createContext(null);m1.displayName="RouteError";var ER="REACT_ROUTER_ERROR",T4="REDIRECT",R4="ROUTE_ERROR_RESPONSE";function _4(r){if(r.startsWith(`${ER}:${T4}:{`))try{let e=JSON.parse(r.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function O4(r){if(r.startsWith(`${ER}:${R4}:{`))try{let e=JSON.parse(r.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new x4(e.status,e.statusText,e.data)}catch{}}function D4(r,{relative:e}={}){ln($c(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=ht.useContext(ea),{hash:a,pathname:i,search:s}=Qc(r,{relative:e}),u=i;return t!=="/"&&(u=i==="/"?t:yi([t,i])),n.createHref({pathname:u,search:s,hash:a})}function $c(){return ht.useContext(Yc)!=null}function Os(){return ln($c(),"useLocation() may be used only in the context of a <Router> component."),ht.useContext(Yc).location}var CR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AR(r){ht.useContext(ea).static||ht.useLayoutEffect(r)}function I4(){let{isDataRoute:r}=ht.useContext(Oi);return r?H4():k4()}function k4(){ln($c(),"useNavigate() may be used only in the context of a <Router> component.");let r=ht.useContext(el),{basename:e,navigator:t}=ht.useContext(ea),{matches:n}=ht.useContext(Oi),{pathname:a}=Os(),i=JSON.stringify(gR(n)),s=ht.useRef(!1);return AR(()=>{s.current=!0}),ht.useCallback((c,f={})=>{if(ja(s.current,CR),!s.current)return;if(typeof c=="number"){t.go(c);return}let h=yR(c,JSON.parse(i),a,f.relative==="path");r==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:yi([e,h.pathname])),(f.replace?t.replace:t.push)(h,f.state,f)},[e,t,i,a,r])}ht.createContext(null);function Qc(r,{relative:e}={}){let{matches:t}=ht.useContext(Oi),{pathname:n}=Os(),a=JSON.stringify(gR(t));return ht.useMemo(()=>yR(r,JSON.parse(a),n,e==="path"),[r,a,n,e])}function M4(r,e){return NR(r,e)}function NR(r,e,t,n,a){ln($c(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=ht.useContext(ea),{matches:s}=ht.useContext(Oi),u=s[s.length-1],c=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",d=u&&u.route;{let C=d&&d.path||"";RR(f,!d||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=Os(),g;if(e){let C=typeof e=="string"?tl(e):e;ln(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),g=C}else g=m;let y=g.pathname||"/",x=y;if(h!=="/"){let C=h.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let w=dR(r,{pathname:x});ja(d||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),ja(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=U4(w&&w.map(C=>Object.assign({},C,{params:Object.assign({},c,C.params),pathname:yi([h,i.encodeLocation?i.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:yi([h,i.encodeLocation?i.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),s,t,n,a);return e&&b?ht.createElement(Yc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},b):b}function z4(){let r=W4(),e=w4(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=ht.createElement(ht.Fragment,null,ht.createElement("p",null," Hey developer "),ht.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ht.createElement("code",{style:i},"ErrorBoundary")," or"," ",ht.createElement("code",{style:i},"errorElement")," prop on your route.")),ht.createElement(ht.Fragment,null,ht.createElement("h2",null,"Unexpected Application Error!"),ht.createElement("h3",{style:{fontStyle:"italic"}},e),t?ht.createElement("pre",{style:a},t):null,s)}var F4=ht.createElement(z4,null),TR=class extends ht.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.onError?this.props.onError(r,e):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const t=O4(r.digest);t&&(r=t)}let e=r!==void 0?ht.createElement(Oi.Provider,{value:this.props.routeContext},ht.createElement(m1.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?ht.createElement(B4,{error:r},e):e}};TR.contextType=C4;var Ay=new WeakMap;function B4({children:r,error:e}){let{basename:t}=ht.useContext(ea);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=_4(e.digest);if(n){let a=Ay.get(e);if(a)throw a;let i=xR(n.location,t);if(bR&&!Ay.get(e))if(i.isExternal||n.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const s=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:n.replace}));throw Ay.set(e,s),s}return ht.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return r}function L4({routeContext:r,match:e,children:t}){let n=ht.useContext(el);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ht.createElement(Oi.Provider,{value:r},t)}function U4(r,e=[],t=null,n=null,a=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let i=r,s=t?.errors;if(s!=null){let h=i.findIndex(d=>d.route.id&&s?.[d.route.id]!==void 0);ln(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let u=!1,c=-1;if(t)for(let h=0;h<i.length;h++){let d=i[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=h),d.route.id){let{loaderData:m,errors:g}=t,y=d.route.loader&&!m.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||y){u=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let f=t&&n?(h,d)=>{n(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:S4(t.matches),errorInfo:d})}:void 0;return i.reduceRight((h,d,m)=>{let g,y=!1,x=null,w=null;t&&(g=s&&d.route.id?s[d.route.id]:void 0,x=d.route.errorElement||F4,u&&(c<0&&m===0?(RR("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):c===m&&(y=!0,w=d.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,m+1)),C=()=>{let A;return g?A=x:y?A=w:d.route.Component?A=ht.createElement(d.route.Component,null):d.route.element?A=d.route.element:A=h,ht.createElement(L4,{match:d,routeContext:{outlet:h,matches:b,isDataRoute:t!=null},children:A})};return t&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?ht.createElement(TR,{location:t.location,revalidation:t.revalidation,component:x,error:g,children:C(),routeContext:{outlet:null,matches:b,isDataRoute:!0},onError:f}):C()},null)}function v1(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function j4(r){let e=ht.useContext(el);return ln(e,v1(r)),e}function P4(r){let e=ht.useContext(Td);return ln(e,v1(r)),e}function V4(r){let e=ht.useContext(Oi);return ln(e,v1(r)),e}function g1(r){let e=V4(r),t=e.matches[e.matches.length-1];return ln(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function q4(){return g1("useRouteId")}function W4(){let r=ht.useContext(m1),e=P4("useRouteError"),t=g1("useRouteError");return r!==void 0?r:e.errors?.[t]}function H4(){let{router:r}=j4("useNavigate"),e=g1("useNavigate"),t=ht.useRef(!1);return AR(()=>{t.current=!0}),ht.useCallback(async(a,i={})=>{ja(t.current,CR),t.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:e,...i}))},[r,e])}var KC={};function RR(r,e,t){!e&&!KC[r]&&(KC[r]=!0,ja(!1,t))}ht.memo(G4);function G4({routes:r,future:e,state:t,onError:n}){return NR(r,void 0,t,n,e)}function bc(r){ln(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function X4({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:s}){ln(!$c(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=r.replace(/^\/*/,"/"),c=ht.useMemo(()=>({basename:u,navigator:a,static:i,unstable_useTransitions:s,future:{}}),[u,a,i,s]);typeof t=="string"&&(t=tl(t));let{pathname:f="/",search:h="",hash:d="",state:m=null,key:g="default"}=t,y=ht.useMemo(()=>{let x=Ei(f,u);return x==null?null:{location:{pathname:x,search:h,hash:d,state:m,key:g},navigationType:n}},[u,f,h,d,m,g,n]);return ja(y!=null,`<Router basename="${u}"> is not able to match the URL "${f}${h}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:ht.createElement(ea.Provider,{value:c},ht.createElement(Yc.Provider,{children:e,value:y}))}function K4({children:r,location:e}){return M4(bb(r),e)}function bb(r,e=[]){let t=[];return ht.Children.forEach(r,(n,a)=>{if(!ht.isValidElement(n))return;let i=[...e,a];if(n.type===ht.Fragment){t.push.apply(t,bb(n.props.children,i));return}ln(n.type===bc,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ln(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=bb(n.props.children,i)),t.push(s)}),t}var Rp="get",_p="application/x-www-form-urlencoded";function Rd(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function Y4(r){return Rd(r)&&r.tagName.toLowerCase()==="button"}function $4(r){return Rd(r)&&r.tagName.toLowerCase()==="form"}function Q4(r){return Rd(r)&&r.tagName.toLowerCase()==="input"}function Z4(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function J4(r,e){return r.button===0&&(!e||e==="_self")&&!Z4(r)}var up=null;function tF(){if(up===null)try{new FormData(document.createElement("form"),0),up=!1}catch{up=!0}return up}var eF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ny(r){return r!=null&&!eF.has(r)?(ja(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_p}"`),null):r}function nF(r,e){let t,n,a,i,s;if($4(r)){let u=r.getAttribute("action");n=u?Ei(u,e):null,t=r.getAttribute("method")||Rp,a=Ny(r.getAttribute("enctype"))||_p,i=new FormData(r)}else if(Y4(r)||Q4(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||u.getAttribute("action");if(n=c?Ei(c,e):null,t=r.getAttribute("formmethod")||u.getAttribute("method")||Rp,a=Ny(r.getAttribute("formenctype"))||Ny(u.getAttribute("enctype"))||_p,i=new FormData(u,r),!tF()){let{name:f,type:h,value:d}=r;if(h==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,d)}}else{if(Rd(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Rp,n=null,a=_p,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:i,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function y1(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function rF(r,e,t,n){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${n}`:a.pathname=`${a.pathname}.${n}`:a.pathname==="/"?a.pathname=`_root.${n}`:e&&Ei(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function aF(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function iF(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function oF(r,e,t){let n=await Promise.all(r.map(async a=>{let i=e.routes[a.route.id];if(i){let s=await aF(i,t);return s.links?s.links():[]}return[]}));return cF(n.flat(1).filter(iF).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function YC(r,e,t,n,a,i){let s=(c,f)=>t[f]?c.route.id!==t[f].route.id:!0,u=(c,f)=>t[f].pathname!==c.pathname||t[f].route.path?.endsWith("*")&&t[f].params["*"]!==c.params["*"];return i==="assets"?e.filter((c,f)=>s(c,f)||u(c,f)):i==="data"?e.filter((c,f)=>{let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(s(c,f)||u(c,f))return!0;if(c.route.shouldRevalidate){let d=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function sF(r,e,{includeHydrateFallback:t}={}){return uF(r.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function uF(r){return[...new Set(r)]}function lF(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function cF(r,e){let t=new Set;return new Set(e),r.reduce((n,a)=>{let i=JSON.stringify(lF(a));return t.has(i)||(t.add(i),n.push({key:i,link:a})),n},[])}function _R(){let r=ht.useContext(el);return y1(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function fF(){let r=ht.useContext(Td);return y1(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var b1=ht.createContext(void 0);b1.displayName="FrameworkContext";function OR(){let r=ht.useContext(b1);return y1(r,"You must render this element inside a <HydratedRouter> element"),r}function hF(r,e){let t=ht.useContext(b1),[n,a]=ht.useState(!1),[i,s]=ht.useState(!1),{onFocus:u,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:d}=e,m=ht.useRef(null);ht.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let x=b=>{b.forEach(C=>{s(C.isIntersecting)})},w=new IntersectionObserver(x,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[r]),ht.useEffect(()=>{if(n){let x=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(x)}}},[n]);let g=()=>{a(!0)},y=()=>{a(!1),s(!1)};return t?r!=="intent"?[i,m,{}]:[i,m,{onFocus:cc(u,g),onBlur:cc(c,y),onMouseEnter:cc(f,g),onMouseLeave:cc(h,y),onTouchStart:cc(d,g)}]:[!1,m,{}]}function cc(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function pF({page:r,...e}){let{router:t}=_R(),n=ht.useMemo(()=>dR(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?ht.createElement(mF,{page:r,matches:n,...e}):null}function dF(r){let{manifest:e,routeModules:t}=OR(),[n,a]=ht.useState([]);return ht.useEffect(()=>{let i=!1;return oF(r,e,t).then(s=>{i||a(s)}),()=>{i=!0}},[r,e,t]),n}function mF({page:r,matches:e,...t}){let n=Os(),{future:a,manifest:i,routeModules:s}=OR(),{basename:u}=_R(),{loaderData:c,matches:f}=fF(),h=ht.useMemo(()=>YC(r,e,f,i,n,"data"),[r,e,f,i,n]),d=ht.useMemo(()=>YC(r,e,f,i,n,"assets"),[r,e,f,i,n]),m=ht.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let x=new Set,w=!1;if(e.forEach(C=>{let A=i.routes[C.route.id];!A||!A.hasLoader||(!h.some(T=>T.route.id===C.route.id)&&C.route.id in c&&s[C.route.id]?.shouldRevalidate||A.hasClientLoader?w=!0:x.add(C.route.id))}),x.size===0)return[];let b=rF(r,u,a.unstable_trailingSlashAwareDataRequests,"data");return w&&x.size>0&&b.searchParams.set("_routes",e.filter(C=>x.has(C.route.id)).map(C=>C.route.id).join(",")),[b.pathname+b.search]},[u,a.unstable_trailingSlashAwareDataRequests,c,n,i,h,e,r,s]),g=ht.useMemo(()=>sF(d,i),[d,i]),y=dF(d);return ht.createElement(ht.Fragment,null,m.map(x=>ht.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),g.map(x=>ht.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),y.map(({key:x,link:w})=>ht.createElement("link",{key:x,nonce:t.nonce,...w,crossOrigin:w.crossOrigin??t.crossOrigin})))}function vF(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var gF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{gF&&(window.__reactRouterVersion="7.13.0")}catch{}function yF({basename:r,children:e,unstable_useTransitions:t,window:n}){let a=ht.useRef();a.current==null&&(a.current=Qz({window:n,v5Compat:!0}));let i=a.current,[s,u]=ht.useState({action:i.action,location:i.location}),c=ht.useCallback(f=>{t===!1?u(f):ht.startTransition(()=>u(f))},[t]);return ht.useLayoutEffect(()=>i.listen(c),[i,c]),ht.createElement(X4,{basename:r,children:e,location:s.location,navigationType:s.action,navigator:i,unstable_useTransitions:t})}var DR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nl=ht.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:u,target:c,to:f,preventScrollReset:h,viewTransition:d,unstable_defaultShouldRevalidate:m,...g},y){let{basename:x,unstable_useTransitions:w}=ht.useContext(ea),b=typeof f=="string"&&DR.test(f),C=xR(f,x);f=C.to;let A=D4(f,{relative:a}),[T,R,D]=hF(n,g),N=SF(f,{replace:s,state:u,target:c,preventScrollReset:h,relative:a,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:w});function O(z){e&&e(z),z.defaultPrevented||N(z)}let k=ht.createElement("a",{...g,...D,href:C.absoluteURL||A,onClick:C.isExternal||i?e:O,ref:vF(y,R),target:c,"data-discover":!b&&t==="render"?"true":void 0});return T&&!b?ht.createElement(ht.Fragment,null,k,ht.createElement(pF,{page:A})):k});nl.displayName="Link";var bF=ht.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:u,children:c,...f},h){let d=Qc(s,{relative:f.relative}),m=Os(),g=ht.useContext(Td),{navigator:y,basename:x}=ht.useContext(ea),w=g!=null&&TF(d)&&u===!0,b=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,C=m.pathname,A=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(C=C.toLowerCase(),A=A?A.toLowerCase():null,b=b.toLowerCase()),A&&x&&(A=Ei(A,x)||A);const T=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let R=C===b||!a&&C.startsWith(b)&&C.charAt(T)==="/",D=A!=null&&(A===b||!a&&A.startsWith(b)&&A.charAt(b.length)==="/"),N={isActive:R,isPending:D,isTransitioning:w},O=R?e:void 0,k;typeof n=="function"?k=n(N):k=[n,R?"active":null,D?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let z=typeof i=="function"?i(N):i;return ht.createElement(nl,{...f,"aria-current":O,className:k,ref:h,style:z,to:s,viewTransition:u},typeof c=="function"?c(N):c)});bF.displayName="NavLink";var xF=ht.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:a,state:i,method:s=Rp,action:u,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:d,unstable_defaultShouldRevalidate:m,...g},y)=>{let{unstable_useTransitions:x}=ht.useContext(ea),w=AF(),b=NF(u,{relative:f}),C=s.toLowerCase()==="get"?"get":"post",A=typeof u=="string"&&DR.test(u),T=R=>{if(c&&c(R),R.defaultPrevented)return;R.preventDefault();let D=R.nativeEvent.submitter,N=D?.getAttribute("formmethod")||s,O=()=>w(D||R.currentTarget,{fetcherKey:e,method:N,navigate:t,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:d,unstable_defaultShouldRevalidate:m});x&&t!==!1?ht.startTransition(()=>O()):O()};return ht.createElement("form",{ref:y,method:C,action:b,onSubmit:n?c:T,...g,"data-discover":!A&&r==="render"?"true":void 0})});xF.displayName="Form";function wF(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function IR(r){let e=ht.useContext(el);return ln(e,wF(r)),e}function SF(r,{target:e,replace:t,state:n,preventScrollReset:a,relative:i,viewTransition:s,unstable_defaultShouldRevalidate:u,unstable_useTransitions:c}={}){let f=I4(),h=Os(),d=Qc(r,{relative:i});return ht.useCallback(m=>{if(J4(m,e)){m.preventDefault();let g=t!==void 0?t:Ic(h)===Ic(d),y=()=>f(r,{replace:g,state:n,preventScrollReset:a,relative:i,viewTransition:s,unstable_defaultShouldRevalidate:u});c?ht.startTransition(()=>y()):y()}},[h,f,d,t,n,e,r,a,i,s,u,c])}var EF=0,CF=()=>`__${String(++EF)}__`;function AF(){let{router:r}=IR("useSubmit"),{basename:e}=ht.useContext(ea),t=q4(),n=r.fetch,a=r.navigate;return ht.useCallback(async(i,s={})=>{let{action:u,method:c,encType:f,formData:h,body:d}=nF(i,e);if(s.navigate===!1){let m=s.fetcherKey||CF();await n(m,t,s.action||u,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:h,body:d,formMethod:s.method||c,formEncType:s.encType||f,flushSync:s.flushSync})}else await a(s.action||u,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:h,body:d,formMethod:s.method||c,formEncType:s.encType||f,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,a,e,t])}function NF(r,{relative:e}={}){let{basename:t}=ht.useContext(ea),n=ht.useContext(Oi);ln(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Qc(r||".",{relative:e})},s=Os();if(r==null){i.search=s.search;let u=new URLSearchParams(i.search),c=u.getAll("index");if(c.some(h=>h==="")){u.delete("index"),c.filter(d=>d).forEach(d=>u.append("index",d));let h=u.toString();i.search=h?`?${h}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:yi([t,i.pathname])),Ic(i)}function TF(r,{relative:e}={}){let t=ht.useContext(SR);ln(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=IR("useViewTransitionState"),a=Qc(r,{relative:e});if(!t.isTransitioning)return!1;let i=Ei(t.currentLocation.pathname,n)||t.currentLocation.pathname,s=Ei(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Jp(a.pathname,s)!=null||Jp(a.pathname,i)!=null}const kR=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();const RF=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const _F=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());const $C=r=>{const e=_F(r);return e.charAt(0).toUpperCase()+e.slice(1)};var OF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const DF=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const IF=ht.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...u},c)=>ht.createElement("svg",{ref:c,...OF,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:kR("lucide",a),...!i&&!DF(u)&&{"aria-hidden":"true"},...u},[...s.map(([f,h])=>ht.createElement(f,h)),...Array.isArray(i)?i:[i]]));const Di=(r,e)=>{const t=ht.forwardRef(({className:n,...a},i)=>ht.createElement(IF,{ref:i,iconNode:e,className:kR(`lucide-${RF($C(r))}`,`lucide-${r}`,n),...a}));return t.displayName=$C(r),t};const kF=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],MF=Di("activity",kF);const zF=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],x1=Di("arrow-left",zF);const FF=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],MR=Di("camera",FF);const BF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LF=Di("loader-circle",BF);const UF=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],xb=Di("mic",UF);const jF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],td=Di("plus",jF);const PF=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],VF=Di("trash-2",PF);const qF=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Ty=Di("volume-2",qF);const WF=[["circle",{cx:"12",cy:"10",r:"8",key:"1gshiw"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 22h10",key:"10w4w3"}],["path",{d:"M12 22v-4",key:"1utk9m"}]],HF=Di("webcam",WF),Ry=({title:r,icon:e,to:t,description:n,color:a})=>J.jsxs(nl,{to:t,className:"group relative overflow-hidden rounded-2xl bg-zinc-900 p-8 transition-all hover:scale-[1.02] hover:shadow-2xl hover:shadow-indigo-500/20 border border-zinc-800",children:[J.jsx("div",{className:`absolute -right-10 -top-10 h-40 w-40 rounded-full opacity-10 blur-3xl ${a}`}),J.jsxs("div",{className:"relative z-10 flex flex-col items-start gap-4",children:[J.jsx("div",{className:`rounded-xl p-3 ${a} bg-opacity-10`,children:J.jsx(e,{className:`h-8 w-8 ${a.replace("bg-","text-")}`})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:r}),J.jsx("p",{className:"text-zinc-400 leading-relaxed",children:n})]})]})]});function GF(){return J.jsx("div",{className:"min-h-screen bg-black text-white p-8",children:J.jsxs("div",{className:"max-w-6xl mx-auto space-y-12",children:[J.jsxs("div",{className:"text-center space-y-4 py-12",children:[J.jsx("h1",{className:"text-6xl font-black tracking-tight bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 bg-clip-text text-transparent",children:"Teachable Machine"}),J.jsx("p",{className:"text-xl text-zinc-400 max-w-2xl mx-auto",children:"Train a computer to recognize your own images, sounds, & poses. A fast, easy way to create machine learning models for your sites, apps, and more  no coding required."})]}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[J.jsx(Ry,{title:"Image Project",description:"Teach a model to classify images using files or your webcam.",icon:MR,to:"/image",color:"bg-blue-500"}),J.jsx(Ry,{title:"Audio Project",description:"Teach a model to classify audio from short sound snippets.",icon:xb,to:"/audio",color:"bg-purple-500"}),J.jsx(Ry,{title:"Pose Project",description:"Teach a model to classify body positions using files or your webcam.",icon:MF,to:"/pose",color:"bg-pink-500"})]})]})})}var _y={},Jo={},zR={},_d={};_d.byteLength=YF;_d.toByteArray=QF;_d.fromByteArray=tB;var za=[],Jr=[],XF=typeof Uint8Array<"u"?Uint8Array:Array,Oy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var _u=0,KF=Oy.length;_u<KF;++_u)za[_u]=Oy[_u],Jr[Oy.charCodeAt(_u)]=_u;Jr[45]=62;Jr[95]=63;function FR(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function YF(r){var e=FR(r),t=e[0],n=e[1];return(t+n)*3/4-n}function $F(r,e,t){return(e+t)*3/4-t}function QF(r){var e,t=FR(r),n=t[0],a=t[1],i=new XF($F(r,n,a)),s=0,u=a>0?n-4:n,c;for(c=0;c<u;c+=4)e=Jr[r.charCodeAt(c)]<<18|Jr[r.charCodeAt(c+1)]<<12|Jr[r.charCodeAt(c+2)]<<6|Jr[r.charCodeAt(c+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=e&255;return a===2&&(e=Jr[r.charCodeAt(c)]<<2|Jr[r.charCodeAt(c+1)]>>4,i[s++]=e&255),a===1&&(e=Jr[r.charCodeAt(c)]<<10|Jr[r.charCodeAt(c+1)]<<4|Jr[r.charCodeAt(c+2)]>>2,i[s++]=e>>8&255,i[s++]=e&255),i}function ZF(r){return za[r>>18&63]+za[r>>12&63]+za[r>>6&63]+za[r&63]}function JF(r,e,t){for(var n,a=[],i=e;i<t;i+=3)n=(r[i]<<16&16711680)+(r[i+1]<<8&65280)+(r[i+2]&255),a.push(ZF(n));return a.join("")}function tB(r){for(var e,t=r.length,n=t%3,a=[],i=16383,s=0,u=t-n;s<u;s+=i)a.push(JF(r,s,s+i>u?u:s+i));return n===1?(e=r[t-1],a.push(za[e>>2]+za[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],a.push(za[e>>10]+za[e>>4&63]+za[e<<2&63]+"=")),a.join("")}var w1={};w1.read=function(r,e,t,n,a){var i,s,u=a*8-n-1,c=(1<<u)-1,f=c>>1,h=-7,d=t?a-1:0,m=t?-1:1,g=r[e+d];for(d+=m,i=g&(1<<-h)-1,g>>=-h,h+=u;h>0;i=i*256+r[e+d],d+=m,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=n;h>0;s=s*256+r[e+d],d+=m,h-=8);if(i===0)i=1-f;else{if(i===c)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,n),i=i-f}return(g?-1:1)*s*Math.pow(2,i-n)};w1.write=function(r,e,t,n,a,i){var s,u,c,f=i*8-a-1,h=(1<<f)-1,d=h>>1,m=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:i-1,y=n?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?e+=m/c:e+=m*Math.pow(2,1-d),e*c>=2&&(s++,c/=2),s+d>=h?(u=0,s=h):s+d>=1?(u=(e*c-1)*Math.pow(2,a),s=s+d):(u=e*Math.pow(2,d-1)*Math.pow(2,a),s=0));a>=8;r[t+g]=u&255,g+=y,u/=256,a-=8);for(s=s<<a|u,f+=a;f>0;r[t+g]=s&255,g+=y,s/=256,f-=8);r[t+g-y]|=x*128};(function(r){const e=_d,t=w1,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=h,r.SlowBuffer=R,r.INSPECT_MAX_BYTES=50;const a=2147483647;r.kMaxLength=a;const{Uint8Array:i,ArrayBuffer:s,SharedArrayBuffer:u}=globalThis;h.TYPED_ARRAY_SUPPORT=c(),!h.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const U=new i(1),_={foo:function(){return 42}};return Object.setPrototypeOf(_,i.prototype),Object.setPrototypeOf(U,_),U.foo()===42}catch{return!1}}Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}});function f(U){if(U>a)throw new RangeError('The value "'+U+'" is invalid for option "size"');const _=new i(U);return Object.setPrototypeOf(_,h.prototype),_}function h(U,_,I){if(typeof U=="number"){if(typeof _=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(U)}return d(U,_,I)}h.poolSize=8192;function d(U,_,I){if(typeof U=="string")return x(U,_);if(s.isView(U))return b(U);if(U==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U);if(Re(U,s)||U&&Re(U.buffer,s)||typeof u<"u"&&(Re(U,u)||U&&Re(U.buffer,u)))return C(U,_,I);if(typeof U=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Y=U.valueOf&&U.valueOf();if(Y!=null&&Y!==U)return h.from(Y,_,I);const st=A(U);if(st)return st;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof U[Symbol.toPrimitive]=="function")return h.from(U[Symbol.toPrimitive]("string"),_,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U)}h.from=function(U,_,I){return d(U,_,I)},Object.setPrototypeOf(h.prototype,i.prototype),Object.setPrototypeOf(h,i);function m(U){if(typeof U!="number")throw new TypeError('"size" argument must be of type number');if(U<0)throw new RangeError('The value "'+U+'" is invalid for option "size"')}function g(U,_,I){return m(U),U<=0?f(U):_!==void 0?typeof I=="string"?f(U).fill(_,I):f(U).fill(_):f(U)}h.alloc=function(U,_,I){return g(U,_,I)};function y(U){return m(U),f(U<0?0:T(U)|0)}h.allocUnsafe=function(U){return y(U)},h.allocUnsafeSlow=function(U){return y(U)};function x(U,_){if((typeof _!="string"||_==="")&&(_="utf8"),!h.isEncoding(_))throw new TypeError("Unknown encoding: "+_);const I=D(U,_)|0;let Y=f(I);const st=Y.write(U,_);return st!==I&&(Y=Y.slice(0,st)),Y}function w(U){const _=U.length<0?0:T(U.length)|0,I=f(_);for(let Y=0;Y<_;Y+=1)I[Y]=U[Y]&255;return I}function b(U){if(Re(U,i)){const _=new i(U);return C(_.buffer,_.byteOffset,_.byteLength)}return w(U)}function C(U,_,I){if(_<0||U.byteLength<_)throw new RangeError('"offset" is outside of buffer bounds');if(U.byteLength<_+(I||0))throw new RangeError('"length" is outside of buffer bounds');let Y;return _===void 0&&I===void 0?Y=new i(U):I===void 0?Y=new i(U,_):Y=new i(U,_,I),Object.setPrototypeOf(Y,h.prototype),Y}function A(U){if(h.isBuffer(U)){const _=T(U.length)|0,I=f(_);return I.length===0||U.copy(I,0,0,_),I}if(U.length!==void 0)return typeof U.length!="number"||tn(U.length)?f(0):w(U);if(U.type==="Buffer"&&Array.isArray(U.data))return w(U.data)}function T(U){if(U>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return U|0}function R(U){return+U!=U&&(U=0),h.alloc(+U)}h.isBuffer=function(_){return _!=null&&_._isBuffer===!0&&_!==h.prototype},h.compare=function(_,I){if(Re(_,i)&&(_=h.from(_,_.offset,_.byteLength)),Re(I,i)&&(I=h.from(I,I.offset,I.byteLength)),!h.isBuffer(_)||!h.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(_===I)return 0;let Y=_.length,st=I.length;for(let mt=0,St=Math.min(Y,st);mt<St;++mt)if(_[mt]!==I[mt]){Y=_[mt],st=I[mt];break}return Y<st?-1:st<Y?1:0},h.isEncoding=function(_){switch(String(_).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(_,I){if(!Array.isArray(_))throw new TypeError('"list" argument must be an Array of Buffers');if(_.length===0)return h.alloc(0);let Y;if(I===void 0)for(I=0,Y=0;Y<_.length;++Y)I+=_[Y].length;const st=h.allocUnsafe(I);let mt=0;for(Y=0;Y<_.length;++Y){let St=_[Y];if(Re(St,i))mt+St.length>st.length?(h.isBuffer(St)||(St=h.from(St)),St.copy(st,mt)):i.prototype.set.call(st,St,mt);else if(h.isBuffer(St))St.copy(st,mt);else throw new TypeError('"list" argument must be an Array of Buffers');mt+=St.length}return st};function D(U,_){if(h.isBuffer(U))return U.length;if(s.isView(U)||Re(U,s))return U.byteLength;if(typeof U!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof U);const I=U.length,Y=arguments.length>2&&arguments[2]===!0;if(!Y&&I===0)return 0;let st=!1;for(;;)switch(_){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return ze(U).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return te(U).length;default:if(st)return Y?-1:ze(U).length;_=(""+_).toLowerCase(),st=!0}}h.byteLength=D;function N(U,_,I){let Y=!1;if((_===void 0||_<0)&&(_=0),_>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,_>>>=0,I<=_))return"";for(U||(U="utf8");;)switch(U){case"hex":return nt(this,_,I);case"utf8":case"utf-8":return X(this,_,I);case"ascii":return tt(this,_,I);case"latin1":case"binary":return q(this,_,I);case"base64":return L(this,_,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,_,I);default:if(Y)throw new TypeError("Unknown encoding: "+U);U=(U+"").toLowerCase(),Y=!0}}h.prototype._isBuffer=!0;function O(U,_,I){const Y=U[_];U[_]=U[I],U[I]=Y}h.prototype.swap16=function(){const _=this.length;if(_%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<_;I+=2)O(this,I,I+1);return this},h.prototype.swap32=function(){const _=this.length;if(_%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<_;I+=4)O(this,I,I+3),O(this,I+1,I+2);return this},h.prototype.swap64=function(){const _=this.length;if(_%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<_;I+=8)O(this,I,I+7),O(this,I+1,I+6),O(this,I+2,I+5),O(this,I+3,I+4);return this},h.prototype.toString=function(){const _=this.length;return _===0?"":arguments.length===0?X(this,0,_):N.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(_){if(!h.isBuffer(_))throw new TypeError("Argument must be a Buffer");return this===_?!0:h.compare(this,_)===0},h.prototype.inspect=function(){let _="";const I=r.INSPECT_MAX_BYTES;return _=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(_+=" ... "),"<Buffer "+_+">"},n&&(h.prototype[n]=h.prototype.inspect),h.prototype.compare=function(_,I,Y,st,mt){if(Re(_,i)&&(_=h.from(_,_.offset,_.byteLength)),!h.isBuffer(_))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof _);if(I===void 0&&(I=0),Y===void 0&&(Y=_?_.length:0),st===void 0&&(st=0),mt===void 0&&(mt=this.length),I<0||Y>_.length||st<0||mt>this.length)throw new RangeError("out of range index");if(st>=mt&&I>=Y)return 0;if(st>=mt)return-1;if(I>=Y)return 1;if(I>>>=0,Y>>>=0,st>>>=0,mt>>>=0,this===_)return 0;let St=mt-st,oe=Y-I;const en=Math.min(St,oe),He=this.slice(st,mt),Ve=_.slice(I,Y);for(let _e=0;_e<en;++_e)if(He[_e]!==Ve[_e]){St=He[_e],oe=Ve[_e];break}return St<oe?-1:oe<St?1:0};function k(U,_,I,Y,st){if(U.length===0)return-1;if(typeof I=="string"?(Y=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,tn(I)&&(I=st?0:U.length-1),I<0&&(I=U.length+I),I>=U.length){if(st)return-1;I=U.length-1}else if(I<0)if(st)I=0;else return-1;if(typeof _=="string"&&(_=h.from(_,Y)),h.isBuffer(_))return _.length===0?-1:z(U,_,I,Y,st);if(typeof _=="number")return _=_&255,typeof i.prototype.indexOf=="function"?st?i.prototype.indexOf.call(U,_,I):i.prototype.lastIndexOf.call(U,_,I):z(U,[_],I,Y,st);throw new TypeError("val must be string, number or Buffer")}function z(U,_,I,Y,st){let mt=1,St=U.length,oe=_.length;if(Y!==void 0&&(Y=String(Y).toLowerCase(),Y==="ucs2"||Y==="ucs-2"||Y==="utf16le"||Y==="utf-16le")){if(U.length<2||_.length<2)return-1;mt=2,St/=2,oe/=2,I/=2}function en(Ve,_e){return mt===1?Ve[_e]:Ve.readUInt16BE(_e*mt)}let He;if(st){let Ve=-1;for(He=I;He<St;He++)if(en(U,He)===en(_,Ve===-1?0:He-Ve)){if(Ve===-1&&(Ve=He),He-Ve+1===oe)return Ve*mt}else Ve!==-1&&(He-=He-Ve),Ve=-1}else for(I+oe>St&&(I=St-oe),He=I;He>=0;He--){let Ve=!0;for(let _e=0;_e<oe;_e++)if(en(U,He+_e)!==en(_,_e)){Ve=!1;break}if(Ve)return He}return-1}h.prototype.includes=function(_,I,Y){return this.indexOf(_,I,Y)!==-1},h.prototype.indexOf=function(_,I,Y){return k(this,_,I,Y,!0)},h.prototype.lastIndexOf=function(_,I,Y){return k(this,_,I,Y,!1)};function F(U,_,I,Y){I=Number(I)||0;const st=U.length-I;Y?(Y=Number(Y),Y>st&&(Y=st)):Y=st;const mt=_.length;Y>mt/2&&(Y=mt/2);let St;for(St=0;St<Y;++St){const oe=parseInt(_.substr(St*2,2),16);if(tn(oe))return St;U[I+St]=oe}return St}function B(U,_,I,Y){return de(ze(_,U.length-I),U,I,Y)}function V(U,_,I,Y){return de(Ne(_),U,I,Y)}function G(U,_,I,Y){return de(te(_),U,I,Y)}function Q(U,_,I,Y){return de(yn(_,U.length-I),U,I,Y)}h.prototype.write=function(_,I,Y,st){if(I===void 0)st="utf8",Y=this.length,I=0;else if(Y===void 0&&typeof I=="string")st=I,Y=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(Y)?(Y=Y>>>0,st===void 0&&(st="utf8")):(st=Y,Y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const mt=this.length-I;if((Y===void 0||Y>mt)&&(Y=mt),_.length>0&&(Y<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");st||(st="utf8");let St=!1;for(;;)switch(st){case"hex":return F(this,_,I,Y);case"utf8":case"utf-8":return B(this,_,I,Y);case"ascii":case"latin1":case"binary":return V(this,_,I,Y);case"base64":return G(this,_,I,Y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,_,I,Y);default:if(St)throw new TypeError("Unknown encoding: "+st);st=(""+st).toLowerCase(),St=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(U,_,I){return _===0&&I===U.length?e.fromByteArray(U):e.fromByteArray(U.slice(_,I))}function X(U,_,I){I=Math.min(U.length,I);const Y=[];let st=_;for(;st<I;){const mt=U[st];let St=null,oe=mt>239?4:mt>223?3:mt>191?2:1;if(st+oe<=I){let en,He,Ve,_e;switch(oe){case 1:mt<128&&(St=mt);break;case 2:en=U[st+1],(en&192)===128&&(_e=(mt&31)<<6|en&63,_e>127&&(St=_e));break;case 3:en=U[st+1],He=U[st+2],(en&192)===128&&(He&192)===128&&(_e=(mt&15)<<12|(en&63)<<6|He&63,_e>2047&&(_e<55296||_e>57343)&&(St=_e));break;case 4:en=U[st+1],He=U[st+2],Ve=U[st+3],(en&192)===128&&(He&192)===128&&(Ve&192)===128&&(_e=(mt&15)<<18|(en&63)<<12|(He&63)<<6|Ve&63,_e>65535&&_e<1114112&&(St=_e))}}St===null?(St=65533,oe=1):St>65535&&(St-=65536,Y.push(St>>>10&1023|55296),St=56320|St&1023),Y.push(St),st+=oe}return it(Y)}const $=4096;function it(U){const _=U.length;if(_<=$)return String.fromCharCode.apply(String,U);let I="",Y=0;for(;Y<_;)I+=String.fromCharCode.apply(String,U.slice(Y,Y+=$));return I}function tt(U,_,I){let Y="";I=Math.min(U.length,I);for(let st=_;st<I;++st)Y+=String.fromCharCode(U[st]&127);return Y}function q(U,_,I){let Y="";I=Math.min(U.length,I);for(let st=_;st<I;++st)Y+=String.fromCharCode(U[st]);return Y}function nt(U,_,I){const Y=U.length;(!_||_<0)&&(_=0),(!I||I<0||I>Y)&&(I=Y);let st="";for(let mt=_;mt<I;++mt)st+=Zn[U[mt]];return st}function W(U,_,I){const Y=U.slice(_,I);let st="";for(let mt=0;mt<Y.length-1;mt+=2)st+=String.fromCharCode(Y[mt]+Y[mt+1]*256);return st}h.prototype.slice=function(_,I){const Y=this.length;_=~~_,I=I===void 0?Y:~~I,_<0?(_+=Y,_<0&&(_=0)):_>Y&&(_=Y),I<0?(I+=Y,I<0&&(I=0)):I>Y&&(I=Y),I<_&&(I=_);const st=this.subarray(_,I);return Object.setPrototypeOf(st,h.prototype),st};function Z(U,_,I){if(U%1!==0||U<0)throw new RangeError("offset is not uint");if(U+_>I)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUintLE=h.prototype.readUIntLE=function(_,I,Y){_=_>>>0,I=I>>>0,Y||Z(_,I,this.length);let st=this[_],mt=1,St=0;for(;++St<I&&(mt*=256);)st+=this[_+St]*mt;return st},h.prototype.readUintBE=h.prototype.readUIntBE=function(_,I,Y){_=_>>>0,I=I>>>0,Y||Z(_,I,this.length);let st=this[_+--I],mt=1;for(;I>0&&(mt*=256);)st+=this[_+--I]*mt;return st},h.prototype.readUint8=h.prototype.readUInt8=function(_,I){return _=_>>>0,I||Z(_,1,this.length),this[_]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(_,I){return _=_>>>0,I||Z(_,2,this.length),this[_]|this[_+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(_,I){return _=_>>>0,I||Z(_,2,this.length),this[_]<<8|this[_+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),(this[_]|this[_+1]<<8|this[_+2]<<16)+this[_+3]*16777216},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),this[_]*16777216+(this[_+1]<<16|this[_+2]<<8|this[_+3])},h.prototype.readBigUInt64LE=on(function(_){_=_>>>0,Wt(_,"offset");const I=this[_],Y=this[_+7];(I===void 0||Y===void 0)&&Ae(_,this.length-8);const st=I+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24,mt=this[++_]+this[++_]*2**8+this[++_]*2**16+Y*2**24;return BigInt(st)+(BigInt(mt)<<BigInt(32))}),h.prototype.readBigUInt64BE=on(function(_){_=_>>>0,Wt(_,"offset");const I=this[_],Y=this[_+7];(I===void 0||Y===void 0)&&Ae(_,this.length-8);const st=I*2**24+this[++_]*2**16+this[++_]*2**8+this[++_],mt=this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+Y;return(BigInt(st)<<BigInt(32))+BigInt(mt)}),h.prototype.readIntLE=function(_,I,Y){_=_>>>0,I=I>>>0,Y||Z(_,I,this.length);let st=this[_],mt=1,St=0;for(;++St<I&&(mt*=256);)st+=this[_+St]*mt;return mt*=128,st>=mt&&(st-=Math.pow(2,8*I)),st},h.prototype.readIntBE=function(_,I,Y){_=_>>>0,I=I>>>0,Y||Z(_,I,this.length);let st=I,mt=1,St=this[_+--st];for(;st>0&&(mt*=256);)St+=this[_+--st]*mt;return mt*=128,St>=mt&&(St-=Math.pow(2,8*I)),St},h.prototype.readInt8=function(_,I){return _=_>>>0,I||Z(_,1,this.length),this[_]&128?(255-this[_]+1)*-1:this[_]},h.prototype.readInt16LE=function(_,I){_=_>>>0,I||Z(_,2,this.length);const Y=this[_]|this[_+1]<<8;return Y&32768?Y|4294901760:Y},h.prototype.readInt16BE=function(_,I){_=_>>>0,I||Z(_,2,this.length);const Y=this[_+1]|this[_]<<8;return Y&32768?Y|4294901760:Y},h.prototype.readInt32LE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),this[_]|this[_+1]<<8|this[_+2]<<16|this[_+3]<<24},h.prototype.readInt32BE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),this[_]<<24|this[_+1]<<16|this[_+2]<<8|this[_+3]},h.prototype.readBigInt64LE=on(function(_){_=_>>>0,Wt(_,"offset");const I=this[_],Y=this[_+7];(I===void 0||Y===void 0)&&Ae(_,this.length-8);const st=this[_+4]+this[_+5]*2**8+this[_+6]*2**16+(Y<<24);return(BigInt(st)<<BigInt(32))+BigInt(I+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24)}),h.prototype.readBigInt64BE=on(function(_){_=_>>>0,Wt(_,"offset");const I=this[_],Y=this[_+7];(I===void 0||Y===void 0)&&Ae(_,this.length-8);const st=(I<<24)+this[++_]*2**16+this[++_]*2**8+this[++_];return(BigInt(st)<<BigInt(32))+BigInt(this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+Y)}),h.prototype.readFloatLE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),t.read(this,_,!0,23,4)},h.prototype.readFloatBE=function(_,I){return _=_>>>0,I||Z(_,4,this.length),t.read(this,_,!1,23,4)},h.prototype.readDoubleLE=function(_,I){return _=_>>>0,I||Z(_,8,this.length),t.read(this,_,!0,52,8)},h.prototype.readDoubleBE=function(_,I){return _=_>>>0,I||Z(_,8,this.length),t.read(this,_,!1,52,8)};function ot(U,_,I,Y,st,mt){if(!h.isBuffer(U))throw new TypeError('"buffer" argument must be a Buffer instance');if(_>st||_<mt)throw new RangeError('"value" argument is out of bounds');if(I+Y>U.length)throw new RangeError("Index out of range")}h.prototype.writeUintLE=h.prototype.writeUIntLE=function(_,I,Y,st){if(_=+_,I=I>>>0,Y=Y>>>0,!st){const oe=Math.pow(2,8*Y)-1;ot(this,_,I,Y,oe,0)}let mt=1,St=0;for(this[I]=_&255;++St<Y&&(mt*=256);)this[I+St]=_/mt&255;return I+Y},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(_,I,Y,st){if(_=+_,I=I>>>0,Y=Y>>>0,!st){const oe=Math.pow(2,8*Y)-1;ot(this,_,I,Y,oe,0)}let mt=Y-1,St=1;for(this[I+mt]=_&255;--mt>=0&&(St*=256);)this[I+mt]=_/St&255;return I+Y},h.prototype.writeUint8=h.prototype.writeUInt8=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,1,255,0),this[I]=_&255,I+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,2,65535,0),this[I]=_&255,this[I+1]=_>>>8,I+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,2,65535,0),this[I]=_>>>8,this[I+1]=_&255,I+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,4,4294967295,0),this[I+3]=_>>>24,this[I+2]=_>>>16,this[I+1]=_>>>8,this[I]=_&255,I+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,4,4294967295,0),this[I]=_>>>24,this[I+1]=_>>>16,this[I+2]=_>>>8,this[I+3]=_&255,I+4};function xt(U,_,I,Y,st){$t(_,Y,st,U,I,7);let mt=Number(_&BigInt(4294967295));U[I++]=mt,mt=mt>>8,U[I++]=mt,mt=mt>>8,U[I++]=mt,mt=mt>>8,U[I++]=mt;let St=Number(_>>BigInt(32)&BigInt(4294967295));return U[I++]=St,St=St>>8,U[I++]=St,St=St>>8,U[I++]=St,St=St>>8,U[I++]=St,I}function Ot(U,_,I,Y,st){$t(_,Y,st,U,I,7);let mt=Number(_&BigInt(4294967295));U[I+7]=mt,mt=mt>>8,U[I+6]=mt,mt=mt>>8,U[I+5]=mt,mt=mt>>8,U[I+4]=mt;let St=Number(_>>BigInt(32)&BigInt(4294967295));return U[I+3]=St,St=St>>8,U[I+2]=St,St=St>>8,U[I+1]=St,St=St>>8,U[I]=St,I+8}h.prototype.writeBigUInt64LE=on(function(_,I=0){return xt(this,_,I,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeBigUInt64BE=on(function(_,I=0){return Ot(this,_,I,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeIntLE=function(_,I,Y,st){if(_=+_,I=I>>>0,!st){const en=Math.pow(2,8*Y-1);ot(this,_,I,Y,en-1,-en)}let mt=0,St=1,oe=0;for(this[I]=_&255;++mt<Y&&(St*=256);)_<0&&oe===0&&this[I+mt-1]!==0&&(oe=1),this[I+mt]=(_/St>>0)-oe&255;return I+Y},h.prototype.writeIntBE=function(_,I,Y,st){if(_=+_,I=I>>>0,!st){const en=Math.pow(2,8*Y-1);ot(this,_,I,Y,en-1,-en)}let mt=Y-1,St=1,oe=0;for(this[I+mt]=_&255;--mt>=0&&(St*=256);)_<0&&oe===0&&this[I+mt+1]!==0&&(oe=1),this[I+mt]=(_/St>>0)-oe&255;return I+Y},h.prototype.writeInt8=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,1,127,-128),_<0&&(_=255+_+1),this[I]=_&255,I+1},h.prototype.writeInt16LE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,2,32767,-32768),this[I]=_&255,this[I+1]=_>>>8,I+2},h.prototype.writeInt16BE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,2,32767,-32768),this[I]=_>>>8,this[I+1]=_&255,I+2},h.prototype.writeInt32LE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,4,2147483647,-2147483648),this[I]=_&255,this[I+1]=_>>>8,this[I+2]=_>>>16,this[I+3]=_>>>24,I+4},h.prototype.writeInt32BE=function(_,I,Y){return _=+_,I=I>>>0,Y||ot(this,_,I,4,2147483647,-2147483648),_<0&&(_=4294967295+_+1),this[I]=_>>>24,this[I+1]=_>>>16,this[I+2]=_>>>8,this[I+3]=_&255,I+4},h.prototype.writeBigInt64LE=on(function(_,I=0){return xt(this,_,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeBigInt64BE=on(function(_,I=0){return Ot(this,_,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function zt(U,_,I,Y,st,mt){if(I+Y>U.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function _t(U,_,I,Y,st){return _=+_,I=I>>>0,st||zt(U,_,I,4),t.write(U,_,I,Y,23,4),I+4}h.prototype.writeFloatLE=function(_,I,Y){return _t(this,_,I,!0,Y)},h.prototype.writeFloatBE=function(_,I,Y){return _t(this,_,I,!1,Y)};function Mt(U,_,I,Y,st){return _=+_,I=I>>>0,st||zt(U,_,I,8),t.write(U,_,I,Y,52,8),I+8}h.prototype.writeDoubleLE=function(_,I,Y){return Mt(this,_,I,!0,Y)},h.prototype.writeDoubleBE=function(_,I,Y){return Mt(this,_,I,!1,Y)},h.prototype.copy=function(_,I,Y,st){if(!h.isBuffer(_))throw new TypeError("argument should be a Buffer");if(Y||(Y=0),!st&&st!==0&&(st=this.length),I>=_.length&&(I=_.length),I||(I=0),st>0&&st<Y&&(st=Y),st===Y||_.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(Y<0||Y>=this.length)throw new RangeError("Index out of range");if(st<0)throw new RangeError("sourceEnd out of bounds");st>this.length&&(st=this.length),_.length-I<st-Y&&(st=_.length-I+Y);const mt=st-Y;return this===_&&typeof i.prototype.copyWithin=="function"?this.copyWithin(I,Y,st):i.prototype.set.call(_,this.subarray(Y,st),I),mt},h.prototype.fill=function(_,I,Y,st){if(typeof _=="string"){if(typeof I=="string"?(st=I,I=0,Y=this.length):typeof Y=="string"&&(st=Y,Y=this.length),st!==void 0&&typeof st!="string")throw new TypeError("encoding must be a string");if(typeof st=="string"&&!h.isEncoding(st))throw new TypeError("Unknown encoding: "+st);if(_.length===1){const St=_.charCodeAt(0);(st==="utf8"&&St<128||st==="latin1")&&(_=St)}}else typeof _=="number"?_=_&255:typeof _=="boolean"&&(_=Number(_));if(I<0||this.length<I||this.length<Y)throw new RangeError("Out of range index");if(Y<=I)return this;I=I>>>0,Y=Y===void 0?this.length:Y>>>0,_||(_=0);let mt;if(typeof _=="number")for(mt=I;mt<Y;++mt)this[mt]=_;else{const St=h.isBuffer(_)?_:h.from(_,st),oe=St.length;if(oe===0)throw new TypeError('The value "'+_+'" is invalid for argument "value"');for(mt=0;mt<Y-I;++mt)this[mt+I]=St[mt%oe]}return this};const kt={};function Ft(U,_,I){kt[U]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:_.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${U}]`,this.stack,delete this.name}get code(){return U}set code(st){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:st,writable:!0})}toString(){return`${this.name} [${U}]: ${this.message}`}}}Ft("ERR_BUFFER_OUT_OF_BOUNDS",function(U){return U?`${U} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ft("ERR_INVALID_ARG_TYPE",function(U,_){return`The "${U}" argument must be of type number. Received type ${typeof _}`},TypeError),Ft("ERR_OUT_OF_RANGE",function(U,_,I){let Y=`The value of "${U}" is out of range.`,st=I;return Number.isInteger(I)&&Math.abs(I)>2**32?st=Pt(String(I)):typeof I=="bigint"&&(st=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(st=Pt(st)),st+="n"),Y+=` It must be ${_}. Received ${st}`,Y},RangeError);function Pt(U){let _="",I=U.length;const Y=U[0]==="-"?1:0;for(;I>=Y+4;I-=3)_=`_${U.slice(I-3,I)}${_}`;return`${U.slice(0,I)}${_}`}function Ut(U,_,I){Wt(_,"offset"),(U[_]===void 0||U[_+I]===void 0)&&Ae(_,U.length-(I+1))}function $t(U,_,I,Y,st,mt){if(U>I||U<_){const St=typeof _=="bigint"?"n":"";let oe;throw _===0||_===BigInt(0)?oe=`>= 0${St} and < 2${St} ** ${(mt+1)*8}${St}`:oe=`>= -(2${St} ** ${(mt+1)*8-1}${St}) and < 2 ** ${(mt+1)*8-1}${St}`,new kt.ERR_OUT_OF_RANGE("value",oe,U)}Ut(Y,st,mt)}function Wt(U,_){if(typeof U!="number")throw new kt.ERR_INVALID_ARG_TYPE(_,"number",U)}function Ae(U,_,I){throw Math.floor(U)!==U?(Wt(U,I),new kt.ERR_OUT_OF_RANGE("offset","an integer",U)):_<0?new kt.ERR_BUFFER_OUT_OF_BOUNDS:new kt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${_}`,U)}const cn=/[^+/0-9A-Za-z-_]/g;function Et(U){if(U=U.split("=")[0],U=U.trim().replace(cn,""),U.length<2)return"";for(;U.length%4!==0;)U=U+"=";return U}function ze(U,_){_=_||1/0;let I;const Y=U.length;let st=null;const mt=[];for(let St=0;St<Y;++St){if(I=U.charCodeAt(St),I>55295&&I<57344){if(!st){if(I>56319){(_-=3)>-1&&mt.push(239,191,189);continue}else if(St+1===Y){(_-=3)>-1&&mt.push(239,191,189);continue}st=I;continue}if(I<56320){(_-=3)>-1&&mt.push(239,191,189),st=I;continue}I=(st-55296<<10|I-56320)+65536}else st&&(_-=3)>-1&&mt.push(239,191,189);if(st=null,I<128){if((_-=1)<0)break;mt.push(I)}else if(I<2048){if((_-=2)<0)break;mt.push(I>>6|192,I&63|128)}else if(I<65536){if((_-=3)<0)break;mt.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((_-=4)<0)break;mt.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return mt}function Ne(U){const _=[];for(let I=0;I<U.length;++I)_.push(U.charCodeAt(I)&255);return _}function yn(U,_){let I,Y,st;const mt=[];for(let St=0;St<U.length&&!((_-=2)<0);++St)I=U.charCodeAt(St),Y=I>>8,st=I%256,mt.push(st),mt.push(Y);return mt}function te(U){return e.toByteArray(Et(U))}function de(U,_,I,Y){let st;for(st=0;st<Y&&!(st+I>=_.length||st>=U.length);++st)_[st+I]=U[st];return st}function Re(U,_){return U instanceof _||U!=null&&U.constructor!=null&&U.constructor.name!=null&&U.constructor.name===_.name}function tn(U){return U!==U}const Zn=(function(){const U="0123456789abcdef",_=new Array(256);for(let I=0;I<16;++I){const Y=I*16;for(let st=0;st<16;++st)_[Y+st]=U[I]+U[st]}return _})();function on(U){return typeof BigInt>"u"?fn:U}function fn(){throw new Error("BigInt not supported")}})(zR);const ys=zR.Buffer;var BR=function(r,e){return(BR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(r,e)};function ba(r,e){function t(){this.constructor=r}BR(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Ht(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){f.done?a(f.value):new t(function(h){h(f.value)}).then(s,u)}c((n=n.apply(r,[])).next())})}function Gt(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}var S1=(function(){function r(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},r.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){var a=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+a+"."),this.set(e,a)}},r.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},r.prototype.getNumber=function(e){return this.get(e)},r.prototype.getBool=function(e){return this.get(e)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},r.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},r.prototype.setFlags=function(e){this.flags=Object.assign({},e)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,n,a=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return(function(c,f,h){c[decodeURIComponent(f)]=decodeURIComponent(h||"")})(n,s[0],s[1]),s.join("=")}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),u=s[0],c=s[1];e.urlFlags[u]=(function(f,h){if((h=h.toLowerCase())==="true"||h==="false")return h==="true";if(""+ +h===h)return+h;throw new Error("Could not parse value flag value "+h+" for flag "+f+".")})(u,c)})}},r})();function yt(){return Od}var Od=null,Hu=new Map;function E1(r,e){var t=C1(r,e);return Hu.get(t)}function ed(r){for(var e=Hu.entries(),t=[];;){var n=e.next(),a=n.done,i=n.value;if(a)break;var s=i[0],u=i[1];s.split("_")[0]===r&&t.push(u)}return t}function nd(r){var e=r.kernelName,t=r.backendName,n=C1(e,t);if(Hu.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");Hu.set(n,r)}function LR(r,e){var t=C1(r,e);if(!Hu.has(t))throw new Error("The kernel '"+r+"' for backend '"+e+"' is not registered");Hu.delete(t)}function C1(r,e){return e+"_"+r}function QC(r){for(var e=r.length,t=0,n=0;e>0;)n=Math.random()*e|0,t=r[--e],r[e]=r[n],r[n]=t}function rd(r,e,t){return Math.max(r,Math.min(e,t))}function A1(r){return r%2==0?r:r+1}function UR(r){for(var e=0,t=0;t<r.length;t++)e+=r[t];return e}function K(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function Ce(r,e,t){t===void 0&&(t=""),K(Pn(r,e),function(){return t+" Shapes "+r+" and "+e+" must match"})}function Ds(r){K(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ci(r,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(r)||$n(r)&&!t)for(var n=0;n<r.length;++n)Ci(r[n],e,t);else e.push(r);return e}function Kt(r){if(r.length===0)return 1;for(var e=r[0],t=1;t<r.length;t++)e*=r[t];return e}function Pn(r,e){if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function mn(r){return r%1==0}function jR(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var e=Math.exp(2*r);return(e-1)/(e+1)}function ad(r){var e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}function ps(r,e){return e<=r.length?r:r+" ".repeat(e-r.length)}function wb(r,e,t){return e===void 0&&(e=function(n){return 0}),new Promise(function(n,a){var i=0,s=function(){if(r())n();else{var u=e(++i);t!=null&&i>=t?a():setTimeout(s,u)}};s()})}function PR(r,e){for(var t=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)t*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+r);return r}if(t===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var i=r.slice();return i[n]=e/t,i}function qn(r,e){var t=e.length;return K((r=r==null?e.map(function(n,a){return a}):[].concat(r)).every(function(n){return n>=-t&&n<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+r}),K(r.every(function(n){return mn(n)}),function(){return"All values in axis param must be integers but got axis "+r}),r.map(function(n){return n<0?t+n:n})}function co(r,e){for(var t=[],n=[],a=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||a?null:qn(e,r).sort(),s=0,u=0;u<r.length;++u){if(i!=null){if(i[s]===u&&r[u]!==1)throw new Error("Can't squeeze axis "+u+" since its dim '"+r[u]+"' is not 1");(i[s]==null||i[s]>u)&&r[u]===1&&(t.push(r[u]),n.push(u)),i[s]<=u&&s++}r[u]!==1&&(t.push(r[u]),n.push(u))}return{newShape:t,keptDims:n}}function kc(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else{if(r!=="bool")throw new Error("Unknown data type "+r);t=new Uint8Array(e)}return t}function Mc(r,e){var t=null;if(r==null||r==="float32")t=new Float32Array(e);else if(r==="int32")t=new Int32Array(e);else if(r==="bool")t=new Uint8Array(e);else{if(r!=="string")throw new Error("Unknown data type "+r);t=new Array(e)}return t}function VR(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function qR(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function WR(r,e){return e!=="complex64"&&(e!=="float32"||r==="complex64")&&(e!=="int32"||r==="float32"||r==="complex64")&&(e!=="bool"||r!=="bool")}function $n(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function N1(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function HR(r){if(r==null)return 0;var e=0;return r.forEach(function(t){return e+=t.length}),e}function fo(r){return typeof r=="string"||r instanceof String}function GR(r){return typeof r=="boolean"}function XR(r){return typeof r=="number"}function rl(r){return Array.isArray(r)?rl(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":XR(r)?"float32":fo(r)?"string":GR(r)?"bool":"float32"}function xo(r){return!!(r&&r.constructor&&r.call&&r.apply)}function id(r,e){for(var t=e;t<r;++t)if(r%t==0)return t;return r}function Co(r){var e=r.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=r[e-1];for(var n=e-3;n>=0;--n)t[n]=t[n+1]*r[n+1];return t}function T1(r,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Ci(r)),t&&VR(r,e),(function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"})(r,e))return r;if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+e)}function Sb(r,e){if(r.length===0)return e[0];var t=r.reduce(function(n,a){return n*a});if(t===0)return[];if(t!==e.length)throw new Error("["+r+"] does not match the input size.");return(function n(a,i,s){var u=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)u[f]=s[a+f];else{c=i[0];var h=i.slice(1),d=h.reduce(function(m,g){return m*g});for(f=0;f<c;f++)u[f]=n(a+f*d,h,s)}return u})(0,r,e)}function R1(r,e){for(var t=al(r,e),n=0;n<t.length;n++)t[n]=1;return t}function al(r,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(r);if(e==="int32")return new Int32Array(r);if(e==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+e)}function la(){return yt().platform.now()}function _1(r){r.forEach(function(e){K(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."})})}function KR(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",yt().platform.encode(r,e)}function zc(r,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",yt().platform.decode(r,e)}var At=Object.freeze({shuffle:QC,clamp:rd,nearestLargerEven:A1,sum:UR,randUniform:function(r,e){var t=Math.random();return e*t+(1-t)*r},distSquared:function(r,e){for(var t=0,n=0;n<r.length;n++){var a=Number(r[n])-Number(e[n]);t+=a*a}return t},assert:K,assertShapesMatch:Ce,assertNonNull:Ds,flatten:Ci,sizeFromShape:Kt,isScalarShape:function(r){return r.length===0},arraysEqual:Pn,isInt:mn,tanh:jR,sizeToSquarishShape:ad,createShuffledIndices:function(r){for(var e=new Uint32Array(r),t=0;t<r;++t)e[t]=t;return QC(e),e},rightPad:ps,repeatedTry:wb,inferFromImplicitShape:PR,parseAxisParam:qn,squeezeShape:co,getTypedArrayFromDType:kc,getArrayFromDType:Mc,checkConversionForErrors:VR,isValidDtype:qR,hasEncodingLoss:WR,isTypedArray:$n,bytesPerElement:N1,bytesFromStringArray:HR,isString:fo,isBoolean:GR,isNumber:XR,inferDtype:rl,isFunction:xo,nearestDivisor:id,computeStrides:Co,toTypedArray:T1,toNestedArray:Sb,makeOnesTypedArray:R1,makeZerosTypedArray:al,now:la,assertNonNegativeIntegerDimensions:_1,fetch:function(r,e){return yt().platform.fetch(r,e)},encodeString:KR,decodeString:zc}),eB=(function(){function r(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new nB)}return r.prototype.profileKernel=function(e,t,n){var a,i=this,s=this.backendTimer.time(function(){a=n()});return a.forEach(function(u){u.data().then(function(c){(function(f,h,d){if(h!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+d+"'"),!0}})(c,u.dtype,e),s.then(function(f){var h="";f.getExtraProfileInfo!=null&&(h=f.getExtraProfileInfo()),i.logger.logKernelProfile(e,u,c,f.kernelMs,t,h)})})}),a},r})(),nB=(function(){function r(){}return r.prototype.logKernelProfile=function(e,t,n,a,i,s){var u=ps(a+"ms",9),c=ps(e,25),f=t.rank,h=t.size,d=ps(t.shape.toString(),14),m="";for(var g in i){var y=i[g].shape,x=y.length;m+=g+": "+x+"D "+(x>0?y:"")+" "}console.log("%c"+c+"	%c"+u+"	%c"+f+"D "+d+"	%c"+h+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r})(),ZC=20,fc=3,Dy=7;function rB(r,e,t,n){var a=Co(e),i=(function(f,h,d,m){var g=Kt(h),y=m[m.length-1],x=new Array(y).fill(0),w=h.length,b=d==="complex64"?pc(f):f;if(w>1)for(var C=0;C<g/y;C++)for(var A=C*y,T=0;T<y;T++)x[T]=Math.max(x[T],hc(b[A+T],0,d).length);return x})(r,e,t,a),s=e.length,u=(function f(h,d,m,g,y,x){x===void 0&&(x=!0);var w=m==="complex64"?2:1,b=d[0],C=d.length;if(C===0){if(m==="complex64"){var A=pc(h);return[hc(A[0],0,m)]}return m==="bool"?[YR(h[0])]:[h[0].toString()]}if(C===1){if(b>ZC){var T=fc*w,R=Array.from(h.slice(0,T)),D=Array.from(h.slice(b-fc*w,b));return m==="complex64"&&(R=pc(R),D=pc(D)),["["+R.map(function(X,$){return hc(X,y[$],m)}).join(", ")+", ..., "+D.map(function(X,$){return hc(X,y[b-fc+$],m)}).join(", ")+"]"]}var N=m==="complex64"?pc(h):Array.from(h);return["["+N.map(function(X,$){return hc(X,y[$],m)}).join(", ")+"]"]}var O=d.slice(1),k=g.slice(1),z=g[0]*w,F=[];if(b>ZC){for(var B=0;B<fc;B++){var V=B*z,G=V+z;F.push.apply(F,f(h.slice(V,G),O,m,k,y,!1))}F.push("...");for(var B=b-fc;B<b;B++){var V=B*z,G=V+z;F.push.apply(F,f(h.slice(V,G),O,m,k,y,B===b-1))}}else for(var B=0;B<b;B++){var V=B*z,G=V+z;F.push.apply(F,f(h.slice(V,G),O,m,k,y,B===b-1))}var Q=C===2?",":"";F[0]="["+F[0]+Q;for(var B=1;B<F.length-1;B++)F[B]=" "+F[B]+Q;for(var L=`,
`,B=2;B<C;B++)L+=`
`;return F[F.length-1]=" "+F[F.length-1]+"]"+(x?"":L),F})(r,e,t,a,i),c=["Tensor"];return n&&(c.push("  dtype: "+t),c.push("  rank: "+s),c.push("  shape: ["+e+"]"),c.push("  values:")),c.push(u.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function hc(r,e,t){return ps(Array.isArray(r)?parseFloat(r[0].toFixed(Dy))+" + "+parseFloat(r[1].toFixed(Dy))+"j":fo(r)?"'"+r+"'":t==="bool"?YR(r):parseFloat(r.toFixed(Dy)).toString(),e)}function YR(r){return r===0?"false":"true"}function pc(r){for(var e=[],t=0;t<r.length;t+=2)e.push([r[t],r[t+1]]);return e}var bs=(function(){function r(e,t,n){var a=this;if(this.dtype=t,this.shape=e.slice(),this.size=Kt(e),n!=null){var i=n.length;K(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Mc(t,this.size),this.strides=Co(e)}return r.prototype.set=function(e){for(var t=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),K(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"});var i=this.locToIndex(n);this.values[i]=e},r.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var n=0,a=0,i=e;a<i.length;a++){var s=i[a];if(s<0||s>=this.shape[n]){var u="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(u)}n++}for(var c=e[e.length-1],f=0;f<e.length-1;++f)c+=this.strides[f]*e[f];return this.values[c]},r.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},r.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return Fa().makeTensor(this.values,this.shape,this.dtype)},r})(),Fa=null,wt=null,$R=null,Ee=(function(){function r(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Kt(e),this.strides=Co(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),K(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},r.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},r.prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),this.reshape([e,t,n,a])},r.prototype.as5D=function(e,t,n,a,i){return this.throwIfDisposed(),this.reshape([e,t,n,a,i])},r.prototype.asType=function(e){return this.throwIfDisposed(),wt.cast(this,e)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return Ht(this,void 0,void 0,function(){var e;return Gt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,wt.buffer(this.shape,this.dtype,e)]}})})},r.prototype.bufferSync=function(){return wt.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return Ht(this,void 0,void 0,function(){var e;return Gt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Sb(this.shape,e)]}})})},r.prototype.arraySync=function(){return Sb(this.shape,this.dataSync())},r.prototype.data=function(){return Ht(this,void 0,void 0,function(){var e,t;return Gt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=Fa().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(a){return zc(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var e=Fa().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(t){return zc(t)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},r.prototype.bytes=function(){return Ht(this,void 0,void 0,function(){var e;return Gt(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,Fa().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(Fa().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(e){return e===void 0&&(e=!1),wt.print(this,e)},r.prototype.reshape=function(e){return this.throwIfDisposed(),wt.reshape(this,e)},r.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},r.prototype.expandDims=function(e){return e===void 0&&(e=0),wt.expandDims(this,e)},r.prototype.cumsum=function(e,t,n){return e===void 0&&(e=0),t===void 0&&(t=!1),n===void 0&&(n=!1),wt.cumsum(this,e,t,n)},r.prototype.squeeze=function(e){return this.throwIfDisposed(),wt.squeeze(this,e)},r.prototype.clone=function(){return this.throwIfDisposed(),wt.clone(this)},r.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),wt.oneHot(this,e,t,n)},r.prototype.toString=function(e){return e===void 0&&(e=!1),rB(this.dataSync(),this.shape,this.dtype,e)},r.prototype.tile=function(e){return this.throwIfDisposed(),wt.tile(this,e)},r.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),wt.gather(this,e,t)},r.prototype.matMul=function(e,t,n){return t===void 0&&(t=!1),n===void 0&&(n=!1),this.throwIfDisposed(),wt.matMul(this,e,t,n)},r.prototype.dot=function(e){return this.throwIfDisposed(),wt.dot(this,e)},r.prototype.norm=function(e,t,n){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),wt.norm(this,e,t,n)},r.prototype.slice=function(e,t){return this.throwIfDisposed(),wt.slice(this,e,t)},r.prototype.reverse=function(e){return this.throwIfDisposed(),wt.reverse(this,e)},r.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof r&&(e=[e]),wt.concat([this].concat(e),t)},r.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),wt.split(this,e,t)},r.prototype.stack=function(e,t){return t===void 0&&(t=0),wt.stack([this,e],t)},r.prototype.unstack=function(e){return e===void 0&&(e=0),wt.unstack(this,e)},r.prototype.pad=function(e,t){return t===void 0&&(t=0),wt.pad(this,e,t)},r.prototype.batchNormalization=function(e,t,n,a,i){return n===void 0&&(n=.001),$R("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,i,a,n)},r.prototype.batchNorm=function(e,t,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),wt.batchNorm(this,e,t,n,a,i)},r.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.all(this,e,t)},r.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.any(this,e,t)},r.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.logSumExp(this,e,t)},r.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.sum(this,e,t)},r.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.prod(this,e,t)},r.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.mean(this,e,t)},r.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.min(this,e,t)},r.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),wt.max(this,e,t)},r.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),wt.argMin(this,e)},r.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),wt.argMax(this,e)},r.prototype.cast=function(e){return this.throwIfDisposed(),wt.cast(this,e)},r.prototype.add=function(e){return this.throwIfDisposed(),wt.add(this,e)},r.prototype.addStrict=function(e){return this.throwIfDisposed(),wt.addStrict(this,e)},r.prototype.atan2=function(e){return this.throwIfDisposed(),wt.atan2(this,e)},r.prototype.sub=function(e){return this.throwIfDisposed(),wt.sub(this,e)},r.prototype.subStrict=function(e){return this.throwIfDisposed(),wt.subStrict(this,e)},r.prototype.pow=function(e){return this.throwIfDisposed(),wt.pow(this,e)},r.prototype.powStrict=function(e){return this.throwIfDisposed(),wt.powStrict(this,e)},r.prototype.mul=function(e){return this.throwIfDisposed(),wt.mul(this,e)},r.prototype.mulStrict=function(e){return this.throwIfDisposed(),wt.mulStrict(this,e)},r.prototype.div=function(e){return this.throwIfDisposed(),wt.div(this,e)},r.prototype.floorDiv=function(e){return this.throwIfDisposed(),wt.floorDiv(this,e)},r.prototype.divStrict=function(e){return this.throwIfDisposed(),wt.divStrict(this,e)},r.prototype.minimum=function(e){return this.throwIfDisposed(),wt.minimum(this,e)},r.prototype.minimumStrict=function(e){return this.throwIfDisposed(),wt.minimumStrict(this,e)},r.prototype.maximum=function(e){return this.throwIfDisposed(),wt.maximum(this,e)},r.prototype.maximumStrict=function(e){return this.throwIfDisposed(),wt.maximumStrict(this,e)},r.prototype.mod=function(e){return this.throwIfDisposed(),wt.mod(this,e)},r.prototype.modStrict=function(e){return this.throwIfDisposed(),wt.modStrict(this,e)},r.prototype.squaredDifference=function(e){return this.throwIfDisposed(),wt.squaredDifference(this,e)},r.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),wt.squaredDifferenceStrict(this,e)},r.prototype.transpose=function(e){return this.throwIfDisposed(),wt.transpose(this,e)},r.prototype.notEqual=function(e){return this.throwIfDisposed(),wt.notEqual(this,e)},r.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),wt.notEqualStrict(this,e)},r.prototype.less=function(e){return this.throwIfDisposed(),wt.less(this,e)},r.prototype.lessStrict=function(e){return this.throwIfDisposed(),wt.lessStrict(this,e)},r.prototype.equal=function(e){return this.throwIfDisposed(),wt.equal(this,e)},r.prototype.equalStrict=function(e){return this.throwIfDisposed(),wt.equalStrict(this,e)},r.prototype.lessEqual=function(e){return this.throwIfDisposed(),wt.lessEqual(this,e)},r.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),wt.lessEqualStrict(this,e)},r.prototype.greater=function(e){return this.throwIfDisposed(),wt.greater(this,e)},r.prototype.greaterStrict=function(e){return this.throwIfDisposed(),wt.greaterStrict(this,e)},r.prototype.greaterEqual=function(e){return this.throwIfDisposed(),wt.greaterEqual(this,e)},r.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),wt.greaterEqualStrict(this,e)},r.prototype.logicalAnd=function(e){return this.throwIfDisposed(),wt.logicalAnd(this,e)},r.prototype.logicalOr=function(e){return this.throwIfDisposed(),wt.logicalOr(this,e)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),wt.logicalNot(this)},r.prototype.logicalXor=function(e){return this.throwIfDisposed(),wt.logicalXor(this,e)},r.prototype.where=function(e,t){return this.throwIfDisposed(),wt.where(e,this,t)},r.prototype.neg=function(){return this.throwIfDisposed(),wt.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),wt.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),wt.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),wt.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),wt.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),wt.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),wt.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),wt.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),wt.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),wt.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),wt.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),wt.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),wt.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),wt.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),wt.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),wt.abs(this)},r.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),wt.clipByValue(this,e,t)},r.prototype.relu=function(){return this.throwIfDisposed(),wt.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),wt.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),wt.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),wt.selu(this)},r.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),wt.leakyRelu(this,e)},r.prototype.prelu=function(e){return this.throwIfDisposed(),wt.prelu(this,e)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),wt.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),wt.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),wt.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),wt.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),wt.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),wt.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),wt.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),wt.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),wt.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),wt.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),wt.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),wt.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),wt.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),wt.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),wt.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),wt.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),wt.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),wt.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),wt.round(this)},r.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),wt.step(this,e)},r.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),wt.softmax(this,e)},r.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),wt.logSoftmax(this,e)},r.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),wt.image.resizeBilinear(this,e,t)},r.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),wt.image.resizeNearestNeighbor(this,e,t)},r.prototype.conv1d=function(e,t,n,a,i,s){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),wt.conv1d(this,e,t,n,a,i,s)},r.prototype.conv2d=function(e,t,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),wt.conv2d(this,e,t,n,a,i,s)},r.prototype.conv2dTranspose=function(e,t,n,a,i){return this.throwIfDisposed(),wt.conv2dTranspose(this,e,t,n,a,i)},r.prototype.depthwiseConv2D=function(e,t,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),wt.depthwiseConv2d(this,e,t,n,a,i,s)},r.prototype.separableConv2d=function(e,t,n,a,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),wt.separableConv2d(this,e,t,n,a,i,s)},r.prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),wt.avgPool(this,e,t,n,a)},r.prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),wt.maxPool(this,e,t,n,a)},r.prototype.localResponseNormalization=function(e,t,n,a){return e===void 0&&(e=5),t===void 0&&(t=1),n===void 0&&(n=1),a===void 0&&(a=.5),wt.localResponseNormalization(this,e,t,n,a)},r.prototype.pool=function(e,t,n,a,i){return this.throwIfDisposed(),wt.pool(this,e,t,n,a,i)},r.prototype.variable=function(e,t,n){return e===void 0&&(e=!0),this.throwIfDisposed(),Fa().makeVariable(this,e,t,n)},r.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),wt.unsortedSegmentSum(this,e,t)},r.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),wt.batchToSpaceND(this,e,t)},r.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),wt.spaceToBatchND(this,e,t)},r.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),wt.topk(this,e,t)},r.prototype.stridedSlice=function(e,t,n,a,i,s,u,c){return a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0),c===void 0&&(c=0),this.throwIfDisposed(),wt.stridedSlice(this,e,t,n,a,i,s,u,c)},r.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),wt.depthToSpace(this,e,t)},r.prototype.fft=function(){return this.throwIfDisposed(),wt.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),wt.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),wt.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),wt.spectral.irfft(this)},r})();Object.defineProperty(Ee,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var od,Eb,Cb,Ab,Nb,Gu=(function(r){function e(t,n,a,i){var s=r.call(this,t.shape,t.dtype,t.dataId,i)||this;return s.trainable=n,s.name=a,s}return ba(e,r),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!Pn(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");Fa().disposeTensor(this),this.dataId=t.dataId,Fa().incRef(this,null)},e.prototype.dispose=function(){Fa().disposeVariable(this),this.isDisposedInternal=!0},e})(Ee);Object.defineProperty(Gu,Symbol.hasInstance,{value:function(r){return r instanceof Ee&&r.assign!=null&&r.assign instanceof Function}}),(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(od||(od={})),(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(Eb||(Eb={})),(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(Cb||(Cb={})),(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Ab||(Ab={})),(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(Nb||(Nb={}));var aB={float32:Ab,int32:Eb,bool:Cb,complex64:Nb};function _n(r,e){if(r==="string"||e==="string"){if(r==="string"&&e==="string")return"string";throw new Error("Can not upcast "+r+" with "+e)}return aB[r][e]}function Iy(r){return _n(r,"int32")}function vn(r,e){if(r.dtype===e.dtype)return[r,e];var t=_n(r.dtype,e.dtype);return[r.cast(t),e.cast(t)]}function QR(r,e){K(r.dtype===e.dtype,function(){return"The dtypes of the first("+r.dtype+") and second("+e.dtype+") input must match"})}function O1(r){var e=[];return(function t(n,a,i){if(n!=null){if(n instanceof Ee)return void a.push(n);if(s=n,!(!Array.isArray(s)&&typeof s!="object")){var s,u=n;for(var c in u){var f=u[c];i.has(f)||(i.add(f),t(f,a,i))}}}})(r,e,new Set),e}var ky,pa=Object.freeze({makeTypesMatch:vn,assertTypesMatch:QR,isTensorInList:function(r,e){for(var t=0;t<e.length;t++)if(e[t].id===r.id)return!0;return!1},getTensorsInContainer:O1}),JC=(function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},r})(),iB=(function(){function r(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new JC}return r.prototype.ready=function(){return Ht(this,void 0,void 0,function(){var e,t,n;return Gt(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,a.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},r.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},r.prototype.registerBackend=function(e,t,n){return n===void 0&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},r.prototype.setBackend=function(e){return Ht(this,void 0,void 0,function(){var t,n,a;return Gt(this,function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new eB(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var e=this;ed(this.backendName).forEach(function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)})},r.prototype.disposeRegisteredKernels=function(e){var t=this;ed(e).forEach(function(n){n.disposeFunc!=null&&n.disposeFunc(t.registry[e])})},r.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(n==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,s=a.then(function(u){return!(i<t.pendingBackendInitId)&&(t.registry[e]=u,t.pendingBackendInit=null,!0)}).catch(function(u){return!(i<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(u.stack||u.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[e]=a,{success:!0,asyncInit:!1}}catch(u){return console.warn("Initialization of backend "+e+" failed"),console.warn(u.stack||u.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],a=this.initializeBackend(n),i=a.success,s=a.asyncInit;if(s||i)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),a=n.backend,i=this.readSync(t);a.disposeData(t),n.backend=e,e.move(t,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(e,t){var n,a=this,i=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(n)},function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},r.prototype.scopedRun=function(e,t,n){e();try{var a=n();return t(),a}catch(i){throw t(),i}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],function(a){return{x:function(){return a.toFloat()}}},[]),t},r.prototype.runKernel=function(e,t,n,a,i){return this.runKernelFunc(null,t,null,e,n,a,i)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(e,t,n){var a=this.backend.numDataIds(),i=0;n.forEach(function(c){i+=c.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],u=a-t-i-s;if(u>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+u+" data ids) after running '"+e+"'")},r.prototype.runKernelFunc=function(e,t,n,a,i,s,u){var c,f=this;s===void 0&&(s=[]),u===void 0&&(u=[]);var h,d=[],m=this.isTapeOn(),g=this.state.activeScope!=null?this.state.activeScope.name:"",y=function(A){m&&(d=A.map(function(T){return f.keep(f.clone(T))}))},x=this.state.numBytes,w=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var b,C=E1(a,this.backendName);return h=C!=null?function(){var A=f.backend.numDataIds();b=C.kernelFunc({inputs:t,attrs:i,backend:f.backend});var T=Array.isArray(b)?b:[b];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(g,A,T);var R=T.map(function(N){var O=N.dataId,k=N.shape,z=N.dtype;return f.makeTensorFromDataId(O,k,z)}),D=R.filter(function(N,O){return u[O]});return y(s.slice().concat(D)),R}:function(){var A=f.backend.numDataIds();b=f.tidy(function(){return e(f.backend,y)});var T=Array.isArray(b)?b:[b];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(g,A,T),T},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(g,t,function(){return h()}):h()}),m&&this.addTapeNode(g,t,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:g,bytesAdded:this.state.numBytes-x,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-w,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(A){return t[A].shape}),outputShapes:c.map(function(A){return A.shape})}),Array.isArray(b)?c:c[0]},r.prototype.makeTensor=function(e,t,n,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=e;n==="string"&&fo(e[0])&&(i=e.map(function(h){return KR(h)}));var s=a.write(i,t,n),u=new Ee(t,n,s,this.nextTensorId());if(this.incRef(u,a),n==="string"){var c=this.state.tensorInfo.get(s),f=HR(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return u},r.prototype.makeTensorFromDataId=function(e,t,n,a){var i=new Ee(t,n=n||"float32",e,this.nextTensorId());return this.incRef(i,a),i},r.prototype.makeVariable=function(e,t,n,a){t===void 0&&(t=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.asType(a));var i=new Gu(e,t,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},r.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(a=e.size*N1(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Gu||this.track(e)},r.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},r.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},r.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},r.prototype.profile=function(e){return Ht(this,void 0,void 0,function(){var t,n;return Gt(this,function(a){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(e,t,n,a,i){var s=this,u={id:this.state.nextTapeNodeId++,name:e,inputs:t,outputs:n,saved:i};a!=null&&(u.gradient=function(c){return c=c.map(function(f,h){if(f==null){var d=n[h],m=al(d.size,d.dtype);return s.makeTensor(m,d.shape,d.dtype)}return f}),a(c.length>1?c:c[0],i)}),this.state.activeTape.push(u)},r.prototype.keep=function(e){return e.kept=!0,e},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},r.prototype.endScope=function(e){for(var t=this,n=O1(e),a=new Set(n.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||a.has(s.id)||s.dispose()}var u=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(c){c.kept||c.scopeId!==u.id||t.track(c)})},r.prototype.gradients=function(e,t,n,a){var i=this;if(a===void 0&&(a=!1),K(t.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});K(s instanceof Ee,function(){return"The result y returned by f() must be a tensor."});var u=(function(c,f,h){for(var d={},m={},g=0;g<f.length;g++)d[f[g].id]=!0;for(g=0;g<c.length;g++){var y=(D=c[g]).inputs;for(var x in y){for(var w=y[x],b=!1,C=0;C<f.length;C++)if(d[w.id]){D.outputs.forEach(function(z){return d[z.id]=!0}),b=!0,m[D.id]=!0;break}if(b)break}}var A={};A[h.id]=!0;var T={};for(g=c.length-1;g>=0;g--)for(y=(D=c[g]).inputs,C=0;C<D.outputs.length;C++)if(A[D.outputs[C].id]){for(var x in y)A[y[x].id]=!0,T[D.id]=!0;break}var R=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&T[D.id]){var N={};for(var x in D.inputs){var O=D.inputs[x];d[O.id]&&(N[x]=O)}var k=Object.assign({},D);k.inputs=N,k.outputs=D.outputs,R.push(k)}}return R})(this.state.activeTape,t,s);if(!a&&u.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,h={};h[s.id]=n??(c=s.shape,f=R1(Kt(c),"float32"),at.makeTensor(f,c,"float32")),(function(m,g,y){for(var x=function(b){var C=g[b],A=[];if(C.outputs.forEach(function(N){var O=m[N.id];O!=null?A.push(O):A.push(null)}),C.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+C.name+".");var T=C.gradient(A),R=function(N){if(!(N in T))throw new Error("Cannot backprop through input "+N+". Available gradients found: "+Object.keys(T)+".");var O=y(function(){return T[N]()});if(O.dtype!=="float32")throw new Error("Error in gradient for op "+C.name+". The gradient of input "+N+" must have 'float32' dtype, but has '"+O.dtype+"'");var k=C.inputs[N];if(!Pn(O.shape,k.shape))throw new Error("Error in gradient for op "+C.name+". The gradient of input '"+N+"' has shape '"+O.shape+"', which does not match the shape of the input '"+k.shape+"'");if(m[k.id]==null)m[k.id]=O;else{var z=m[k.id];m[k.id]=z.add(O),z.dispose()}};for(var D in C.inputs)R(D)},w=g.length-1;w>=0;w--)x(w)})(h,u,function(m){return i.tidy(m)});var d=t.map(function(m){return h[m.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(m){for(var g in m.saved)m.saved[g].dispose()}),i.state.activeTape=null),{value:s,grads:d}})},r.prototype.customGrad=function(e){var t=this;return K(xo(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];K(a.every(function(u){return u instanceof Ee}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return a.forEach(function(u,c){s[c]=u}),t.runKernelFunc(function(u,c){return K((n=e.apply(void 0,a.concat([c]))).value instanceof Ee,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),K(xo(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},s,function(u,c){var f=n.gradFunc(u,c),h=Array.isArray(f)?f:[f];K(h.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),K(h.every(function(m){return m instanceof Ee}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return h.forEach(function(m,g){d[g]=function(){return m}}),d})}},r.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},r.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},r.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},r.prototype.time=function(e){return Ht(this,void 0,void 0,function(){var t,n;return Gt(this,function(a){switch(a.label){case 0:return t=la(),[4,this.backend.time(e)];case 1:return(n=a.sent()).wallMs=la()-t,[2,n]}})})},r.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new JC,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r})(),at=(function(){var r=(function(){if(ky==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof qC<"u")t=qC;else if(typeof Rn<"u")t=Rn;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}ky=t}return ky})();if(r._tfengine==null){var e=new S1(r);r._tfengine=new iB(e)}return(function(t){Od=t})(r._tfengine.ENV),Fa=function(){return r._tfengine},r._tfengine})();function ZR(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var hi=yt();hi.registerFlag("DEBUG",function(){return!1},function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),hi.registerFlag("IS_BROWSER",function(){return ZR()}),hi.registerFlag("IS_NODE",function(){return typeof Rn<"u"&&Rn.versions!==void 0&&Rn.versions.node!==void 0}),hi.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),hi.registerFlag("PROD",function(){return!1}),hi.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return hi.getBool("DEBUG")}),hi.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),hi.registerFlag("IS_TEST",function(){return!1});var Fc,Mr,kr,rs={},My={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function JR(r,e){rs[r]=e}function Ha(r){r in rs||(rs[r]=(function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=t_(t);return n.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete rs[t]},!1),t===1?n.getContext("webgl",My)||n.getContext("experimental-webgl",My):n.getContext("webgl2",My)})(r));var e=rs[r];return e.isContextLost()?(delete rs[r],Ha(r)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),rs[r])}function t_(r){if(typeof OffscreenCanvas<"u"&&r===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Dd(r,e){return[e,r]}function Nc(r){var e=Kt(r);return ad(Math.ceil(e/4))}function Zc(r,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(r/2))]}function D1(r,e){var t,n,a,i,s,u,c,f,h,d=r;return yt().getNumber("WEBGL_VERSION")===2?(t=d.R32F,n=d.R16F,a=d.RGBA16F,i=d.RGBA32F,s=d.RED,u=4,c=1,f=d.HALF_FLOAT,h=d.FLOAT):(t=r.RGBA,n=r.RGBA,a=r.RGBA,i=d.RGBA,s=r.RGBA,u=4,c=4,f=e!=null?e.HALF_FLOAT_OES:null,h=r.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}function Vt(r,e,t){var n=t();return e&&(function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+n_(a,i))})(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Fc||(Fc={})),(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Mr||(Mr={})),(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(kr||(kr={}));var oB=596e-10,sB=65504;function e_(r){return!!(yt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||oB<Math.abs(r)&&Math.abs(r)<sB)}function n_(r,e){switch(e){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Op(r,e,t){return Ii(r,e,function(){return r.getExtension(t)},'Extension "'+t+'" not supported on this browser.')}function r_(r,e,t){var n=Ii(r,e,function(){return r.createShader(r.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Vt(r,e,function(){return r.shaderSource(n,t)}),Vt(r,e,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function a_(r,e,t){var n=Ii(r,e,function(){return r.createShader(r.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Vt(r,e,function(){return r.shaderSource(n,t)}),Vt(r,e,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw(function(a,i){var s=uB.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var u=+s[1],c=a.split(`
`),f=c.length.toString().length+2,h=c.map(function(w,b){return ps((b+1).toString(),f)+w}),d=0,m=0;m<h.length;m++)d=Math.max(h[m].length,d);var g=h.slice(0,u-1),y=h.slice(u-1,u),x=h.slice(u);console.log(g.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+ps(y[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(x.join(`
`))})(t,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Dp,Ip,uB=/ERROR: [0-9]+:([0-9]+):/g;function i_(r,e){return Ii(r,e,function(){return r.createProgram()},"Unable to create WebGLProgram.")}function o_(r,e,t){if(Vt(r,e,function(){return r.linkProgram(t)}),r.getProgramParameter(t,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function kp(r,e,t){if(Vt(r,e,function(){return r.validateProgram(t)}),r.getProgramParameter(t,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function s_(r,e,t){var n=Ii(r,e,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return Vt(r,e,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),Vt(r,e,function(){return r.bufferData(r.ARRAY_BUFFER,t,r.STATIC_DRAW)}),n}function u_(r,e,t){var n=Ii(r,e,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return Vt(r,e,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)}),Vt(r,e,function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW)}),n}function l_(r,e){return Ii(r,e,function(){return r.createTexture()},"Unable to create WebGLTexture.")}function c_(r,e){var t=yt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||e<=0){var n="["+r+"x"+e+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>t||e>t)throw n="["+r+"x"+e+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function f_(r,e){return Ii(r,e,function(){return r.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Tb(r,e,t,n,a,i,s,u){var c=r.getAttribLocation(t,n);return c!==-1&&(Vt(r,e,function(){return r.bindBuffer(r.ARRAY_BUFFER,a)}),Vt(r,e,function(){return r.vertexAttribPointer(c,i,r.FLOAT,!1,s,u)}),Vt(r,e,function(){return r.enableVertexAttribArray(c)}),!0)}function h_(r,e,t,n){g_(r,n),Vt(r,e,function(){return r.activeTexture(r.TEXTURE0+n)}),Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,t)})}function p_(r,e,t,n){return Ii(r,e,function(){return r.getUniformLocation(t,n)},'uniform "'+n+'" not present in program.')}function d_(r,e,t){return r.getUniformLocation(e,t)}function m_(r,e,t,n,a,i){Vt(r,e,function(){return h_(r,e,n,i)}),Vt(r,e,function(){return r.uniform1i(a,i)})}function Mp(r,e,t,n){Vt(r,e,function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)}),Vt(r,e,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)})}function Rb(r,e,t){Vt(r,e,function(){return r.bindFramebuffer(r.FRAMEBUFFER,t)}),Vt(r,e,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)})}function xc(r){var e=r.checkFramebufferStatus(r.FRAMEBUFFER);if(e!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+v_(r,e))}function v_(r,e){switch(e){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Ii(r,e,t,n){var a=Vt(r,e,function(){return t()});if(a==null)throw new Error(n);return a}function g_(r,e){var t=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+r.TEXTURE0;if(n<r.TEXTURE0||n>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function Bc(r,e){return e===void 0&&(e=2),Kt(r.slice(0,r.length-e))}function Lc(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function zp(r){var e=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(e=[Bc(r)].concat(Lc(r))),e}function y_(r,e){var t;e===void 0&&(e=!1);var n=yt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,(r=r.map(function(f,h){return h>=r.length-2?A1(r[h]):r[h]})).length===1&&(r=[2,r[0]])),r.length!==2){var a=co(r);r=a.newShape}var i=Kt(r);if(r.length<=1&&i<=n)return[1,i];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(e){var s=Bc(r),u=2,c=2;return r.length&&(u=(t=Lc(r))[0],c=t[1]),ad(i=s*(u/2)*(c/2)).map(function(f){return 2*f})}return ad(i)}function lp(r){return r%2==0}function wc(r,e){if(Pn(r=r.slice(-2),e=e.slice(-2))||!r.length||!e.length||r[0]===0||r[1]===0||e[0]===0||e[1]===0)return!0;if(r.length!==e.length){var t=r.slice(-1)[0],n=e.slice(-1)[0];if(t===n||lp(t)&&lp(n)&&(r[0]===1||e[0]===1))return!0}return r[1]===e[1]&&lp(r[0])&&lp(e[0])}function b_(r){if(Dp==null){var e=Ha(r);Dp=e.getParameter(e.MAX_TEXTURE_SIZE)}return Dp}function x_(r){if(Ip==null){var e=Ha(r);Ip=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ip)}function w_(r){if(r===0)return 0;var e=Ha(r);return ca(e,"EXT_disjoint_timer_query_webgl2")&&r===2?2:ca(e,"EXT_disjoint_timer_query")?1:0}function ca(r,e){return r.getExtension(e)!=null}function _b(r){try{if(Ha(r)!=null)return!0}catch{return!1}return!1}function S_(r){if(r===0)return!1;var e=Ha(r);if(r===1){if(!ca(e,"OES_texture_float"))return!1}else if(!ca(e,"EXT_color_buffer_float"))return!1;return Ob(e)}function E_(r){if(r===0)return!1;var e=Ha(r);if(r!==1){if(ca(e,"EXT_color_buffer_float"))return Ob(e);if(ca(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return(function(n,a){var i=D1(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var u=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,u),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);var c=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(u),c})(e,t)}return!1}return!!ca(e,"OES_texture_float")&&!!ca(e,"WEBGL_color_buffer_float")&&Ob(e)}function Ob(r){var e=D1(r),t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(t),r.deleteFramebuffer(n),a}function C_(r){return r===2&&Ha(r).fenceSync!=null}var lB=Object.freeze({callAndCheck:Vt,canBeRepresented:e_,getWebGLErrorMessage:n_,getExtensionOrThrow:Op,createVertexShader:r_,createFragmentShader:a_,createProgram:i_,linkProgram:o_,validateProgram:kp,createStaticVertexBuffer:s_,createStaticIndexBuffer:u_,getNumChannels:function(){return yt().getNumber("WEBGL_VERSION")===2?1:4},createTexture:l_,validateTextureSize:c_,createFramebuffer:f_,bindVertexBufferToProgramAttribute:Tb,bindTextureUnit:h_,unbindTextureUnit:function(r,e,t){g_(r,t),Vt(r,e,function(){return r.activeTexture(r.TEXTURE0+t)}),Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:p_,getProgramUniformLocation:d_,bindTextureToProgramUniformSampler:m_,bindCanvasToFramebuffer:function(r,e){Vt(r,e,function(){return r.bindFramebuffer(r.FRAMEBUFFER,null)}),Vt(r,e,function(){return r.viewport(0,0,r.canvas.width,r.canvas.height)}),Vt(r,e,function(){return r.scissor(0,0,r.canvas.width,r.canvas.height)})},bindColorTextureToFramebuffer:Mp,unbindColorTextureFromFramebuffer:Rb,validateFramebuffer:xc,getFramebufferErrorMessage:v_,getBatchDim:Bc,getRowsCols:Lc,getShapeAs3D:zp,getTextureShapeFromLogicalShape:y_,isReshapeFree:wc,getWebGLMaxTextureSize:b_,resetMaxTextureSize:function(){Dp=null},resetMaxTexturesInShader:function(){Ip=null},getMaxTexturesInShader:x_,getWebGLDisjointQueryTimerVersion:w_,hasExtension:ca,isWebGLVersionEnabled:_b,isCapableOfRenderingToFloatTexture:S_,isDownloadFloatTextureEnabled:E_,isWebGLFenceEnabled:C_}),ee=yt();function A_(){yt().set("PROD",!0)}function N_(){yt().set("DEBUG",!0)}function T_(){yt().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Jc(r){yt().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function R_(){at.disposeVariables()}function __(){return at}function sd(){return at.memory()}function O_(r){return at.profile(r)}function ft(r,e){return at.tidy(r,e)}function re(r){O1(r).forEach(function(e){return e.dispose()})}function ma(r){return at.keep(r)}function D_(r){return at.time(r)}function I_(r){return at.setBackend(r)}function k_(){return at.ready()}function M_(){return at.backendName}function z_(r){at.removeBackend(r)}function F_(r){return at.findBackend(r)}function B_(r){return at.findBackendFactory(r)}function L_(r,e,t){return t===void 0&&(t=1),at.registerBackend(r,e,t)}function tf(){return at.backend}function U_(r,e){yt().setPlatform(r,e)}function Db(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];yt().getBool("IS_TEST")||console.warn.apply(console,r)}function Pa(r,e){var t=r;if($n(r))return e==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(t)||$n(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(r)&&yt().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function a(i,s,u){if(u=u||[],!Array.isArray(i)&&!$n(i))return void K(s.length===0,function(){return"Element arr["+u.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});K(s.length>0,function(){return"Element arr["+u.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),K(i.length===s[0],function(){return"Element arr["+u.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var c=s.slice(1),f=0;f<i.length;++f)a(i[f],c,u.concat(f))})(r,n,[]),n}function tA(r,e,t,n){if(r!=null&&(r!=="numeric"&&r!==e||r==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+n+"' must be "+r+" tensor, but got "+e+" tensor")}function H(r,e,t,n){if(n===void 0&&(n="numeric"),r instanceof Ee)return tA(n,r.dtype,e,t),r;var a=rl(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),tA(n,a,e,t),r==null||!$n(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var i=r==null?"null":r.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=Pa(r,a);$n(r)||Array.isArray(r)||(r=[r]);var u=a!=="string"?T1(r,a,yt().getBool("DEBUG")):Ci(r,[],!0);return at.makeTensor(u,s,a)}function Uc(r,e,t,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return r.map(function(a,i){return H(a,e+"["+i+"]",t)},n)}function I1(r,e){for(var t=0;t<r.length;++t)if(r[r.length-t-1]!==e-1-t)return!1;return!0}function j_(r,e,t){for(var n=r.length+e.length,a=[],i=0,s=0,u=0;u<n;u++)t.indexOf(u)===-1?a.push(r[i++]):a.push(e[s++]);return a}function Yn(r,e){for(var t=[],n=r.length,a=0;a<n;a++)e.indexOf(a)===-1&&t.push(r[a]);return[t,e.map(function(i){return r[i]})]}function Br(r,e){return j_(r,e.map(function(t){return 1}),e)}function wr(r,e,t){K(I1(e,t),function(){return r+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."})}function xa(r,e){if(I1(r,e))return null;for(var t=[],n=0;n<e;++n)r.indexOf(n)===-1&&t.push(n);return r.forEach(function(a){return t.push(a)}),t}function Id(r){return r.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function wa(r,e){for(var t=[],n=e-r;n<e;++n)t.push(n);return t}function P_(r,e){var t=r[0].length;r.forEach(function(a,i){K(a.length===t,function(){return"Error in concat"+t+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+t+")"})}),K(e>=0&&e<t,function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."});var n=r[0];r.forEach(function(a,i){for(var s=0;s<t;s++)K(s===e||a[s]===n[s],function(){return"Error in concat"+t+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."})})}function xs(r,e){for(var t=r[0].slice(),n=1;n<r.length;n++)t[e]+=r[n][e];return t}function rt(r){var e=Object.keys(r);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],n=r[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var a=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];at.startScope(t);try{var u=n.apply(void 0,i);return u instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),at.endScope(u),u}catch(c){throw at.endScope(null),c}};return Object.defineProperty(a,"name",{value:t,configurable:!0}),a}ee.registerFlag("HAS_WEBGL",function(){return ee.getNumber("WEBGL_VERSION")>0}),ee.registerFlag("WEBGL_VERSION",function(){return _b(2)?2:_b(1)?1:0}),ee.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return ee.get("WEBGL_VERSION")===2}),ee.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),ee.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),ee.registerFlag("WEBGL_PACK",function(){return ee.getBool("HAS_WEBGL")}),ee.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_CLIP",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),ee.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_PACK_REDUCE",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_LAZILY_UNPACK",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_CONV_IM2COL",function(){return ee.getBool("WEBGL_PACK")}),ee.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return b_(ee.getNumber("WEBGL_VERSION"))}),ee.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return x_(ee.getNumber("WEBGL_VERSION"))}),ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var r=ee.getNumber("WEBGL_VERSION");return r===0?0:w_(r)}),ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return ee.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r}),ee.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return S_(ee.getNumber("WEBGL_VERSION"))}),ee.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!ee.getBool("WEBGL_FORCE_F16_TEXTURES")&&ee.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),ee.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return E_(ee.getNumber("WEBGL_VERSION"))}),ee.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return C_(ee.getNumber("WEBGL_VERSION"))}),ee.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return ee.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),$R=Jc;var Tn=rt({complex_:function(r,e){var t=H(r,"real","complex"),n=H(e,"imag","complex");return Ce(t.shape,n.shape,"real and imag shapes, "+t.shape+" and "+n.shape+", must match in call to tf.complex()."),at.runKernelFunc(function(a){return a.complex(t,n)},{$real:t,$imag:n})}}),sr=rt({real_:function(r){var e=H(r,"input","real");return at.runKernelFunc(function(t){return t.real(e)},{$input:e})}}),zr=rt({imag_:function(r){var e=H(r,"input","imag");return at.runKernelFunc(function(t){return t.imag(e)},{$input:e})}});function sn(r,e,t){return Ao(r,e,Pa(r,t),t)}function Ao(r,e,t,n){if(n==null&&(n=rl(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!$n(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){_1(e);var a=Kt(e),i=Kt(t);K(a===i,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+a+" values but has "+i});for(var s=0;s<t.length;++s){var u=t[s],c=s!==t.length-1||u!==Kt(e.slice(s));K(t[s]===e[s]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "})}}return $n(r)||Array.isArray(r)||(r=[r]),e=e||t,r=n!=="string"?T1(r,n,yt().getBool("DEBUG")):Ci(r,[],!0),at.makeTensor(r,e,n)}function jt(r,e){if(($n(r)&&e!=="string"||Array.isArray(r))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&$n(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ao(r,[],[],e)}function zn(r,e){Ds(r);var t=Pa(r,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ao(r,null,t,e)}function ta(r,e,t){if(Ds(r),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=Pa(r,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ao(r,e,n,t)}function ds(r,e,t){if(Ds(r),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=Pa(r,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ao(r,e,n,t)}function ka(r,e,t){if(Ds(r),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=Pa(r,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ao(r,e,n,t)}function k1(r,e,t){if(Ds(r),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=Pa(r,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ao(r,e,n,t)}function M1(r,e,t){if(Ds(r),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=Pa(r,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ao(r,e=e||n,n,t)}function kd(r,e,t,n){return e===void 0&&(e=!0),at.makeVariable(r,e,t,n)}function Sa(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Sa(r,"float32"),n=Ie(r,"float32");return Tn(t,n)}var a=R1(Kt(r),e);return at.makeTensor(a,r,e)}function Ie(r,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Ie(r,"float32"),n=Ie(r,"float32");return Tn(t,n)}var a=al(Kt(r),e);return at.makeTensor(a,r,e)}function Is(r,e,t){return at.runKernelFunc(function(n){return n.fill(r,e,t)},{})}function Md(r,e,t){if(t<=0)throw new Error("The number of values should be positive.");return at.runKernelFunc(function(n){return n.linspace(r,e,t)},{})}function ef(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t===0)throw new Error("Cannot have a step of zero");if(r===e||r<e&&t<0||e<r&&t>1)return Ie([0],n);var a=al(Math.abs(Math.ceil((e-r)/t)),n);e<r&&t===1&&(t=-1),a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+t;return zn(a,n)}var Er=rt({onesLike_:function(r){var e=H(r,"x","onesLike");if(e.dtype==="complex64"){var t=Er(sr(e)),n=ye(zr(e));return Tn(t,n)}return at.runKernelFunc(function(a){return a.onesLike(e)},{$x:e},function(a,i){return{$x:function(){return ye(a)}}})}}),ye=rt({zerosLike_:function(r){var e=H(r,"x","zerosLike");return at.runKernelFunc(function(t){return t.zerosLike(e)},{$x:e},function(t,n){return{$x:function(){return ye(t)}}})}}),Vn=rt({concat_:function(r,e){e===void 0&&(e=0),K(r.length>=1,function(){return"Pass at least one tensor to concat"});var t=Uc(r,"tensors","concat");t[0].dtype==="complex64"&&t.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),e=qn(e,t[0].shape)[0];var n=xs(t.map(function(s){return s.shape}),e);if(Kt(n)===0)return sn([],n);if((t=t.filter(function(s){return s.size>0})).length===1)return t[0];var a=t.map(function(s){return s.shape});P_(a,e);var i=t;return at.runKernelFunc(function(s){return s.concat(t,e)},i,function(s){var u=a.map(function(c){return c[e]});return La(s,u,e).map(function(c){return function(){return c}})})}}),zd=rt({concat1d_:function(r){return Vn(r,0)}}),Fd=rt({concat2d_:function(r,e){return Vn(r,e)}}),Bd=rt({concat3d_:function(r,e){return Vn(r,e)}}),Ld=rt({concat4d_:function(r,e){return Vn(r,e)}}),La=rt({split_:function(r,e,t){t===void 0&&(t=0);var n,a=H(r,"x","split");return t=qn(t,a.shape)[0],typeof e=="number"?(K(a.shape[t]%e==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(e).fill(a.shape[t]/e)):(K(a.shape[t]===e.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=e),at.runKernelFunc(function(i){return i.split(a,n,t)},{$x:a},function(i){return{$x:function(){return Vn(i,t)}}})}});function ks(r,e){return r(e={exports:{}},e.exports),e.exports}var cB=ks(function(r){(function(e,t,n){function a(u){var c,f=this,h=(c=4022871197,function(d){d=d.toString();for(var m=0;m<d.length;m++){var g=.02519603282416938*(c+=d.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var d=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=d-(f.c=0|d)},f.c=1,f.s0=h(" "),f.s1=h(" "),f.s2=h(" "),f.s0-=h(u),f.s0<0&&(f.s0+=1),f.s1-=h(u),f.s1<0&&(f.s1+=1),f.s2-=h(u),f.s2<0&&(f.s2+=1),h=null}function i(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function s(u,c){var f=new a(u),h=c&&c.state,d=f.next;return d.int32=function(){return 4294967296*f.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.alea=s})(0,r)}),fB=ks(function(r){(function(e,t,n){function a(u){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var d=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^d^d>>>8},u===(0|u)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=0|f.charCodeAt(h),c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(0,r)}),hB=ks(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^d^d<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,u===(0|u)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=0|f.charCodeAt(h),h==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c.v=u.v,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(0,r)}),pB=ks(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var f,h,d=c.x,m=c.i;return f=d[m],h=(f^=f>>>7)^f<<24,h^=(f=d[m+1&7])^f>>>10,h^=(f=d[m+3&7])^f>>>3,h^=(f=d[m+4&7])^f<<7,f=d[m+7&7],h^=(f^=f<<13)^f<<9,d[m]=h,c.i=m+1&7,h},(function(f,h){var d,m=[];if(h===(0|h))m[0]=h;else for(h=""+h,d=0;d<h.length;++d)m[7&d]=m[7&d]<<15^h.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],f.x=m,f.i=0,d=256;d>0;--d)f.next()})(c,u)}function i(u,c){return c.x=u.x.slice(),c.i=u.i,c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=f.next,d.quick=d,h&&(h.x&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(0,r)}),dB=ks(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var f,h,d=c.w,m=c.X,g=c.i;return c.w=d=d+1640531527|0,h=m[g+34&127],f=m[g=g+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,h=m[g]=h^f,c.i=g,h+(d^d>>>16)|0},(function(f,h){var d,m,g,y,x,w=[],b=128;for(h===(0|h)?(m=h,h=null):(h+="\0",m=0,b=Math.max(b,h.length)),g=0,y=-32;y<b;++y)h&&(m^=h.charCodeAt((y+32)%h.length)),y===0&&(x=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(x=x+1640531527|0,g=(d=w[127&y]^=m+x)==0?g+1:0);for(g>=128&&(w[127&(h&&h.length||0)]=-1),g=127,y=512;y>0;--y)m=w[g+34&127],d=w[g=g+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,w[g]=m^d;f.w=x,f.X=w,f.i=g})(c,u)}function i(u,c){return c.i=u.i,c.w=u.w,c.X=u.X.slice(),c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=f.next,d.quick=d,h&&(h.X&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(0,r)}),mB=ks(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.b,m=c.c,g=c.d,y=c.a;return d=d<<25^d>>>7^m,m=m-g|0,g=g<<24^g>>>8^y,y=y-d|0,c.b=d=d<<20^d>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^y,c.a=y-d|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,u===Math.floor(u)?(c.a=u/4294967296|0,c.b=0|u):f+=u;for(var h=0;h<f.length+20;h++)c.b^=0|f.charCodeAt(h),c.next()}function i(u,c){return c.a=u.a,c.b=u.b,c.c=u.c,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(0,r)}),as=ks(function(r){(function(e,t){var n,a=this,i=256,s=6,u="random",c=t.pow(i,s),f=t.pow(2,52),h=2*f,d=i-1;function m(b,C,A){var T=[],R=x((function O(k,z){var F,B=[],V=typeof k;if(z&&V=="object")for(F in k)try{B.push(O(k[F],z-1))}catch{}return B.length?B:V=="string"?k:k+"\0"})((C=C==1?{entropy:!0}:C||{}).entropy?[b,w(e)]:b??(function(){try{var O;return n&&(O=n.randomBytes)?O=O(i):(O=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(O)),w(O)}catch{var k=a.navigator,z=k&&k.plugins;return[+new Date,a,z,a.screen,w(e)]}})(),3),T),D=new g(T),N=function(){for(var O=D.g(s),k=c,z=0;O<f;)O=(O+z)*i,k*=i,z=D.g(1);for(;O>=h;)O/=2,k/=2,z>>>=1;return(O+z)/k};return N.int32=function(){return 0|D.g(4)},N.quick=function(){return D.g(4)/4294967296},N.double=N,x(w(D.S),e),(C.pass||A||function(O,k,z,F){return F&&(F.S&&y(F,D),O.state=function(){return y(D,{})}),z?(t[u]=O,k):O})(N,R,"global"in C?C.global:this==t,C.state)}function g(b){var C,A=b.length,T=this,R=0,D=T.i=T.j=0,N=T.S=[];for(A||(b=[A++]);R<i;)N[R]=R++;for(R=0;R<i;R++)N[R]=N[D=d&D+b[R%A]+(C=N[R])],N[D]=C;(T.g=function(O){for(var k,z=0,F=T.i,B=T.j,V=T.S;O--;)k=V[F=d&F+1],z=z*i+V[d&(V[F]=V[B=d&B+k])+(V[B]=k)];return T.i=F,T.j=B,z})(i)}function y(b,C){return C.i=b.i,C.j=b.j,C.S=b.S.slice(),C}function x(b,C){for(var A,T=b+"",R=0;R<T.length;)C[d&R]=d&(A^=19*C[d&R])+T.charCodeAt(R++);return w(C)}function w(b){return String.fromCharCode.apply(0,b)}if(t["seed"+u]=m,x(t.random(),e),r.exports){r.exports=m;try{n=require("crypto")}catch{}}})([],Math)});as.alea=cB,as.xor128=fB,as.xorwow=hB,as.xorshift7=pB,as.xor4096=dB,as.tychei=mB;var Ud=as.alea,z1=(function(){function r(e,t,n,a,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=Ud(s.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,a=!1;!a;){var i=void 0,s=void 0,u=void 0;do u=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(u>=1||u===0);var c=Math.sqrt(-2*Math.log(u)/u);t=this.mean+this.stdDev*i*c,n=this.mean+this.stdDev*s*c,this.truncated&&!this.isValidTruncated(t)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},r.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},r.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},r})(),vB=(function(){function r(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;var i=a||Math.random();this.randu=Ud(i.toString()),this.randn=new z1(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var e,t,n,a,i,s;;){do a=this.randn.nextValue(),s=1+this.c*a;while(s<=0);if(s*=s*s,t=1-.331*(e=a*a)*e,n=.5*e+this.d*(1-s+Math.log(s)),(i=this.randu())<t||Math.log(i)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},r.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},r})(),gB=(function(){function r(e,t,n,a){var i=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=Ud(a)}return r.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r})();function ae(r,e,t){return e===void 0&&(e="float32"),e=e||"float32",_1(r),new bs(r,e,t)}function F1(r,e){e===void 0&&(e=!1),console.log(r.toString(e))}var nf=rt({batchToSpaceND_:function(r,e,t){var n=H(r,"x","batchToSpaceND"),a=e.reduce(function(i,s){return i*s});return K(n.rank>=1+e.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+e.length}),K(t.length===e.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length}),K(n.shape[0]%a==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+a}),at.runKernelFunc(function(i){return i.batchToSpaceND(n,e,t)},{$x:n},function(i){return{$x:function(){return i.spaceToBatchND(e,t)}}})}}),No=rt({cast_:function(r,e){var t=H(r,"x","cast");if(!qR(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:e};return at.runKernelFunc(function(a){return a.cast(t,e)},{x:t},function(a){return{x:function(){return a.clone()}}},"Cast",n)}}),B1=rt({clone_:function(r){var e=H(r,"x","clone",null);return at.runKernelFunc(function(){return at.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(t){return{$x:function(){return t.toFloat()}}})}}),L1=rt({cumsum_:function(r,e,t,n){e===void 0&&(e=0),t===void 0&&(t=!1),n===void 0&&(n=!1);var a=H(r,"x","cumsum"),i=xa([e|=0],a.rank),s=a;i!=null&&(s=a.transpose(i));var u=wa(1,a.rank)[0],c=at.runKernelFunc(function(f){return f.cumsum(s,u,t,n)},{permutedX:s},function(f){return{permutedX:function(){return f.cumsum(e,t,!n)}}});return i!=null&&(c=c.transpose(i)),c}}),jd=rt({depthToSpace_:function(r,e,t){t===void 0&&(t="NHWC");var n=H(r,"x","depthToSpace"),a=t==="NHWC"?n.shape[1]:n.shape[2],i=t==="NHWC"?n.shape[2]:n.shape[3],s=t==="NHWC"?n.shape[3]:n.shape[1];return K(a*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+e+`  for depthToSpace with input shape
      `+n.shape}),K(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+n.shape}),K(s%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+n.shape}),at.runKernelFunc(function(u){return u.depthToSpace(n,e,t)},{$x:n})}}),Qn=rt({expandDims_:function(r,e){e===void 0&&(e=0);var t=H(r,"x","expandDims",null);K(e<=t.rank,function(){return"Axis must be <= rank of the tensor"});var n=t.shape.slice();return e<0&&(K(-(t.rank+1)<=e,function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"}),e=t.rank+e+1),n.splice(e,0,1),Ms(t,n)}}),rf=rt({eye_:function(r,e,t,n){n===void 0&&(n="float32"),e==null&&(e=r);for(var a=ae([r,e],n),i=r<=e?r:e,s=0;s<i;++s)a.set(1,s,s);var u=a.toTensor().as2D(r,e);if(t==null)return u;if(t.length===1)return bi(Qn(u,0),[t[0],1,1]);if(t.length===2)return bi(Qn(Qn(u,0),0),[t[0],t[1],1,1]);if(t.length===3)return bi(Qn(Qn(Qn(u,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),Pd=rt({multinomial_:function(r,e,t,n){n===void 0&&(n=!1);var a=H(r,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);t=t||Math.random();var u=s===1?a.as2D(1,-1):a,c=at.runKernelFunc(function(f){return f.multinomial(u,n,e,t)},{logits2D:u});return s===1?c.as1D():c}}),Ua=rt({oneHot_:function(r,e,t,n){if(t===void 0&&(t=1),n===void 0&&(n=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var a=H(r,"indices","oneHot","int32"),i=a.shape.concat([e]);return a=a.flatten(),at.runKernelFunc(function(s){return s.oneHot(a,e,t,n)},{$indices:a},function(s){return{$indices:function(){return Ie(a.shape,"float32")}}}).reshape(i)}}),ki=rt({pad_:function(r,e,t){t===void 0&&(t=0);var n=H(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a=e.map(function(i){return i[0]});return at.runKernelFunc(function(i){return i.pad(n,e,t)},{$x:n},function(i){return{$x:function(){return i.slice(a,n.shape)}}})}}),U1=rt({pad1d_:function(r,e,t){return t===void 0&&(t=0),K(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ki(r,[e],t)}}),j1=rt({pad2d_:function(r,e,t){return t===void 0&&(t=0),K(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ki(r,e,t)}}),Vd=rt({pad3d_:function(r,e,t){return t===void 0&&(t=0),K(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ki(r,e,t)}}),P1=rt({pad4d_:function(r,e,t){return t===void 0&&(t=0),K(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ki(r,e,t)}}),V1=rt({rand_:function(r,e,t){var n=Kt(r),a=null;if(t==null||t==="float32")a=new Float32Array(n);else if(t==="int32")a=new Int32Array(n);else{if(t!=="bool")throw new Error("Unknown data type "+t);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=e();return at.makeTensor(a,r,t)}}),qd=rt({randomNormal_:function(r,e,t,n,a){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new z1(e,t,n,!1,a),s=ae(r,n),u=0;u<s.values.length;u++)s.values[u]=i.nextValue();return s.toTensor()}}),q1=rt({randomGamma_:function(r,e,t,n,a){if(t===void 0&&(t=1),n===void 0&&(n="float32"),t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new vB(e,t,n,a),s=ae(r,n),u=0;u<s.values.length;u++)s.values[u]=i.nextValue();return s.toTensor()}}),To=rt({randomUniform_:function(r,e,t,n,a){e===void 0&&(e=0),t===void 0&&(t=1),n===void 0&&(n="float32");for(var i=ae(r,n),s=new gB(e,t,null,a),u=0;u<i.values.length;u++)i.values[u]=s.nextValue();return i.toTensor()}}),Ms=rt({reshape_:function(r,e){var t=H(r,"x","reshape",null);e=PR(e,t.size),K(t.size===Kt(e),function(){return"new shape and old shape must have the same number of elements."});var n={shape:e};return at.runKernelFunc(function(a){return a.reshape(t,e)},{x:t},function(a){return{x:function(){return a.reshape(t.shape)}}},"Reshape",n)}}),af=rt({spaceToBatchND_:function(r,e,t){var n=H(r,"x","spaceToBatchND");return K(n.rank>=1+e.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+e.length}),K(t.length===e.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length}),K(n.shape.reduce(function(a,i,s){return s>0&&s<=e.length?a&&(i+t[s-1][0]+t[s-1][1])%e[s-1]==0:a},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()}),at.runKernelFunc(function(a){return a.spaceToBatchND(n,e,t)},{$x:n},function(a){return{$x:function(){return a.batchToSpaceND(e,t)}}})}}),Ai=rt({squeeze_:function(r,e){var t=H(r,"x","squeeze");return Ms(t,co(t.shape,e).newShape)}}),Lr=rt({stack_:function(r,e){e===void 0&&(e=0);var t=Uc(r,"tensors","stack");if(K(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),t.length===1)return t[0].expandDims(e);var n=t[0].rank,a=t[0].shape,i=t[0].dtype;K(e<=n,function(){return"Axis must be <= rank of the tensor"}),t.forEach(function(u){Ce(a,u.shape,"All tensors passed to stack must have matching shapes")}),t.forEach(function(u){K(i===u.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=t.map(function(u){return u.expandDims(e)});return Vn(s,e)}}),bi=rt({tile_:function(r,e){var t=H(r,"x","tile",null);return K(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."}),at.runKernelFunc(function(n,a){var i=n.tile(t,e);return a([t]),i},{$x:t},function(n,a){var i=a[0];return{$x:function(){var s=ye(i);if(i.rank===1)for(var u=0;u<e[0];++u)s=s.add(n.slice([u*i.shape[0]],[i.shape[0]]));else if(i.rank===2)for(u=0;u<e[0];++u)for(var c=0;c<e[1];++c)s=s.add(n.slice([u*i.shape[0],c*i.shape[1]],[i.shape[0],i.shape[1]]));else if(i.rank===3)for(u=0;u<e[0];++u)for(c=0;c<e[1];++c)for(var f=0;f<e[2];++f)s=s.add(n.slice([u*i.shape[0],c*i.shape[1],f*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(i.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+i.rank+" tensors yet.");for(u=0;u<e[0];++u)for(c=0;c<e[1];++c)for(f=0;f<e[2];++f)for(var h=0;h<e[3];++h)s=s.add(n.slice([u*i.shape[0],c*i.shape[1],f*i.shape[2],h*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return s}}})}}),il=rt({truncatedNormal_:function(r,e,t,n,a){if(e===void 0&&(e=0),t===void 0&&(t=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new z1(e,t,n,!0,a),s=ae(r,n),u=0;u<s.values.length;u++)s.values[u]=i.nextValue();return s.toTensor()}}),Ni=rt({unstack_:function(r,e){e===void 0&&(e=0),e=e||0;var t=H(r,"x","unstack");return K(e>=-t.shape.length&&e<t.shape.length,function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"}),e<0&&(e+=t.shape.length),at.runKernelFunc(function(n){return n.unstack(t,e)},{$x:t},function(n){return{$x:function(){return Lr(n,e)}}})}}),Wd=function(r,e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f,h,d;return Gt(this,function(m){switch(m.label){case 0:return t=H(r,"x","setdiff1d"),n=H(e,"y","setdiff1d"),K(t.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+n.dtype+")."}),K(t.rank===1,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),K(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,t.data()];case 1:return a=m.sent(),[4,n.data()];case 2:for(i=m.sent(),s=new Set(i),u=0,h=0;h<a.length;h++)s.has(a[h])||u++;for(c=new bs([u],t.dtype),f=new bs([u],"int32"),h=0,d=0;h<a.length;h++)s.has(a[h])||(c.values[d]=a[h],f.values[d]=h,d++);return[2,[c.toTensor(),f.toTensor()]]}})})};function ud(r,e,t,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(e.slice(0))).push(r[0]/t),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var i=e.length,s=0;s<i;++s)a=a.concat([r[s+1]/e[s],e[s]]);a=a.concat(r.slice(i+1))}return a}function ld(r,e,t){t===void 0&&(t=!0);var n=[];if(t){n.push(e);for(var a=e+1;a<r;++a)a<=2*e?(n.push(a),n.push(a-(e+1))):n.push(a)}else{var i=[],s=[];for(a=1;a<r;++a)a>=2*e+1||a%2==1?s.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,s)}return n}function cd(r,e,t,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/t):a.push(r[0]*t);for(var i=1;i<r.length;++i)i<=e.length?n?a.push(e[i-1]*r[i]):a.push(r[i]/e[i-1]):a.push(r[i]);return a}function V_(r,e){for(var t=[0],n=0;n<e;++n)t.push(r[n][0]);return t}function q_(r,e,t){for(var n=r.slice(0,1),a=0;a<t;++a)n.push(r[a+1]-e[a][0]-e[a][1]);return n}function W_(r,e){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var t=e.shape,n=t[t.length-1],a=1,i=0;i<t.length-1;++i)a*=t[i];var s=r.shape,u=t.slice();u.pop();var c=1;for(i=n;i<r.rank;++i)c*=s[i],u.push(s[i]);var f=Co(r.shape).map(function(h){return h/c}).concat([1]).slice(0,n);return[u,a,c,f]}var H_=30;function zy(r){return r<=H_?r:id(r,Math.floor(Math.sqrt(r)))}function yB(r,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}(function(n,a,i){var s=a.rank>1?a.shape[a.rank-1]:1,u=a.rank>1?a.rank-1:1,c="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+i.shape+", indices.shape: "+a.shape+", shape: "+n+", sliceDim: "+s+", and batchDim: "+u+".";if(i.rank<u)throw new Error(c+" update.rank < "+u+". ");if(n.length<s+(i.rank-u))throw new Error(c+" Output shape length < "+(s+(i.rank-u)));if(i.rank!==u+n.length-s)throw new Error(c+" update.rank != "+(u+n.length-s));for(var f=0;f<u;++f)if(i.shape[f]!==a.shape[f])throw new Error(c+" updates.shape["+f+"] ("+i.shape[f]+") != indices.shape["+f+"] ("+a.shape[f]+").");for(f=0;f<i.rank-u;++f)if(i.shape[f+u]!==n[f+s])throw new Error(c+" updates.shape["+(f+u)+"] ("+i.shape[f+u]+") != shape["+(f+u)+"] ("+n[f+u]+")")})(t,e,r)}function fd(r,e,t){for(var n=e.rank>1?e.shape[e.rank-1]:1,a=t.length,i=1,s=n;s<a;++s)i*=t[s];var u=n<1?1:n;return{sliceRank:n,numUpdates:e.size/u,sliceSize:i,strides:Co(t.slice(0,n)).concat([1]),outputSize:Kt(t)}}function G_(r,e,t){K(r.rank===e.length,function(){return"Error in slice"+r.rank+"D: Length of begin "+e+" must match the rank of the array ("+r.rank+")."}),K(r.rank===t.length,function(){return"Error in slice"+r.rank+"D: Length of size "+t+" must match the rank of the array ("+r.rank+")."});for(var n=function(i){K(e[i]+t[i]<=r.shape[i],function(){return"Error in slice"+r.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+t[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")"})},a=0;a<r.rank;++a)n(a)}function Ib(r){for(var e=[],t=0;r>0;)1&r&&e.push(t),r/=2,t++;return e}function Hd(r,e,t){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((e[a]-r[a])/t[a]);return n}function X_(r,e,t,n,a){var i=e[a],s=t[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=n[a];return i<0&&(i+=u),i=rd(0,i,u-1)}function K_(r,e,t,n,a){var i=e[a],s=t[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=n[a];return i<0&&(i+=u),i=s>0?rd(0,i,u):rd(-1,i,u-1)}function W1(r,e,t){for(var n=t.length,a=0;a<t.length;a++)if(t[a]>1){n=a;break}for(a=n+1;a<t.length;a++)if(e[a]>0||t[a]!==r[a])return!1;return!0}function H1(r,e){for(var t=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)t+=r[n]*e[n];return t}var Y_=Object.freeze({assertParamsValid:G_,maskToAxes:Ib,computeOutShape:Hd,startForAxis:X_,stopForAxis:K_,isSliceContinous:W1,computeFlatOffset:H1});function $_(r){return K(xo(r),function(){return"The f passed in grad(f) must be a function"}),function(e,t){var n=H(e,"x","tf.grad",null),a=t!=null?H(t,"dy","tf.grad"):null;return at.tidy(function(){var i=at.gradients(function(){return r(n)},[n],a),s=i.value,u=i.grads;return a!=null&&Ce(s.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Gd(u),u[0]})}}function Q_(r){return K(xo(r),function(){return"The f passed in grads(f) must be a function"}),function(e,t){K(Array.isArray(e),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var n=Uc(e,"args","tf.grads",null),a=t!=null?H(t,"dy","tf.grads"):null;return at.tidy(function(){var i=at.gradients(function(){return r.apply(void 0,n)},n,a),s=i.value,u=i.grads;return a!=null&&Ce(s.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Gd(u),u})}}function Z_(r){return K(xo(r),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(e,t){K(e instanceof Ee,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),K(t==null||t instanceof Ee,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var n=at.gradients(function(){return r(e)},[e],t),a=n.grads,i=n.value;return Gd(a),{grad:a[0],value:i}}}function J_(r){return K(xo(r),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(e,t){K(Array.isArray(e)&&e.every(function(a){return a instanceof Ee}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),K(t==null||t instanceof Ee,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var n=at.gradients(function(){return r.apply(void 0,e)},e,t);return t!=null&&Ce(n.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Gd(n.grads),n}}function G1(r,e){K(xo(r),function(){return"The f passed in variableGrads(f) must be a function"}),K(e==null||Array.isArray(e)&&e.every(function(h){return h instanceof Gu}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var t=e!=null;if(!t)for(var n in e=[],at.registeredVariables)e.push(at.registeredVariables[n]);var a=t?e.filter(function(h){return!h.trainable}):null,i=e.length;K((e=e.filter(function(h){return h.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=at.gradients(r,e,null,!0),u=s.value,c=s.grads;K(c.some(function(h){return h!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),K(u.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+u.rank+" tensor"});var f={};return e.forEach(function(h,d){c[d]!=null&&(f[h.name]=c[d])}),a?.forEach(function(h){return f[h.name]=null}),{value:u,grads:f}}function zs(r){return at.customGrad(r)}function Gd(r){if(r.filter(function(e){return e==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Ro=rt({softmax_:function(r,e){e===void 0&&(e=-1);var t=H(r,"logits","softmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return zs(function(n,a){var i=n.logSumExp([e],!0),s=n.toFloat().sub(i).exp();return a([s]),{value:s,gradFunc:function(u,c){var f=c[0],h=u.mul(f);return h.sub(h.sum([e],!0).mul(f))}}})(t)}}),of=rt({logSoftmax_:function(r,e){e===void 0&&(e=-1);var t=H(r,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return zs(function(n,a){var i=n.max(e,!0),s=n.sub(i),u=s.toFloat().sub(s.exp().sum(e,!0).log());return a([u]),{value:u,gradFunc:function(c,f){var h=f[0].exp();return c.sub(c.sum(e,!0).mul(h))}}})(t)}}),Xd=(function(){function r(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},r.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},r.prototype.has=function(e){return this.data.has(e)},r.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},r.prototype.numDataIds=function(){return this.dataIdsCount},r})(),Kd=(function(){function r(){}return r.prototype.time=function(e){return gt()},r.prototype.read=function(e){return gt()},r.prototype.readSync=function(e){return gt()},r.prototype.numDataIds=function(){return gt()},r.prototype.disposeData=function(e){return gt()},r.prototype.fromPixels=function(e,t){return gt()},r.prototype.write=function(e,t,n){return gt()},r.prototype.move=function(e,t,n,a){return gt()},r.prototype.memory=function(){return gt()},r.prototype.floatPrecision=function(){return gt()},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(e,t,n,a){return gt()},r.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,gt()},r.prototype.slice=function(e,t,n){return gt()},r.prototype.stridedSlice=function(e,t,n,a){return gt()},r.prototype.unstack=function(e,t){return gt()},r.prototype.reverse=function(e,t){return gt()},r.prototype.concat=function(e,t){return gt()},r.prototype.neg=function(e){return gt()},r.prototype.add=function(e,t){return gt()},r.prototype.addN=function(e){return gt()},r.prototype.subtract=function(e,t){return gt()},r.prototype.multiply=function(e,t){return gt()},r.prototype.realDivide=function(e,t){return gt()},r.prototype.floorDiv=function(e,t){return gt()},r.prototype.sum=function(e,t){return gt()},r.prototype.prod=function(e,t){return gt()},r.prototype.unsortedSegmentSum=function(e,t,n){return gt()},r.prototype.argMin=function(e,t){return gt()},r.prototype.argMax=function(e,t){return gt()},r.prototype.equal=function(e,t){return gt()},r.prototype.notEqual=function(e,t){return gt()},r.prototype.less=function(e,t){return gt()},r.prototype.lessEqual=function(e,t){return gt()},r.prototype.greater=function(e,t){return gt()},r.prototype.greaterEqual=function(e,t){return gt()},r.prototype.logicalNot=function(e){return gt()},r.prototype.logicalAnd=function(e,t){return gt()},r.prototype.logicalOr=function(e,t){return gt()},r.prototype.where=function(e){return gt()},r.prototype.select=function(e,t,n){return gt()},r.prototype.topk=function(e,t,n){return gt()},r.prototype.min=function(e,t){return gt()},r.prototype.minimum=function(e,t){return gt()},r.prototype.mod=function(e,t){return gt()},r.prototype.max=function(e,t){return gt()},r.prototype.maximum=function(e,t){return gt()},r.prototype.all=function(e,t){return gt()},r.prototype.any=function(e,t){return gt()},r.prototype.squaredDifference=function(e,t){return gt()},r.prototype.ceil=function(e){return gt()},r.prototype.floor=function(e){return gt()},r.prototype.round=function(e){return gt()},r.prototype.sign=function(e){return gt()},r.prototype.isNaN=function(e){return gt()},r.prototype.isInf=function(e){return gt()},r.prototype.isFinite=function(e){return gt()},r.prototype.pow=function(e,t){return gt()},r.prototype.exp=function(e){return gt()},r.prototype.expm1=function(e){return gt()},r.prototype.log=function(e){return gt()},r.prototype.log1p=function(e){return gt()},r.prototype.sqrt=function(e){return gt()},r.prototype.rsqrt=function(e){return gt()},r.prototype.square=function(e){return gt()},r.prototype.reciprocal=function(e){return gt()},r.prototype.relu=function(e){return gt()},r.prototype.relu6=function(e){return gt()},r.prototype.prelu=function(e,t){return gt()},r.prototype.elu=function(e){return gt()},r.prototype.eluDer=function(e,t){return gt()},r.prototype.selu=function(e){return gt()},r.prototype.int=function(e){return gt()},r.prototype.clip=function(e,t,n){return gt()},r.prototype.abs=function(e){return gt()},r.prototype.complexAbs=function(e){return gt()},r.prototype.sigmoid=function(e){return gt()},r.prototype.softplus=function(e){return gt()},r.prototype.sin=function(e){return gt()},r.prototype.cos=function(e){return gt()},r.prototype.tan=function(e){return gt()},r.prototype.asin=function(e){return gt()},r.prototype.acos=function(e){return gt()},r.prototype.atan=function(e){return gt()},r.prototype.atan2=function(e,t){return gt()},r.prototype.sinh=function(e){return gt()},r.prototype.cosh=function(e){return gt()},r.prototype.tanh=function(e){return gt()},r.prototype.asinh=function(e){return gt()},r.prototype.acosh=function(e){return gt()},r.prototype.atanh=function(e){return gt()},r.prototype.erf=function(e){return gt()},r.prototype.step=function(e,t){return gt()},r.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,gt()},r.prototype.conv2d=function(e,t,n){return gt()},r.prototype.conv2dDerInput=function(e,t,n){return gt()},r.prototype.conv2dDerFilter=function(e,t,n){return gt()},r.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,gt()},r.prototype.depthwiseConv2D=function(e,t,n){return gt()},r.prototype.depthwiseConv2DDerInput=function(e,t,n){return gt()},r.prototype.depthwiseConv2DDerFilter=function(e,t,n){return gt()},r.prototype.conv3d=function(e,t,n){return gt()},r.prototype.conv3dDerInput=function(e,t,n){return gt()},r.prototype.conv3dDerFilter=function(e,t,n){return gt()},r.prototype.maxPool=function(e,t){return gt()},r.prototype.maxPoolBackprop=function(e,t,n,a){return gt()},r.prototype.avgPool=function(e,t){return gt()},r.prototype.avgPoolBackprop=function(e,t,n){return gt()},r.prototype.avgPool3d=function(e,t){return gt()},r.prototype.avgPool3dBackprop=function(e,t,n){return gt()},r.prototype.maxPool3d=function(e,t){return gt()},r.prototype.maxPool3dBackprop=function(e,t,n,a){return gt()},r.prototype.reshape=function(e,t){return gt()},r.prototype.cast=function(e,t){return gt()},r.prototype.tile=function(e,t){return gt()},r.prototype.pad=function(e,t,n){return gt()},r.prototype.transpose=function(e,t){return gt()},r.prototype.gather=function(e,t,n){return gt()},r.prototype.gatherND=function(e,t){return gt()},r.prototype.scatterND=function(e,t,n){return gt()},r.prototype.batchToSpaceND=function(e,t,n){return gt()},r.prototype.spaceToBatchND=function(e,t,n){return gt()},r.prototype.resizeBilinear=function(e,t,n,a){return gt()},r.prototype.resizeBilinearBackprop=function(e,t,n){return gt()},r.prototype.resizeNearestNeighbor=function(e,t,n,a){return gt()},r.prototype.resizeNearestNeighborBackprop=function(e,t,n){return gt()},r.prototype.batchNormalization=function(e,t,n,a,i,s){return gt()},r.prototype.localResponseNormalization4D=function(e,t,n,a,i){return gt()},r.prototype.LRNGrad=function(e,t,n,a,i,s,u){return gt()},r.prototype.multinomial=function(e,t,n,a){return gt()},r.prototype.oneHot=function(e,t,n,a){return gt()},r.prototype.cumsum=function(e,t,n,a){return gt()},r.prototype.nonMaxSuppression=function(e,t,n,a,i){return gt()},r.prototype.fft=function(e){return gt()},r.prototype.ifft=function(e){return gt()},r.prototype.complex=function(e,t){return gt()},r.prototype.real=function(e){return gt()},r.prototype.imag=function(e){return gt()},r.prototype.cropAndResize=function(e,t,n,a,i,s){return gt()},r.prototype.depthToSpace=function(e,t,n){return gt()},r.prototype.split=function(e,t,n){return gt()},r.prototype.sparseToDense=function(e,t,n,a){return gt()},r.prototype.diag=function(e){return gt()},r.prototype.fill=function(e,t,n){throw new Error("Not yet implemented.")},r.prototype.onesLike=function(e){return gt()},r.prototype.zerosLike=function(e){return gt()},r.prototype.linspace=function(e,t,n){return gt()},r.prototype.dispose=function(){return gt()},r})();function gt(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ls(r,e){for(var t=r.length,n=[],a=0;a<t;a++){var i=t-1-a,s=r[i]||1;(e[e.length-1-a]||1)>1&&s===1&&n.unshift(i)}return n}function In(r,e){for(var t=[],n=0;n<e.length;n++){var a=r[r.length-n-1],i=e.length-n-1,s=e[i];(a==null||a===1&&s>1)&&t.unshift(i)}return t}function ge(r,e){for(var t=[],n=Math.max(r.length,e.length),a=0;a<n;a++){var i=r[r.length-a-1];i==null&&(i=1);var s=e[e.length-a-1];if(s==null&&(s=1),i===1)t.unshift(s);else if(s===1)t.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+r+" and "+e+".");t.unshift(i)}}return t}function Xu(r,e,t,n,a,i,s){s===void 0&&(s="channelsLast");var u,c=hd(e),f=c[0],h=c[1];if(s==="channelsLast")u=[f,h,r[3],r[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);u=[f,h,r[1],r[1]]}return _o(r,u,t,n,a,i,!1,s)}function jc(r,e,t,n,a,i,s){s===void 0&&(s="NDHWC");var u,c,f=kb(e),h=f[0],d=f[1],m=f[2];if(s==="NDHWC")c="channelsLast",u=[h,d,m,r[4],r[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);c="channelsFirst",u=[h,d,m,r[1],r[1]]}return Pc(r,u,t,n,a,!1,c,i)}function _o(r,e,t,n,a,i,s,u){s===void 0&&(s=!1),u===void 0&&(u="channelsLast");var c=[-1,-1,-1,-1],f=c[0],h=c[1],d=c[2],m=c[3];if(u==="channelsLast")f=r[0],h=r[1],d=r[2],m=r[3];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);f=r[0],m=r[1],h=r[2],d=r[3]}var g,y=e[0],x=e[1],w=e[3],b=hd(t),C=b[0],A=b[1],T=hd(n),R=T[0],D=T[1],N=Uu(y,R),O=Uu(x,D),k=(function(G,Q,L,X,$,it,tt,q){var nt,W,Z;if(typeof G=="number"){var ot=G===0?"VALID":"NUMBER";nt={top:G,bottom:G,left:G,right:G,type:ot};var xt=(function(Pt,Ut,$t,Wt,Ae){Wt==null&&(Wt=X1(Pt,Ut,$t));var cn=Pt[0],Et=Pt[1],ze=Tc((cn-Ut+2*Wt)/$t+1,Ae);K(mn(ze),function(){return"The output # of rows ("+ze+") must be an integer. Change the stride and/or zero pad parameters"});var Ne=Tc((Et-Ut+2*Wt)/$t+1,Ae);return K(mn(Ne),function(){return"The output # of columns ("+Ne+") must be an integer. Change the stride and/or zero pad parameters"}),[ze,Ne]})([Q,L],it,X,G,q);W=xt[0],Z=xt[1]}else if(G==="same"){W=Math.ceil(Q/X),Z=Math.ceil(L/$);var Ot=Math.max(0,(W-1)*X+it-Q),zt=Math.max(0,(Z-1)*$+tt-L),_t=Math.floor(Ot/2),Mt=Ot-_t,kt=Math.floor(zt/2),Ft=zt-kt;nt={top:_t,bottom:Mt,left:kt,right:Ft,type:"SAME"}}else{if(G!=="valid")throw Error("Unknown padding parameter: "+G);nt={top:0,bottom:0,left:0,right:0,type:"VALID"},W=Math.ceil((Q-it+1)/X),Z=Math.ceil((L-tt+1)/$)}return{padInfo:nt,outHeight:W,outWidth:Z}})(a,h,d,C,A,N,O,i),z=k.padInfo,F=k.outHeight,B=k.outWidth,V=s?w*m:w;return u==="channelsFirst"?g=[f,V,F,B]:u==="channelsLast"&&(g=[f,F,B,V]),{batchSize:f,dataFormat:u,inHeight:h,inWidth:d,inChannels:m,outHeight:F,outWidth:B,outChannels:V,padInfo:z,strideHeight:C,strideWidth:A,filterHeight:y,filterWidth:x,effectiveFilterHeight:N,effectiveFilterWidth:O,dilationHeight:R,dilationWidth:D,inShape:r,outShape:g,filterShape:e}}function Pc(r,e,t,n,a,i,s,u){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],h=c[1],d=c[2],m=c[3],g=c[4];if(s==="channelsLast")f=r[0],h=r[1],d=r[2],m=r[3],g=r[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);f=r[0],g=r[1],h=r[2],d=r[3],m=r[4]}var y,x=e[0],w=e[1],b=e[2],C=e[4],A=kb(t),T=A[0],R=A[1],D=A[2],N=kb(n),O=N[0],k=N[1],z=N[2],F=Uu(x,O),B=Uu(w,k),V=Uu(b,z),G=(function(tt,q,nt,W,Z,ot,xt,Ot,zt,_t,Mt){var kt,Ft,Pt,Ut;if(typeof tt=="number"){var $t=tt===0?"VALID":"NUMBER";kt={top:tt,bottom:tt,left:tt,right:tt,front:tt,back:tt,type:$t};var Wt=(function(tn,Zn,on,fn,U,_){U==null&&(U=X1(tn,Zn,fn));var I=tn[0],Y=tn[1],st=tn[2],mt=Tc((I-Zn+2*U)/fn+1,_);K(mn(mt),function(){return"The output # of depths ("+mt+") must be an integer. Change the stride and/or zero pad parameters"});var St=Tc((Y-Zn+2*U)/fn+1,_);K(mn(St),function(){return"The output # of rows ("+St+") must be an integer. Change the stride and/or zero pad parameters"});var oe=Tc((st-Zn+2*U)/fn+1,_);return K(mn(oe),function(){return"The output # of columns ("+oe+") must be an integer. Change the stride and/or zero pad parameters"}),[mt,St,oe,on]})([q,nt,W,1],Ot,1,Z,tt,Mt);Ft=Wt[0],Pt=Wt[1],Ut=Wt[2]}else if(tt==="same"){Ft=Math.ceil(q/Z),Pt=Math.ceil(nt/ot),Ut=Math.ceil(W/xt);var Ae=(Ft-1)*Z+Ot-q,cn=(Pt-1)*ot+zt-nt,Et=(Ut-1)*xt+_t-W,ze=Math.floor(Ae/2),Ne=Ae-ze,yn=Math.floor(cn/2),te=cn-yn,de=Math.floor(Et/2),Re=Et-de;kt={top:yn,bottom:te,left:de,right:Re,front:ze,back:Ne,type:"SAME"}}else{if(tt!=="valid")throw Error("Unknown padding parameter: "+tt);kt={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ft=Math.ceil((q-Ot+1)/Z),Pt=Math.ceil((nt-zt+1)/ot),Ut=Math.ceil((W-_t+1)/xt)}return{padInfo:kt,outDepth:Ft,outHeight:Pt,outWidth:Ut}})(a,h,d,m,T,R,D,F,B,V,u),Q=G.padInfo,L=G.outDepth,X=G.outHeight,$=G.outWidth,it=i?C*g:C;return s==="channelsFirst"?y=[f,it,L,X,$]:s==="channelsLast"&&(y=[f,L,X,$,it]),{batchSize:f,dataFormat:s,inDepth:h,inHeight:d,inWidth:m,inChannels:g,outDepth:L,outHeight:X,outWidth:$,outChannels:it,padInfo:Q,strideDepth:T,strideHeight:R,strideWidth:D,filterDepth:x,filterHeight:w,filterWidth:b,effectiveFilterDepth:F,effectiveFilterHeight:B,effectiveFilterWidth:V,dilationDepth:O,dilationHeight:k,dilationWidth:z,inShape:r,outShape:y,filterShape:e}}function X1(r,e,t,n){n===void 0&&(n=1);var a=Uu(e,n);return Math.floor((r[0]*(t-1)-t+a)/2)}function hd(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function kb(r){return typeof r=="number"?[r,r,r]:r}function Uu(r,e){return e<=1?r:r+(r-1)*(e-1)}function Tc(r,e){if(!e)return r;switch(e){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+e)}}function ws(r){var e=hd(r),t=e[0],n=e[1],a=e[2];return t===1&&n===1&&a===1}function cr(r,e){return ws(r)||ws(e)}function Yd(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function K1(r,e,t){if(e==="complex64"){if(r.dtype==="complex64")return r.clone();var n=Ie(r.shape),a=r.toFloat(),i=t.complex(a,n);return n.dispose(),a.dispose(),i}if(!WR(r.dtype,e))return at.makeTensorFromDataId(r.dataId,r.shape,e);if(r.dtype==="complex64"){var s=t.real(r);return i=s.cast(e),s.dispose(),i}if(e==="int32")return t.int(r);if(e==="bool"){var u=jt(0,r.dtype);return i=t.notEqual(r,u),u.dispose(),i}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+e)}function pd(r,e){return at.makeTensorFromDataId(r.dataId,e,r.dtype)}function Y1(r,e,t){var n=(e-r)/(t-1),a=al(t,"float32");a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return zn(a,"float32")}var tO=Object.freeze({castTensor:K1,reshapeTensor:pd,linspaceImpl:Y1,upcastType:_n,axesAreInnerMostDims:I1,combineLocations:j_,computeOutAndReduceShapes:Yn,expandShapeToKeepDim:Br,assertAxesAreInnerMostDims:wr,getAxesPermutation:xa,getUndoAxesPermutation:Id,getInnerMostAxes:wa,getBroadcastDims:ls,getReductionAxes:In,assertAndGetBroadcastShape:ge,assertParamsConsistent:P_,computeOutShape:xs,computePool2DInfo:Xu,computePool3DInfo:jc,computeConv2DInfo:_o,computeConv3DInfo:Pc,computeDefaultPad:X1,tupleValuesAreOne:ws,eitherStridesOrDilationsAreOne:cr,convertConv2DDataFormat:Yd});function Mb(r,e){if(r.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+e.length+".");for(var t=new Float32Array(2*r.length),n=0;n<t.length;n+=2)t[n]=r[n/2],t[n+1]=e[n/2];return t}function eA(r,e){return{real:r[2*e],imag:r[2*e+1]}}function bB(r,e,t,n){r[2*n]=e,r[2*n+1]=t}function xB(r,e,t){var n=(t?2:-2)*Math.PI*(r/e);return{real:Math.cos(n),imag:Math.sin(n)}}function $1(r,e,t,n,a){for(var i=Array.from(e).map(function(g,y){return{score:g,boxIndex:y}}).filter(function(g){return g.score>a}).sort(function(g,y){return y.score-g.score}),s=[],u=0;u<i.length;u++){var c=i[u],f=c.score,h=c.boxIndex;if(f<a)break;for(var d=!1,m=s.length-1;m>=0;--m)if(wB(r,h,s[m])>=n){d=!0;break}if(!d&&(s.push(h),s.length>=t))break}return zn(s,"int32")}function wB(r,e,t){var n=r.subarray(4*e,4*e+4),a=r.subarray(4*t,4*t+4),i=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),u=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]),f=Math.min(a[0],a[2]),h=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(u-i)*(c-s),y=(d-f)*(m-h);if(g<=0||y<=0)return 0;var x=Math.max(i,f),w=Math.max(s,h),b=Math.min(u,d),C=Math.min(c,m),A=Math.max(b-x,0)*Math.max(C-w,0);return A/(g+y-A)}function eO(r,e,t){var n=new Array(r.rank).fill(0),a=r.shape.slice();return e.map(function(i){a[t]=i;var s=r.slice(n,a);return n[t]+=i,s})}function nO(r,e){for(var t=new Array(r.rank),n=0;n<t.length;n++)t[n]=r.shape[n]*e[n];var a=ae(t,r.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),s=new Array(r.rank),u=0;u<s.length;u++)s[u]=i[u]%r.shape[u];var c=r.locToIndex(s);a.values[n]=r.values[c]}return a.toTensor()}function rO(r,e,t,n,a){for(var i=e[e.length-1],s=[r.length/i,i],u=s[0],c=s[1],f=kc(t,u*n),h=kc("int32",u*n),d=0;d<u;d++){for(var m=d*c,g=r.subarray(m,m+c),y=[],x=0;x<g.length;x++)y.push({value:g[x],index:x});y.sort(function(T,R){return R.value-T.value});var w=d*n,b=f.subarray(w,w+n),C=h.subarray(w,w+n);for(x=0;x<n;x++)b[x]=y[x].value,C[x]=y[x].index}var A=e.slice();return A[A.length-1]=n,[sn(f,A,t),sn(h,A,"int32")]}function Q1(r,e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(n);var a=ae(r,"int32"),i=ae([t.length,r.length],"int32");for(n=0;n<t.length;n++){var s=a.indexToLoc(t[n]),u=n*r.length;i.values.set(s,u)}return i.toTensor()}var SB=(function(){return function(r,e){this.outputShape=[],this.outputShape=r,this.variableNames=e.map(function(a,i){return"T"+i});var t=[];this.variableNames.forEach(function(a){t.push("float v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `}})(),EB=(function(){return function(r,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=e.map(function(a,i){return"T"+i});var t=[];this.variableNames.forEach(function(a){t.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `}})(),CB=(function(){return function(r,e,t){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,i=r.inSize,s=Math.ceil(i/n);t||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];var u=e==="max"?">":"<",c=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+u+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}})();function aO(r,e){return["x","y","z","w","u","v"].slice(0,e).map(function(t){return r+"."+t})}function Sr(r,e){return e===1?[r]:aO(r,e)}function tr(){var r,e,t,n,a,i,s,u,c,f;return yt().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",e="in",t="out",n="in",a="texture",i="outputColor",s="out vec4 outputColor;",u=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",e="attribute",t="varying",n="varying",a="texture2D",i="gl_FragColor",s="",u=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:e,varyingVs:t,varyingFs:n,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:c,defineRound:f}}function cs(r,e,t){t===void 0&&(t="index");var n=Co(e);return n.map(function(a,i){return"int "+r[i]+" = "+t+" / "+a+"; "+(i===n.length-1?"int "+r[i+1]+" = "+t+" - "+r[i]+" * "+a:"index -= "+r[i]+" * "+a)+";"}).join("")}function Z1(r){var e=Co(r).map(function(t){return t.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var iO=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function AB(r,e,t,n){var a=[];r.forEach(function(g){var y=Kt(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(y>1?"["+y+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var i,s,u=a.join(`
`),c=r.map(function(g){return(function(y,x,w){w===void 0&&(w=!1);var b="";b+=w?oO(y):ku(y);var C=y.shapeInfo.logicalShape,A=x.logicalShape;return C.length<=A.length&&(b+=w?(function(T,R){var D,N=T.name,O=N.charAt(0).toUpperCase()+N.slice(1),k="get"+O+"AtOutCoords",z=T.shapeInfo.logicalShape.length,F=R.logicalShape.length,B=ls(T.shapeInfo.logicalShape,R.logicalShape),V=Xe(F),G=F-z,Q=["x","y","z","w","u","v"];D=z===0?"":F<2&&B.length>=1?"coords = 0;":B.map(function(nt){return"coords."+Q[nt+G]+" = 0;"}).join(`
`);var L="";L=F<2&&z>0?"coords":T.shapeInfo.logicalShape.map(function(nt,W){return"coords."+Q[W+G]}).join(", ");var X="return outputValue;",$=Kt(T.shapeInfo.logicalShape)===1,it=Kt(R.logicalShape)===1;if(z!==1||$||it){if($&&!it)X=F===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(B.length){var tt=z-2,q=z-1;B.indexOf(tt)>-1&&B.indexOf(q)>-1?X="return vec4(outputValue.x);":B.indexOf(tt)>-1?X="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":B.indexOf(q)>-1&&(X="return vec4(outputValue.xx, outputValue.zz);")}}else X=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+V+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+O+"("+L+`);
      `+X+`
    }
  `})(y,x):(function(T,R){var D=T.name,N=D.charAt(0).toUpperCase()+D.slice(1),O="get"+N+"AtOutCoords",k=R.texShape,z=T.shapeInfo.texShape,F=T.shapeInfo.logicalShape.length,B=R.logicalShape.length;if(!T.shapeInfo.isUniform&&F===B&&T.shapeInfo.flatOffset==null&&Pn(z,k))return`
      float `+O+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var V,G=Xe(B),Q=ls(T.shapeInfo.logicalShape,R.logicalShape),L=B-F,X=["x","y","z","w","u","v"];V=F===0?"":B<2&&Q.length>=1?"coords = 0;":Q.map(function(it){return"coords."+X[it+L]+" = 0;"}).join(`
`);var $="";return $=B<2&&F>0?"coords":T.shapeInfo.logicalShape.map(function(it,tt){return"coords."+X[tt+L]}).join(", "),`
    float `+O+`() {
      `+G+` coords = getOutputCoords();
      `+V+`
      return get`+N+"("+$+`);
    }
  `})(y,x)),b})(g,e,n)}).join(`
`),f=e.texShape,h=tr(),d=(function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `})(h),m=(function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+NB+`
    `+TB+`
    `+RB+`
  `})(h);return e.isPacked?(i=(function(g,y){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(T,R){var D=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `})(0,y);case 2:return(function(T,R){var D=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)];if(Pn(T,R))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var N=Math.ceil(T[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+N+`);
      int c = imod(index, `+N+`) * 2;

      return ivec2(r, c);
    }
  `})(g,y);case 3:return x=g,w=y,b=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],C=Math.ceil(x[2]/2),A=C*Math.ceil(x[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;

      int b = index / `+A+`;
      index -= b * `+A+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(T,R){for(var D=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)],N=Math.ceil(T[T.length-1]/2),O=N*Math.ceil(T[T.length-2]/2),k=O,z="",F="b, r, c",B=2;B<T.length-1;B++)k*=T[T.length-B-1],z=`
      int b`+B+" = index / "+k+`;
      index -= b`+B+" * "+k+`;
    `+z,F="b"+B+", "+F;return`
    ivec`+T.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+z+`

      int b = index / `+O+`;
      index -= b * `+O+`;

      int r = 2 * (index / `+N+`);
      int c = imod(index, `+N+`) * 2;

      return ivec`+T.length+"("+F+`);
    }
  `})(g,y)}var x,w,b,C,A})(e.logicalShape,f),s=(function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `})(h)):(i=(function(g,y){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(b,C){return C[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return resTexRC.x * `+C[1]+` + resTexRC.y;
    }
  `})(0,y);case 2:return(function(b,C){return Pn(b,C)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `:b[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:b[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = index / `+b[1]+`;
      int c = index - r * `+b[1]+`;
      return ivec2(r, c);
    }
  `})(g,y);case 3:return x=y,w=cs(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+w+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(b,C){var A=cs(["r","c","d","d2"],b);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      `+A+`
      return ivec4(r, c, d, d2);
    }
  `})(g,y);case 5:return(function(b,C){var A=cs(["r","c","d","d2","d3"],b);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+C[0]+`,
                             `+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+A+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(g,y);case 6:return(function(b,C){var A=cs(["r","c","d","d2","d3","d4"],b);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+A+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(g,y);default:throw new Error(g.length+"-D output sampling is not yet supported")}var x,w})(e.logicalShape,f),s=(function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `})(h)),n&&(m+=_B),[m,d,s,u,i,c,t].join(`
`)}function ku(r){var e=r.shapeInfo.logicalShape;switch(e.length){case 0:return(function(t){var n=t.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=t.shapeInfo.texShape,s=i[0],u=i[1];if(s===1&&u===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=t.shapeInfo.texShape,f=c[0],h=c[1],d=ts(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+h+", "+d+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 1:return(function(t){var n=t.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+Ou(t)+`
      }
    `;var i=t.shapeInfo.texShape,s=i[0],u=i[1];if(u===1&&s===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=ts(n);return u===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+s+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+u+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+u+", index + "+c+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 2:return(function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=t.shapeInfo.texShape;if(s!=null&&Pn(n,s)){var u=s[0],c=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+u+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=co(n),h=f.newShape,d=f.keptDims,m=h;if(m.length<n.length){var g=Mu(t,m);return`
      `+ku(g)+`
      float `+i+`(int row, int col) {
        return `+i+"("+zu(["row","col"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+Ou(t)+`
      }
    `;var y=s[0],x=s[1],w=ts(a);return x===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+y+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:y===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+x+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+w+`;
    vec2 uv = uvFromFlat(`+y+", "+x+`, index);
    return sampleTexture(`+a+`, uv);
  }
`})(r);case 3:return(function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],u=n[2],c=co(n),f=c.newShape,h=c.keptDims,d=f;if(d.length<n.length){var m=Mu(t,d);return`
        `+ku(m)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+zu(["row","col","depth"],h)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+u+`, 1)));
        `+Ou(t)+`
      }
    `;var g=t.shapeInfo.texShape,y=g[0],x=g[1],w=t.shapeInfo.flatOffset;if(x===s&&w==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+u+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+x+".0, "+y+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(x===u&&w==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+x+".0, "+y+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var b=ts(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+u+" + depth + "+b+`;
        vec2 uv = uvFromFlat(`+y+", "+x+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `})(r);case 4:return(function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],u=n[2]*s,c=n[1]*u,f=co(n),h=f.newShape,d=f.keptDims;if(h.length<n.length){var m=Mu(t,h);return`
      `+ku(m)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+zu(["row","col","depth","depth2"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+u+", "+s+`, 1)));
        `+Ou(t)+`
      }
    `;var g=t.shapeInfo.flatOffset,y=t.shapeInfo.texShape,x=y[0],w=y[1];if(w===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+u+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(w===s&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var b=ts(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+x+", "+w+", index + "+b+`);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 5:return(function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[4],u=n[3]*s,c=n[2]*u,f=n[1]*c,h=co(n),d=h.newShape,m=h.keptDims;if(d.length<n.length){var g=Mu(t,d);return`
      `+ku(g)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+zu(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+u+", "+s+`)) +
          depth3;
        `+Ou(t)+`
      }
    `;var y=t.shapeInfo.flatOffset,x=t.shapeInfo.texShape,w=x[0],b=x[1];if(b===f&&y==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+u+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+b+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(b===s&&y==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+b+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=ts(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+u+` +
          depth2 * `+s+" + depth3 + "+C+`;
      vec2 uv = uvFromFlat(`+w+", "+b+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 6:return(function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=co(n),u=s.newShape,c=s.keptDims;if(u.length<n.length){var f=Mu(t,u);return`
      `+ku(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+zu(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var h=n[5],d=n[4]*h,m=n[3]*d,g=n[2]*m,y=n[1]*g;if(t.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+y+", "+g+", "+m+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+h+`, 1)));
        `+Ou(t)+`
      }
    `;var x=t.shapeInfo.flatOffset,w=t.shapeInfo.texShape,b=w[0],C=w[1];if(C===y&&x==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+d+", "+h+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+C+".0, "+b+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(C===h&&x==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+C+".0, "+b+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var A=ts(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+y+" + col * "+g+" + depth * "+m+` +
          depth2 * `+d+" + depth3 * "+h+" + depth4 + "+A+`;
      vec2 uv = uvFromFlat(`+b+", "+C+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function oO(r){var e,t,n;switch(r.shapeInfo.logicalShape.length){case 0:return e=r.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),n=tr(),`
    vec4 `+t+`() {
      return `+n.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return(function(a){var i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),u=a.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=tr();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `})(r);case 2:return(function(a){var i=a.shapeInfo.logicalShape,s=a.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=c[0],h=c[1],d=tr();if(c!=null&&Pn(i,c))return`
      vec4 `+u+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+h+".0, "+f+`.0);

        return `+d.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(i[1]/2);return`
    vec4 `+u+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+d.texture2D+"("+s+`, uv);
    }
  `})(r);case 3:return(function(a){var i=a.shapeInfo.logicalShape,s=a.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var h=i.slice(1),d=Mu(a,h);return`
        `+oO(d)+`
        vec4 `+u+`(int b, int row, int col) {
          return `+u+"("+zu(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],y=Math.ceil(i[2]/2),x=y*Math.ceil(i[1]/2),w=tr();return`
    vec4 `+u+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+x+", "+y+`, b, row, col);
      return `+w.texture2D+"("+s+`, uv);
    }
  `})(r);default:return(function(a){for(var i=a.shapeInfo.logicalShape,s=i.length,u=a.name,c="get"+u.charAt(0).toUpperCase()+u.slice(1),f=a.shapeInfo.texShape,h=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],d=h[0],m=h[1],g=Math.ceil(i[s-1]/2),y=g*Math.ceil(i[s-2]/2),x="int b, int row, int col",w="b * "+y+" + (row / 2) * "+g+" + (col / 2)",b=2;b<s-1;b++)x="int b"+b+", "+x,y*=i[s-b-1],w="b"+b+" * "+y+" + "+w;var C=tr();return`
    vec4 `+c+"("+x+`) {
      int index = `+w+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+d+`);
      return `+C.texture2D+"("+u+`, uv);
    }
  `})(r)}}var NB=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,TB=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,RB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_B=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ts(r){return"offset"+r}function Ou(r){var e=r.name,t=Kt(r.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Xe(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function Mu(r,e){var t=JSON.parse(JSON.stringify(r));return t.shapeInfo.logicalShape=e,t}function zu(r,e){return e.map(function(t){return r[t]}).join(", ")}var OB=(function(){return function(r,e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,K(r.length>2,function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."});var a=r[r.length-1],i=Math.ceil(a/e);this.outputShape=r.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,f=c.length,h=Xe(f),d=Sr("coords",f);if(i===1){var m=Xe(u=f+1);s=`
        `+m+" sourceLocR = "+m+"("+d.join()+`, 0);
        ++`+d[f-1]+`;
        `+m+" sourceLocG = "+m+"("+d.join()+`, 0);
        ++`+d[f-2]+`;
        `+m+" sourceLocA = "+m+"("+d.join()+`, 0);
        --`+d[f-1]+`;
        `+m+" sourceLocB = "+m+"("+d.join()+`, 0);
        --`+d[f-2]+";"}else u=f,s=`
        `+h+` sourceLocR = coords;
        ++`+d[f-1]+`;
        `+h+` sourceLocG = coords;
        ++`+d[f-2]+`;
        `+h+` sourceLocA = coords;
        --`+d[f-1]+`;
        `+h+` sourceLocB = coords;
        --`+d[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,u),y="."+g[u-1],x=g.map(function(O){return"int "+O}),w=Sr("sourceLocR",u-1).concat("inIdx.r"),b=Sr("sourceLocG",u-1).concat("inIdx.g"),C=Sr("sourceLocB",u-1).concat("inIdx.b"),A=Sr("sourceLocA",u-1).concat("inIdx.a"),T=t==="max"?"greaterThan":"lessThan",R=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+b.join()+`),
                             getBestIndicesAChannel(`+C.join()+`),
                             getBestIndicesAChannel(`+A.join()+")));",D=`vec4(
            getAChannel(`+w.join()+`),
            hasNextCol ? getAChannel(`+b.join()+`) : 0.,
            hasNextRow ? getAChannel(`+C.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+A.join()+") : 0.)",N=n?"":`
      float getBestIndicesAChannel(`+x.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+x.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+N+`
      void main() {
        `+h+` coords = getOutputCoords();
        bool hasNextCol = `+d[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+d[f-2]+" < "+(c[f-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+y+", sourceLocG"+y+`,
          sourceLocB`+y+", sourceLocA"+y+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+R+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+T+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}})(),DB=(function(){return function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var e=r.filterHeight,t=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dilationHeight,s=r.dilationWidth,u=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=u-1-r.padInfo.top,h=c-1-r.padInfo.left,d=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+h+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+u+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}})(),IB=(function(){return function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var e=r.filterDepth,t=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=h-1-r.padInfo.front,y=d-1-r.padInfo.top,x=m-1-r.padInfo.left,w=1/(e*t*n);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+y+", "+x+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+u+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),kB=(function(){return function(r,e,t,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ge(r,e),ge(r,t);var s="0.0";n!=null&&(ge(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";a!=null&&(ge(r,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+u+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}})(),MB=(function(){return function(r,e,t,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ge(r,e),ge(r,t);var s="vec4(0.0)";n!=null&&(ge(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";a!=null&&(ge(r,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+u+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `}})(),zB="return areal * breal - aimag * bimag;",FB="return areal * bimag + aimag * breal;",nA=(function(){return function(r,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ge(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}})(),Fy="return a + b;",By="return a - b;",rA="return a * b;",sO="return (a < 0.) ? b * a : a;",dn=(function(){return function(r,e,t){this.variableNames=["A","B"],this.outputShape=ge(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}})(),uO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,pi=(function(){return function(r,e,t,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ge(e,t);var a=this.outputShape.length,i="";if(n)if(a===0||Kt(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Xe(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Sr("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+s[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+s[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `}})(),BB=(function(){function r(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,t)}},r})(),LB=(function(){function r(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,t)}},r})(),UB=(function(){return function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}})(),jB=(function(){return function(r){this.outputShape=[],this.outputShape=xs(r,1),this.variableNames=r.map(function(u,c){return"T"+c});var e=new Array(r.length-1);e[0]=r[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+r[t][1];var n=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var a=e[t-1];n.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+a+"));")}var i=e.length,s=e[e.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `}})(),PB=(function(){return function(r,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=xs(r,e);var t=this.outputShape,n=t.length,a=Xe(n),i=Sr("coords",n),s=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map(function(w,b){return"T"+b});var u=new Array(r.length-1);u[0]=r[0][e];for(var c=1;c<u.length;c++)u[c]=u[c-1]+r[c][e];var f=s[e],h=s.slice(-2),d=s.join(),m="if ("+f+" < "+u[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+h.join()+`));
        }`;for(c=1;c<u.length;c++){var g=u[c-1];m+=`
        if (`+f+" < "+u[c]+"  && "+f+" >= "+u[c-1]+`) {
          return getChannel(
            getT`+c+"("+cp(s,f,g)+`),
            vec2(`+cp(h,f,g)+`));
        }`}var y=u.length,x=u[u.length-1];m+=`
        return getChannel(
          getT`+y+"("+cp(s,f,x)+`),
          vec2(`+cp(h,f,x)+"));",this.userCode=`
      float getValue(`+s.map(function(w){return"int "+w})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+t[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+t[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+t[n-2]+` &&
            `+i[n-1]+" < "+t[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `}})();function cp(r,e,t){var n=r.indexOf(e);return r.map(function(a,i){return i===n?a+" - "+t:a}).join()}var VB=(function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var e=r.strideHeight,t=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),qB=(function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var e=r.filterHeight,t=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dataFormat==="channelsLast",s=e-1-r.padInfo.top,u=t-1-r.padInfo.left,c=i?1:2,f=i?2:3,h=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+h+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),WB=(function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var e=r.strideDepth,t=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,i=r.padInfo.top,s=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+i+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+s+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),HB=(function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var e=r.filterDepth,t=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=e-1-r.padInfo.front,c=t-1-r.padInfo.top,f=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+u+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),GB=(function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var e=r.strideHeight,t=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),XB=(function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var e=r.filterHeight,t=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=e-1-r.padInfo.top,s=t-1-r.padInfo.left,u=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+u+`; dm++) {
              int d2 = d1 * `+u+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),aA=(function(){return function(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,i=r.padInfo.left,s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,f=r.dilationWidth,h=r.filterHeight,d=r.filterWidth,m=4*Math.floor(r.inChannels/4),g=r.inChannels%4,y=r.dataFormat==="channelsLast",x=y?1:2,w=y?2:3,b=y?3:1,C="",A="";t&&(C=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,A="result = activation(result);");var T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+s+", "+u+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+b+`];

        ivec2 xRCCorner =
            ivec2(coords[`+x+"], coords["+w+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+y+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+y+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+y+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+y+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+T+`
        `+A+`
        setOutput(result);
      }
    `}})(),KB=(function(){return function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var e=r.padInfo.front,t=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,h=r.filterDepth,d=r.filterHeight,m=r.filterWidth,g=4*Math.floor(r.inChannels/4),y=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+h+`; wF++) {
          int xF = xFCorner + wF * `+u+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(y===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(y===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(y===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),iA=(function(){return function(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,u=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,h=r.dilationHeight,d=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,y=r.outChannels/r.inChannels,x="",w="";t&&(x=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,w="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+y+`;
        int q = d2 - d1 * `+y+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+h+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+b+`
        `+w+`
        setOutput(result);
      }
    `}})(),oA=(function(){return function(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,u=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,h=r.dilationHeight,d=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,y=g,x="int xR; int xC; int xCOffset;",w=0;w<m;w++)for(var b=0;b<g;b++)x+=`
          vec4 xTexelR`+w+"C"+2*b+` = vec4(0.);
          vec4 wR`+w+"C"+b+` = vec4(0.);
          vec4 xR`+w+"C"+b+" = vec4(0.);";for(w=0;w<m;w++)for(var C=0;C<y;C++){if(x+=`
          xR = xRCorner + `+w*h+`;
          xC = xCCorner + `+(b=2*C)*d+`;
        `,f===1){if(b<g&&(x+=u%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+w+"C"+b+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+b+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);
                  xR`+w+"C"+b+" = vec4(previous.zw, xTexelR"+w+"C"+b+`.xy);
                } else {
                  xR`+w+"C"+b+" = vec4(0, 0, xTexelR"+w+"C"+b+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+w+"C"+b+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+b+` = vec4(0.);
                }

                xR`+w+"C"+b+" = xTexelR"+w+"C"+b+`;
              `,b+1<g)){var A=u%2==0?A1(d):d;d%2==0&&u%2==1||d%2!=0&&u%2!=1?(x+=`
                  xCOffset = xC + `+u%2+" + "+A+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(b+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(x+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+w+"C"+b+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+w+"C"+b+` = vec4(0.);
                    }
                  `),x+=`
                  xR`+w+"C"+(b+1)+` = vec4(
                    xTexelR`+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+`.xy);
                `):x+=`
                  xCOffset = xC + `+A+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+w+"C"+(b+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+w+"C"+(b+1)+" = xTexelR"+w+"C"+(b+2)+`;
                `}}else b<g&&(x+=`
              if(xR >= 0 && xR < `+a+`) {
            `,u%2==1?(x+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+b+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+b+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+w+"C"+(b+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+w+"C"+(b+2)+` = vec4(0.);
                }

                xR`+w+"C"+b+` = vec4(
                  xTexelR`+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+`.zw);
              `,b+1<g&&(x+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+w+"C"+(b+1)+" = vec4(xTexelR"+w+"C"+(b+2)+`.xy, final.xy);
                `)):(x+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+w+"C"+b+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+b+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+w+"C"+(b+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+(b+2)+` = vec4(0.);
                }

                xR`+w+"C"+b+` = vec4(
                  xTexelR`+w+"C"+b+".xy, xTexelR"+w+"C"+(b+2)+`.xy);
              `,b+1<g&&(x+=`
                  xR`+w+"C"+(b+1)+` = vec4(
                    xTexelR`+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+`.zw);
                `)),x+="}");b<g&&(x+=`
            vec4 wTexelR`+w+"C"+b+" = getW("+w+", "+b+`, d1, q);
            wR`+w+"C"+b+" = vec4(wTexelR"+w+"C"+b+".xz, wTexelR"+w+"C"+b+`.xz);
          `,b+1<g&&(x+=`
              vec4 wTexelR`+w+"C"+(b+1)+" = getW("+w+", "+(b+1)+`, d1, q);
              wR`+w+"C"+(b+1)+` =
                vec4(wTexelR`+w+"C"+(b+1)+".xz, wTexelR"+w+"C"+(b+1)+".xz);"))}for(w=0;w<m;w++)for(b=0;b<g;b++)x+="dotProd += xR"+w+"C"+b+" * wR"+w+"C"+b+";";var T="",R="";t&&(T=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,R="result = activation(result);");var D=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+T+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+u+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+x+`

        vec4 result = dotProd;
        `+D+`
        `+R+`
        setOutput(result);
      }
    `}})(),YB=(function(){return function(r,e,t,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=r[0],s=r[1],u=r[2],c=r[3],f=e[0],h=t[0],d=t[1];this.outputShape=[f,h,d,c];var m=n==="bilinear"?1:0,g=[s-1+".0",u-1+".0"],y=g[0],x=g[1],w=h>1?[""+(s-1)/(h-1),"(y2-y1) * height_ratio","y1*"+y+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+y],b=w[0],C=w[1],A=w[2],T=d>1?[""+(u-1)/(d-1),"(x2-x1) * width_ratio","x1*"+x+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+x],R=T[0],D=T[1],N=T[2];this.userCode=`
      const float height_ratio = float(`+b+`);
      const float width_ratio = float(`+R+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+C+`;
        float width_scale = `+D+`;

        float in_y = `+A+`;
        if( in_y < 0.0 || in_y > `+y+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+N+`;
        if( in_x < 0.0 || in_x > `+x+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}})(),$B=(function(){return function(r,e,t){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],i=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Xe(n)+` coords = getOutputCoords();
        int end = `+sA(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+sA(n,"coords")+` = idx;
          val += getX(`+(function(s,u){if(s===1)return""+u;if(s===2)return u+".x, "+u+".y";if(s===3)return u+".x, "+u+".y, "+u+".z";if(s===4)return u+".x, "+u+".y, "+u+".z, "+u+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")})(n,"coords")+`);
        }
        setOutput(val);
      }
    `}})();function sA(r,e){if(r===1)return""+e;if(r===2)return e+".y";if(r===3)return e+".z";if(r===4)return e+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var QB=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Fc.DENSE;var e=Nc(r),t=tr();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+cs(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `}})(),ZB=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Fc.DENSE;var e=Nc(r),t=tr();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+cs(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `}})(),JB=(function(){function r(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r})(),tL=(function(){return function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}})(),eL=(function(){return function(r){this.variableNames=["A"],this.outTexUsage=Mr.DOWNLOAD;var e=tr();this.outputShape=r,this.userCode=`
      `+iO+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `}})(),nL=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mr.DOWNLOAD;var e=tr();this.outputShape=r,this.userCode=`
      `+iO+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `}})(),rL=(function(){return function(r,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var n=tr(),a=e[0],i=e[1];this.outputShape=r;var s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Z1(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `}})(),aL=(function(){return function(r,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=tr(),a=e[0],i=e[1];this.outputShape=r;var s="",u="result";t&&(u="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var h=2*c+f;s+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+r[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+r[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+h+`] = values[0];
              } else if(offset == 1) {
                result[`+h+`] = values[1];
              } else if(offset == 2) {
                result[`+h+`] = values[2];
              } else {
                result[`+h+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Z1(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+n.output+" = "+u+`;
      }
    `}})(),iL="return real * expR - imag * expI;",oL="return real * expI + imag * expR;",uA=(function(){return function(r,e,t){this.variableNames=["real","imag"];var n=e[1];this.outputShape=e;var a=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=t?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}})(),sL=(function(){function r(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,a){t.valueLoc==null&&(t.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(t.valueLoc,e)}},r})(),uL=(function(){return function(r){this.variableNames=["A"];var e=tr(),t=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}})(),lL=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=tr(),t=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `}})(),cL=(function(){return function(r,e,t){this.variableNames=["A","indices"];var n=r.slice();n[t]=e,this.outputShape=n,this.rank=n.length;var a=Xe(this.rank),i=(function(s,u){var c=s.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],h=[],d=0;d<s.length;d++)d===u?h.push("int(getIndices("+f[d]+"))"):h.push(""+f[d]);return h.join()})(r,t);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `}})(),fL=(function(){return function(r,e,t){this.sliceDim=r,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var n=Xe(e.length),a=Xe(t.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}})();function lO(r,e){var t=tr();return r_(r,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function cO(r,e){return s_(r,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function fO(r,e){return u_(r,e,new Uint16Array([0,1,2,2,1,3]))}function sf(r,e,t,n,a,i,s){c_(t,n);var u=l_(r,e),c=r.TEXTURE_2D;return Vt(r,e,function(){return r.bindTexture(c,u)}),Vt(r,e,function(){return r.texParameteri(c,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)}),Vt(r,e,function(){return r.texParameteri(c,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)}),Vt(r,e,function(){return r.texParameteri(c,r.TEXTURE_MIN_FILTER,r.NEAREST)}),Vt(r,e,function(){return r.texParameteri(c,r.TEXTURE_MAG_FILTER,r.NEAREST)}),Vt(r,e,function(){return r.texImage2D(c,0,a,t,n,0,i,s,null)}),Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,null)}),u}function hO(r,e,t,n,a){var i=Dd(t,n);return sf(r,e,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function pO(r,e,t,n,a){var i=Dd(t,n);return sf(r,e,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function dO(r,e,t,n,a){var i=Dd(t,n);return sf(r,e,i[0],i[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function mO(r,e,t,n,a){var i=Zc(t,n);return sf(r,e,i[0],i[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function vO(r,e,t,n,a){var i=Zc(t,n);return sf(r,e,i[0],i[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function gO(r,e,t,n){return Vt(r,e,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),Tb(r,e,t,"clipSpacePos",n,3,20,0)&&Tb(r,e,t,"uv",n,2,20,12)}function yO(r,e,t,n,a,i,s){var u,c,f;Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,t)}),i instanceof Uint8Array?(u=new Uint8Array(n*a*4),c=r.UNSIGNED_BYTE,f=r.RGBA):(u=new Float32Array(n*a*4),c=r.FLOAT,f=s.internalFormatPackedFloat),u.set(i),Vt(r,e,function(){return r.texImage2D(r.TEXTURE_2D,0,f,n,a,0,r.RGBA,c,u)}),Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function bO(r,e,t,n){Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,t)}),n.data instanceof Uint8Array?Vt(r,e,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)}):Vt(r,e,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)}),Vt(r,e,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function xO(r,e,t,n,a){var i=r.createBuffer();Vt(r,e,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,i)});var s=16*t*n;return Vt(r,e,function(){return r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)}),Vt(r,e,function(){return r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,0)}),Vt(r,e,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}),i}function wO(r,e,t){var n=r,a=new Float32Array(t);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function SO(r,e,t,n,a){var i=Dd(t,n),s=i[0],u=i[1],c=new Uint8Array(t*n*4);return Vt(r,e,function(){return r.readPixels(0,0,s,u,a.downloadTextureFormat,r.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function EO(r,e,t,n,a,i,s,u){var c=r,f=new Float32Array((function(h,d){var m=Zc(h,d);return m[0]*m[1]*4})(i,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function CO(r,e,t,n){var a=new Float32Array(t*n*4);return Vt(r,e,function(){return r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,a)}),a}var hL=Object.freeze({createVertexShader:lO,createVertexBuffer:cO,createIndexBuffer:fO,createFloat32MatrixTexture:hO,createFloat16MatrixTexture:pO,createUnsignedBytesMatrixTexture:dO,createPackedMatrixTexture:mO,createFloat16PackedMatrixTexture:vO,bindVertexProgramAttributeStreams:gO,uploadDenseMatrixToTexture:yO,uploadPixelDataToTexture:bO,createBufferFromOutputTexture:xO,downloadFloat32MatrixFromBuffer:wO,downloadByteEncodedFloatMatrixFromOutputTexture:SO,downloadPackedMatrixFromBuffer:EO,downloadMatrixFromPackedOutputTexture:CO}),AO=(function(){function r(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=yt().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,JR(t,e)):this.gl=Ha(t),yt().getNumber("WEBGL_VERSION")===1)this.textureFloatExtension=Op(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Op(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(ca(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!ca(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=cO(this.gl,this.debug),this.indexBuffer=fO(this.gl,this.debug),this.framebuffer=f_(this.gl,this.debug),this.textureConfig=D1(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return yt().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Vt(t,this.debug,function(){return t.finish()}),Vt(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),Vt(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),Vt(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),Vt(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),Vt(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),hO(this.gl,this.debug,e,t,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),pO(this.gl,this.debug,e,t,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),dO(this.gl,this.debug,e,t,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),bO(this.gl,this.debug,e,t)},r.prototype.uploadDenseMatrixToTexture=function(e,t,n,a){this.throwIfDisposed(),yO(this.gl,this.debug,e,t,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),vO(this.gl,this.debug,e,t,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),mO(this.gl,this.debug,e,t,this.textureConfig)},r.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Rb(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Vt(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var a=this;return this.downloadMatrixDriver(e,function(){return SO(a.gl,a.debug,t,n,a.textureConfig)})},r.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,a,i,s){return EO(this.gl,e,0,0,0,i,s,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return wO(this.gl,e,t)},r.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var a=xO(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},r.prototype.createFence=function(e){var t,n,a=this;if(yt().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var u=i.clientWaitSync(s,0,0);return u===i.ALREADY_SIGNALED||u===i.CONDITION_SATISFIED},t=s}else yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(t,yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var a=this;return this.downloadMatrixDriver(e,function(){return CO(a.gl,a.debug,t,n)})},r.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=a_(t,this.debug,e),a=lO(t,this.debug),i=i_(t,this.debug);return Vt(t,this.debug,function(){return t.attachShader(i,a)}),Vt(t,this.debug,function(){return t.attachShader(i,n)}),o_(t,this.debug,i),this.debug&&kp(t,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=gO(t,this.debug,this.program,this.vertexBuffer)),i},r.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Vt(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},r.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&kp(this.gl,this.debug,this.program),Vt(this.gl,this.debug,function(){return t.gl.useProgram(e)})},r.prototype.getUniformLocation=function(e,t,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?p_(this.gl,this.debug,e,t):d_(this.gl,e,t)},r.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),Vt(this.gl,this.debug,function(){return n.gl.getAttribLocation(e,t)})},r.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},r.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),m_(this.gl,this.debug,this.program,e,t,n)},r.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},r.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var a=Zc(t,n),i=a[0],s=a[1];this.setOutputMatrixTextureDriver(e,i,s)},r.prototype.setOutputMatrixWriteRegion=function(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)},r.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&kp(this.gl,this.debug,this.program),xc(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Vt(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},r.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Vt(this.gl,this.debug,function(){return e.gl.finish()})},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Op(this.gl,this.debug,yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},r.prototype.endQuery=function(){if(yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(e){return Ht(this,void 0,void 0,function(){var t=this;return Gt(this,function(n){switch(n.label){case 0:return[4,wb(function(){return t.disposed||t.isQueryAvailable(e,yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(e,yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},r.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(e,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},r.prototype.pollFence=function(e){var t=this;return new Promise(function(n){t.addItemToPoll(function(){return e.isFencePassed()},function(){return n()})})},r.prototype.pollItems=function(){for(var e=(function(n){for(var a=0;a<n.length;++a){var i=n[a]();if(!i)break}return a-1})(this.itemsToPoll.map(function(n){return n.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},r.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||wb(function(){return n.pollItems(),n.itemsToPoll.length===0})},r.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Mp(this.gl,this.debug,e,this.framebuffer),this.debug&&xc(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Mp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&xc(this.gl)):Rb(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var a=this.gl;Mp(a,this.debug,e,this.framebuffer),this.debug&&xc(a),this.outputTexture=e,Vt(a,this.debug,function(){return a.viewport(0,0,t,n)}),Vt(a,this.debug,function(){return a.scissor(0,0,t,n)})},r.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,a){var i=this;this.throwIfDisposed(),Vt(this.gl,this.debug,function(){return i.gl.scissor(e,t,n,a)})},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r})();function lA(r,e){if(r.length!==e.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+e.length+" inputs");r.forEach(function(t,n){var a=t.logicalShape,i=e[n],s=i.shape;if(!Pn(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+s+" must match");if(!t.isUniform||!i.isUniform){var u=t.texShape,c=i.isUniform?null:i.texData.texShape;if(!Pn(u,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+u+" and "+c+" must match")}})}var pL=(function(){return function(r,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=t.filterWidth,a=t.inChannels,i=t.strideWidth,s=t.strideHeight,u=t.padInfo,c=t.outWidth,f=t.dilationWidth,h=t.dilationHeight,d=t.dataFormat,m=u.left,g=u.top,y=a*n,x=tr(),w=d==="channelsLast",b=w?0:1,C=w?1:2,A="",T=0;T<=1;T++)for(var R=0;R<=1;R++)A+=`
          blockIndex = rc.y + `+R+`;
          pos = rc.x + `+T+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+s+" - "+g+`;
            d0 = offsetY + `+h+" * (pos / "+y+`);

            if(d0 < `+e[b]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+y+".) / "+a+`.));

              if(d1 < `+e[C]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+w+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*T+R)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*T+R)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+A+`

        `+x.output+` = result;
      }
    `}})(),dL=(function(){return function(r,e,t,n,a){this.variableNames=["x"],this.outputShape=[];var i,s=e,u=r[3]-1;this.outputShape=r;var c="float("+t+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+u+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `}})(),mL=(function(){return function(r,e,t,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=e,this.bias=t,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}})(),vL=(function(){return function(r,e,t,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=e,u=r[3]-1;this.outputShape=r;var c="float("+t+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+u+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `}})(),gL=(function(){return function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var e=r.strideHeight,t=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,i=r.effectiveFilterWidth,s=a-1-r.padInfo.top,u=i-1-r.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}})(),yL=(function(){return function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var e=r.strideDepth,t=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,i=r.dilationHeight,s=r.dilationWidth,u=r.effectiveFilterDepth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=u-1-r.padInfo.front,d=c-1-r.padInfo.top,m=f-1-r.padInfo.left,g=u*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+d+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+u+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}})(),Ly=(function(){return function(r,e,t,n,a,i,s){t===void 0&&(t=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var u=t?r[1]:r[2],c=Math.ceil(u/2),f=t?"i * 2, rc.y":"rc.y, i * 2",h=n?"rc.z, i * 2":"i * 2, rc.z",d=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",y="";i&&(g=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,y="result = activation(result);");var x=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+h+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+m[0]+`);
          result += (`+d[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+x+`

        `+y+`

        setOutput(result);
      }
    `}})(),bL=(function(){function r(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,a){t.seedLoc==null&&(t.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(t.seedLoc,e)}},r})(),xL=(function(){return function(r,e,t,n){this.variableNames=["indices"],this.outputShape=[r,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+t+`),
                      float(index == coords.y)));
      }
    `}})(),wL=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var e=r.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=Sr("rc",e),n=Xe(e),a=(function(u,c,f){if(u===1)return"rc > "+c[0];for(var h="",d=u-2;d<u;d++)h+=f[d]+" >= "+c[d],d<u-1&&(h+="||");return h})(e,r,t),i=(function(u,c,f,h){if(u===1)return"";var d=h.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `})(e,r[r.length-1],r[r.length-2],t),s=(function(u,c){var f=u.length,h=(function(d,m){for(var g=[],y=0;y<=1;y++)for(var x=0;x<=1;x++){for(var w=(y===0?"r":"rp1")+", "+(x===0?"c":"cp1"),b=2;b<d;b++)w=m[m.length-1-b]+","+w;g.push(w)}return g})(f,c);return f===1?`getA(rc),
            rc + 1 >= `+u[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+h[0]+`),
          cEdge ? 0. : getA(`+h[1]+`),
          rEdge ? 0. : getA(`+h[2]+`),
          rEdge || cEdge ? 0. : getA(`+h[3]+")"})(r,t);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}}})(),SL=(function(){return function(r,e,t){this.variableNames=["x"],this.outputShape=e.map(function(c,f){return c[0]+r[f]+c[1]});var n=r.length,a=Xe(n),i=e.map(function(c){return c[0]}).join(","),s=e.map(function(c,f){return c[0]+r[f]}).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+u+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}})(),EL=(function(){return function(r,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(w,b){return w[0]+r[b]+w[1]});for(var n=r.length,a=Xe(n),i=e.map(function(w){return w[0]}).join(","),s=e.map(function(w,b){return w[0]+r[b]}).join(","),u=Sr("rc",n),c=Sr("source",n),f=u[n-1]+" < "+this.outputShape[n-1],h=n===1?"source":"vec2("+c.slice(-2).join()+")",d=[a+" rc = outputLoc;",u[n-1]+` += 1;
       if(`+f+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+u[n-2]+` += 1;
       if(`+u[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+u[n-1]+` += 1;
         if(`+f+") {"],m=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",y=0,x=n===1?2:4;y<x;y++)g+=`
        `+d[y]+`
        if (`+m+`) {
          result[`+y+"] = float("+t+`);
        } else {
          `+a+` source = rc - start;
          result[`+y+"] = getChannel(getX("+c.join()+"), "+h+`);
        }
      `;g+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `}})(),Uy=(function(){return function(r,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=r.padInfo.top,d=r.padInfo.left;this.outputShape=r.outShape;var m=e==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+h+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var x=4*Math.floor(n/4),w=n%4,b=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+h+", "+d+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+x+`; wC += 4) {
            int xC = xCCorner + wC * `+u+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+u+`, d),
              getValue(batch, xR, xC + 2 * `+u+`, d),
              getValue(batch, xR, xC + 3 * `+u+`, d)
            );

            `+b+`
          }

          int xC = xCCorner + `+x+`;
          if (`+(w===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+b+`
          } else if (`+(w===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+u+`, d),
              initializationValue,
              initializationValue
            );

            `+b+`
          } else if (`+(w===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+u+`, d),
              getValue(batch, xR, xC + 2 * `+u+`, d),
              initializationValue
            );

            `+b+`
          }
        }
        setOutput(`+y+`);
      }
    `}}})(),jy=(function(){return function(r,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=r.padInfo.front,y=r.padInfo.top,x=r.padInfo.left;this.outputShape=r.outShape;var w=e==="avg",b="0.0";if(w||(b="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+g+", "+y+", "+x+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+h+`;
              wD += `+u+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var C=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(C="avgValue / count");var A=4*Math.floor(n/4),T=n%4,R=`
      if (`+w+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+g+", "+y+", "+x+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+u+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+A+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+R+`
            }

            int xC = xCCorner + `+A+`;
            if (`+(T===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+R+`
            } else if (`+(T===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+R+`
            } else if (`+(T===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+R+`
            }
          }
          setOutput(`+C+`);
        }
      }
    `}}})(),CL=(function(){return function(r,e){this.variableNames=["x"];var t=r.windowSize,n=r.batchSize,a=r.inSize,i=Math.ceil(a/t);this.outputShape=[n,i];var s="0.0",u="";e==="prod"?s="1.0":e==="min"?(s="1.0 / 1e-20",u="min"):e==="max"&&(s="-1.0 / 1e-20",u="max");var c=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?c="sumValue":e==="prod"?c="prodValue":e==="all"?c="allValue":e==="any"&&(c="anyValue");var f=4*Math.floor(t/4),h=t%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+u+`(values, minMaxValue);
      }
    `,m="vec4";e==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):e==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%t>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(h===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+c+`);
      }
    `}})(),AL=(function(){return function(r,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var t="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),t+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+cs(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+Z1(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+t+`

        setOutput(result);
      }
    `}})(),NL=(function(){return function(r,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var n=e.shape,a=n[1],i=n[2],s=r.shape,u=s[1],c=s[2],f=[t&&u>1?a-1:a,t&&c>1?i-1:i],h=[t&&u>1?u-1:u,t&&c>1?c-1:c],d=f[0]/h[0],m=f[1]/h[1],g=1/d,y=1/m,x=2*Math.ceil(g)+2,w=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+x+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+u+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}})(),TL=(function(){return function(r,e,t,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],u=r[3];this.outputShape=[a,e,t,u];var c=[n&&e>1?i-1:i,n&&t>1?s-1:s],f=[n&&e>1?e-1:e,n&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}})(),RL=(function(){return function(r,e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],i=r[1],s=r[2],u=r[3];this.outputShape=[a,e,t,u];var c=[n&&e>1?i-1:i,n&&t>1?s-1:s],f=[n&&e>1?e-1:e,n&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(u-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}})(),_L=(function(){return function(r,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var n=e.shape,a=n[1],i=n[2],s=r.shape,u=s[1],c=s[2],f=[t&&u>1?a-1:a,t&&c>1?i-1:i],h=[t&&u>1?u-1:u,t&&c>1?c-1:c],d=f[0]/h[0],m=f[1]/h[1],g=1/d,y=1/m,x=2*Math.ceil(g)+2,w=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+x+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+u+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+h[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+h[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}})(),OL=(function(){return function(r,e,t,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],u=r[3];this.outputShape=[a,e,t,u];var c=[n&&e>1?i-1:i,n&&t>1?s-1:s],f=[n&&e>1?e-1:e,n&&t>1?t-1:t],h=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+h+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}})(),DL=(function(){return function(r,e){this.variableNames=["x"];var t=r.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=r,t!==1){var n=r.map(function(i,s){return(function(u){return e.indexOf(u)!==-1&&r[u]!==1?r[u]+" - coords["+u+"] - 1":"coords["+u+"]"})(s)}).join(","),a=Xe(t);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `}})(),IL=(function(){return function(r,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=r.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=r;var n=Sr("rc",t),a=n[t-1]+" + 1 < "+this.outputShape[t-1],i=n[t-2]+" + 1 < "+this.outputShape[t-2],s=Xe(t);function u(c){var f=r.map(function(h,d){return(function(m,g){return e.indexOf(m)!==-1&&r[m]!==1?r[m]+" - "+g[m]+" - 1":""+g[m]})(d,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(c){return u(c)})(n.slice())+`;
          if(`+a+`){
            result.g = `+(function(c){return c[t-1]="("+c[t-1]+" + 1)",u(c)})(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+(function(c){return c[t-2]="("+c[t-2]+" + 1)",u(c)})(n.slice())+`;
            if(`+a+`) {
              result.a = `+(function(c){return c[t-1]="("+c[t-1]+" + 1)",c[t-2]="("+c[t-2]+" + 1)",u(c)})(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `}})(),cA=(function(){return function(r,e,t,n,a,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var u=Xe(a.length),c=Xe(i.length),f="";t===1?f="i":t===2&&(f="i, j");var h="getIndices("+f+")",d="";n===1?d="i":n===2&&(d="i, coords[1]");var m="getUpdates("+d+")",g=e>1?"strides[j]":"strides";this.userCode=`
        `+u+" strides = "+u+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+h+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}})(),kL=(function(){return function(r,e){this.variableNames=["x","segmentIds"];var t=r.windowSize,n=r.batchSize,a=r.inSize,i=r.numSegments,s=i*Math.ceil(a/t);this.outputShape=[n,s];var u=4*Math.floor(t/4),c=t%4,f=`
        sumValue += dot(values, segFilter);
    `,h="";a%t>0&&(h=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var d="";a%t>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+u+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+u+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `}})(),ML=(function(){return function(r,e,t){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<e.length;c++)u.push(""+i[c]),c<r&&s.push(""+i[c]);n=s.join(),a=u.join()}var f=Xe(t);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `}})(),zL=(function(){function r(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Xe(this.rank),a="uniform int start["+this.rank+"];",i=(function(s){if(s===1)return"sourceLoc";if(s<=6)return Py.slice(0,s).map(function(u){return"sourceLoc."+u}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")})(this.rank);t=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+e.map(function(s,u){return"sourceLoc."+Py[u]+" = start["+u+"] + coords."+Py[u]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+t+`
        setOutput(getSource(`+i+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){t.startLoc==null&&(t.startLoc=n.getUniformLocationNoThrow(a,"start"),t.startLoc==null)||n.gl.uniform1iv(t.startLoc,e)}},r})(),Py=["x","y","z","w","u","v"],FL=(function(){function r(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Xe(this.rank),n=Sr("coords",this.rank),a=Sr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",s="getChannel(getSource("+a.join()+"), "+i+")",u=`
      result.x = `+s+`;
      if (++`+n[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+s+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+n[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map(function(h,d){return"start["+d+"]"}).join()+");":e.map(function(h,d){return a[d]+" = "+n[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+u+`
        `+c+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){t.startLoc==null&&(t.startLoc=n.getUniformLocationNoThrow(a,"start"),t.startLoc==null)||n.gl.uniform1iv(t.startLoc,e)}},r})(),BL=(function(){return function(r,e,t){this.variableNames=["x"],this.outputShape=t;var n=t.length,a=Xe(t.length),i=Xe(t.length),s="";if(n===1)s="coords * strides + begin";else{var u=0;s=t.map(function(c,f){return u++,t.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(u-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `}})(),LL=(function(){function r(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(e,t,n){var a,i=fA(t,n),s=hA(e,i,n);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var u=this.freeTextures[s].shift();return this.usedTextures[s].push(u),u}return this.numUsedTextures++,this.log(),i===kr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===kr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===kr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===kr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===kr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(a),a},r.prototype.releaseTexture=function(e,t,n,a){if(this.freeTextures!=null){var i=hA(t,fA(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],u=s.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(u,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(n){e.gpgpu.deleteMatrixTexture(n)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(a){e.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r})();function fA(r,e){if(r===Mr.UPLOAD)return kr.PACKED_2X2_FLOAT32;if(r===Mr.RENDER||r==null)return(function(t){return yt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?kr.PACKED_2X2_FLOAT32:kr.UNPACKED_FLOAT32:t?kr.PACKED_2X2_FLOAT16:kr.UNPACKED_FLOAT16})(e);if(r===Mr.DOWNLOAD||r===Mr.PIXELS)return kr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function hA(r,e,t){return r[0]+"_"+r[1]+"_"+e+"_"+t}var UL=(function(){return function(r,e){this.variableNames=["A"];for(var t=new Array(r.length),n=0;n<t.length;n++)t[n]=r[n]*e[n];this.outputShape=t,this.rank=t.length;var a=Xe(this.rank),i=(function(s){var u=s.length;if(u>5)throw Error("Tile for rank "+u+" is not yet supported");if(u===1)return"imod(resRC, "+s[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],h=0;h<s.length;h++)f.push("imod("+c[h]+", "+s[h]+")");return f.join()})(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `}})(),jL=(function(){return function(r,e){this.variableNames=["A"];for(var t=new Array(r.length),n=0;n<t.length;n++)t[n]=r[e[n]];this.outputShape=t,this.rank=t.length;var a=Xe(this.rank),i=(function(s){var u=s.length;if(u>6)throw Error("Transpose for rank "+u+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(u),h=0;h<s.length;h++)f[s[h]]=c[h];return f.join()})(e);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `}})(),PL=(function(){return function(r,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(r.length),n=0;n<t.length;n++)t[n]=r[e[n]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Xe(this.rank),i=aO("rc",this.rank),s=new Array(this.rank);for(n=0;n<e.length;n++)s[e[n]]=i[n];var u="vec2("+s.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+t[this.rank-1],f="getChannel(getA("+s.join()+"), "+u+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `}})(),J1=1.7580993408473768,tx=1.0507009873554805,fe=(function(){return function(r,e){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}})(),Ea="if (isnan(x)) return x;",VL="return x;",pA="return abs(x);",NO=Ea+`
  return (x < 0.0) ? 0.0 : x;
`,TO=Ea+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,RO="return (x >= 0.0) ? x : (exp(x) - 1.0);",qL=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+J1+`;
  float scale = `+tx+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,dA="return -x;",mA="return ceil(x);",vA="return floor(x);",gA="return exp(x);",yA="return exp(x) - 1.0;",WL=Ea+`
  return sin(x);
`,HL=Ea+`
  return cos(x);
`,GL=Ea+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,XL=Ea+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,KL=Ea+`
  return atan(x);
`,YL=Ea+"return log(x + sqrt(x * x + 1.0));",$L=Ea+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,QL=Ea+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,fp="return x;",ZL="return x;",_O=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,OO=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DO=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,dc=(function(){return function(r,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}})(),JL=(function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var e=r.length,t=Sr("rc",e),n=Xe(e),a=(function(u,c){if(u===1)return"rc";for(var f="",h=0;h<u;h++)f+=c[h],h<u-1&&(f+=",");return f})(e,t),i=t.slice(-2),s=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `}})(),hp={};function pp(r,e){if(e===void 0&&(e=!1),r==="linear")return e?ZL:VL;if(r==="relu")return e?_O:NO;if(r==="elu")return e?DO:RO;if(r==="relu6")return e?OO:TO;if(r==="prelu")return e?uO:sO;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var tU=600,IO=(function(r){function e(t){var n,a=r.call(this)||this;if(a.gpgpu=t,a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!yt().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var i=Ha(yt().getNumber("WEBGL_VERSION"));a.binaryCache=((n=yt().getNumber("WEBGL_VERSION"))in hp||(hp[n]={}),hp[n]),a.gpgpu=new AO(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=t.gl.canvas;return a.textureManager=new LL(a.gpgpu),a.numMBBeforeWarning=yt().global.screen==null?1024:yt().global.screen.height*yt().global.screen.width*window.devicePixelRatio*tU/1024/1024,a.texData=new Xd(a,at),a}return ba(e,r),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.fromPixels=function(t,n){if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var a=typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement,i=t.data instanceof Uint8Array,s=typeof ImageData<"u"&&t instanceof ImageData,u=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement,c=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,f=u?[t.videoWidth,t.videoHeight]:[t.width,t.height],h=f[0],d=f[1],m=[d,h],g=[d,h,n];if(!(a||i||s||u||c))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(c||u)&&(this.fromPixels2DContext==null&&(this.fromPixels2DContext=t_(yt().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=h,this.fromPixels2DContext.canvas.height=d,this.fromPixels2DContext.drawImage(t,0,0,h,d),t=this.fromPixels2DContext.canvas);var y,x,w=this.makeTensorInfo(m,"int32");return this.texData.get(w.dataId).usage=Mr.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(w.dataId),t),yt().getBool("WEBGL_PACK")?(y=new lL(g),x=this.compileAndRun(y,[w])):(y=new uL(g),x=this.compileAndRun(y,[w])),this.disposeData(w.dataId),x},e.prototype.write=function(t,n,a){if(yt().getBool("DEBUG")&&this.checkNumericalProblems(t),a==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:t,usage:Mr.UPLOAD}),i},e.prototype.move=function(t,n,a,i){if(yt().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:a,dtype:i,values:n,usage:Mr.UPLOAD})},e.prototype.readSync=function(t){var n=this.texData.get(t),a=n.values,i=n.dtype,s=n.complexTensors,u=n.slice,c=n.shape,f=n.isPacked;if(u!=null){var h=void 0;h=f?new dc(c,fp):new fe(c,fp);var d=this.runWebGLProgram(h,[{dataId:t,shape:c,dtype:i}],i),m=this.readSync(d.dataId);return this.disposeData(d.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return a;var g,y,x=this.activeTimers!=null;return x&&(g=la()),i==="complex64"?y=Mb(s.real.dataSync(),s.imag.dataSync()):y=this.getValuesFromTexture(t),x&&(this.downloadWaitMs+=la()-g),this.convertAndCacheOnCPU(t,y)},e.prototype.read=function(t){return Ht(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N,O;return Gt(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(t))return n=this.pendingRead.get(t),[2,new Promise(function(z){return n.push(z)})];if(a=this.texData.get(t),i=a.values,s=a.shape,u=a.slice,c=a.dtype,f=a.complexTensors,h=a.isPacked,u!=null)return d=void 0,d=h?new dc(s,fp):new fe(s,fp),m=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(i!=null)return[2,this.convertAndCacheOnCPU(t)];if(!yt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&yt().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return y=null,c!=="complex64"&&yt().get("WEBGL_BUFFER_SUPPORTED")&&(x=this.decode(t),w=this.texData.get(x.dataId),y=(O=this.gpgpu).createBufferFromTexture.apply(O,[w.texture].concat(Nc(s)))),this.pendingRead.set(t,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return C=k.sent(),A=C[0],T=C[1],b=Mb(A,T),[3,5];case 4:y==null?b=this.getValuesFromTexture(t):(R=Kt(s),b=this.gpgpu.downloadFloat32MatrixFromBuffer(y,R)),k.label=5;case 5:return x!=null&&this.disposeData(x.dataId),D=this.convertAndCacheOnCPU(t,b),N=this.pendingRead.get(t),this.pendingRead.delete(t),N.forEach(function(z){return z(D)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,D]}})})},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var n=0;n<t.length;n++){var a=t[n];if(!e_(a))throw yt().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var n,a=this.texData.get(t),i=a.shape,s=a.dtype,u=a.isPacked,c=Kt(i);if(yt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(t),h=this.texData.get(f.dataId),d=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[h.texture].concat(Nc(i))).subarray(0,c);return this.disposeData(f.dataId),d}var m=yt().getBool("WEBGL_PACK")&&u===!0,g=m?zp(i):i,y=m?new nL(g):new eL(g),x=this.runWebGLProgram(y,[{shape:g,dtype:s,dataId:t}],"float32"),w=this.texData.get(x.dataId),b=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,c);return this.disposeData(x.dataId),b},e.prototype.time=function(t){return Ht(this,void 0,void 0,function(){var n,a,i,s,u,c,f;return Gt(this,function(h){switch(h.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,t(),s=Ci(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),u=Ci(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=n,i&&(this.programTimersStack=null),[4,Promise.all(s)];case 1:return c=h.sent(),f={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:UR(c),getExtraProfileInfo:function(){return c.map(function(d,m){return{name:u[m],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,f]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:la(),endMs:null}},e.prototype.endTimer=function(t){return yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=la(),t)},e.prototype.getQueryTime=function(t){return Ht(this,void 0,void 0,function(){var n;return Gt(this,function(a){return yt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(n=t).endMs-n.startMs]})})},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var n=this.texData.get(t).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var n=this.texData.get(t),a=n.texture,i=n.dtype,s=n.texShape,u=n.usage,c=n.isPacked,f=n.slice,h=f&&f.origDataId||t,d=this.dataRefCount.get(h);d>1?this.dataRefCount.set(h,d-1):(this.dataRefCount.delete(h),a!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(a,s,u,c)));var m=this.texData.get(t);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return yt().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=at.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&t.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<n})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,n){var a=this.makeOutput(t.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:at.keep(t.clone()),imag:at.keep(n.clone())},a},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,n,a){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,n,a);if(Kt(a)===0)return sn([],a,t.dtype);var i=this.texData.get(t.dataId).isPacked,s=W1(t.shape,n,a);if(i||!s){var u=yt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FL(a):new zL(a),c=u.getCustomSetupFunc(n);return this.compileAndRun(u,[t],null,c)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,n,a)},e.prototype.shallowSlice=function(t,n,a){var i=this.texData.get(t.dataId),s=this.makeOutput(a,t.dtype),u=this.texData.get(s.dataId);Object.assign(u,i),u.shape=a,u.dtype=t.dtype;var c=H1(n,t.strides);i.slice&&(c+=i.slice.flatOffset),u.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||t.dataId};var f=this.dataRefCount.get(u.slice.origDataId)||1;return this.dataRefCount.set(u.slice.origDataId,f+1),s},e.prototype.stridedSlice=function(t,n,a,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,n,a,i);var s=Hd(n,a,i);if(s.some(function(c){return c===0}))return sn([],s);var u=new BL(n,i,s);return this.compileAndRun(u,[t])},e.prototype.reverse=function(t,n){var a=yt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IL(t.shape,n):new DL(t.shape,n);return this.compileAndRun(a,[t])},e.prototype.concat=function(t,n){if(t[0].dtype==="complex64"){var a=t.map(function(g){return sr(g)}),i=t.map(function(g){return zr(g)});return Tn(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,n);if(t.length===1)return t[0];if(t.length>yt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(t.length/2),u=this.concat(t.slice(0,s),n),c=this.concat(t.slice(s),n);return this.concat([u,c],n)}if(yt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var f=new PB(t.map(function(g){return g.shape}),n);return this.compileAndRun(f,t)}var h=xs(t.map(function(g){return g.shape}),n),d=t.map(function(g){return g.as2D(-1,Kt(g.shape.slice(n)))}),m=new jB(d.map(function(g){return g.shape}));return this.compileAndRun(m,d).reshape(h)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,dA,t.dtype);var n=new fe(t.shape,dA);return this.compileAndRun(n,[t])},e.prototype.batchMatMul=function(t,n,a,i){var s=a?t.shape[2]:t.shape[1],u=i?n.shape[1]:n.shape[2],c=a?t.shape[1]:t.shape[2],f=t.shape[0];if((s===1||u===1)&&c>1e3){a&&(t=t.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var h=u===1?t:t.as3D(f,c,1),d=u===1?2:1,m=u===1?n.as3D(f,1,c):n;return this.multiply(h,m).sum(d,!0)}var g=_n(t.dtype,n.dtype),y=new Ly(t.shape,[f,s,u],a,i);return this.compileAndRun(y,[t,n],g)},e.prototype.fusedBatchMatMul=function(t){var n=t.a,a=t.b,i=t.transposeA,s=t.transposeB,u=t.bias,c=t.activation,f=t.preluActivationWeights,h=i?n.shape[2]:n.shape[1],d=s?a.shape[1]:a.shape[2],m=n.shape[0],g=_n(n.dtype,a.dtype),y=u!=null,x=f!=null,w=c?pp(c,!0):null,b=new Ly(n.shape,[m,h,d],i,s,y,w,x),C=[n,a];return u&&C.push(u),f&&C.push(f),this.compileAndRun(b,C,g)},e.prototype.multiply=function(t,n){if(t.dtype==="complex64"){var a=this.texData.get(t.dataId),i=this.texData.get(n.dataId),s=new nA(zB,t.shape,n.shape),u=new nA(FB,t.shape,n.shape),c=[this.makeComplexComponentTensorInfo(t,a.complexTensors.real),this.makeComplexComponentTensorInfo(t,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],f=this.compileAndRun(s,c),h=this.compileAndRun(u,c),d=this.complex(f,h);return f.dispose(),h.dispose(),d}if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.multiply(t,n);if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,rA,t.dtype);var m=new dn(rA,t.shape,n.shape);return this.compileAndRun(m,[t,n],t.dtype)},e.prototype.batchNormalization=function(t,n,a,i,s,u){var c=[t,n,a],f=null;u!=null&&(f=u.shape,c.push(u));var h=null;if(s!=null&&(h=s.shape,c.push(s)),yt().getBool("WEBGL_PACK_NORMALIZATION")){var d=new MB(t.shape,n.shape,a.shape,f,h,i);return this.compileAndRun(d,c)}var m=new kB(t.shape,n.shape,a.shape,f,h,i);return this.compileAndRun(m,c)},e.prototype.localResponseNormalization4D=function(t,n,a,i,s){var u=yt().getBool("WEBGL_PACK_NORMALIZATION")?new vL(t.shape,n,a,i,s):new dL(t.shape,n,a,i,s);return this.compileAndRun(u,[t])},e.prototype.LRNGrad=function(t,n,a,i,s,u,c){var f=new mL(n.shape,i,s,u,c);return this.compileAndRun(f,[n,a,t])},e.prototype.tile=function(t,n){if(t.dtype==="string"){var a=this.readSync(t.dataId).map(function(s){return zc(s)});return nO(ae(t.shape,t.dtype,a),n)}var i=new UL(t.shape,n);return this.compileAndRun(i,[t])},e.prototype.pad=function(t,n,a){var i=yt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EL(t.shape,n,a):new SL(t.shape,n,a);return this.compileAndRun(i,[t])},e.prototype.transpose=function(t,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,n);var a=yt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new PL(t.shape,n):new jL(t.shape,n);return this.compileAndRun(a,[t])},e.prototype.gather=function(t,n,a){if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.gather(t,n,a);var i=new cL(t.shape,n.size,a);return this.compileAndRun(i,[t,n])},e.prototype.batchToSpaceND=function(t,n,a){K(t.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(d,m){return d*m}),s=ud(t.shape,n,i),u=ld(s.length,n.length),c=cd(t.shape,n,i),f=V_(a,n.length),h=q_(c,a,n.length);return t.reshape(s).transpose(u).reshape(c).slice(f,h)},e.prototype.spaceToBatchND=function(t,n,a){K(t.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var u=1+n.length;u<t.shape.length;++u)s.push([0,0]);var c=t.pad(s),f=ud(c.shape,n,i,!1),h=ld(f.length,n.length,!1),d=cd(c.shape,n,i,!1);return c.reshape(f).transpose(h).reshape(d)},e.prototype.reduce=function(t,n,a){var i=t.shape[0],s=t.shape[1],u=zy(s),c=new CL({windowSize:u,inSize:s,batchSize:i},n),f=this.compileAndRun(c,[t],a);return f.shape[1]===1?f:this.reduce(f,n,a)},e.prototype.argReduce=function(t,n,a){a===void 0&&(a=null);var i=t.shape[0],s=t.shape[1];a!=null&&(i=a.shape[0],s=a.shape[1]);var u=zy(s),c=new CB({windowSize:u,inSize:s,batchSize:i},n,a==null),f=[t];a!=null&&f.push(a);var h=this.compileAndRun(c,f,"int32");return h.shape[1]===1?h:this.argReduce(t,n,h)},e.prototype.argReducePacked=function(t,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:t.shape,s=zy(i[i.length-1]),u=new OB(i,s,n,a==null),c=a==null?[t]:[t,a],f=this.compileAndRun(u,c,"int32");return f.rank===t.rank?this.argReducePacked(t,n,f):f},e.prototype.sum=function(t,n){wr("sum",n,t.rank);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s),c=Iy(t.dtype);return this.reduce(u,"sum",c).reshape(i)},e.prototype.prod=function(t,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,n);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s),c=Iy(t.dtype);return this.reduce(u,"prod",c).reshape(i)},e.prototype.unsortedSegmentSum=function(t,n,a){var i=0,s=xa([i],t.rank),u=t;s!=null&&(u=t.transpose(s),i=wa(1,t.rank)[0]);var c=(function(g,y,x){for(var w=[],b=g.length,C=0;C<b;C++)C!==y?w.push(g[C]):w.push(x);return w})(u.shape,i,a),f=Kt([u.shape[i]]),h=u.as2D(-1,f),d=Iy(t.dtype),m=this.segOpCompute(h,"unsortedSegmentSum",n,d,a).reshape(c);return s!=null&&(m=m.transpose(Id(s))),m},e.prototype.segOpCompute=function(t,n,a,i,s){var u=t.shape[0],c=t.shape[1],f=(function(m,g){var y,x=!1;for(m<=H_?(y=m,x=!0):y=id(m,Math.floor(Math.sqrt(m)));!x;)y>g||y===m?x=!0:y=id(m,y+1);return y})(c,s),h=new kL({windowSize:f,inSize:c,batchSize:u,numSegments:s},n),d=this.compileAndRun(h,[t,a],i);return d.shape[1]===s?d:(a=ef(0,s).tile([c/f]),this.segOpCompute(d,n,a,i,s))},e.prototype.argMinMaxReduce=function(t,n,a){var i=[n];if(wr("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,t.rank),!yt().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var s=Yn(t.shape,i),u=s[0],c=Kt(s[1]),f=t.as2D(-1,c);return this.argReduce(f,a).reshape(u)}return this.argReducePacked(t,a)},e.prototype.argMin=function(t,n){return this.argMinMaxReduce(t,n,"min")},e.prototype.argMax=function(t,n){return this.argMinMaxReduce(t,n,"max")},e.prototype.cumsum=function(t,n,a,i){if(n!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+n);var s=new $B(t.shape,a,i);return this.compileAndRun(s,[t])},e.prototype.equal=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(equal(a, b));
`,"bool");var a=new dn("return float(a == b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.notEqual=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new dn("return float(a != b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.less=function(t,n){if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.less(t,n);if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new dn("return float(a < b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.lessEqual=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new dn("return float(a <= b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.greater=function(t,n){if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.greater(t,n);if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new dn("return float(a > b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.greaterEqual=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new dn("return float(a >= b);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.logicalNot=function(t){var n=new fe(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[t])},e.prototype.logicalAnd=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new dn("return float(a >= 1.0 && b >= 1.0);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.logicalOr=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new dn("return float(a >= 1.0 || b >= 1.0);",t.shape,n.shape);return this.compileAndRun(a,[t,n],"bool")},e.prototype.select=function(t,n,a){var i=new ML(t.rank,n.shape,n.rank);return this.compileAndRun(i,[t,n,a],_n(n.dtype,a.dtype))},e.prototype.where=function(t){Db("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=t.dataSync();return Q1(t.shape,n)},e.prototype.topk=function(t,n,a){return rO(t.dataSync(),t.shape,t.dtype,n)},e.prototype.min=function(t,n){wr("min",n,t.rank);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s);return this.reduce(u,"min",u.dtype).reshape(i)},e.prototype.minimum=function(t,n){if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.minimum(t,n);var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,n.shape):new dn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.mod=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,n.shape):new dn(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.max=function(t,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,n);wr("max",n,t.rank);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s);return this.reduce(u,"max",u.dtype).reshape(i)},e.prototype.maximum=function(t,n){if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.maximum(t,n);var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,n.shape):new dn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.all=function(t,n){wr("all",n,t.rank);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s);return this.reduce(u,"all",u.dtype).reshape(i)},e.prototype.any=function(t,n){wr("any",n,t.rank);var a=Yn(t.shape,n),i=a[0],s=Kt(a[1]),u=t.as2D(-1,s);return this.reduce(u,"any",u.dtype).reshape(i)},e.prototype.squaredDifference=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("return (a - b) * (a - b);",t.shape,n.shape):new dn("return (a - b) * (a - b);",t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.realDivide=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new dn(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,n.shape);return this.compileAndRun(a,[t,n],"float32")},e.prototype.floorDiv=function(t,n){if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new dn(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,n.shape);return this.compileAndRun(a,[t,n],"int32")},e.prototype.add=function(t,n){if(t.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(t,n,Fy);if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.add(t,n);var a=_n(t.dtype,n.dtype);if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,Fy,a);var i=new dn(Fy,t.shape,n.shape);return this.compileAndRun(i,[t,n],a)},e.prototype.packedUnaryOp=function(t,n,a){var i=new dc(t.shape,n);return this.compileAndRun(i,[t],a)},e.prototype.packedBinaryOp=function(t,n,a,i,s){s===void 0&&(s=!1);var u=new pi(a,t.shape,n.shape,s);return this.compileAndRun(u,[t,n],i)},e.prototype.complexSeparableBinaryOp=function(t,n,a){var i=this,s=this.texData.get(t.dataId),u=this.texData.get(n.dataId),c=[[s.complexTensors.real,u.complexTensors.real],[s.complexTensors.imag,u.complexTensors.imag]].map(function(m){var g=m[0],y=m[1],x=i.makeComplexComponentTensorInfo(t,g),w=i.makeComplexComponentTensorInfo(n,y),b=new dn(a,t.shape,n.shape);return i.compileAndRun(b,[x,w],_n(g.dtype,y.dtype))}),f=c[0],h=c[1],d=this.complex(f,h);return f.dispose(),h.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(t,n){return{dataId:n.dataId,dtype:n.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>yt().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(t.length/2),a=this.addN(t.slice(0,n)),i=this.addN(t.slice(n));return this.addN([a,i])}var s=t.map(function(f){return f.dtype}).reduce(function(f,h){return _n(f,h)}),u=t.map(function(f){return f.shape}),c=yt().getBool("WEBGL_PACK")?new EB(t[0].shape,u):new SB(t[0].shape,u);return this.compileAndRun(c,t,s)},e.prototype.subtract=function(t,n){if(t.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(t,n,By);if(this.shouldExecuteOnCPU([t,n]))return this.cpuBackend.subtract(t,n);var a=_n(t.dtype,n.dtype);if(yt().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,n,By,t.dtype);var i=new dn(By,t.shape,n.shape);return this.compileAndRun(i,[t,n],a)},e.prototype.pow=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,n.shape):new dn(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,n.shape),i=_n(t.dtype,n.dtype);return this.compileAndRun(a,[t,n],i)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,mA,t.dtype);var n=new fe(t.shape,mA);return this.compileAndRun(n,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,vA,t.dtype);var n=new fe(t.shape,vA);return this.compileAndRun(n,[t])},e.prototype.sign=function(t){var n=new fe(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[t])},e.prototype.isNaN=function(t){var n=new fe(t.shape,"return float(isnan(x));");return this.compileAndRun(n,[t],"bool")},e.prototype.isInf=function(t){var n=new fe(t.shape,"return float(isinf(x));");return this.compileAndRun(n,[t],"bool")},e.prototype.isFinite=function(t){var n=new fe(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[t],"bool")},e.prototype.round=function(t){var n=new fe(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,gA,t.dtype);var n=new fe(t.shape,gA);return this.compileAndRun(n,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,yA,t.dtype);var n=new fe(t.shape,yA);return this.compileAndRun(n,[t])},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var n=new fe(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[t])},e.prototype.log1p=function(t){var n=new fe(t.shape,"return log(1.0 + x);");return this.compileAndRun(n,[t])},e.prototype.sqrt=function(t){var n=new fe(t.shape,"return sqrt(x);");return this.compileAndRun(n,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var n=new fe(t.shape,"return inversesqrt(x);");return this.compileAndRun(n,[t])},e.prototype.reciprocal=function(t){var n=new fe(t.shape,"return 1.0 / x;");return this.compileAndRun(n,[t])},e.prototype.relu=function(t){var n;return n=yt().getBool("WEBGL_PACK")?new dc(t.shape,_O):new fe(t.shape,NO),this.compileAndRun(n,[t])},e.prototype.relu6=function(t){var n;return n=yt().getBool("WEBGL_PACK")?new dc(t.shape,OO):new fe(t.shape,TO),this.compileAndRun(n,[t])},e.prototype.prelu=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(uO,t.shape,n.shape):new dn(sO,t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.elu=function(t){if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,DO,t.dtype);var n=new fe(t.shape,RO);return this.compileAndRun(n,[t])},e.prototype.eluDer=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,n.shape):new dn("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.selu=function(t){var n=new fe(t.shape,qL);return this.compileAndRun(n,[t])},e.prototype.int=function(t){var n=new fe(t.shape,"return float(int(x));");return this.compileAndRun(n,[t],"int32")},e.prototype.clip=function(t,n,a){var i,s=(i=yt().getBool("WEBGL_PACK_CLIP")?new LB(t.shape):new BB(t.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[t],null,s)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(yt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,pA,t.dtype);var n=new fe(t.shape,pA);return this.compileAndRun(n,[t])},e.prototype.complexAbs=function(t){var n=this.texData.get(t.dataId),a=new UB(t.shape),i=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)];return this.compileAndRun(a,i)},e.prototype.sigmoid=function(t){var n=new fe(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[t])},e.prototype.softplus=function(t){var n=new fe(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[t])},e.prototype.sin=function(t){var n=new fe(t.shape,WL);return this.compileAndRun(n,[t])},e.prototype.cos=function(t){var n=new fe(t.shape,HL);return this.compileAndRun(n,[t])},e.prototype.tan=function(t){var n=new fe(t.shape,"return tan(x);");return this.compileAndRun(n,[t])},e.prototype.asin=function(t){var n=new fe(t.shape,GL);return this.compileAndRun(n,[t])},e.prototype.acos=function(t){var n=new fe(t.shape,XL);return this.compileAndRun(n,[t])},e.prototype.atan=function(t){var n=new fe(t.shape,KL);return this.compileAndRun(n,[t])},e.prototype.atan2=function(t,n){var a=yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,n.shape):new dn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,n.shape);return this.compileAndRun(a,[t,n])},e.prototype.sinh=function(t){var n=new fe(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[t])},e.prototype.cosh=function(t){var n=new fe(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[t])},e.prototype.tanh=function(t){var n=new fe(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[t])},e.prototype.asinh=function(t){var n=new fe(t.shape,YL);return this.compileAndRun(n,[t])},e.prototype.acosh=function(t){var n=new fe(t.shape,$L);return this.compileAndRun(n,[t])},e.prototype.atanh=function(t){var n=new fe(t.shape,QL);return this.compileAndRun(n,[t])},e.prototype.erf=function(t){var n=new fe(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[t])},e.prototype.step=function(t,n){var a=new fe(t.shape,(function(i){return i===void 0&&(i=0),Ea+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `})(n));return this.compileAndRun(a,[t])},e.prototype.conv2dByMatMul=function(t,n,a,i,s,u){var c=t.shape,f=this.texData.get(t.dataId),h=a.inChannels,d=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",y=(d===1||m===1)&&h>1e3,x=c[2]%2!=0&&!!f.isPacked;if(y||!yt().getBool("WEBGL_LAZILY_UNPACK")||!yt().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!x){var w=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],b=this.reshape(t,[1,w,a.inChannels]),C=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:b,b:C,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:u}),a.outShape)}var A=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),T={dataId:t.dataId,shape:[1,A,a.inChannels],dtype:t.dtype},R=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,K(wc(f.shape,T.shape),function(){return"packed reshape "+f.shape+" to "+T.shape+" isn't free"});var D=this.reshape(n,[1,a.inChannels,a.outChannels]),N=this.fusedBatchMatMul({a:T,b:D,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:u}),O=this.texData.get(N.dataId);return K(O.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=R,O.shape=a.outShape,at.makeTensorFromDataId(N.dataId,a.outShape,N.dtype)},e.prototype.conv2dWithIm2Row=function(t,n,a,i,s,u){var c=a.filterWidth,f=a.filterHeight,h=a.inChannels,d=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",y=c*f*h,x=m*d,w=[y,x],b=t.squeeze([0]),C=n.reshape([1,y,-1]),A=new pL(w,b.shape,a),T=this.compileAndRun(A,[b]).reshape([1,w[0],w[1]]),R=i!=null,D=u!=null,N=s?pp(s,!0):null,O=new Ly(T.shape,[1,x,a.outChannels],!0,!1,R,N,D),k=[T,C];i&&k.push(i),D&&k.push(u);var z=this.compileAndRun(O,k);return g?z.reshape([1,m,d,a.outChannels]):z.reshape([1,a.outChannels,m,d])},e.prototype.fusedConv2d=function(t){var n=t.input,a=t.filter,i=t.convInfo,s=t.bias,u=t.activation,c=t.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,s,u,c);if(yt().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,s,u,c);var f=s!=null,h=c!=null,d=u?pp(u,!1):null,m=new aA(i,f,d,h),g=[n,a];return s&&g.push(s),c&&g.push(c),this.compileAndRun(m,g)},e.prototype.conv2d=function(t,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(t,n,a);if(yt().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,n,a);var i=new aA(a);return this.compileAndRun(i,[t,n])},e.prototype.conv2dDerInput=function(t,n,a){var i=new qB(a);return this.compileAndRun(i,[t,n])},e.prototype.conv2dDerFilter=function(t,n,a){var i=new VB(a);return this.compileAndRun(i,[t,n])},e.prototype.fusedDepthwiseConv2D=function(t){var n,a=t.input,i=t.filter,s=t.convInfo,u=t.bias,c=t.activation,f=t.preluActivationWeights,h=yt().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,d=c?pp(c,h):null,m=[a,i],g=u!=null,y=f!=null;return g&&m.push(u),y&&m.push(f),h?(n=new oA(s,g,d,y),this.compileAndRun(n,m)):(n=new iA(s,g,d,y),this.compileAndRun(n,m))},e.prototype.depthwiseConv2D=function(t,n,a){var i;return yt().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new oA(a),this.compileAndRun(i,[t,n])):(i=new iA(a),this.compileAndRun(i,[t,n]))},e.prototype.depthwiseConv2DDerInput=function(t,n,a){var i=new XB(a);return this.compileAndRun(i,[t,n])},e.prototype.depthwiseConv2DDerFilter=function(t,n,a){var i=new GB(a);return this.compileAndRun(i,[t,n])},e.prototype.conv3d=function(t,n,a){var i=new KB(a);return this.compileAndRun(i,[t,n])},e.prototype.conv3dDerInput=function(t,n,a){var i=new HB(a);return this.compileAndRun(i,[t,n])},e.prototype.conv3dDerFilter=function(t,n,a){var i=new WB(a);return this.compileAndRun(i,[t,n])},e.prototype.maxPool=function(t,n){var a=new Uy(n,"max",!1);return this.compileAndRun(a,[t])},e.prototype.avgPool=function(t,n){var a=new Uy(n,"avg",!1);return this.compileAndRun(a,[t],"float32")},e.prototype.maxPoolBackprop=function(t,n,a,i){var s=new Uy(i,"max",!0),u=this.compileAndRun(s,[n]),c=new gL(i),f=this.compileAndRun(c,[t,u],n.dtype);return u.dispose(),f},e.prototype.avgPoolBackprop=function(t,n,a){var i=new DB(a);return this.compileAndRun(i,[t],n.dtype)},e.prototype.cast=function(t,n){return K1(t,n,this)},e.prototype.unstack=function(t,n){for(var a=t.shape[n],i=new Array(t.rank-1),s=0,u=0;u<t.rank;u++)u!==n&&(i[s++]=t.shape[u]);var c=new Array(t.rank).fill(0),f=t.shape.slice();f[n]=1;var h=new Array(a);for(u=0;u<h.length;u++)c[n]=u,h[u]=this.slice(t,c,f).reshape(i);return h},e.prototype.avgPool3d=function(t,n){var a=new jy(n,"avg",!1);return this.compileAndRun(a,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,n,a){var i=new IB(a);return this.compileAndRun(i,[t],n.dtype)},e.prototype.maxPool3d=function(t,n){var a=new jy(n,"max",!1);return this.compileAndRun(a,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,n,a,i){var s=new jy(i,"max",!0),u=this.compileAndRun(s,[n]),c=new yL(i),f=this.compileAndRun(c,[t,u],n.dtype);return u.dispose(),f},e.prototype.reshape=function(t,n){var a=this.texData.get(t.dataId);if(a.isPacked&&!wc(t.shape,n)&&(a.texture===null||!wc(a.shape,n))){var i=this.packedReshape(t,n);return at.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return pd(t,n)},e.prototype.resizeBilinear=function(t,n,a,i){var s=yt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new RL(t.shape,n,a,i):new TL(t.shape,n,a,i);return this.compileAndRun(s,[t])},e.prototype.resizeBilinearBackprop=function(t,n,a){var i=new NL(t,n,a);return this.compileAndRun(i,[t])},e.prototype.resizeNearestNeighbor=function(t,n,a,i){var s=new OL(t.shape,n,a,i);return this.compileAndRun(s,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,n,a){var i=new _L(t,n,a);return this.compileAndRun(i,[t])},e.prototype.multinomial=function(t,n,a,i){var s=n?t:Ro(t),u=s.shape[0],c=s.shape[1],f=new bL(u,c,a),h=f.getCustomSetupFunc(i);return this.compileAndRun(f,[s],"int32",h)},e.prototype.oneHot=function(t,n,a,i){var s=new xL(t.size,n,a,i);return this.compileAndRun(s,[t])},e.prototype.diag=function(t){var n=new tL(t.size);return this.compileAndRun(n,[t])},e.prototype.nonMaxSuppression=function(t,n,a,i,s){return Db("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),$1(t.dataSync(),n.dataSync(),a,i,s)},e.prototype.cropAndResize=function(t,n,a,i,s,u){var c=new YB(t.shape,n.shape,i,s,u);return this.compileAndRun(c,[t,n,a])},e.prototype.depthToSpace=function(t,n,a){K(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});var i=t.shape[0],s=a==="NHWC"?t.shape[1]:t.shape[2],u=a==="NHWC"?t.shape[2]:t.shape[3],c=a==="NHWC"?t.shape[3]:t.shape[1],f=s*n,h=u*n,d=c/(n*n),m=new JB(a==="NHWC"?[i,f,h,d]:[i,d,f,h],n,a);return this.compileAndRun(m,[t])},e.prototype.split=function(t,n,a){return eO(t,n,a)},e.prototype.scatterND=function(t,n,a){var i=fd(0,t,a),s=i.sliceRank,u=i.numUpdates,c=i.sliceSize,f=i.strides,h=i.outputSize,d=[h/c,c],m=t.reshape([u,s]),g=n.reshape([u,c]);if(h===0)return pd(sn([]),a);var y=jt(0),x=new cA(u,s,m.rank,g.rank,f,d);return this.compileAndRun(x,[g,m,y]).reshape(a)},e.prototype.sparseToDense=function(t,n,a,i){var s=fd(0,t,a),u=s.sliceRank,c=s.numUpdates,f=s.strides,h=s.outputSize,d=new cA(c,u,t.rank,n.rank,f,[h,1],!1);return this.compileAndRun(d,[n,t,i]).reshape(a)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,n){var a=this.texData.get(t.dataId),i=new uA(iL,t.shape,n),s=new uA(oL,t.shape,n),u=[this.makeComplexComponentTensorInfo(t,a.complexTensors.real),this.makeComplexComponentTensorInfo(t,a.complexTensors.imag)],c=this.compileAndRun(i,u),f=this.compileAndRun(s,u),h=this.complex(c,f).as2D(t.shape[0],t.shape[1]);return c.dispose(),f.dispose(),h},e.prototype.gatherND=function(t,n){var a=n.shape,i=a[a.length-1],s=W_(t,n),u=s[0],c=s[1],f=s[2],h=s[3],d=n.reshape([c,i]),m=t.reshape([t.size/f,f]),g=new fL(i,h,[c,f]);return this.compileAndRun(g,[m,d]).reshape(u)},e.prototype.fill=function(t,n,a){if((a=a||rl(n))==="string"){var i=Mc(a,Kt(t));return i.fill(n),at.makeTensor(i,t,a,this)}var s=new sL(t,n),u=s.getCustomSetupFunc(n);return this.compileAndRun(s,[],a,u)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,n,a){return Y1(t,n,a)},e.prototype.makeTensorInfo=function(t,n){var a=this.write(null,t,n);return this.texData.get(a).usage=null,{dataId:a,shape:t,dtype:n}},e.prototype.makeOutput=function(t,n){var a=this.makeTensorInfo(t,n).dataId;return at.makeTensorFromDataId(a,t,n,this)},e.prototype.unpackTensor=function(t){var n=new JL(t.shape);return this.runWebGLProgram(n,[t],t.dtype)},e.prototype.packTensor=function(t){var n=new wL(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,n){var a=[Bc(t.shape)].concat(Lc(t.shape)),i={dtype:t.dtype,shape:a,dataId:t.dataId},s=[Bc(n)].concat(Lc(n)),u=new AL(s,a),c=this.runWebGLProgram(u,[i],t.dtype,null,!0);return{dataId:c.dataId,shape:n,dtype:c.dtype}},e.prototype.decode=function(t){var n,a=this.texData.get(t),i=a.isPacked,s=a.shape,u=a.dtype,c=zp(s);return n=i?new ZB(c):new QB(c),{dtype:u,shape:s,dataId:this.runWebGLProgram(n,[{shape:c,dtype:u,dataId:t}],u,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,n,a,i,s){var u=this;s===void 0&&(s=!1);var c=this.makeTensorInfo(t.outputShape,a),f=this.texData.get(c.dataId);if(t.packedOutput&&(f.isPacked=!0),t.outPackingScheme===Fc.DENSE){var h=Nc(t.outputShape);f.texShape=h.map(function(A){return 2*A})}if(t.outTexUsage!=null&&(f.usage=t.outTexUsage),Kt(c.shape)===0)return f.values=kc(c.dtype,0),c;var d=[],m=n.map(function(A){if(A.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var T=u.texData.get(A.dataId);if(T.texture==null){if(!t.packedInputs&&Kt(A.shape)<=yt().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:A.shape,texData:null,isUniform:!0,uniformValues:T.values};t.packedInputs&&(T.isPacked=!0,T.shape=A.shape)}else if(!!T.isPacked!=!!t.packedInputs)A=T.isPacked?u.unpackTensor(A):u.packTensor(A),d.push(A),T=u.texData.get(A.dataId);else if(T.isPacked&&!wc(T.shape,A.shape)){var R=A,D=A.shape;A.shape=T.shape,A=u.packedReshape(A,D),d.push(A),T=u.texData.get(A.dataId),R.shape=D}return u.uploadToGPU(A.dataId),{shape:A.shape,texData:T,isUniform:!1}});this.uploadToGPU(c.dataId);var g,y={shape:c.shape,texData:f,isUniform:!1},x=(function(A,T,R){var D="";T.concat(R).forEach(function(k){var z=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,F=k.isUniform?"uniform":k.texData.texShape;D+=k.shape+"_"+F+"_"+z});var N=A.userCode,O=A.constructor.name;return O+="_"+D+"_"+N})(t,m,y),w=this.getAndSaveBinary(x,function(){return(function(A,T,R,D){var N=T.userCode,O=R.map(function($,it){var tt={logicalShape:$.shape,texShape:$.isUniform?null:$.texData.texShape,isUniform:$.isUniform,isPacked:!$.isUniform&&$.texData.isPacked,flatOffset:null};return $.texData!=null&&$.texData.slice!=null&&$.texData.slice.flatOffset>0&&(tt.flatOffset=$.texData.slice.flatOffset),{name:T.variableNames[it],shapeInfo:tt}}),k=O.map(function($){return $.shapeInfo}),z={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},F=AB(O,z,N,T.packedInputs),B=A.createProgram(F),V=null,G=A.getUniformLocation(B,"NAN",!1);yt().getNumber("WEBGL_VERSION")===1&&(V=A.getUniformLocation(B,"INFINITY",!1));for(var Q={},L=0;L<T.variableNames.length;L++){var X=T.variableNames[L];Q[X]=A.getUniformLocation(B,X,!1),Q["offset"+X]=A.getUniformLocation(B,"offset"+X,!1)}return{program:T,source:F,webGLProgram:B,uniformLocations:Q,inShapeInfos:k,outShapeInfo:z,infLoc:V,nanLoc:G}})(u.gpgpu,t,m,y)}),b=this.activeTimers!=null;if(b&&(g=this.startTimer()),(function(A,T,R,D,N){lA(T.inShapeInfos,R),lA([T.outShapeInfo],[D]);var O=D.texData.texture,k=D.texData.texShape;D.texData.isPacked?A.setOutputPackedMatrixTexture(O,k[0],k[1]):A.setOutputMatrixTexture(O,k[0],k[1]),A.setProgram(T.webGLProgram),yt().getNumber("WEBGL_VERSION")===1&&T.infLoc!==null&&A.gl.uniform1f(T.infLoc,1/0),T.nanLoc!==null&&A.gl.uniform1f(T.nanLoc,NaN),R.forEach(function(z,F){var B=T.program.variableNames[F],V=T.uniformLocations[B],G=T.uniformLocations["offset"+B];if(V!=null)if(z.isUniform)if(Kt(z.shape)<2)A.gl.uniform1f(V,z.uniformValues[0]);else{var Q=z.uniformValues;Q instanceof Float32Array||(Q=new Float32Array(Q)),A.gl.uniform1fv(V,Q)}else z.texData.slice!=null&&G!=null&&A.gl.uniform1i(G,z.texData.slice.flatOffset),A.setInputMatrixTexture(z.texData.texture,V,F)}),N?.(A,T.webGLProgram),A.executeProgram()})(this.gpgpu,w,m,y,i),d.forEach(function(A){return u.disposeData(A.dataId)}),b&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)})),!yt().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&s===!1){var C=this.unpackTensor(c);return this.disposeData(c.dataId),C}return c},e.prototype.compileAndRun=function(t,n,a,i,s){s===void 0&&(s=!1),a=a||n[0].dtype;var u=this.runWebGLProgram(t,n,a,i,s);return at.makeTensorFromDataId(u.dataId,u.shape,u.dtype)},e.prototype.getAndSaveBinary=function(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.fromPixels2DContext!=null&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ft(function(){if(!yt().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=yt().getBool("DEBUG");yt().set("DEBUG",!1);var a=t.abs(jt(1e-8)).dataSync()[0];if(yt().set("DEBUG",n),a>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var n,a=this.texData.get(t),i=a.shape,s=a.dtype,u=a.values,c=a.texture,f=a.usage,h=a.isPacked;if(c==null){var d,m=this.activeTimers!=null;m&&(d=la());var g=a.texShape;if(g==null&&(g=y_(i,h),a.texShape=g),u!=null){var y=zp(i),x=void 0,w=g[1],b=g[0],C=u instanceof Uint8Array;h?(w=(n=Zc(g[0],g[1]))[0],b=n[1],x=new aL(y,[b,w],C)):x=new rL(y,[b,w],C);var A=this.makeTensorInfo([b,w],s);this.texData.get(A.dataId).usage=C?Mr.PIXELS:Mr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(A.dataId),w,b,u);var T=this.runWebGLProgram(x,[A],s,null,!0),R=this.texData.get(T.dataId);a.texture=R.texture,a.texShape=R.texShape,a.isPacked=R.isPacked,a.usage=R.usage,this.disposeData(A.dataId),this.texData.delete(T.dataId),a.values=null,m&&(this.uploadWaitMs+=la()-d)}else{var D=this.acquireTexture(g,f,s,h);a.texture=D}}},e.prototype.convertAndCacheOnCPU=function(t,n){var a=this.texData.get(t),i=a.dtype;return this.releaseGPUData(t),n!=null&&(a.values=(function(s,u){if(u==="float32"||u==="complex64")return s;if(u==="int32"||u==="bool"){for(var c=u==="int32"?new Int32Array(s.length):new Uint8Array(s.length),f=0;f<c.length;++f)c[f]=Math.round(s[f]);return c}throw new Error("Unknown dtype "+u)})(n,i)),a.values},e.prototype.acquireTexture=function(t,n,a,i){if(this.numBytesInGPU+=this.computeBytes(t,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,n,i)},e.prototype.computeBytes=function(t,n){return t[0]*t[1]*N1(n)},e})(Kd);ZR()&&at.registerBackend("webgl",function(){return new IO},2);var $d=rt({square_:function(r){var e=H(r,"x","square"),t=[e];return at.runKernelFunc(function(n,a){return a([e]),n.square(e)},{x:e},function(n,a){var i=a[0];return{x:function(){return n.mul(i.toFloat().mul(2))}}},"Square",{},t,[])}}),Ti=rt({abs_:function(r){var e=H(r,"x","abs");return e.dtype==="complex64"?at.runKernelFunc(function(t){return t.complexAbs(e)},{$x:e}):at.runKernelFunc(function(t,n){var a=t.abs(e);return n([e]),a},{x:e},function(t,n){var a=n[0];return{x:function(){return t.mul(a.toFloat().step(-1))}}},"Abs")}}),Qd=rt({acos_:function(r){var e=H(r,"x","acos");return at.runKernelFunc(function(t,n){var a=t.acos(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.divStrict(jt(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),Zd=rt({acosh_:function(r){var e=H(r,"x","acosh");return at.runKernelFunc(function(t,n){var a=t.acosh(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),Jd=rt({asin_:function(r){var e=H(r,"x","asin");return at.runKernelFunc(function(t,n){var a=t.asin(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.divStrict(jt(1).sub(a.toFloat().square()).sqrt())}}})}}),tm=rt({asinh_:function(r){var e=H(r,"x","asinh");return at.runKernelFunc(function(t,n){var a=t.asinh(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.divStrict(jt(1).add(a.toFloat().square()).sqrt())}}})}}),em=rt({atan_:function(r){var e=H(r,"x","atan");return at.runKernelFunc(function(t,n){var a=t.atan(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.toFloat().square().add(1))}}})}}),nm=rt({atanh_:function(r){var e=H(r,"x","atanh");return at.runKernelFunc(function(t,n){var a=t.atanh(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(jt(1).sub(a.toFloat().square()))}}})}}),rm=rt({ceil_:function(r){var e=H(r,"x","ceil");return at.runKernelFunc(function(t){return t.ceil(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),er=rt({clipByValue_:function(r,e,t){var n=H(r,"x","clipByValue");return K(e<=t,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."}),at.runKernelFunc(function(a,i){var s=a.clip(n,e,t);return i([n]),s},{$x:n},function(a,i){var s=i[0];return{$x:function(){return a.where(s.greaterEqual(e).logicalAnd(s.lessEqual(t)),ye(a))}}})}}),am=rt({cos_:function(r){var e=H(r,"x","cos");return at.runKernelFunc(function(t,n){var a=t.cos(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return a.toFloat().sin().neg().mul(t)}}})}}),im=rt({cosh_:function(r){var e=H(r,"x","cosh");return at.runKernelFunc(function(t,n){var a=t.cosh(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(t)}}})}}),om=rt({erf_:function(r){var e=H(r,"x","erf");return K(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),at.runKernelFunc(function(t,n){var a=t.erf(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),sm=rt({exp_:function(r){var e=H(r,"x","exp");return at.runKernelFunc(function(t,n){var a=t.exp(e);return n([a]),a},{$x:e},function(t,n){return{$x:function(){return t.mulStrict(n[0])}}})}}),um=rt({expm1_:function(r){var e=H(r,"x","expm1");return at.runKernelFunc(function(t,n){var a=t.expm1(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.mul(a.exp())}}})}}),uf=rt({floor_:function(r){var e=H(r,"x","floor");return at.runKernelFunc(function(t){return t.floor(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),Va=rt({log_:function(r){var e=H(r,"x","log");return at.runKernelFunc(function(t,n){var a=t.log(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.toFloat())}}})}}),lm=rt({log1p_:function(r){var e=H(r,"x","log1p");return at.runKernelFunc(function(t,n){var a=t.log1p(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.add(1))}}})}}),ex=rt({logSigmoid_:function(r){var e=H(r,"x","logSigmoid");return at.runKernelFunc(function(t,n){var a=t.softplus(e.neg()).neg();return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.mul(a.neg().sigmoid())}}})}}),Oo=rt({neg_:function(r){var e=H(r,"x","neg");return at.runKernelFunc(function(t){return t.neg(e)},{$x:e},function(t){return{$x:function(){return t.neg()}}})}}),cm=rt({reciprocal_:function(r){var e=H(r,"x","reciprocal");return at.runKernelFunc(function(t,n){var a=t.reciprocal(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.square().neg())}}})}}),fm=rt({round_:function(r){var e=H(r,"x","round");return at.runKernelFunc(function(t){return t.round(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),lf=rt({rsqrt_:function(r){var e=H(r,"x","rsqrt");return at.runKernelFunc(function(t,n){var a=t.rsqrt(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.pow(1.5).mul(2)).neg()}}})}}),ol=rt({sigmoid_:function(r){var e=H(r,"x","sigmoid");return at.runKernelFunc(function(t,n){var a=t.sigmoid(e);return n([a]),a},{x:e},function(t,n){var a=n[0];return{x:function(){return t.mul(a.mul(jt(1).sub(a)))}}},"Sigmoid")}}),hm=rt({sign_:function(r){var e=H(r,"x","sign");return at.runKernelFunc(function(t){return t.sign(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),nx=rt({isNaN_:function(r){var e=H(r,"x","isNaN");return at.runKernelFunc(function(t){return t.isNaN(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),rx=rt({isInf_:function(r){var e=H(r,"x","isInf");return at.runKernelFunc(function(t){return t.isInf(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),ax=rt({isFinite_:function(r){var e=H(r,"x","isFinite");return at.runKernelFunc(function(t){return t.isFinite(e)},{$x:e},function(t){return{$x:function(){return ye(t)}}})}}),pm=rt({sin_:function(r){var e=H(r,"x","sin");return at.runKernelFunc(function(t,n){var a=t.sin(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return a.toFloat().cos().mul(t)}}})}}),dm=rt({sinh_:function(r){var e=H(r,"x","sinh");return at.runKernelFunc(function(t,n){var a=t.sinh(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(t)}}})}}),sl=rt({softplus_:function(r){var e=H(r,"x","softplus");return at.runKernelFunc(function(t,n){var a=t.softplus(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.mul(a.sigmoid())}}})}}),Fs=rt({sqrt_:function(r){var e=H(r,"x","sqrt");return at.runKernelFunc(function(t,n){var a=t.sqrt(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.toFloat().sqrt().mul(2))}}})}}),ix=rt({step_:function(r,e){e===void 0&&(e=0);var t=H(r,"x","step");return at.runKernelFunc(function(n){return n.step(t,e)},{$x:t},function(n){return{$x:function(){return ye(n)}}})}}),mm=rt({tan_:function(r){var e=H(r,"x","tan");return at.runKernelFunc(function(t,n){var a=t.tan(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.div(a.cos().square())}}})}}),cf=rt({tanh_:function(r){var e=H(r,"x","tanh");return at.runKernelFunc(function(t,n){var a=t.tanh(e);return n([a]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return jt(1).sub(a.square()).mulStrict(t)}}})}});function kO(r,e,t,n,a,i){var s,u,c=H(r,"x","batchNorm"),f=H(e,"mean","batchNorm"),h=H(t,"variance","batchNorm");return a!=null&&(s=H(a,"scale","batchNorm")),n!=null&&(u=H(n,"offset","batchNorm")),K(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),K(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),K(h.rank===2||h.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+h.rank+"."}),s!=null&&K(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),u!=null&&K(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+u.rank+"."}),ff(c,f,h,u,s,i)}function MO(r,e,t,n,a,i){var s,u,c=H(r,"x","batchNorm"),f=H(e,"mean","batchNorm"),h=H(t,"variance","batchNorm");return a!=null&&(s=H(a,"scale","batchNorm")),n!=null&&(u=H(n,"offset","batchNorm")),K(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),K(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),K(h.rank===3||h.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+h.rank+"."}),s!=null&&K(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),u!=null&&K(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+u.rank+"."}),ff(c,f,h,u,s,i)}function zO(r,e,t,n,a,i){var s,u,c=H(r,"x","batchNorm"),f=H(e,"mean","batchNorm"),h=H(t,"variance","batchNorm");return a!=null&&(s=H(a,"scale","batchNorm")),n!=null&&(u=H(n,"offset","batchNorm")),K(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),K(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),K(h.rank===4||h.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+h.rank+"."}),s!=null&&K(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),u!=null&&K(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+u.rank+"."}),ff(c,f,h,u,s,i)}function ff(r,e,t,n,a,i){i==null&&(i=.001);var s,u,c,f=H(r,"x","batchNorm"),h=H(e,"mean","batchNorm"),d=H(t,"variance","batchNorm");a!=null&&(s=H(a,"scale","batchNorm")),n!=null&&(u=H(n,"offset","batchNorm")),K(h.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),K(u==null||h.rank===u.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),K(s==null||h.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,h,d,s];return at.runKernelFunc(function(g,y){var x=g.batchNormalization(c,dp(h),dp(d),i,dp(s),dp(u));return y([f,h,d,s]),x},{x:f,mean:h,variance:d,scale:s,offset:u},function(g,y){var x=y,w=x[0],b=x[1],C=x[2],A=x[3],T=A??jt(1),R=In(b.shape,c.shape),D=[];if(b.rank===1){for(var N=0;N<c.shape.length-1;++N)D.push(c.shape[N]);D.push(1)}var O=w.sub(b),k=g.mul(T),z=lf(C.add(jt(i))),F=z.mul(z).mul(z).mul(jt(-.5));return{x:function(){return b.rank===1?g.mul(bi(z.as4D(1,1,1,b.shape[0]),D)).mul(T).reshape(w.shape):g.mul(z).mul(T).reshape(w.shape)},mean:function(){var B=z.mul(jt(-1)).mul(k);return b.rank===1&&(B=B.sum(R)),B.reshape(b.shape)},variance:function(){var B=F.mul(O).mul(k);return b.rank===1&&(B=B.sum(R)),B.reshape(b.shape)},scale:function(){var B=O.mul(z),V=g.mul(B);return b.rank===1&&(V=V.sum(R)),V.reshape(b.shape)},offset:function(){var B=g;return b.rank===1&&(B=B.sum(R)),B.reshape(b.shape)}}},"BatchNormalization",{varianceEpsilon:i},m).reshape(f.shape)}function dp(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function vm(){Jc("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var ox=rt({batchNormalization2d_:function(r,e,t,n,a,i){return n===void 0&&(n=.001),vm(),kO(r,e,t,i,a,n)}}),sx=rt({batchNormalization3d_:function(r,e,t,n,a,i){return n===void 0&&(n=.001),vm(),MO(r,e,t,i,a,n)}}),ux=rt({batchNormalization4d_:function(r,e,t,n,a,i){return n===void 0&&(n=.001),vm(),zO(r,e,t,i,a,n)}}),lx=rt({batchNormalization_:function(r,e,t,n,a,i){return n===void 0&&(n=.001),vm(),ff(r,e,t,i,a,n)}}),gm=rt({batchNorm_:ff}),ym=rt({batchNorm2d_:kO}),bm=rt({batchNorm3d_:MO}),xm=rt({batchNorm4d_:zO}),Ga=rt({logicalAnd_:function(r,e){var t=H(r,"a","logicalAnd","bool"),n=H(e,"b","logicalAnd","bool");return ge(t.shape,n.shape),at.runKernelFunc(function(a){return a.logicalAnd(t,n)},{$a:t,$b:n})}}),wm=rt({logicalNot_:function(r){var e=H(r,"x","logicalNot","bool");return at.runKernelFunc(function(t){return t.logicalNot(e)},{$x:e})}}),hf=rt({logicalOr_:function(r,e){var t=H(r,"a","logicalOr","bool"),n=H(e,"b","logicalOr","bool");return ge(t.shape,n.shape),at.runKernelFunc(function(a){return a.logicalOr(t,n)},{$a:t,$b:n})}}),cx=rt({logicalXor_:function(r,e){var t=H(r,"a","logicalXor","bool"),n=H(e,"b","logicalXor","bool");return ge(t.shape,n.shape),hf(r,e).logicalAnd(Ga(r,e).logicalNot())}}),qa=rt({where_:function(r,e,t){var n=H(e,"a","where"),a=H(t,"b","where"),i=H(r,"condition","where","bool");return Ce(n.shape,a.shape,"Error in where: "),i.rank===1?K(i.shape[0]===n.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ce(i.shape,a.shape,"Error in where: "),at.runKernelFunc(function(s,u){var c=s.select(i,n,a);return u([i]),c},{$condition:i,$a:n,$b:a},function(s,u){var c=u[0];return{$condition:function(){return ye(c).toFloat()},$a:function(){return s.mul(c.cast(s.dtype))},$b:function(){return s.mul(c.logicalNot().cast(s.dtype))}}})}}),pf=function(r){return Ht(this,void 0,void 0,function(){var e,t,n;return Gt(this,function(a){switch(a.label){case 0:return[4,(e=H(r,"condition","whereAsync","bool")).data()];case 1:return t=a.sent(),n=Q1(e.shape,t),r!==e&&e.dispose(),[2,n]}})})},se=rt({add_:function(r,e){var t,n=H(r,"a","add"),a=H(e,"b","add");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s){return s.add(n,a)},{a:n,b:a},function(s){return{a:function(){var u=s,c=In(n.shape,i);return c.length>0&&(u=u.sum(c)),u.reshape(n.shape)},b:function(){var u=s,c=In(a.shape,i);return c.length>0&&(u=u.sum(c)),u.reshape(a.shape)}}},"Add")}}),Sm=rt({addN_:function(r){K(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),K(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length});var e=r.map(function(a,i){return H(a,"tensors"+i,"addN")}),t=e[0];e.forEach(function(a){if(a.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(a){if(!Pn(a.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=e;return at.runKernelFunc(function(a){return a.addN(e)},n,function(a){var i={};return e.forEach(function(s,u){i[u]=function(){return a.clone()}}),i})}}),fx=rt({addStrict_:function(r,e){var t=H(r,"a","addStrict"),n=H(e,"b","addStrict");return Ce(t.shape,n.shape,"Error in addStrict: "),t.add(n)}}),Em=rt({atan2_:function(r,e){var t,n=H(r,"a","atan2"),a=H(e,"b","atan2");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s,u){var c=s.atan2(n,a);return u([n,a]),c},{$a:n,$b:a},function(s,u){var c=u[0],f=u[1];return{$a:function(){var h=se(c.square(),f.square()),d=s.mul(f.div(h)),m=In(c.shape,i);return m.length>0&&(d=d.sum(m)),d.reshape(c.shape)},$b:function(){var h=se(c.square(),f.square()),d=Oo(s.mul(c.div(h))),m=In(f.shape,i);return m.length>0&&(d=d.sum(m)),d.reshape(f.shape)}}})}}),Sn=rt({div_:function(r,e){var t,n=H(r,"a","div"),a=H(e,"b","div");if(t=vn(n,a),n=t[0],a=t[1],n.dtype==="int32"&&a.dtype==="int32")return df(n,a);var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s,u){var c=s.realDivide(n,a);return u([n,a]),c},{a:n,b:a},function(s,u){var c=u[0],f=u[1];return{a:function(){var h=s.div(f.toFloat()),d=In(c.shape,i);return d.length>0?h.sum(d).reshape(c.shape):h},b:function(){var h=s.mul(c.toFloat()),d=In(f.shape,i);d.length>0&&(h=h.sum(d).reshape(f.shape));var m=f.square();return h.div(m.toFloat()).neg()}}},"Div")}}),hx=rt({divStrict_:function(r,e){var t=H(r,"a","div"),n=H(e,"b","div");return Ce(t.shape,n.shape,"Error in divideStrict: "),t.div(n)}}),df=rt({floorDiv_:function(r,e){var t,n=H(r,"a","floorDiv"),a=H(e,"b","floorDiv");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s,u){var c=s.floorDiv(n,a);return u([n,a]),c},{$a:n,$b:a},function(s,u){var c=u[0],f=u[1];return{$a:function(){var h=s.div(f.toFloat()),d=In(c.shape,i);return d.length>0?h.sum(d).reshape(c.shape):h},$b:function(){var h=s.mul(c.toFloat()),d=In(f.shape,i);d.length>0&&(h=h.sum(d).reshape(f.shape));var m=f.square();return h.div(m.toFloat()).neg()}}})}}),Ca=rt({maximum_:function(r,e){var t,n=H(r,"a","maximum"),a=H(e,"b","maximum");return t=vn(n,a),n=t[0],a=t[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),ge(n.shape,a.shape),at.runKernelFunc(function(i,s){var u=i.maximum(n,a);return s([n,a]),u},{$a:n,$b:a},function(i,s){var u=s[0],c=s[1];return{$a:function(){return i.mul(u.greaterEqual(c).toFloat())},$b:function(){return i.mul(u.less(c).toFloat())}}})}}),px=rt({maximumStrict_:function(r,e){var t=H(r,"a","maximumStrict"),n=H(e,"b","maximumStrict");return Ce(t.shape,n.shape,"Error in maximumStrict: "),t.maximum(n)}}),Bs=rt({minimum_:function(r,e){var t,n=H(r,"a","minimum"),a=H(e,"b","minimum");return t=vn(n,a),n=t[0],a=t[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),ge(n.shape,a.shape),at.runKernelFunc(function(i,s){var u=i.minimum(n,a);return s([n,a]),u},{$a:n,$b:a},function(i,s){var u=s[0],c=s[1];return{$a:function(){return i.mul(u.lessEqual(c).toFloat())},$b:function(){return i.mul(u.greater(c).toFloat())}}})}}),dx=rt({minimumStrict_:function(r,e){var t=H(r,"a","minimumStrict"),n=H(e,"b","minimumStrict");return Ce(t.shape,n.shape,"Error in minimumStrict: "),t.minimum(n)}}),Cm=rt({mod_:function(r,e){var t,n=H(r,"a","mod"),a=H(e,"b","mod");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s,u){var c=s.mod(n,a);return u([n,a]),c},{$a:n,$b:a},function(s,u){var c=u[0],f=u[1];return{$a:function(){var h=In(c.shape,i);return h.length>0?s.sum(h).reshape(c.shape):s},$b:function(){var h=s.mul(c.div(f).floor().neg()),d=In(f.shape,i);return d.length>0?h.sum(d).reshape(f.shape):h}}})}}),mx=rt({modStrict_:function(r,e){var t=H(r,"a","modStrict"),n=H(e,"b","modStrict");return Ce(t.shape,n.shape,"Error in modStrict: "),t.mod(n)}}),Jt=rt({mul_:function(r,e){var t,n=H(r,"a","mul"),a=H(e,"b","mul");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s,u){var c=s.multiply(n,a);return u([n,a]),c},{a:n,b:a},function(s,u){var c=u[0],f=u[1];return{a:function(){var h=s.mul(f.toFloat()),d=In(c.shape,i);return d.length>0?h.sum(d).reshape(c.shape):h},b:function(){var h=s.mul(c.toFloat()),d=In(f.shape,i);return d.length>0?h.sum(d).reshape(f.shape):h}}},"Mul")}}),mf=rt({mulStrict_:function(r,e){var t=H(r,"a","mul"),n=H(e,"b","mul");return Ce(t.shape,n.shape,"Error in multiplyStrict: "),t.mul(n)}}),Ss=rt({pow_:function(r,e){var t=H(r,"base","pow"),n=H(e,"exp","pow"),a=ge(t.shape,n.shape);return r=t.cast(_n(t.dtype,n.dtype)),e=n.cast(_n(t.dtype,n.dtype)),at.runKernelFunc(function(i,s){var u=i.pow(t,n);return s([t,n,u]),u},{$base:t,$exp:n},function(i,s){var u=s[0],c=s[1],f=s[2];return{$base:function(){var h=c.toFloat(),d=i.mul(h.mul(u.pow(h.sub(jt(1))))),m=In(u.shape,a);return m.length>0&&(d=d.sum(m)),d.reshape(u.shape)},$exp:function(){var h=u.greater(0),d=u.log().where(h,ye(u)),m=i.mul(f.mul(d)),g=In(c.shape,a);return g.length>0&&(m=m.sum(g)),m.reshape(c.shape)}}})}}),vx=rt({powStrict_:function(r,e){return Ce(r.shape,e.shape,"Error in powStrict: "),r.pow(e)}}),Am=rt({squaredDifference_:function(r,e){var t,n=H(r,"a","squaredDifference"),a=H(e,"b","squaredDifference");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i,s){var u=i.squaredDifference(n,a);return s([n,a]),u},{$a:n,$b:a},function(i,s){var u=s[0],c=s[1],f=jt(2);return{$a:function(){return i.mul(u.sub(c).mul(f))},$b:function(){return i.mul(c.sub(u).mul(f))}}})}}),gx=rt({squaredDifferenceStrict_:function(r,e){var t=H(r,"a","squaredDifferenceStrict"),n=H(e,"b","squaredDifferenceStrict");return Ce(t.shape,n.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(n)}}),gn=rt({sub_:function(r,e){var t,n=H(r,"a","sub"),a=H(e,"b","sub");t=vn(n,a),n=t[0],a=t[1];var i=ge(n.shape,a.shape);return at.runKernelFunc(function(s){return s.subtract(n,a)},{a:n,b:a},function(s){return{a:function(){var u=s,c=In(n.shape,i);return c.length>0&&(u=u.sum(c)),u.reshape(n.shape)},b:function(){var u=s,c=In(a.shape,i);return c.length>0&&(u=u.sum(c)),u.neg().reshape(a.shape)}}},"Sub")}}),yx=rt({subStrict_:function(r,e){var t=H(r,"a","subStrict"),n=H(e,"b","subStrict");return Ce(t.shape,n.shape,"Error in subStrict: "),t.sub(n)}}),Do=rt({equal_:function(r,e){var t,n=H(r,"a","equal"),a=H(e,"b","equal");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i){return i.equal(n,a)},{$a:n,$b:a})}}),bx=rt({equalStrict_:function(r,e){var t=H(r,"a","equalStrict"),n=H(e,"b","equalStrict");return Ce(t.shape,n.shape,"Error in equalStrict: "),t.equal(n)}}),Ls=rt({greater_:function(r,e){var t,n=H(r,"a","greater"),a=H(e,"b","greater");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i){return i.greater(n,a)},{$a:n,$b:a})}}),ul=rt({greaterEqual_:function(r,e){var t,n=H(r,"a","greaterEqual"),a=H(e,"b","greaterEqual");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i,s){var u=i.greaterEqual(n,a);return s([n,a]),u},{$a:n,$b:a},function(i,s){var u=s[0],c=s[1];return{$a:function(){return ye(u)},$b:function(){return ye(c)}}})}}),xx=rt({greaterEqualStrict_:function(r,e){var t=H(r,"a","greaterEqualStrict"),n=H(e,"b","greaterEqualStrict");return Ce(t.shape,n.shape,"Error in greaterEqualStrict: "),t.greaterEqual(n)}}),wx=rt({greaterStrict_:function(r,e){var t=H(r,"a","greaterStrict"),n=H(e,"b","greaterStrict");return Ce(t.shape,n.shape,"Error in greaterStrict: "),t.greater(n)}}),Nm=rt({less_:function(r,e){var t,n=H(r,"a","less"),a=H(e,"b","less");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i){return i.less(n,a)},{$a:n,$b:a})}}),Tm=rt({lessEqual_:function(r,e){var t,n=H(r,"a","lessEqual"),a=H(e,"b","lessEqual");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i){return i.lessEqual(n,a)},{$a:n,$b:a})}}),Sx=rt({lessEqualStrict_:function(r,e){var t=H(r,"a","lessEqualStrict"),n=H(e,"b","lessEqualStrict");return Ce(t.shape,n.shape,"Error in lessEqualStrict: "),t.lessEqual(n)}}),Ex=rt({lessStrict_:function(r,e){var t=H(r,"a","lessStrict"),n=H(e,"b","lessStrict");return Ce(t.shape,n.shape,"Error in lessStrict: "),t.less(n)}}),Es=rt({notEqual_:function(r,e){var t,n=H(r,"a","notEqual"),a=H(e,"b","notEqual");return t=vn(n,a),n=t[0],a=t[1],ge(n.shape,a.shape),at.runKernelFunc(function(i){return i.notEqual(n,a)},{$a:n,$b:a})}}),Cx=rt({notEqualStrict_:function(r,e){var t=H(r,"a","notEqualStrict"),n=H(e,"b","notEqualStrict");return Ce(t.shape,n.shape,"Error in notEqualStrict: "),t.notEqual(n)}});function bA(r,e){for(var t=[],n=r;n<e;++n)t.push(n);return t}function xA(r){for(var e=[],t=0;t<r.length;++t)for(var n=0;n<r[t].length;++n)e.push(r[t][n]);return e}var fa=rt({gather_:function(r,e,t){t===void 0&&(t=0);var n=H(r,"x","gather"),a=H(e,"indices","gather","int32");t=qn(t,n.shape)[0];var i=(function(s,u,c){for(var f=s.shape[c],h=[],d=1,m=1,g=0;g<c;g++)h.push(s.shape[g]),d*=s.shape[g];for(g=0;g<u.rank;g++)h.push(u.shape[g]);for(g=c+1;g<s.rank;g++)h.push(s.shape[g]),m*=s.shape[g];return{batchSize:d,sliceSize:m,dimSize:f,outputShape:h}})(n,a,t);return at.runKernelFunc(function(s,u){var c=s.gather(n,a.flatten(),t);return u([a]),c},{$x:n},function(s,u){var c=u[0];return{$x:function(){var f=n.shape,h=c.size,d=f.slice(0,t),m=d.length,g=f.slice(t,f.length).slice(1),y=g.length,x=bA(0,m),w=bA(m+1,m+1+y),b=xA([d,[h],g]),C=s.reshape(b),A=c.reshape([h]),T=xA([[m],x,w]),R=C.transpose(T),D=Rm(R,A,n.shape[t]),N=Id(T);return D=D.transpose(N)}}}).reshape(i.outputShape)}}),Rm=rt({unsortedSegmentSum_:function(r,e,t){var n=H(r,"x","unsortedSegmentSum"),a=H(e,"segmentIds","unsortedSegmentSum","int32");return K(mn(t),function(){return"numSegments must be of dtype int"}),at.runKernelFunc(function(i,s){var u=i.unsortedSegmentSum(n,a,t);return s([a]),u},{$x:n},function(i,s){var u=s[0];return{$x:function(){return(function(c,f){for(var h=Ca(f,ye(f)),d=fa(c,h),m=ul(f,jt(0,"int32")),g=d.rank-m.rank,y=0;y<g;++y)m=Qn(m,y+1);m=Ga(m,Sa(d.shape,"bool"));var x=ye(d);return qa(m,d,x)})(i,u)}}})}}),Ax=function(r,e,t){return Ht(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x;return Gt(this,function(w){switch(w.label){case 0:for(n=H(r,"tensor","boolMask"),a=H(e,"mask","boolMask","bool"),i=t??0,s=a.rank,u=n.shape,K(s>0,function(){return"mask cannot be scalar"}),Ce(u.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+s;f++)c*=u[f];return h=u.slice(0,i).concat([c],u.slice(i+s)),d=n.reshape(h),m=a.reshape([-1]),[4,pf(m)];case 1:return g=w.sent(),y=g.squeeze([1]),x=fa(d,y,i),r!==n&&n.dispose(),e!==a&&a.dispose(),y.dispose(),d.dispose(),m.dispose(),g.dispose(),[2,x]}})})};function FO(r,e,t,n,a,i,s){i===void 0&&(i="NHWC"),K(r.length===e.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+e.rank+") must match"});var u=r,c=e,f=!1;e.rank===3&&(f=!0,c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),u=[1,r[0],r[1],r[2]]),K(u.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+u.length+"."}),K(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),K(t.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank});var h=i==="NHWC"?u[3]:u[1],d=i==="NHWC"?c.shape[3]:c.shape[1];K(h===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+h+") must match input depth for filter "+t.shape[2]+"."}),K(d===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+t.shape[3]+"."}),s!=null&&K(mn(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var m=Yd(i),g=_o(u,t.shape,n,1,a,s,!1,m),y=at.runKernelFunc(function(x,w){var b=x.conv2dDerInput(c,t,g);return w([t,c]),b},{dy4D:c,filter:t},function(x,w){var b=w[0],C=w[1];return{dy4D:function(){return Io(x,b,n,a,i,1,s)},filter:function(){return Nx(x,C,b.shape,n,a,i,s)}}});return f?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}function Vy(r){var e=(function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i})(r),t=e[0],n=e[1],a=e[2];return t===1&&n===1&&a===1}function BO(r,e,t,n,a){K(r.length===e.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+e.rank+") must match"});var i=r,s=e,u=!1;e.rank===4&&(u=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,r[0],r[1],r[2],r[3]]);var c=i[4],f=s.shape[4];K(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),K(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),K(t.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank}),K(c===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+t.shape[3]+"."}),K(f===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+t.shape[4]+"."});var h=Pc(i,t.shape,n,1,a),d=at.runKernelFunc(function(m){return m.conv3dDerInput(s,t,h)},{dy5D:s});return u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var vf=rt({conv1d_:function(r,e,t,n,a,i,s){a===void 0&&(a="NWC"),i===void 0&&(i=1);var u=H(r,"x","conv1d"),c=H(e,"filter","conv1d"),f=u,h=!1;u.rank===2&&(h=!0,f=u.as3D(1,u.shape[0],u.shape[1])),K(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),K(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),s!=null&&K(mn(n),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}),K(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),K(cr(t,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+i+"'"}),K(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=Io(m,d,[1,t],n,"NHWC",[1,i],s);return h?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),Io=rt({conv2d_:function(r,e,t,n,a,i,s){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var u=H(r,"x","conv2d"),c=H(e,"filter","conv2d"),f=u,h=!1;u.rank===3&&(h=!0,f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),K(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),K(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),s!=null&&K(mn(n),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var d=a==="NHWC"?f.shape[3]:f.shape[1];K(d===c.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+c.shape[2]+"."}),K(cr(t,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"});var m=Yd(a),g=_o(f.shape,c.shape,t,i,n,s,!1,m),y=at.runKernelFunc(function(x,w){var b=x.conv2d(f,c,g);return w([c,f]),b},{x:f,$filter:c},function(x,w){var b=w,C=b[0],A=b[1];return K(ws(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return LO(A.shape,x,C,t,n,a)},$filter:function(){return Nx(A,x,C.shape,t,n,a)}}});return h?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),gf=rt({conv3d_:function(r,e,t,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var s=H(r,"x","conv3d"),u=H(e,"filter","conv3d"),c=s,f=!1;s.rank===4&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),K(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),K(u.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+u.rank+"."}),K(c.shape[4]===u.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+u.shape[3]+"."}),K((function(m,g){return Vy(m)||Vy(g)})(t,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"}),K(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var h=Pc(c.shape,u.shape,t,i,n),d=at.runKernelFunc(function(m,g){var y=m.conv3d(c,u,h);return g([c,u]),y},{x:c,$filter:u},function(m,g){K(Vy(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var y=g[0],x=g[1];return{x:function(){return BO(y.shape,m,x,t,n)},$filter:function(){return(function(w,b,C,A,T){var R=w;w.rank===4&&(R=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var D=b;D.rank===4&&(D=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),K(R.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+R.shape+"."}),K(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),K(C.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+C+"."}),K(R.shape[4]===C[3],function(){return"Error in conv3dDerFilter: depth of input "+R.shape[4]+") must match input depth in filter ("+C[3]+"."}),K(D.shape[4]===C[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+C[4]+")."});var N=Pc(R.shape,C,A,1,T);return at.runKernelFunc(function(O){return O.conv3dDerFilter(R,D,N)},{x5D:R,dy5D:D})})(y,m,x.shape,t,n)}}});return f?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Nx=rt({conv2dDerFilter_:function(r,e,t,n,a,i,s){i===void 0&&(i="NHWC");var u=r;r.rank===3&&(u=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var c=e;c.rank===3&&(c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),K(u.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+u.shape+"."}),K(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),K(t.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."});var f=i==="NHWC"?u.shape[3]:u.shape[1],h=i==="NHWC"?c.shape[3]:c.shape[1];K(f===t[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+t[2]+"."}),K(h===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+h+") must match output depth for filter ("+t[3]+")."}),s!=null&&K(mn(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var d=Yd(i),m=_o(u.shape,t,n,1,a,s,!1,d);return at.runKernelFunc(function(g){return g.conv2dDerFilter(u,c,m)},{x4D:u,dy4D:c})}}),LO=rt({conv2dDerInput_:FO}),Us=rt({depthwiseConv2d_:function(r,e,t,n,a,i,s){i===void 0&&(i=[1,1]);var u=H(r,"x","depthwiseConv2d"),c=H(e,"filter","depthwiseConv2d"),f=u,h=!1;u.rank===3&&(h=!0,f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),K(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),K(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),K(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),K(cr(t,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"}),s!=null&&K(mn(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var d=_o(f.shape,c.shape,t,i,n,s,!0),m=at.runKernelFunc(function(g,y){var x=g.depthwiseConv2D(f,c,d);return y([f,c]),x},{x:f,$filter:c},function(g,y){K(ws(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var x=y[0],w=y[1];return{x:function(){return UO(x.shape,g,w,d)},$filter:function(){return jO(x,g,w.shape,d)}}});return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),UO=rt({depthwiseConv2dDerInput_:function(r,e,t,n){var a=e,i=!1;e.rank===3&&(i=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=at.runKernelFunc(function(u){return u.depthwiseConv2DDerInput(a,t,n)},{dy4D:a});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),jO=rt({depthwiseConv2dDerFilter_:function(r,e,t,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),at.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(a,i,n)},{x4D:a,dy4D:i})}}),_m=rt({separableConv2d_:function(r,e,t,n,a,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var u=H(r,"x","separableConv2d"),c=H(e,"depthwiseFilter","separableConv2d"),f=H(t,"pointwiseFilter","separableConv2d"),h=u,d=!1;if(u.rank===3&&(d=!0,h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");K(h.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+h.rank+"."}),K(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),K(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),K(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),K(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];K(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var y=Us(h,c,n,a,s,i),x=Io(y,f,1,"valid",s);return d?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),yf=rt({conv2dTranspose_:function(r,e,t,n,a,i){return FO(t,H(r,"x","conv2dTranspose"),H(e,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),Tx=rt({conv3dTranspose_:function(r,e,t,n,a){return BO(t,H(r,"x","conv3dTranspose"),H(e,"filter","conv3dTranspose"),n,a)}}),bf=rt({matMul_:function(r,e,t,n){var a;t===void 0&&(t=!1),n===void 0&&(n=!1);var i=H(r,"a","matMul"),s=H(e,"b","matMul");a=vn(i,s),i=a[0],s=a[1];var u=t?i.shape[i.rank-2]:i.shape[i.rank-1],c=n?s.shape[s.rank-1]:s.shape[s.rank-2],f=t?i.shape[i.rank-1]:i.shape[i.rank-2],h=n?s.shape[s.rank-2]:s.shape[s.rank-1],d=i.shape.slice(0,-2),m=s.shape.slice(0,-2),g=Kt(d),y=Kt(m);K(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),K(Pn(d,m),function(){return"Error in matMul: outer dimensions ("+d+") and ("+m+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),K(u===c,function(){return"Error in matMul: inner shapes ("+u+") and ("+c+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+t+" and transposeB="+n+" must match."});var x=i.shape.slice(0,-2).concat([f,h]),w=t?i.as3D(g,u,f):i.as3D(g,f,u),b=n?s.as3D(y,h,c):s.as3D(y,c,h),C={transposeA:t,transposeB:n};return at.runKernelFunc(function(A,T){var R=A.batchMatMul(w,b,t,n);return T([w,b]),R},{a:w,b},function(A,T){var R=T,D=R[0],N=R[1];return t||n?!t&&n?{a:function(){return A.matMul(N,!1,!1)},b:function(){return A.matMul(D,!0,!1)}}:t&&!n?{a:function(){return N.matMul(A,!1,!0)},b:function(){return D.matMul(A,!1,!1)}}:{a:function(){return N.matMul(A,!0,!0)},b:function(){return A.matMul(D,!0,!0)}}:{a:function(){return A.matMul(N,!1,!0)},b:function(){return D.matMul(A,!0,!1)}}},"BatchMatMul",C).reshape(x)}}),Rx=rt({dot_:function(r,e){var t=H(r,"t1","dot"),n=H(e,"t2","dot");K(!(t.rank!==1&&t.rank!==2||n.rank!==1&&n.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+n.rank+"."});var a=t.rank===1?t.size:t.shape[1],i=n.rank===1?n.size:n.shape[0];return K(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),t.rank===1&&n.rank===1?t.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():t.rank===1&&n.rank===2?t.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():t.rank===2&&n.rank===1?t.matMul(n.as2D(-1,1)).as1D():t.matMul(n.as2D(n.shape[0],n.shape[1]))}}),_x=rt({outerProduct_:function(r,e){var t=H(r,"v1","outerProduct"),n=H(e,"v2","outerProduct");return K(t.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+n.rank+"."}),t.as2D(-1,1).matMul(n.as2D(1,-1))}}),va=rt({reverse_:function(r,e){var t=H(r,"x","reverse");if(t.rank===0)return t.clone();var n=qn(e,t.shape);return at.runKernelFunc(function(a){return a.reverse(t,n)},{$x:t},function(a){return{$x:function(){return a.reverse(n)}}}).reshapeAs(t)}}),Ox=rt({reverse1d_:function(r){var e=H(r,"x","reverse");return K(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),va(e,0)}}),Dx=rt({reverse2d_:function(r,e){var t=H(r,"x","reverse");return K(t.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),va(t,e)}}),Ix=rt({reverse3d_:function(r,e){var t=H(r,"x","reverse");return K(t.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),va(t,e)}}),kx=rt({reverse4d_:function(r,e){var t=H(r,"x","reverse");return K(t.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),va(t,e)}});function PO(r,e,t,n,a,i){var s=H(r,"x","maxPool"),u=s,c=!1;s.rank===3&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),K(u.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+u.rank+"."}),K(cr(t,n),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+n+"'"}),i!=null&&K(mn(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Xu(u.shape,e,t,n,a,i),h=at.runKernelFunc(function(d,m){var g=d.maxPool(u,f);return m([u,g]),g},{x:u},function(d,m){var g=m[0],y=m[1];return{x:function(){return(function(x,w,b,C,A,T,R,D){var N=H(x,"dy","maxPoolBackprop"),O=H(w,"input","maxPoolBackprop"),k=H(b,"output","maxPoolBackprop");K(O.rank===N.rank,function(){return"Rank of input ("+O.rank+") does not match rank of dy ("+N.rank+")"}),K(cr(A,T),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+A+" and dilations '"+T+"'"}),K(N.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."}),K(O.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+O.rank+"."});var z=Xu(O.shape,C,A,T,R,D);return at.runKernelFunc(function(F){return F.maxPoolBackprop(N,O,k,z)},{$dy:N,$input:O})})(d,g,y,e,t,n,a)}}});return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function VO(r,e,t,n,a,i){var s=H(r,"x","avgPool","float32");K(cr(t,n),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+n+"'"});var u=s,c=!1;s.rank===3&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),K(u.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+u.rank+"."}),i!=null&&K(mn(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Xu(u.shape,e,t,n,a,i),h=at.runKernelFunc(function(d){return d.avgPool(u,f)},{x:u},function(d){return{x:function(){return(function(m,g,y,x,w,b){var C=H(m,"dy","avgPoolBackprop"),A=H(g,"input","avgPoolBackprop");K(A.rank===C.rank,function(){return"Rank of input ("+A.rank+") does not match rank of dy ("+C.rank+")"}),K(cr(x,w),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"});var T=A,R=C,D=!1;A.rank===3&&(D=!0,T=A.as4D(1,A.shape[0],A.shape[1],A.shape[2]),R=C.as4D(1,C.shape[0],C.shape[1],C.shape[2])),K(R.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+R.rank+"."}),K(T.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+T.rank+"."});var N=Xu(T.shape,y,x,w,b),O=at.runKernelFunc(function(k){return k.avgPoolBackprop(R,T,N)},{dy4D:R,input4D:T});return D?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O})(d,u,e,t,n,a)}}});return h=h.cast(s.dtype),c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}var xf=rt({maxPool_:function(r,e,t,n,a){return PO(r,e,t,1,n,a)}}),wf=rt({avgPool_:function(r,e,t,n,a){return VO(r,e,t,1,n,a)}}),Mx=rt({pool_:function(r,e,t,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var s=H(r,"x","maxPool"),u=s,c=!1;s.rank===3&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),K(cr(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,h=Xu(u.shape,e,i,a,n),d=[h.dilationHeight,h.dilationWidth];f=n==="same"?(function(T,R){var D=T.map(function(k,z){return k+(k-1)*(R[z]-1)}).map(function(k){return k-1}),N=D.map(function(k){return Math.floor(k/2)}),O=D.map(function(k,z){return k-N[z]});return D.map(function(k,z){return[N[z],O[z]]})})([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var m=d[0]===1&&d[1]===1,g=(function(T,R,D){var N=D.map(function(G){return G[0]}),O=D.map(function(G){return G[1]}),k=T.concat(N,O),z=R.map(function(G,Q){return(G-k[Q]%G)%G}),F=O.map(function(G,Q){return G+z[Q]}),B=R.map(function(G,Q){return[N[Q],F[Q]]}),V=R.map(function(G,Q){return[0,z[Q]]});return[B,V]})([h.inHeight,h.inWidth],d,f),y=g[0],x=g[1],w=m?n:"valid",b=m?u:af(u,d,y),C=(t==="avg"?function(){return VO(b,e,i,1,w)}:function(){return PO(b,e,i,1,w)})(),A=m?C:nf(C,d,x);return c?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),Sf=rt({maxPool3d_:function(r,e,t,n,a,i,s){i===void 0&&(i="NDHWC");var u=H(r,"x","maxPool3d"),c=u,f=!1;u.rank===4&&(f=!0,c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),s==null&&(s=[1,1,1]),K(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),K(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),K(cr(t,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"}),a!=null&&K(mn(n),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var h=jc(c.shape,e,t,s,n,a,i),d=at.runKernelFunc(function(m,g){var y=m.maxPool3d(c,h);return g([c,y]),y},{x:c},function(m,g){var y=g[0],x=g[1];return{x:function(){return(function(w,b,C,A,T,R,D,N){var O=H(w,"dy","maxPool3dBackprop"),k=H(b,"input","maxPool3dBackprop"),z=H(C,"output","maxPool3dBackprop"),F=O,B=k,V=z,G=!1;k.rank===4&&(G=!0,F=O.as5D(1,O.shape[0],O.shape[1],O.shape[2],O.shape[3]),B=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),V=z.as5D(1,z.shape[0],z.shape[1],z.shape[2],z.shape[3])),K(F.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+F.rank+"."}),K(B.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+B.rank+"."}),K(V.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+V.rank+"."}),R==null&&(R=[1,1,1]),K(cr(T,R),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+T+" and dilations '"+R+"'"}),N!=null&&K(mn(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+N+" but got pad "+D+"."});var Q=jc(B.shape,A,T,R,D,N),L=at.runKernelFunc(function(X){return X.maxPool3dBackprop(F,B,V,Q)},{dy5D:F,input5D:B});return G?L.as4D(L.shape[1],L.shape[2],L.shape[3],L.shape[4]):L})(m,y,x,e,t,s,n,a)}}});return f?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Ef=rt({avgPool3d_:function(r,e,t,n,a,i,s){i===void 0&&(i="NDHWC");var u=H(r,"x","avgPool3d","float32"),c=u,f=!1;u.rank===4&&(f=!0,c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),s==null&&(s=[1,1,1]),K(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),K(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),K(cr(t,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"}),a!=null&&K(mn(n),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var h=jc(c.shape,e,t,s,n,a,i),d=at.runKernelFunc(function(m){return m.avgPool3d(c,h)},{x:c},function(m){return{x:function(){return(function(g,y,x,w,b,C,A){var T=H(g,"dy","avgPool3dBackprop"),R=H(y,"input","avgPool3dBackprop"),D=T,N=R,O=!1;R.rank===4&&(O=!0,D=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3]),N=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),K(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),K(N.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+N.rank+"."}),b==null&&(b=[1,1,1]),K(cr(w,b),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),A!=null&&K(mn(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+C+"."});var k=jc(N.shape,x,w,b,C,A),z=at.runKernelFunc(function(F){return F.avgPool3dBackprop(D,N,k)},{dy5D:D,input5D:N});return O?z.as4D(z.shape[1],z.shape[2],z.shape[3],z.shape[4]):z})(m,c,e,t,s,n,a)}}});return d=d.cast(c.dtype),f?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),nr=rt({slice_:function(r,e,t){var n,a,i=H(r,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach(function(c){K(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=t==null?new Array(i.rank).fill(-1):typeof t=="number"?[t].concat(new Array(i.rank-1).fill(-1)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(-1)):t).map(function(c,f){return c>=0?c:(K(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-n[f])}),G_(i,n,a);var s=i.shape,u={begin:n,size:a};return at.runKernelFunc(function(c){return c.slice(i,n,a)},{x:i},function(c){for(var f=[],h=0;h<c.rank;h++)f.push([n[h],s[h]-n[h]-a[h]]);return{x:function(){return c.pad(f)}}},"Slice",u)}}),ll=rt({slice1d_:function(r,e,t){var n=H(r,"x","slice1d");return K(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),nr(n,[e],[t])}}),Cf=rt({slice2d_:function(r,e,t){var n=H(r,"x","slice2d");return K(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),nr(n,e,t)}}),cl=rt({slice3d_:function(r,e,t){var n=H(r,"x","slice3d");return K(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),nr(n,e,t)}}),Cs=rt({slice4d_:function(r,e,t){var n=H(r,"x","slice4d");return K(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),nr(n,e,t)}});function qO(r,e,t,n,a){return e.rank<t.rank&&(e=e.reshape(Br(e.shape,n))),r.rank<t.rank&&(r=r.reshape(Br(r.shape,n))),{$x:function(){var i=r.mul(t.equal(e).cast(r.dtype));return a==null?i:i.transpose(a)}}}var Af=rt({all_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","all","bool"),a=qn(e,n.shape),i=a,s=xa(i,n.rank);s!=null&&(n=n.transpose(s),i=wa(i.length,n.rank));var u=at.runKernelFunc(function(f){return f.all(n,i)},{$x:n});if(t){var c=Br(u.shape,a);return u.reshape(c)}return u}}),Ku=rt({any_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","any","bool"),a=qn(e,n.shape),i=a,s=xa(i,n.rank);s!=null&&(n=n.transpose(s),i=wa(i.length,n.rank));var u=at.runKernelFunc(function(f){return f.any(n,i)},{$x:n});if(t){var c=Br(u.shape,a);return u.reshape(c)}return u}}),Ri=rt({argMax_:function(r,e){e===void 0&&(e=0);var t=H(r,"x","argMax");e==null&&(e=0);var n=qn(e,t.shape),a=xa(n,t.rank);return a!=null&&(t=t.transpose(a),n=wa(n.length,t.rank)),at.runKernelFunc(function(i,s){var u=i.argMax(t,n[0]);return s([t]),u},{$x:t},function(i,s){var u=s[0];return{$x:function(){return ye(u)}}})}}),Om=rt({argMin_:function(r,e){e===void 0&&(e=0);var t=H(r,"x","argMin");e==null&&(e=0);var n=qn(e,t.shape),a=xa(n,t.rank);return a!=null&&(t=t.transpose(a),n=wa(n.length,t.rank)),at.runKernelFunc(function(i,s){var u=i.argMin(t,n[0]);return s([t]),u},{$x:t},function(i,s){var u=s[0];return{$x:function(){return ye(u)}}})}}),zx=rt({logSumExp_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","logSumExp"),a=qn(e,n.shape),i=n.max(a,!0),s=n.sub(i).exp().sum(a).log(),u=i.reshape(s.shape).add(s);if(t){var c=Br(u.shape,a);return u.reshape(c)}return u}}),Wa=rt({max_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","max"),a=n,i=qn(e,n.shape),s=i,u=xa(s,n.rank);u!=null&&(n=n.transpose(u),s=wa(s.length,n.rank));var c=at.runKernelFunc(function(h,d){var m=h.max(n,s);return d([a,m]),m},{$x:n},function(h,d){return qO(h,d[1],d[0],i,u)});if(t){var f=Br(c.shape,i);c=c.reshape(f)}return c}}),un=rt({mean_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","mean"),a=qn(e,n.shape),i=Kt(Yn(n.shape,a)[1]);return zs(function(s){var u=jt(i);return{value:(u.dtype===s.dtype?s:s.cast(u.dtype)).div(u).sum(e,t),gradFunc:function(c){var f=s.shape.slice();return a.forEach(function(h){f[h]=1}),c.reshape(f).mul(Sa(s.shape,"float32")).div(i)}}})(n)}}),Nf=rt({min_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","min"),a=n,i=qn(e,n.shape),s=i,u=xa(s,n.rank);u!=null&&(n=n.transpose(u),s=wa(s.length,n.rank));var c=at.runKernelFunc(function(h,d){var m=h.min(n,s);return d([a,m]),m},{$x:n},function(h,d){return qO(h,d[1],d[0],i,u)});if(t){var f=Br(c.shape,i);c=c.reshape(f)}return c}}),ko=rt({moments_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=qn(e,(r=H(r,"x","moments")).shape),a=r.mean(n,t),i=a.shape;t||(i=Br(a.shape,n));var s=r.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:s.mean(n,t)}}}),fr=rt({sum_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=qn(e,n.shape);return zs(function(i){var s=xa(a,i.rank),u=a,c=i;s!=null&&(c=i.transpose(s),u=wa(u.length,i.rank));var f=at.runKernelFunc(function(d){return d.sum(c,u)},{permutedX:c});if(t){var h=Br(f.shape,a);f=f.reshape(h)}return{value:f,gradFunc:function(d){var m=i.shape.slice();return a.forEach(function(g){m[g]=1}),d.reshape(m).mul(Sa(i.shape,"float32"))}}})(n)}}),Tf=rt({prod_:function(r,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var n=H(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=qn(e,n.shape),i=xa(a,n.rank),s=a,u=n;i!=null&&(u=n.transpose(i),s=wa(s.length,n.rank));var c=at.runKernelFunc(function(h){return h.prod(u,s)},{permutedX:u});if(t){var f=Br(c.shape,a);c=c.reshape(f)}return c}}),js=rt({elu_:function(r){var e=H(r,"x","elu");return at.runKernelFunc(function(t,n){var a=t.elu(e);return n([a]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return at.runKernelFunc(function(i){return i.eluDer(t,a)},{dy:t,y:a})}}})}}),Rf=rt({leakyRelu_:function(r,e){e===void 0&&(e=.2);var t=H(r,"x","leakyRelu");return Ca(jt(e).mul(t),t)}}),_f=rt({prelu_:function(r,e){var t=H(r,"x","prelu"),n=H(e,"alpha","prelu");return at.runKernelFunc(function(a,i){var s=a.prelu(t,n);return i([t,n]),s},{x:t,alpha:n},function(a,i){var s=i[0],u=i[1],c=s.greater(0);return{x:function(){return qa(c,a,a.mul(u))},alpha:function(){var f=qa(c,ye(a),a.mul(s)),h=In(u.shape,a.shape);return h.length>0&&(f=f.sum(h)),f.reshape(u.shape)}}},"Prelu")}}),Mi=rt({relu_:function(r){var e=H(r,"x","relu");return e.dtype==="bool"?e.toInt():at.runKernelFunc(function(t,n){var a=t.relu(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){return t.mulStrict(a.step().toFloat())}}})}}),Dm=rt({relu6_:function(r){var e=H(r,"x","relu6");return e.dtype==="bool"?e.toInt():at.runKernelFunc(function(t,n){var a=t.relu6(e);return n([e]),a},{$x:e},function(t,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{$x:function(){return t.mulStrict(i.toFloat())}}})}}),Of=rt({selu_:function(r){var e=H(r,"x","selu");return at.runKernelFunc(function(t,n){var a=t.selu(e);return n([e]),a},{$x:e},function(t,n){var a=n[0];return{$x:function(){var i=a.greater(jt(0)),s=jt(J1),u=jt(tx),c=t.mul(u),f=t.mul(s).mul(a.toFloat().exp());return qa(i,c,f)}}})}}),Qe=rt({transpose_:function(r,e){var t=H(r,"x","transpose");return e==null&&(e=t.shape.map(function(n,a){return a}).reverse()),K(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."}),e.forEach(function(n){K(n>=0&&n<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e})}),t.rank<=1?t.clone():at.runKernelFunc(function(n){return n.transpose(t,e)},{$x:t},function(n){var a=Id(e);return{$x:function(){return n.transpose(a)}}})}}),Im=rt({localResponseNormalization_:function(r,e,t,n,a){e===void 0&&(e=5),t===void 0&&(t=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=H(r,"x","localResponseNormalization");K(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),K(mn(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var s=i,u=!1;i.rank===3&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=at.runKernelFunc(function(f,h){var d=f.localResponseNormalization4D(s,e,t,n,a);return h([s,d]),d},{x4D:s},function(f,h){var d=h[0],m=h[1];return{x4D:function(){return at.runKernelFunc(function(g){return g.LRNGrad(f,d,m,e,t,n,a)},{})}}});return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),km=rt({norm_:function(r,e,t,n){e===void 0&&(e="euclidean"),t===void 0&&(t=null),n===void 0&&(n=!1);var a=(function u(c,f,h){if(h===void 0&&(h=null),c.rank===0)return c.abs();if(c.rank!==1&&h===null)return u(c.reshape([-1]),f,h);if(c.rank===1||typeof h=="number"||Array.isArray(h)&&h.length===1){if(f===1)return c.abs().sum(h);if(f===1/0)return c.abs().max(h);if(f===-1/0)return c.abs().min(h);if(f==="euclidean"||f===2)return c.abs().pow(jt(2,"int32")).sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(h)&&h.length===2){if(f===1)return c.abs().sum(h[0]).max(h[1]-1);if(f===1/0)return c.abs().sum(h[1]).max(h[0]);if(f===-1/0)return c.abs().sum(h[1]).min(h[0]);if(f==="fro"||f==="euclidean")return c.square().sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+h)})(r=H(r,"x","norm"),e,t),i=a.shape;if(n){var s=qn(t,r.shape);i=Br(a.shape,s)}return a.reshape(i)}}),Fx=rt({basicLSTMCell_:function(r,e,t,n,a,i){var s=H(r,"forgetBias","basicLSTMCell"),u=H(e,"lstmKernel","basicLSTMCell"),c=H(t,"lstmBias","basicLSTMCell"),f=H(n,"data","basicLSTMCell"),h=H(a,"c","basicLSTMCell"),d=H(i,"h","basicLSTMCell"),m=f.concat(d,1).matMul(u).add(c),g=m.shape[0],y=m.shape[1]/4,x=[g,y],w=m.slice([0,0],x),b=m.slice([0,y],x),C=m.slice([0,2*y],x),A=m.slice([0,3*y],x),T=w.sigmoid().mulStrict(b.tanh()).addStrict(h.mulStrict(s.add(C).sigmoid())),R=T.tanh().mulStrict(A.sigmoid());return[T,R]}}),Bx=rt({multiRNNCell_:function(r,e,t,n){for(var a=H(e,"data","multiRNNCell"),i=Uc(t,"c","multiRNNCell"),s=Uc(n,"h","multiRNNCell"),u=a,c=[],f=0;f<r.length;f++){var h=r[f](u,i[f],s[f]);c.push(h[0]),c.push(h[1]),u=h[1]}var d=[],m=[];for(f=0;f<c.length;f+=2)d.push(c[f]),m.push(c[f+1]);return[d,m]}}),Lx=rt({movingAverage_:function(r,e,t,n,a){a===void 0&&(a=!0);var i=H(r,"v","movingAverage"),s=H(e,"x","movingAverage"),u=H(t,"decay","movingAverage");QR(i,s),K(Pn(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var c=jt(1),f=c.sub(u),h=s.sub(i).mul(f);if(a){K(n!=null,function(){return"When using zeroDebias: true, step is required."});var d=H(n,"step","movingAverage");h=h.div(c.sub(Ss(u,d)))}return i.add(h)}}),Mm=rt({stridedSlice_:function(r,e,t,n,a,i,s,u,c){if(a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0),c===void 0&&(c=0),n==null&&(n=new Array(e.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var f=H(r,"x","stridedSlice"),h=Ib(u),d=f.shape.slice();h.forEach(function(w){e[w]=0,t[w]=1,d.splice(w,0,1)}),f=f.reshape(d);for(var m=0;m<f.rank;m++)e[m]=X_(a,e,n,f.shape,m),t[m]=K_(i,t,n,f.shape,m),n[m]=n[m]||1;var g=Ib(c);g.forEach(function(w){t[w]=e[w]+1,n[w]=1});var y=Hd(e,t,n),x=y.filter(function(w,b){return g.indexOf(b)===-1});return n.every(function(w){return w===1})?nr(f,e,y).reshape(x):at.runKernelFunc(function(w){return w.stridedSlice(f,e,t,n)},{$x:f}).reshape(x)}}),zm=rt({topk_:function(r,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var n=H(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+e);var i=at.runKernelFunc(function(s){return s.topk(n,e,t)},{$x:n});return{values:i[0],indices:i[1]}}}),Fm=rt({scatterND_:function(r,e,t){var n=H(r,"indices","scatterND","int32"),a=H(e,"updates","scatterND");return yB(a,n,t),at.runKernelFunc(function(i){return i.scatterND(n,a,t)},{$indices:n,$updates:a})}}),fl=rt({fft_:function(r){K(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."});var e=r.shape[r.shape.length-1],t=r.size/e,n=r.as2D(t,e);return at.runKernelFunc(function(a){return a.fft(n)},{input:r}).reshape(r.shape)}}),As=rt({ifft_:function(r){K(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."});var e=r.shape[r.shape.length-1],t=r.size/e,n=r.as2D(t,e);return at.runKernelFunc(function(a){return a.ifft(n)},{input:r}).reshape(r.shape)}}),hl=rt({rfft_:function(r,e){K(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var t,n=r.shape[r.shape.length-1],a=r.size/n;if(e!=null&&e<n){var i=r.shape.map(function(b){return 0}),s=r.shape.map(function(b){return b});s[r.shape.length-1]=e,t=r.slice(i,s),n=e}else if(e!=null&&e>n){var u=r.shape.map(function(b){return b});u[r.shape.length-1]=e-n,t=r.concat(Ie(u),r.shape.length-1),n=e}else t=r;var c=t.zerosLike(),f=Tn(t,c).as2D(a,n),h=fl(f),d=Math.floor(n/2)+1,m=sr(h),g=zr(h),y=m.split([d,n-d],m.shape.length-1),x=g.split([d,n-d],g.shape.length-1),w=t.shape.slice();return w[t.shape.length-1]=d,Tn(y[0],x[0]).reshape(w)}}),Df=rt({irfft_:function(r){var e=r.shape[r.shape.length-1],t=r.size/e;if(e<=2){var n=r.as2D(t,e),a=As(n);return sr(a)}var i=[t,2*(e-1)],s=sr(r).as2D(t,e),u=zr(r).as2D(t,e),c=s.slice([0,1],[t,e-2]).reverse(1),f=u.slice([0,1],[t,e-2]).reverse(1).mul(jt(-1)),h=s.concat(c,1),d=u.concat(f,1);return n=Tn(h,d).as2D(i[0],i[1]),a=As(n),sr(a)}}),Ux=Object.freeze({fft:fl,ifft:As,rfft:hl,irfft:Df}),If=rt({sparseToDense_:function(r,e,t,n){n===void 0&&(n=0);var a=H(r,"sparseIndices","sparseToDense","int32"),i=H(e,"sparseValues","sparseToDense"),s=H(n,"defaultValue","sparseToDense",i.dtype);return(function(u,c,f,h){if(u.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+u.dtype+".");if(u.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+u.shape+".");var d=u.rank>0?u.shape[0]:1,m=u.rank>1?u.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==d))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+d+"]");if(c.dtype!==h.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(a,i,t,s),at.runKernelFunc(function(u){return u.sparseToDense(a,i,t,s)},{$sparseIndices:a,$sparseValues:i,$defaultValue:s})}}),Bm=rt({gatherND_:function(r,e){var t=H(e,"indices","gatherND","int32"),n=H(r,"x","gatherND");return at.runKernelFunc(function(a){return a.gatherND(n,t)},{$x:n,$indices:t})}}),jx=rt({diag_:function(r){var e=H(r,"x","diag").flatten(),t=r.shape.concat(r.shape);return at.runKernelFunc(function(n){return n.diag(e)},{$x:e}).reshape(t)}}),Lm=rt({dropout_:function(r,e,t,n){var a=H(r,"x","dropout");if(K(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),K(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return r instanceof Ee?a.clone():a;var i=(function(c,f){if(f==null)return c.shape.slice();if(Pn(c.shape,f))return f;if(c.shape.length===f.length){for(var h=[],d=0;d<c.shape.length;d++)f[d]==null&&c.shape[d]!=null?h.push(c.shape[d]):h.push(f[d]);return h}return f})(a,t),s=1-e,u=To(i,0,1,"float32",n).add(s).floor().div(s);return a.mul(u)}});function WO(r,e,t){for(var n=1-r%2,a=new Float32Array(r),i=0;i<r;++i){var s=2*Math.PI*i/(r+n-1);a[i]=e-t*Math.cos(s)}return zn(a,"float32")}var kf=rt({hannWindow_:function(r){return WO(r,.5,.5)}}),Um=rt({hammingWindow_:function(r){return WO(r,.54,.46)}}),Mf=rt({frame_:function(r,e,t,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,s=[];i+e<=r.size;)s.push(nr(r,i,e)),i+=t;if(n)for(;i<r.size;){var u=i+e-r.size,c=Vn([nr(r,i,e-u),Is([u],a)]);s.push(c),i+=t}return s.length===0?ta([],[0,e]):Vn(s).as2D(s.length,e)}}),jm=rt({stft_:function(r,e,t,n,a){var i;a===void 0&&(a=kf),n==null&&(i=e,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=Mf(r,e,t),u=Jt(s,a(e)),c=[],f=0;f<s.shape[0];f++)c.push(hl(u.slice([f,0],[1,e]),n));return Vn(c)}}),Px=Object.freeze({hannWindow:kf,hammingWindow:Um,frame:Mf,stft:jm}),Un,Vx=function(r,e,t){return t===void 0&&(t=1),Ht(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w;return Gt(this,function(b){switch(b.label){case 0:return n=H(r,"predictions","inTopK"),a=H(e,"targets","inTopK"),K(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank}),K(n.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank}),Ce(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],K(t>0&&t<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+t}),[4,n.data()];case 1:return s=b.sent(),[4,a.data()];case 2:for(u=b.sent(),c=[s.length/i,i],h=c[1],d=kc("bool",f=c[0]),m=0;m<f;m++){for(g=m*h,y=s.subarray(g,g+h),x=[],w=0;w<y.length;w++)x.push({value:y[w],index:w});for(x.sort(function(C,A){return A.value-C.value}),d[m]=0,w=0;w<t;w++)if(x[w].index===u[m]){d[m]=1;break}}return r!==n&&n.dispose(),e!==a&&a.dispose(),[2,sn(d,a.shape,"bool")]}})})};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Un||(Un={}));var eU=rt({absoluteDifference_:function(r,e,t,n){n===void 0&&(n=Un.SUM_BY_NONZERO_WEIGHTS);var a=H(r,"labels","absoluteDifference"),i=H(e,"predictions","absoluteDifference"),s=null;t!=null&&(s=H(t,"weights","absoluteDifference")),Ce(a.shape,i.shape,"Error in absoluteDifference: ");var u=a.sub(i).abs();return zi(u,s,n)}}),zi=rt({computeWeightedLoss_:function(r,e,t){t===void 0&&(t=Un.SUM_BY_NONZERO_WEIGHTS);var n=H(r,"losses","computeWeightedLoss"),a=null;e!=null&&(a=H(e,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(t===Un.NONE)return i;if(t===Un.SUM)return i.sum();if(t===Un.MEAN){if(a==null)return i.mean();var s=n.size/a.size,u=i.sum().div(a.sum());return s>1?u.div(jt(s)):u}if(t===Un.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(jt(n.size));var c=a.mul(Sa(n.shape)).notEqual(jt(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+t)}}),nU=rt({cosineDistance_:function(r,e,t,n,a){a===void 0&&(a=Un.SUM_BY_NONZERO_WEIGHTS);var i=H(r,"labels","cosineDistance"),s=H(e,"predictions","cosineDistance"),u=null;n!=null&&(u=H(n,"weights","cosineDistance")),Ce(i.shape,s.shape,"Error in cosineDistance: ");var c=jt(1).sub(i.mul(s).sum(t,!0));return zi(c,u,a)}}),rU=rt({hingeLoss_:function(r,e,t,n){n===void 0&&(n=Un.SUM_BY_NONZERO_WEIGHTS);var a=H(r,"labels","hingeLoss"),i=H(e,"predictions","hingeLoss"),s=null;t!=null&&(s=H(t,"weights","hingeLoss")),Ce(a.shape,i.shape,"Error in hingeLoss: ");var u=jt(1);a=jt(2).mul(a).sub(u);var c=u.sub(a.mul(i)).relu();return zi(c,s,n)}}),aU=rt({huberLoss_:function(r,e,t,n,a){n===void 0&&(n=1),a===void 0&&(a=Un.SUM_BY_NONZERO_WEIGHTS);var i=H(r,"labels","huberLoss"),s=H(e,"predictions","huberLoss"),u=null;t!=null&&(u=H(t,"weights","huberLoss")),Ce(i.shape,s.shape,"Error in huberLoss: ");var c=jt(n),f=s.sub(i).abs(),h=Bs(f,c),d=f.sub(h),m=jt(.5).mul(h.square()).add(c.mul(d));return zi(m,u,a)}}),iU=rt({logLoss_:function(r,e,t,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Un.SUM_BY_NONZERO_WEIGHTS);var i=H(r,"labels","logLoss"),s=H(e,"predictions","logLoss"),u=null;t!=null&&(u=H(t,"weights","logLoss")),Ce(i.shape,s.shape,"Error in logLoss: ");var c=jt(1),f=jt(n),h=i.mul(s.add(f).log()).neg().sub(c.sub(i).mul(c.sub(s).add(f).log()));return zi(h,u,a)}}),oU=rt({meanSquaredError_:function(r,e,t,n){n===void 0&&(n=Un.SUM_BY_NONZERO_WEIGHTS);var a=H(r,"labels","meanSquaredError"),i=H(e,"predictions","meanSquaredError"),s=null;t!=null&&(s=H(t,"weights","meanSquaredError")),Ce(a.shape,i.shape,"Error in meanSquaredError: ");var u=a.squaredDifference(i);return zi(u,s,n)}}),sU=rt({sigmoidCrossEntropy_:function(r,e,t,n,a){n===void 0&&(n=0),a===void 0&&(a=Un.SUM_BY_NONZERO_WEIGHTS);var i=H(r,"multiClassLabels","sigmoidCrossEntropy"),s=H(e,"logits","sigmoidCrossEntropy"),u=null;if(t!=null&&(u=H(t,"weights","sigmoidCrossEntropy")),Ce(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),n>0){var c=jt(n),f=jt(1),h=jt(.5);i=i.mul(f.sub(c)).add(h.mul(c))}var d=(function(m,g){var y=H(m,"labels","sigmoidCrossEntropyWithLogits"),x=H(g,"logits","sigmoidCrossEntropyWithLogits");Ce(y.shape,x.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=x.relu(),b=x.mul(y),C=x.abs().neg().exp().log1p();return w.sub(b).add(C)})(i,s);return zi(d,u,a)}}),uU=rt({softmaxCrossEntropy_:function(r,e,t,n,a){n===void 0&&(n=0),a===void 0&&(a=Un.SUM_BY_NONZERO_WEIGHTS);var i=H(r,"onehotLabels","softmaxCrossEntropy"),s=H(e,"logits","softmaxCrossEntropy"),u=null;if(t!=null&&(u=H(t,"weights","softmaxCrossEntropy")),Ce(i.shape,s.shape,"Error in softmaxCrossEntropy: "),n>0){var c=jt(n),f=jt(1),h=jt(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(h))}var d=(function(m,g,y){if(y===void 0&&(y=-1),y===-1&&(y=g.rank-1),y!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+y);return zs(function(x,w,b){var C=w.logSumExp([y],!0),A=w.toFloat().sub(C);return b([x,A]),{value:A.mul(x).neg().sum([y]),gradFunc:function(T,R){var D=R[0],N=R[1],O=Br(T.shape,[y]);return[T.reshape(O).mul(D.toFloat().sub(N.exp())),T.reshape(O).mul(N.exp().sub(D.toFloat()))]}}})(m,g)})(i,s);return zi(d,u,a)}}),qx=Object.freeze({get Reduction(){return Un},absoluteDifference:eU,computeWeightedLoss:zi,cosineDistance:nU,hingeLoss:rU,huberLoss:aU,logLoss:iU,meanSquaredError:oU,sigmoidCrossEntropy:sU,softmaxCrossEntropy:uU});function wA(r,e){return e===void 0&&(e=!1),at.tidy(function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var t=r.shape[0],n=r.shape[1],a=rf(t),i=r.clone(),s=ta([[1]],[1,1]),u=s.clone(),c=t>=n?n:t,f=function(d){var m,g=i,y=u,x=a;m=at.tidy(function(){var w=i.slice([d,d],[t-d,1]),b=w.norm(),C=i.slice([d,d],[1,1]),A=ta([[-1]]).where(C.greater(0),ta([[1]])),T=C.sub(A.mul(b)),R=w.div(T);u=R.shape[0]===1?s.clone():s.concat(R.slice([1,0],[R.shape[0]-1,R.shape[1]]),0);var D=A.matMul(T).div(b).neg(),N=i.slice([d,0],[t-d,n]),O=D.mul(u);if(d===0)i=N.sub(O.matMul(u.transpose().matMul(N)));else{var k=N.sub(O.matMul(u.transpose().matMul(N)));i=i.slice([0,0],[d,n]).concat(k,0)}var z=a.slice([0,d],[t,a.shape[1]-d]);if(d===0)a=z.sub(z.matMul(u).matMul(O.transpose()));else{var F=z.sub(z.matMul(u).matMul(O.transpose()));a=a.slice([0,0],[t,d]).concat(F,1)}return[u,i,a]}),u=m[0],i=m[1],a=m[2],re([g,y,x])},h=0;h<c;++h)f(h);return!e&&t>n&&(a=a.slice([0,0],[t,n]),i=i.slice([0,0],[n,n])),[a,i]})}var lU=rt({gramSchmidt_:function(r){var e;if(Array.isArray(r)){e=!1,K(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=r[0].shape[0],n=function(c){K(r[c].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[c].shape[0]+" vs. "+t+")"})},a=1;a<r.length;++a)n(a)}else e=!0,r=La(r,r.shape[0],0).map(function(c){return Ai(c,[0])});K(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."});var i=[],s=r,u=function(c){i.push(at.tidy(function(){var f=s[c];if(c>0)for(var h=0;h<c;++h){var d=fr(i[h].mulStrict(f)).mul(i[h]);f=f.sub(d)}return f.div(km(f,"euclidean"))}))};for(a=0;a<r.length;++a)u(a);return e?Lr(i,0):i}}),cU=rt({qr_:function(r,e){if(e===void 0&&(e=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return wA(r,e);var t=r.shape.slice(0,r.shape.length-2).reduce(function(s,u){return s*u}),n=Ni(r.reshape([t,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],i=[];return n.forEach(function(s){var u=wA(s,e),c=u[0],f=u[1];a.push(c),i.push(f)}),[Lr(a,0).reshape(r.shape),Lr(i,0).reshape(r.shape)]}}),Pm=Object.freeze({gramSchmidt:lU,qr:cU});function HO(r,e,t,n,a){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY);var i=r.shape[0];return t=Math.min(t,i),K(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),K(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),K(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),K(e.rank===1,function(){return"scores must be a 1D tensor"}),K(e.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", but was "+e.shape[0]}),{maxOutputSize:t,iouThreshold:n,scoreThreshold:a}}var fU=rt({resizeBilinear_:function(r,e,t){t===void 0&&(t=!1);var n=H(r,"images","resizeBilinear");K(n.rank===3||n.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."}),K(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=e[0],u=e[1],c=at.runKernelFunc(function(f,h){return h([a]),f.resizeBilinear(a,s,u,t)},{batchImages:a},function(f,h){return{batchImages:function(){return at.runKernelFunc(function(d){return d.resizeBilinearBackprop(f,h[0],t)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),hU=rt({resizeNearestNeighbor_:function(r,e,t){t===void 0&&(t=!1);var n=H(r,"images","resizeNearestNeighbor");K(n.rank===3||n.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."}),K(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),K(n.dtype==="float32"||n.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=e[0],u=e[1],c=at.runKernelFunc(function(f,h){return h([a]),f.resizeNearestNeighbor(a,s,u,t)},{batchImages:a},function(f,h){return{batchImages:function(){return at.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(f,h[0],t)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),pU=rt({nonMaxSuppression_:function(r,e,t,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=H(r,"boxes","nonMaxSuppression"),s=H(e,"scores","nonMaxSuppression"),u=HO(i,s,t,n,a);return t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,at.runKernelFunc(function(c){return c.nonMaxSuppression(i,s,t,n,a)},{$boxes:i})}}),dU=function(r,e,t,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ht(this,void 0,void 0,function(){var i,s,u,c,f,h,d;return Gt(this,function(m){switch(m.label){case 0:return i=H(r,"boxes","nonMaxSuppressionAsync"),s=H(e,"scores","nonMaxSuppressionAsync"),u=HO(i,s,t,n,a),t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return c=m.sent(),f=c[0],h=c[1],d=$1(f,h,t,n,a),i!==r&&i.dispose(),s!==e&&s.dispose(),[2,d]}})})},mU=rt({cropAndResize_:function(r,e,t,n,a,i){var s=H(r,"image","cropAndResize","float32"),u=H(e,"boxes","cropAndResize","float32"),c=H(t,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=u.shape[0];return K(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),K(u.rank===2&&u.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+u.shape+"."}),K(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+u.shape+"."}),K(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."}),K(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),K(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),at.runKernelFunc(function(h,d){return h.cropAndResize(s,u,c,n,a,i)},{$image:s,$boxes:u})}}),xi=Object.freeze({resizeBilinear:fU,resizeNearestNeighbor:hU,nonMaxSuppression:pU,nonMaxSuppressionAsync:dU,cropAndResize:mU}),Wx=function(r,e){return!(r>0)&&(e==="linear"||e==="relu")},Hx=function(r,e,t){if(t==null||t==="linear")return r;if(t==="relu")return r.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},Gx=function(r,e){var t=e,n=In(r.shape,e.shape);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},Xx=function(r,e,t){if(e==="linear")return r;if(e==="relu")return Mi(r);if(e==="elu")return js(r);if(e==="relu6")return Dm(r);if(e==="prelu")return _f(r,t);throw new Error("Unknown fused activation "+e+".")},vU=rt({matMul_:function(r){var e,t=r.a,n=r.b,a=r.transposeA,i=a!==void 0&&a,s=r.transposeB,u=s!==void 0&&s,c=r.bias,f=r.activation,h=f===void 0?"linear":f,d=r.preluActivationWeights;if(Wx(at.state.gradientDepth,h)===!1){var m=bf(t,n,i,u);return c!=null&&(m=se(m,c)),Xx(m,h,d)}var g=H(t,"a","fused matMul"),y=H(n,"b","fused matMul");e=vn(g,y),g=e[0],y=e[1];var x=i?g.shape[g.rank-2]:g.shape[g.rank-1],w=u?y.shape[y.rank-1]:y.shape[y.rank-2],b=i?g.shape[g.rank-1]:g.shape[g.rank-2],C=u?y.shape[y.rank-2]:y.shape[y.rank-1],A=g.shape.slice(0,-2),T=y.shape.slice(0,-2),R=Kt(A),D=Kt(T);K(g.rank>=2&&y.rank>=2&&g.rank===y.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+y.rank+"."}),K(Pn(A,T),function(){return"Error in fused matMul: outer dimensions ("+A+") and ("+T+") of Tensors with shapes "+g.shape+" and "+y.shape+" must match."}),K(x===w,function(){return"Error in fused matMul: inner shapes ("+x+") and ("+w+") of Tensors with shapes "+g.shape+" and "+y.shape+" and transposeA="+i+" and transposeB="+u+" must match."});var N,O,k=g.shape.slice(0,-2).concat([b,C]),z=i?g.as3D(R,x,b):g.as3D(R,b,x),F=u?y.as3D(D,C,w):y.as3D(D,w,C);c!=null&&ge(k,(N=vn(N=H(c,"bias","fused matMul"),g)[0]).shape),d!=null&&(O=H(d,"prelu weights","fused matMul"));var B={$a:z,$b:F};return c!=null&&(B.$bias=N),d!=null&&(B.$preluActivationWeights=O),at.runKernelFunc(function(V,G){var Q=V.fusedBatchMatMul({a:z,b:F,transposeA:i,transposeB:u,bias:N,activation:h,preluActivationWeights:O});return G([z,F,Q]),Q},B,function(V,G){var Q=G[0],L=G[1],X=G[2],$=Hx(V,X,h),it={};return c!=null&&(it={$bias:function(){return Gx(N,$)}}),Object.assign(i||u?!i&&u?{$a:function(){return $.matMul(L,!1,!1)},$b:function(){return $.matMul(Q,!0,!1)}}:i&&!u?{$a:function(){return L.matMul($,!1,!0)},$b:function(){return Q.matMul($,!1,!1)}}:{$a:function(){return L.matMul($,!0,!0)},$b:function(){return $.matMul(Q,!0,!0)}}:{$a:function(){return $.matMul(L,!1,!0)},$b:function(){return Q.matMul($,!0,!1)}},it)}).reshape(k)}}),gU=rt({conv2d_:function(r){var e=r.x,t=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,c=u===void 0?[1,1]:u,f=r.dimRoundingMode,h=r.bias,d=r.activation,m=d===void 0?"linear":d,g=r.preluActivationWeights;if(m=m||"linear",Wx(at.state.gradientDepth,m)===!1){var y=Io(e,t,n,a,s,c,f);return h!=null&&(y=se(y,h)),Xx(y,m,g)}var x=H(e,"x","conv2d"),w=H(t,"filter","conv2d"),b=x,C=!1;x.rank===3&&(C=!0,b=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),K(b.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+b.rank+"."}),K(w.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."}),f!=null&&K(mn(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),K(b.shape[3]===w.shape[2],function(){return"Error in conv2d: depth of input ("+b.shape[3]+") must match input depth for filter "+w.shape[2]+"."}),K(cr(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),K(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var A,T,R=_o(b.shape,w.shape,n,c,a,f);h!=null&&(A=vn(A=H(h,"bias","fused conv2d"),x)[0],ge(R.outShape,A.shape)),g!=null&&(T=H(g,"prelu weights","fused conv2d"));var D={x:b,$filter:w};h!=null&&(D.$bias=A),g!=null&&(D.$preluActivationWeights=T);var N=at.runKernelFunc(function(O,k){var z=O.fusedConv2d({input:b,filter:w,convInfo:R,bias:A,activation:m,preluActivationWeights:T});return k([w,b,z]),z},D,function(O,k){var z=k,F=z[0],B=z[1],V=z[2],G=Hx(O,V,m);K(ws(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var Q={};return h!=null&&(Q={$bias:function(){return Gx(A,G)}}),Object.assign({x:function(){return LO(B.shape,G,F,n,a)},$filter:function(){return Nx(B,G,F.shape,n,a)}},Q)});return C?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),yU=rt({depthwiseConv2d_:function(r){var e=r.x,t=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,u=r.dilations,c=u===void 0?[1,1]:u,f=r.dimRoundingMode,h=r.bias,d=r.activation,m=d===void 0?"linear":d,g=r.preluActivationWeights;if(Wx(at.state.gradientDepth,m)===!1){var y=Us(e,t,n,a,s,c,f);return h!=null&&(y=se(y,h)),Xx(y,m,g)}var x=H(e,"x","depthwiseConv2d"),w=H(t,"filter","depthwiseConv2d"),b=x,C=!1;x.rank===3&&(C=!0,b=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),K(b.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+b.rank+"."}),K(w.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."}),K(b.shape[3]===w.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+b.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."}),c==null&&(c=[1,1]),K(cr(n,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),f!=null&&K(mn(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var A,T,R=_o(b.shape,w.shape,n,c,a,f,!0);h!=null&&(A=vn(A=H(h,"bias","fused conv2d"),x)[0],ge(R.outShape,A.shape)),g!=null&&(T=H(g,"prelu weights","fused depthwiseConv2d"));var D={x:b,$filter:w};h!=null&&(D.$bias=A),g!=null&&(D.$preluActivationWeights=T);var N=at.runKernelFunc(function(O,k){var z=O.fusedDepthwiseConv2D({input:b,filter:w,convInfo:R,bias:A,activation:m,preluActivationWeights:T});return k([b,w,z]),z},D,function(O,k){K(ws(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var z=k[0],F=k[1],B=k[2],V=Hx(O,B,m),G={};return h!=null&&(G={$bias:function(){return Gx(A,V)}}),Object.assign({x:function(){return UO(z.shape,V,F,R)},$filter:function(){return jO(z,V,F.shape,R)}},G)});return C?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),Ns=Object.freeze({matMul:vU,conv2d:gU,depthwiseConv2d:yU}),bU=Object.freeze({image:xi,linalg:Pm,losses:qx,spectral:Ux,fused:Ns,signal:Px,square:$d,conv1d:vf,conv2d:Io,conv3d:gf,depthwiseConv2d:Us,separableConv2d:_m,conv2dTranspose:yf,conv3dTranspose:Tx,op:rt,batchNormalization2d:ox,batchNormalization3d:sx,batchNormalization4d:ux,batchNormalization:lx,batchNorm:gm,batchNorm2d:ym,batchNorm3d:bm,batchNorm4d:xm,booleanMaskAsync:Ax,complex:Tn,real:sr,imag:zr,concat:Vn,concat1d:zd,concat2d:Fd,concat3d:Bd,concat4d:Ld,split:La,matMul:bf,dot:Rx,outerProduct:_x,reverse:va,reverse1d:Ox,reverse2d:Dx,reverse3d:Ix,reverse4d:kx,maxPool:xf,avgPool:wf,pool:Mx,maxPool3d:Sf,avgPool3d:Ef,slice:nr,slice1d:ll,slice2d:Cf,slice3d:cl,slice4d:Cs,abs:Ti,acos:Qd,acosh:Zd,asin:Jd,asinh:tm,atan:em,atanh:nm,ceil:rm,clipByValue:er,cos:am,cosh:im,erf:om,exp:sm,expm1:um,floor:uf,log:Va,log1p:lm,logSigmoid:ex,neg:Oo,reciprocal:cm,round:fm,rsqrt:lf,sigmoid:ol,sign:hm,isNaN:nx,isInf:rx,isFinite:ax,sin:pm,sinh:dm,softplus:sl,sqrt:Fs,step:ix,tan:mm,tanh:cf,all:Af,any:Ku,argMax:Ri,argMin:Om,logSumExp:zx,max:Wa,mean:un,min:Nf,moments:ko,sum:fr,prod:Tf,equal:Do,equalStrict:bx,greater:Ls,greaterEqual:ul,greaterEqualStrict:xx,greaterStrict:wx,less:Nm,lessEqual:Tm,lessEqualStrict:Sx,lessStrict:Ex,notEqual:Es,notEqualStrict:Cx,add:se,addN:Sm,addStrict:fx,atan2:Em,div:Sn,divStrict:hx,floorDiv:df,maximum:Ca,maximumStrict:px,minimum:Bs,minimumStrict:dx,mod:Cm,modStrict:mx,mul:Jt,mulStrict:mf,pow:Ss,powStrict:vx,squaredDifference:Am,squaredDifferenceStrict:gx,sub:gn,subStrict:yx,elu:js,leakyRelu:Rf,prelu:_f,relu:Mi,relu6:Dm,selu:Of,logicalAnd:Ga,logicalNot:wm,logicalOr:hf,logicalXor:cx,where:qa,whereAsync:pf,buffer:ae,print:F1,batchToSpaceND:nf,cast:No,clone:B1,cumsum:L1,depthToSpace:jd,expandDims:Qn,eye:rf,multinomial:Pd,oneHot:Ua,pad:ki,pad1d:U1,pad2d:j1,pad3d:Vd,pad4d:P1,rand:V1,randomNormal:qd,randomGamma:q1,randomUniform:To,reshape:Ms,spaceToBatchND:af,squeeze:Ai,stack:Lr,tile:bi,truncatedNormal:il,unstack:Ni,setdiff1dAsync:Wd,fill:Is,linspace:Md,ones:Sa,range:ef,scalar:jt,tensor:sn,tensor1d:zn,tensor2d:ta,tensor3d:ds,tensor4d:ka,tensor5d:k1,tensor6d:M1,variable:kd,zeros:Ie,onesLike:Er,zerosLike:ye,transpose:Qe,softmax:Ro,logSoftmax:of,localResponseNormalization:Im,norm:km,gather:fa,unsortedSegmentSum:Rm,basicLSTMCell:Fx,multiRNNCell:Bx,movingAverage:Lx,stridedSlice:Mm,topk:zm,scatterND:Fm,fft:fl,ifft:As,rfft:hl,irfft:Df,sparseToDense:If,gatherND:Bm,diag:jx,dropout:Lm,hannWindow:kf,hammingWindow:Um,frame:Mf,stft:jm,inTopKAsync:Vx});function Dt(r,e){Array.isArray(r)||(r=[r]),r.forEach(function(t){t!=null&&K(t.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function qy(r,e,t,n){if(t==="linear")return r.linear(e);if(t==="relu")return r.relu(e);if(t==="elu")return r.elu(e);if(t==="relu6")return r.relu6(e);if(t==="prelu")return r.prelu(e,n);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var xU=(function(r){function e(){var t=r.call(this)||this;if(t.blockSize=48,t.firstUse=!0,yt().get("IS_BROWSER")){var n=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;n!==null&&(t.fromPixels2DContext=n.getContext("2d"))}return t.data=new Xd(t,at),t}return ba(e,r),e.prototype.write=function(t,n,a){this.firstUse&&(this.firstUse=!1,yt().get("IS_NODE")&&Db(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================
`));var i={};return this.data.set(i,{values:t,dtype:a}),i},e.prototype.move=function(t,n,a,i){this.data.set(t,{values:n,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.fromPixels=function(t,n){if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var a,i,s=t.data instanceof Uint8Array,u=typeof ImageData<"u"&&t instanceof ImageData,c=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement,f=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,h=c?[t.videoWidth,t.videoHeight]:[t.width,t.height],d=h[0],m=h[1];if(yt().get("IS_NODE")&&t.getContext==null)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(t.getContext!=null)a=t.getContext("2d").getImageData(0,0,d,m).data;else if(u||s)a=t.data;else{if(!f&&!c)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(this.fromPixels2DContext==null)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=d,this.fromPixels2DContext.canvas.height=m,this.fromPixels2DContext.drawImage(t,0,0,d,m),a=this.fromPixels2DContext.getImageData(0,0,d,m).data}if(n===4)i=new Int32Array(a);else{var g=d*m;i=new Int32Array(g*n);for(var y=0;y<g;y++)for(var x=0;x<n;++x)i[y*n+x]=a[4*y+x]}return ds(i,[m,d,n],"int32")},e.prototype.read=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){return[2,this.readSync(t)]})})},e.prototype.readSync=function(t){var n=this.data.get(t),a=n.dtype,i=n.complexTensors;return a==="complex64"?Mb(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var n=this.readSync(t.dataId),a=n;if(t.dtype==="string")try{a=n.map(function(i){return zc(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ae(t.shape,t.dtype,a)},e.prototype.makeOutput=function(t,n,a){var i=this.write(t,n,a);return at.makeTensorFromDataId(i,n,a,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var n=this.data.get(t).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return Ht(this,void 0,void 0,function(){var n;return Gt(this,function(a){return n=la(),t(),[2,{kernelMs:la()-n}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,n){var a=this.makeOutput(null,t.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:at.keep(t.clone()),imag:at.keep(n.clone())},a},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,n,a){if(Dt(t,"slice"),W1(t.shape,n,a)){var i=H1(n,t.strides),s=Kt(a);return sn(this.readSync(t.dataId).subarray(i,i+s),a,t.dtype)}for(var u=ae(a,t.dtype),c=this.bufferSync(t),f=0;f<u.size;++f){var h=u.indexToLoc(f).map(function(d,m){return d+n[m]});u.values[f]=c.get.apply(c,h)}return u.toTensor()},e.prototype.stridedSlice=function(t,n,a,i){Dt(t,"stridedSlice");var s=Hd(n,a,i);if(s.some(function(g){return g===0}))return sn([],s);for(var u=ae(s,t.dtype),c=this.bufferSync(t),f=0;f<u.size;f++){for(var h=u.indexToLoc(f),d=new Array(h.length),m=0;m<d.length;m++)d[m]=h[m]*i[m]+n[m];u.set.apply(u,[c.get.apply(c,d)].concat(h))}return u.toTensor()},e.prototype.diag=function(t){for(var n=this.readSync(t.dataId),a=ae([t.size,t.size],t.dtype),i=a.values,s=0;s<n.length;s++)i[s*t.size+s]=n[s];return a.toTensor()},e.prototype.unstack=function(t,n){for(var a=t.shape[n],i=new Array(t.rank-1),s=0,u=0;u<t.rank;u++)u!==n&&(i[s++]=t.shape[u]);var c=new Array(t.rank).fill(0),f=t.shape.slice();f[n]=1;var h=new Array(a);for(u=0;u<h.length;u++)c[n]=u,h[u]=this.slice(t,c,f).reshape(i);return h},e.prototype.reverse=function(t,n){Dt(t,"reverse");for(var a=ae(t.shape,t.dtype),i=this.bufferSync(t),s=function(c){var f=a.indexToLoc(c),h=f.slice();n.forEach(function(d){return h[d]=t.shape[d]-1-h[d]}),a.set.apply(a,[i.get.apply(i,h)].concat(f))},u=0;u<a.size;u++)s(u);return a.toTensor()},e.prototype.concat=function(t,n){var a=this;if(t[0].dtype==="complex64"){var i=t.map(function(g){return sr(g)}),s=t.map(function(g){return zr(g)});return Tn(this.concat(i,n),this.concat(s,n))}var u=t.map(function(g){var y=Kt(g.shape.slice(n));return g.as2D(-1,y)}),c=xs(u.map(function(g){return g.shape}),1),f=ae(c,t[0].dtype).values;if(u[0].shape[0]===1){var h=0;u.forEach(function(g){f.set(a.readSync(g.dataId),h),h+=g.size})}else{var d=0;u.forEach(function(g){for(var y=a.readSync(g.dataId),x=0,w=0;w<g.shape[0];++w)for(var b=w*c[1]+d,C=0;C<g.shape[1];++C)f[b+C]=y[x++];d+=g.shape[1]})}var m=xs(t.map(function(g){return g.shape}),n);return sn(f,m,t[0].dtype)},e.prototype.neg=function(t){return Dt(t,"neg"),this.multiply(jt(-1),t)},e.prototype.add=function(t,n){return t.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),n.cast("complex64"),function(a,i,s,u){return{real:a+s,imag:i+u}}):this.broadcastedBinaryOp(t,n,_n(t.dtype,n.dtype),function(a,i){return a+i})},e.prototype.addN=function(t){var n=this;Dt(t,"addN");for(var a=t.map(function(h){return n.readSync(h.dataId)}),i=ae(t[0].shape,t[0].dtype),s=i.values,u=0;u<t.length;u++)for(var c=a[u],f=0;f<s.length;f++)s[f]+=c[f];return i.toTensor()},e.prototype.subtract=function(t,n){return t.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),n.cast("complex64"),function(a,i,s,u){return{real:a-s,imag:i-u}}):this.broadcastedBinaryOp(t,n,_n(t.dtype,n.dtype),function(a,i){return a-i})},e.prototype.pow=function(t,n){return Dt([t,n],"pow"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){return Math.pow(a,i)})},e.prototype.batchMatMul=function(t,n,a,i){Dt([t,n],"matMul");for(var s=a?t.shape[1]:t.shape[2],u=a?t.shape[2]:t.shape[1],c=i?n.shape[1]:n.shape[2],f=t.shape[0],h=this.readSync(t.dataId),d=this.readSync(n.dataId),m=a?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],g=m[0],y=m[1],x=m[2],w=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],b=w[0],C=w[1],A=w[2],T=u*c,R=ae([f,u,c],t.dtype),D=R.values,N=this.blockSize,O=0;O<f;O++)for(var k=0;k<u;k+=N)for(var z=0;z<c;z+=N)for(var F=0;F<s;F+=N)for(var B=Math.min(k+N,u),V=Math.min(z+N,c),G=Math.min(F+N,s),Q=k;Q<B;Q++)for(var L=z;L<V;L++){for(var X=0,$=F;$<G;$++)X+=h[O*g+Q*y+$*x]*d[$*b+L*C+O*A];D[O*T+(Q*c+L)]+=X}return R.toTensor()},e.prototype.fusedBatchMatMul=function(t){var n=t.a,a=t.b,i=t.transposeA,s=t.transposeB,u=t.bias,c=t.activation,f=t.preluActivationWeights,h=this.batchMatMul(n,a,i,s);return u&&(h=this.add(h,u)),c&&(h=qy(this,h,c,f)),h},e.prototype.multiply=function(t,n){return t.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),n.cast("complex64"),function(a,i,s,u){return{real:a*s-i*u,imag:a*u+i*s}}):this.broadcastedBinaryOp(t,n,_n(t.dtype,n.dtype),function(a,i){return a*i})},e.prototype.realDivide=function(t,n){return Dt([t,n],"realDivide"),this.broadcastedBinaryOp(t,n,"float32",function(a,i){return a/i})},e.prototype.floorDiv=function(t,n){return Dt([t,n],"floorDiv"),this.broadcastedBinaryOp(t,n,"int32",function(a,i){return Math.floor(a/i)})},e.prototype.sum=function(t,n){Dt(t,"sum"),wr("sum",n,t.rank);for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,_n(t.dtype,"int32")),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=0,y=0;y<c;++y)g+=h[m+y];f[d]=g}return u},e.prototype.prod=function(t,n){Dt(t,"sum");for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,_n(t.dtype,"int32")),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=1,y=0;y<c;++y)g*=h[m+y];f[d]=g}return u},e.prototype.unsortedSegmentSum=function(t,n,a){Dt(t,"unsortedSegmentSum");for(var i=[],s=t.rank-n.rank,u=0;u<s;++u)n=n.expandDims(u+1);for(u=0;u<a;++u){var c=jt(u,"int32"),f=Do(c,n).asType("float32").mul(t).sum(0);i.push(f)}return Lr(i)},e.prototype.argMin=function(t,n){Dt(t,"argMin");var a=[n];wr("argMin",a,t.rank);for(var i=Yn(t.shape,a),s=i[0],u=i[1],c=Ie(s,"int32"),f=Kt(u),h=this.readSync(c.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var g=m*f,y=d[g],x=0,w=0;w<f;++w){var b=d[g+w];b<y&&(y=b,x=w)}h[m]=x}return c},e.prototype.argMax=function(t,n){Dt(t,"argMax");var a=[n];wr("argMax",a,t.rank);for(var i=Yn(t.shape,a),s=i[0],u=i[1],c=Ie(s,"int32"),f=Kt(u),h=this.readSync(c.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var g=m*f,y=d[g],x=0,w=0;w<f;++w){var b=d[g+w];b>y&&(y=b,x=w)}h[m]=x}return c},e.prototype.cumsum=function(t,n,a,i){if(Dt(t,"cumsum"),n!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+n);for(var s=_n(t.dtype,"int32"),u=Ie(t.shape,s),c=this.readSync(u.dataId),f=this.readSync(t.dataId),h=t.shape[t.rank-1],d=i?function(w,b){return w+h-b-1}:function(w,b){return w+b},m=0;m<f.length;m+=h)for(var g=0;g<h;g++){var y=d(m,g);if(g===0)c[y]=a?0:f[y];else{var x=d(m,g-1);c[y]=a?f[x]+c[x]:f[y]+c[x]}}return u},e.prototype.equal=function(t,n){return Dt([t,n],"equal"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a===i?1:0})},e.prototype.notEqual=function(t,n){return Dt([t,n],"notEqual"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a!==i?1:0})},e.prototype.less=function(t,n){return Dt([t,n],"less"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a<i?1:0})},e.prototype.lessEqual=function(t,n){return Dt([t,n],"lessEqual"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a<=i?1:0})},e.prototype.greater=function(t,n){return Dt([t,n],"greater"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a>i?1:0})},e.prototype.greaterEqual=function(t,n){return Dt([t,n],"greaterEqual"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a>=i?1:0})},e.prototype.logicalNot=function(t){Dt(t,"logicalNot");for(var n=this.readSync(t.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,t.shape,"bool")},e.prototype.logicalAnd=function(t,n){return Dt([t,n],"logicalAnd"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a&&i})},e.prototype.logicalOr=function(t,n){return Dt([t,n],"logicalOr"),this.broadcastedBinaryOp(t,n,"bool",function(a,i){return a||i})},e.prototype.select=function(t,n,a){Dt([t,n,a],"select");for(var i=this.readSync(t.dataId),s=this.readSync(n.dataId),u=this.readSync(a.dataId),c=Ie(n.shape,_n(n.dtype,a.dtype)),f=this.readSync(c.dataId),h=0,d=t.rank===0||t.rank>1||n.rank===1?1:Kt(n.shape.slice(1)),m=0;m<i.length;m++)for(var g=0;g<d;g++)i[m]===1?f[h++]=s[m]:f[h++]=u[m];return c},e.prototype.where=function(t){Dt([t],"where");var n=this.readSync(t.dataId);return Q1(t.shape,n)},e.prototype.topk=function(t,n,a){return Dt(t,"topk"),rO(this.readSync(t.dataId),t.shape,t.dtype,n)},e.prototype.min=function(t,n){Dt(t,"min"),wr("min",n,t.rank);for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,t.dtype),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=h[m],y=0;y<c;++y){var x=h[m+y];x<g&&(g=x)}f[d]=g}return u},e.prototype.minimum=function(t,n){return Dt([t,n],"minimum"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){return Math.min(a,i)})},e.prototype.mod=function(t,n){return Dt([t,n],"mod"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){var s=a%i;return a<0&&i<0||a>=0&&i>=0?s:(s+i)%i})},e.prototype.max=function(t,n){Dt(t,"max"),wr("max",n,t.rank);for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,t.dtype),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=h[m],y=0;y<c;++y){var x=h[m+y];x>g&&(g=x)}f[d]=g}return u},e.prototype.maximum=function(t,n){return Dt([t,n],"maximum"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){return Math.max(a,i)})},e.prototype.all=function(t,n){Dt(t,"all"),wr("all",n,t.rank);for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,t.dtype),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=h[m],y=0;y<c;++y){var x=h[m+y];g=g&&x}f[d]=g}return u},e.prototype.any=function(t,n){Dt(t,"any"),wr("any",n,t.rank);for(var a=Yn(t.shape,n),i=a[0],s=a[1],u=Ie(i,t.dtype),c=Kt(s),f=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<f.length;++d){for(var m=d*c,g=h[m],y=0;y<c;++y){var x=h[m+y];g=g||x}f[d]=g}return u},e.prototype.squaredDifference=function(t,n){return Dt([t,n],"squaredDifference"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){var s=a-i;return s*s})},e.prototype.ceil=function(t){Dt(t,"ceil");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,t.shape,"float32")},e.prototype.floor=function(t){Dt(t,"floor");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,t.shape,"float32")},e.prototype.sign=function(t){Dt(t,"x");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,t.shape,"float32")},e.prototype.isNaN=function(t){Dt(t,"x");for(var n=this.readSync(t.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,t.shape,"bool")},e.prototype.isInf=function(t){Dt(t,"x");for(var n=this.readSync(t.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,t.shape,"bool")},e.prototype.isFinite=function(t){Dt(t,"x");for(var n=this.readSync(t.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,t.shape,"bool")},e.prototype.round=function(t){Dt(t,"round");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=Math.floor(n[i]);n[i]-s<.5?a[i]=Math.floor(n[i]):n[i]-s>.5?a[i]=Math.ceil(n[i]):a[i]=s%2==0?s:s+1}return this.makeOutput(a,t.shape,"float32")},e.prototype.exp=function(t){Dt(t,"exp");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,t.shape,"float32")},e.prototype.expm1=function(t){Dt(t,"expm1");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,t.shape,"float32")},e.prototype.log=function(t){Dt(t,"log");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log(s)}return this.makeOutput(a,t.shape,"float32")},e.prototype.log1p=function(t){Dt(t,"log1p");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log1p(s)}return this.makeOutput(a,t.shape,"float32")},e.prototype.sqrt=function(t){Dt(t,"sqrt");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.sqrt(s)}return this.makeOutput(a,t.shape,"float32")},e.prototype.rsqrt=function(t){Dt(t,"rsqrt");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=1/Math.sqrt(s)}return this.makeOutput(a,t.shape,"float32")},e.prototype.reciprocal=function(t){Dt(t,"reciprocal");for(var n=this.readSync(t.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){Dt(t,"relu");for(var n=Ie(t.shape,t.dtype),a=this.readSync(n.dataId),i=this.readSync(t.dataId),s=0;s<i.length;++s)a[s]=Math.max(0,i[s]);return n},e.prototype.relu6=function(t){Dt(t,"relu");for(var n=Ie(t.shape,t.dtype),a=this.readSync(n.dataId),i=this.readSync(t.dataId),s=0;s<i.length;++s)a[s]=Math.min(Math.max(0,i[s]),6);return n},e.prototype.prelu=function(t,n){return Dt([t,n],"prelu"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){return a<0?i*a:a})},e.prototype.elu=function(t){Dt(t,"elu");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i){var s=a[i];n[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(n,t.shape,"float32")},e.prototype.eluDer=function(t,n){Dt([t,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),s=this.readSync(t.dataId),u=0;u<i.length;++u){var c=i[u];a[u]=c>=1?s[u]:s[u]*(c+1)}return this.makeOutput(a,n.shape,"float32")},e.prototype.selu=function(t){Dt(t,"selu");for(var n=J1,a=tx,i=new Float32Array(t.size),s=this.readSync(t.dataId),u=0;u<s.length;++u){var c=s[u];i[u]=c>=0?a*c:n*(Math.exp(c)-1)}return this.makeOutput(i,t.shape,"float32")},e.prototype.clip=function(t,n,a){Dt(t,"clip");for(var i=new Float32Array(t.size),s=this.readSync(t.dataId),u=0;u<s.length;++u){var c=s[u];i[u]=c>a?a:c<n?n:c}return this.makeOutput(i,t.shape,"float32")},e.prototype.abs=function(t){for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<t.size;++i){var s=a[2*i],u=a[2*i+1];n[i]=Math.hypot(s,u)}return this.makeOutput(n,t.shape,"float32")},e.prototype.int=function(t){Dt(t,"int");for(var n=new Int32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,t.shape,"int32")},e.prototype.sigmoid=function(t){Dt(t,"sigmoid");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,t.shape,"float32")},e.prototype.softplus=function(t){Dt(t,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s){var u=i[s]>-n,c=i[s]<n,f=Math.exp(i[s]),h=void 0;h=c?f:u?i[s]:Math.log(1+f),a[s]=h}return this.makeOutput(a,t.shape,"float32")},e.prototype.sin=function(t){Dt(t,"sin");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.cos=function(t){Dt(t,"cos");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.tan=function(t){Dt(t,"tan");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.asin=function(t){Dt(t,"asin");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.acos=function(t){Dt(t,"acos");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.atan=function(t){Dt(t,"atan");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.atan2=function(t,n){return Dt([t,n],"atan2"),this.broadcastedBinaryOp(t,n,t.dtype,function(a,i){return Math.atan2(a,i)})},e.prototype.sinh=function(t){Dt(t,"sinh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.cosh=function(t){Dt(t,"cosh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.tanh=function(t){Dt(t,"tanh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=jR(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.asinh=function(t){Dt(t,"asinh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.acosh=function(t){Dt(t,"acosh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.atanh=function(t){Dt(t,"atanh");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,t.shape,"float32")},e.prototype.erf=function(t){Dt(t,"erf");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i){var s=Math.sign(a[i]),u=Math.abs(a[i]),c=1/(1+.3275911*u);n[i]=s*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-u*u))}return this.makeOutput(n,t.shape,"float32")},e.prototype.step=function(t,n){n===void 0&&(n=0),Dt(t,"step");for(var a=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s){var u=i[s];isNaN(u)?a[s]=NaN:a[s]=u>0?1:n}return this.makeOutput(a,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var n=t.input,a=t.filter,i=t.convInfo,s=t.bias,u=t.activation,c=t.preluActivationWeights,f=this.conv2d(n,a,i);return s&&(f=this.add(f,s)),u&&(f=qy(this,f,u,c)),f},e.prototype.conv2d=function(t,n,a){Dt([t,n],"conv2d");for(var i=a.filterHeight,s=a.filterWidth,u=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,h=a.padInfo.top,d=a.dataFormat==="channelsLast",m=ae(a.outShape,t.dtype),g=t.strides[0],y=d?t.strides[1]:t.strides[2],x=d?t.strides[2]:1,w=d?1:t.strides[1],b=m.strides[0],C=d?m.strides[1]:m.strides[2],A=d?m.strides[2]:1,T=d?1:m.strides[1],R=this.readSync(t.dataId),D=this.readSync(n.dataId),N=m.values,O=0;O<a.batchSize;++O)for(var k=O*g,z=O*b,F=0;F<a.outHeight;++F)for(var B=z+F*C,V=F*a.strideHeight-h,G=0;G<i;G++){var Q=V+G*u;if(!(Q<0||Q>=a.inHeight))for(var L=G*n.strides[0],X=k+Q*y,$=0;$<a.outWidth;++$)for(var it=B+$*A,tt=$*a.strideWidth-f,q=0;q<s;q++){var nt=tt+q*c;if(!(nt<0||nt>=a.inWidth))for(var W=X+nt*x,Z=L+q*n.strides[1],ot=0;ot<a.inChannels;++ot){for(var xt=R[W+ot*w],Ot=0;Ot<a.outChannels;++Ot)N[it+Ot*T]+=xt*D[Z+Ot];Z+=a.outChannels}}}return m.toTensor()},e.prototype.conv3d=function(t,n,a){for(var i=a.filterDepth,s=a.filterHeight,u=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,h=a.dilationWidth,d=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,y=ae(a.outShape,t.dtype),x=this.readSync(t.dataId),w=this.readSync(n.dataId),b=y.values,C=0;C<a.batchSize;++C)for(var A=C*t.strides[0],T=C*y.strides[0],R=0;R<a.outDepth;++R)for(var D=T+R*y.strides[1],N=R*a.strideDepth-d,O=0;O<i;O++){var k=N+O*c;if(!(k<0||k>=a.inDepth))for(var z=O*n.strides[0],F=A+k*t.strides[1],B=0;B<a.outHeight;++B)for(var V=D+B*y.strides[2],G=B*a.strideHeight-g,Q=0;Q<s;Q++){var L=G+Q*f;if(!(L<0||L>=a.inHeight))for(var X=z+Q*n.strides[1],$=F+L*t.strides[2],it=0;it<a.outWidth;++it)for(var tt=V+it*a.outChannels,q=it*a.strideWidth-m,nt=0;nt<u;nt++){var W=q+nt*h;if(!(W<0||W>=a.inWidth))for(var Z=X+nt*n.strides[2],ot=$+W*a.inChannels,xt=Z,Ot=0;Ot<a.inChannels;++Ot){for(var zt=x[ot+Ot],_t=0;_t<a.outChannels;++_t)b[tt+_t]+=zt*w[xt+_t];xt+=a.outChannels}}}}return y.toTensor()},e.prototype.conv2dDerInput=function(t,n,a){Dt([t,n],"conv2dDerInput");for(var i=ae(a.inShape,"float32"),s=i.values,u=this.readSync(t.dataId),c=this.readSync(n.dataId),f=n.strides,h=f[0],d=f[1],m=f[2],g=a.batchSize,y=a.filterHeight,x=a.filterWidth,w=a.inChannels,b=a.inHeight,C=a.inWidth,A=a.outChannels,T=a.outHeight,R=a.outWidth,D=a.strideHeight,N=a.strideWidth,O=a.dataFormat,k=y-1-a.padInfo.top,z=x-1-a.padInfo.left,F=O==="channelsLast",B=i.strides[0],V=F?i.strides[1]:i.strides[2],G=F?i.strides[2]:1,Q=F?1:i.strides[1],L=t.strides[0],X=F?t.strides[1]:t.strides[2],$=F?t.strides[2]:1,it=F?1:t.strides[1],tt=0;tt<g;++tt)for(var q=0;q<w;++q)for(var nt=0;nt<b;++nt)for(var W=nt-k,Z=Math.max(0,Math.ceil(W/D)),ot=Math.min(T,(y+W)/D),xt=0;xt<C;++xt){for(var Ot=xt-z,zt=Math.max(0,Math.ceil(Ot/N)),_t=Math.min(R,(x+Ot)/N),Mt=0,kt=Z;kt<ot;++kt)for(var Ft=kt*D-W,Pt=zt;Pt<_t;++Pt)for(var Ut=L*tt+X*kt+$*Pt,$t=h*(y-1-Ft)+d*(x-1-(Pt*N-Ot))+m*q,Wt=0;Wt<A;++Wt)Mt+=u[Ut+it*Wt]*c[$t+Wt];s[B*tt+V*nt+G*xt+Q*q]=Mt}return i.toTensor()},e.prototype.conv3dDerInput=function(t,n,a){for(var i=ae(a.inShape,"float32"),s=i.values,u=i.strides,c=u[0],f=u[1],h=u[2],d=u[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],x=g[1],w=g[2],b=g[3],C=this.readSync(n.dataId),A=n.strides,T=A[0],R=A[1],D=A[2],N=A[3],O=a.batchSize,k=a.filterDepth,z=a.filterHeight,F=a.filterWidth,B=a.inChannels,V=a.inDepth,G=a.inHeight,Q=a.inWidth,L=a.outChannels,X=a.outDepth,$=a.outHeight,it=a.outWidth,tt=a.strideDepth,q=a.strideHeight,nt=a.strideWidth,W=k-1-a.padInfo.front,Z=z-1-a.padInfo.top,ot=F-1-a.padInfo.left,xt=0;xt<O;++xt)for(var Ot=0;Ot<B;++Ot)for(var zt=0;zt<V;++zt)for(var _t=zt-W,Mt=Math.max(0,Math.ceil(_t/tt)),kt=Math.min(X,(k+_t)/tt),Ft=0;Ft<G;++Ft)for(var Pt=Ft-Z,Ut=Math.max(0,Math.ceil(Pt/q)),$t=Math.min($,(z+Pt)/q),Wt=0;Wt<Q;++Wt){for(var Ae=Wt-ot,cn=Math.max(0,Math.ceil(Ae/nt)),Et=Math.min(it,(F+Ae)/nt),ze=0,Ne=Mt;Ne<kt;++Ne)for(var yn=Ne*tt-_t,te=Ut;te<$t;++te)for(var de=te*q-Pt,Re=cn;Re<Et;++Re)for(var tn=y*xt+x*Ne+w*te+b*Re,Zn=T*(k-1-yn)+R*(z-1-de)+D*(F-1-(Re*nt-Ae))+N*Ot,on=0;on<L;++on)ze+=m[tn+on]*C[Zn+on];s[c*xt+f*zt+h*Ft+d*Wt+Ot]=ze}return i.toTensor()},e.prototype.conv2dDerFilter=function(t,n,a){Dt([t,n],"conv2dDerFilter");for(var i=a.strideHeight,s=a.strideWidth,u=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",h=ae(a.filterShape,"float32"),d=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(t),y=this.bufferSync(n),x=0;x<u;++x)for(var w=Math.max(0,Math.ceil((m-x)/i)),b=Math.min(a.outHeight,(a.inHeight+m-x)/i),C=0;C<c;++C)for(var A=Math.max(0,Math.ceil((d-C)/s)),T=Math.min(a.outWidth,(a.inWidth+d-C)/s),R=0;R<a.inChannels;++R)for(var D=0;D<a.outChannels;++D){for(var N=0,O=0;O<a.batchSize;++O)for(var k=w;k<b;++k)for(var z=x+k*i-m,F=A;F<T;++F){var B=C+F*s-d;N+=f?g.get(O,z,B,R)*y.get(O,k,F,D):g.get(O,R,z,B)*y.get(O,D,k,F)}h.set(N,x,C,R,D)}return h.toTensor()},e.prototype.conv3dDerFilter=function(t,n,a){for(var i=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.filterDepth,f=a.filterHeight,h=a.filterWidth,d=ae(a.filterShape,"float32"),m=d.values,g=d.strides,y=g[0],x=g[1],w=g[2],b=g[3],C=this.readSync(n.dataId),A=n.strides,T=A[0],R=A[1],D=A[2],N=A[3],O=this.readSync(t.dataId),k=t.strides,z=k[0],F=k[1],B=k[2],V=k[3],G=a.padInfo.front,Q=a.padInfo.left,L=a.padInfo.top,X=0;X<c;++X)for(var $=Math.max(0,Math.ceil((G-X)/i)),it=Math.min(a.outDepth,(a.inDepth+G-X)/i),tt=X*y,q=0;q<f;++q)for(var nt=Math.max(0,Math.ceil((L-q)/s)),W=Math.min(a.outHeight,(a.inHeight+L-q)/s),Z=q*x+tt,ot=0;ot<h;++ot)for(var xt=Math.max(0,Math.ceil((Q-ot)/u)),Ot=Math.min(a.outWidth,(a.inWidth+Q-ot)/u),zt=ot*w+Z,_t=0;_t<a.inChannels;++_t)for(var Mt=_t*b+zt,kt=0;kt<a.outChannels;++kt){for(var Ft=0,Pt=0;Pt<a.batchSize;++Pt)for(var Ut=Pt*z,$t=Pt*T,Wt=$;Wt<it;++Wt)for(var Ae=(X+Wt*i-G)*F+Ut,cn=Wt*R+$t,Et=nt;Et<W;++Et)for(var ze=(q+Et*s-L)*B+Ae,Ne=Et*D+cn,yn=xt;yn<Ot;++yn){var te=yn*N+Ne;Ft+=O[(ot+yn*u-Q)*V+ze+_t]*C[te+kt]}m[Mt+kt]=Ft}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var n=t.input,a=t.filter,i=t.convInfo,s=t.bias,u=t.activation,c=t.preluActivationWeights,f=this.depthwiseConv2D(n,a,i);return s&&(f=this.add(f,s)),u&&(f=qy(this,f,u,c)),f},e.prototype.depthwiseConv2D=function(t,n,a){Dt([t,n],"depthwiseConv2D");for(var i=a.filterHeight,s=a.filterWidth,u=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,h=a.padInfo.top,d=a.outChannels/a.inChannels,m=ae(a.outShape,t.dtype),g=this.readSync(t.dataId),y=this.readSync(n.dataId),x=m.values,w=0;w<a.batchSize;++w)for(var b=w*t.strides[0],C=w*m.strides[0],A=0;A<a.outHeight;++A)for(var T=C+A*m.strides[1],R=A*a.strideHeight-f,D=0;D<i;++D){var N=R+D*u;if(!(N<0||N>=a.inHeight))for(var O=D*n.strides[0],k=b+N*t.strides[1],z=0;z<a.outWidth;++z)for(var F=T+z*m.strides[2],B=z*a.strideWidth-h,V=0;V<s;++V){var G=B+V*c;if(!(G<0||G>=a.inWidth))for(var Q=O+V*n.strides[1],L=k+G*a.inChannels,X=F,$=Q,it=0;it<a.inChannels;++it){for(var tt=g[L+it],q=0;q<d;++q)x[X+q]+=tt*y[$+q];X+=d,$+=d}}}return m.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,n,a){Dt([t,n],"depthwiseConv2DDerInput");for(var i=ae(a.inShape,"float32"),s=i.values,u=i.strides,c=u[0],f=u[1],h=u[2],d=this.readSync(t.dataId),m=t.strides,g=m[0],y=m[1],x=m[2],w=this.readSync(n.dataId),b=n.strides,C=b[0],A=b[1],T=b[2],R=a.batchSize,D=a.filterHeight,N=a.filterWidth,O=a.inChannels,k=a.inHeight,z=a.inWidth,F=a.outChannels,B=a.outHeight,V=a.outWidth,G=a.strideHeight,Q=a.strideWidth,L=D-1-a.padInfo.top,X=N-1-a.padInfo.left,$=F/O,it=0;it<R;++it)for(var tt=0;tt<O;++tt)for(var q=0;q<k;++q)for(var nt=q-L,W=Math.max(0,Math.ceil(nt/G)),Z=Math.min(B,(D+nt)/G),ot=0;ot<z;++ot){for(var xt=ot-X,Ot=Math.max(0,Math.ceil(xt/Q)),zt=Math.min(V,(N+xt)/Q),_t=0,Mt=W;Mt<Z;++Mt)for(var kt=Mt*G-nt,Ft=Ot;Ft<zt;++Ft)for(var Pt=g*it+y*Mt+x*Ft,Ut=C*(D-1-kt)+A*(N-1-(Ft*Q-xt))+T*tt,$t=0;$t<$;++$t)_t+=d[Pt+(tt*$+$t)]*w[Ut+$t];s[c*it+f*q+h*ot+tt]=_t}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,n,a){Dt([t,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,s=a.strideWidth,u=a.filterHeight,c=a.filterWidth,f=ae(a.filterShape,"float32"),h=a.padInfo.left,d=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(t),y=this.bufferSync(n),x=0;x<u;++x)for(var w=Math.max(0,Math.ceil((d-x)/i)),b=Math.min(a.outHeight,(a.inHeight+d-x)/i),C=0;C<c;++C)for(var A=Math.max(0,Math.ceil((h-C)/s)),T=Math.min(a.outWidth,(a.inWidth+h-C)/s),R=0;R<a.outChannels;++R){for(var D=Math.trunc(R/m),N=R%m,O=0,k=0;k<a.batchSize;++k)for(var z=w;z<b;++z)for(var F=x+z*i-d,B=A;B<T;++B){var V=C+B*s-h;O+=g.get(k,F,V,D)*y.get(k,z,B,R)}f.set(O,x,C,D,N)}return f.toTensor()},e.prototype.tile=function(t,n){return Dt(t,"tile"),nO(this.bufferSync(t),n)},e.prototype.pad=function(t,n,a){Dt(t,"pad");var i=n.map(function(m,g){return m[0]+t.shape[g]+m[1]}),s=n.map(function(m){return m[0]}),u=this.bufferSync(t),c=ae(i,t.dtype);a!==0&&c.values.fill(a);for(var f=0;f<t.size;f++){var h=u.indexToLoc(f),d=h.map(function(m,g){return m+s[g]});c.set.apply(c,[u.get.apply(u,h)].concat(d))}return c.toTensor()},e.prototype.transpose=function(t,n){Dt(t,"transpose");for(var a=new Array(t.rank),i=0;i<a.length;i++)a[i]=t.shape[n[i]];var s=this.readSync(t.dataId),u=ae(a,t.dtype),c=this.bufferSync(t);for(i=0;i<t.size;++i){for(var f=c.indexToLoc(i),h=new Array(f.length),d=0;d<h.length;d++)h[d]=f[n[d]];var m=u.locToIndex(h);u.values[m]=s[i]}return u.toTensor()},e.prototype.gather=function(t,n,a){Dt([t,n],"gather");var i=t.shape.slice(),s=this.readSync(n.dataId);i[a]=s.length;for(var u=ae(i,t.dtype),c=this.bufferSync(t),f=0;f<u.size;++f){var h=u.indexToLoc(f),d=h.slice();d[a]=s[h[a]];var m=c.locToIndex(d);u.values[f]=c.values[m]}return u.toTensor()},e.prototype.batchToSpaceND=function(t,n,a){Dt([t],"batchToSpaceND");var i=n.reduce(function(d,m){return d*m}),s=ud(t.shape,n,i),u=ld(s.length,n.length),c=cd(t.shape,n,i),f=V_(a,n.length),h=q_(c,a,n.length);return t.reshape(s).transpose(u).reshape(c).slice(f,h)},e.prototype.spaceToBatchND=function(t,n,a){Dt([t],"spaceToBatchND");var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var u=1+n.length;u<t.shape.length;++u)s.push([0,0]);var c=t.pad(s),f=ud(c.shape,n,i,!1),h=ld(f.length,n.length,!1),d=cd(c.shape,n,i,!1);return c.reshape(f).transpose(h).reshape(d)},e.prototype.pool=function(t,n,a){Dt(t,"pool");for(var i=n.strideHeight,s=n.strideWidth,u=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,h=n.effectiveFilterWidth,d=n.padInfo.top,m=n.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(t.dataId),x=ae(n.outShape,t.dtype),w=x.values,b=n.outShape[1]*n.outShape[2]*n.outShape[3],C=n.outShape[2]*n.outShape[3],A=n.outShape[3],T=0;T<n.batchSize;++T)for(var R=T*b,D=T*t.strides[0],N=0;N<n.inChannels;++N)for(var O=0;O<n.outHeight;++O)for(var k=O*i-d,z=Math.max(0,k),F=Math.min(n.inHeight,f+k),B=R+O*C,V=0;V<n.outWidth;++V){for(var G=V*s-m,Q=Math.max(0,G),L=Math.min(n.inWidth,h+G),X=g,$=0,it=0,tt=z;tt<F;tt+=u){for(var q=D+tt*t.strides[1],nt=Q;nt<L;nt+=c){var W=y[q+nt*t.strides[2]+N];a==="max"&&W>X?X=W:a==="avg"&&($+=W,it++)}if(isNaN(X))break}w[B+V*A+N]=a==="avg"?$/it:X}return x.toTensor()},e.prototype.maxPool=function(t,n){return this.pool(t,n,"max")},e.prototype.maxPoolPositions=function(t,n){for(var a=ae(n.outShape,"int32"),i=n.strideHeight,s=n.strideWidth,u=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,h=n.effectiveFilterWidth,d=n.padInfo.top,m=n.padInfo.left,g=this.bufferSync(t),y=0;y<n.batchSize;++y)for(var x=0;x<n.inChannels;++x)for(var w=0;w<n.outHeight;++w){for(var b=w*i-d,C=b;C<0;)C+=u;for(var A=Math.min(n.inHeight,f+b),T=0;T<n.outWidth;++T){for(var R=T*s-m,D=R;D<0;)D+=c;for(var N=Math.min(n.inWidth,h+R),O=Number.NEGATIVE_INFINITY,k=-1,z=C;z<A;z+=u)for(var F=z-b,B=D;B<N;B+=c){var V=B-R,G=g.get(y,z,B,x);G>O&&(O=G,k=F*h+V)}a.set(k,y,w,T,x)}}return a.toTensor()},e.prototype.maxPoolBackprop=function(t,n,a,i){Dt([n,a],"maxPoolBackprop");for(var s=this.maxPoolPositions(n,i),u=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=m-1-i.padInfo.left,y=d-1-i.padInfo.top,x=ae(n.shape,"float32"),w=this.bufferSync(s),b=this.bufferSync(t),C=0;C<i.batchSize;++C)for(var A=0;A<i.inChannels;++A)for(var T=0;T<i.inHeight;++T)for(var R=0;R<i.inWidth;++R){for(var D=T-y,N=R-g,O=0,k=0;k<d;k+=f){var z=(D+k)/u;if(!(z<0||z>=i.outHeight||Math.floor(z)!==z))for(var F=0;F<m;F+=h){var B=(N+F)/c;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var V=d*m-1-w.get(C,z,B,A)===k*m+F?1:0;V!==0&&(O+=b.get(C,z,B,A)*V)}}}x.set(O,C,T,R,A)}return x.toTensor()},e.prototype.avgPoolBackprop=function(t,n,a){Dt([t,n],"avgPoolBackprop");for(var i=a.strideHeight,s=a.strideWidth,u=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,h=a.dilationWidth,d=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,y=d-1-a.padInfo.top,x=ae(n.shape,"float32"),w=1/(u*c),b=this.bufferSync(t),C=0;C<a.batchSize;++C)for(var A=0;A<a.inChannels;++A)for(var T=0;T<a.inHeight;++T)for(var R=0;R<a.inWidth;++R){for(var D=T-y,N=R-g,O=0,k=0;k<d;k+=f){var z=(D+k)/i;if(!(z<0||z>=a.outHeight||Math.floor(z)!==z))for(var F=0;F<m;F+=h){var B=(N+F)/s;B<0||B>=a.outWidth||Math.floor(B)!==B||(O+=b.get(C,z,B,A))}}x.set(O*w,C,T,R,A)}return x.toTensor()},e.prototype.pool3d=function(t,n,a){Dt(t,"pool3d");for(var i=n.strideDepth,s=n.strideHeight,u=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,y=n.padInfo.front,x=n.padInfo.top,w=n.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=this.readSync(t.dataId),A=ae(n.outShape,t.dtype),T=A.values,R=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],D=n.outShape[2]*n.outShape[3]*n.outShape[4],N=n.outShape[3]*n.outShape[4],O=n.outShape[4],k=0;k<n.batchSize;++k)for(var z=k*R,F=k*t.strides[0],B=0;B<n.inChannels;++B)for(var V=0;V<n.outDepth;++V){for(var G=V*i-y,Q=G;Q<0;)Q+=c;for(var L=Math.min(n.inDepth,d+G),X=z+V*D,$=0;$<n.outHeight;++$){for(var it=$*s-x,tt=it;tt<0;)tt+=f;for(var q=Math.min(n.inHeight,m+it),nt=X+$*N,W=0;W<n.outWidth;++W){for(var Z=W*u-w,ot=Z;ot<0;)ot+=h;for(var xt=Math.min(n.inWidth,g+Z),Ot=nt+W*O,zt=b,_t=0,Mt=0,kt=Q;kt<L;kt+=c){for(var Ft=F+kt*t.strides[1],Pt=tt;Pt<q;Pt+=f){for(var Ut=Ft+Pt*t.strides[2],$t=ot;$t<xt;$t+=h){var Wt=C[Ut+$t*t.strides[3]+B];if(a==="max"&&Wt>zt?zt=Wt:a==="avg"&&(_t+=Wt,Mt++),isNaN(zt))break}if(isNaN(zt))break}if(isNaN(zt))break}T[Ot+B]=a==="avg"?_t/Mt:zt}}}return A.toTensor()},e.prototype.avgPool3d=function(t,n){return Dt(t,"avgPool3d"),this.pool3d(t,n,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,n,a){Dt([t,n],"avgPool3dBackprop");for(var i=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.filterDepth,f=a.filterHeight,h=a.filterWidth,d=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,y=a.effectiveFilterDepth,x=a.effectiveFilterHeight,w=a.effectiveFilterWidth,b=y-1-a.padInfo.front,C=w-1-a.padInfo.left,A=x-1-a.padInfo.top,T=ae(n.shape,"float32"),R=1/(c*f*h),D=this.bufferSync(t),N=0;N<a.batchSize;++N)for(var O=0;O<a.inChannels;++O)for(var k=0;k<a.inDepth;++k)for(var z=0;z<a.inHeight;++z)for(var F=0;F<a.inWidth;++F){for(var B=k-b,V=z-A,G=F-C,Q=0,L=0;L<y;L+=d){var X=(B+L)/i;if(!(X<0||X>=a.outDepth||Math.floor(X)!==X))for(var $=0;$<x;$+=m){var it=(V+$)/s;if(!(it<0||it>=a.outHeight||Math.floor(it)!==it))for(var tt=0;tt<w;tt+=g){var q=(G+tt)/u;q<0||q>=a.outWidth||Math.floor(q)!==q||(Q+=D.get(N,X,it,q,O))}}}T.set(Q*R,N,k,z,F,O)}return T.toTensor()},e.prototype.maxPool3d=function(t,n){return Dt(t,"maxPool3d"),this.pool3d(t,n,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,n){for(var a=ae(n.outShape,"int32"),i=n.strideDepth,s=n.strideHeight,u=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,y=n.padInfo.front,x=n.padInfo.top,w=n.padInfo.left,b=this.bufferSync(t),C=0;C<n.batchSize;++C)for(var A=0;A<n.inChannels;++A)for(var T=0;T<n.outDepth;++T){for(var R=T*i-y,D=R;D<0;)D+=c;for(var N=Math.min(n.inDepth,d+R),O=0;O<n.outHeight;++O){for(var k=O*s-x,z=k;z<0;)z+=f;for(var F=Math.min(n.inHeight,m+k),B=0;B<n.outWidth;++B){for(var V=B*u-w,G=V;G<0;)G+=h;for(var Q=Math.min(n.inWidth,g+V),L=Number.NEGATIVE_INFINITY,X=-1,$=D;$<N;$+=c)for(var it=$-R,tt=z;tt<F;tt+=f)for(var q=tt-k,nt=G;nt<Q;nt+=h){var W=nt-V,Z=b.get(C,$,tt,nt,A);Z>=L&&(L=Z,X=it*m*g+q*m+W)}a.set(X,C,T,O,B,A)}}}return a.toTensor()},e.prototype.maxPool3dBackprop=function(t,n,a,i){Dt([n,a],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(n,i),u=i.strideDepth,c=i.strideHeight,f=i.strideWidth,h=i.dilationDepth,d=i.dilationHeight,m=i.dilationWidth,g=i.effectiveFilterDepth,y=i.effectiveFilterHeight,x=i.effectiveFilterWidth,w=g-1-i.padInfo.front,b=x-1-i.padInfo.left,C=y-1-i.padInfo.top,A=ae(n.shape,"float32"),T=this.bufferSync(s),R=this.bufferSync(t),D=0;D<i.batchSize;++D)for(var N=0;N<i.inChannels;++N)for(var O=0;O<i.inDepth;++O)for(var k=0;k<i.inHeight;++k)for(var z=0;z<i.inWidth;++z){for(var F=O-w,B=k-C,V=z-b,G=0,Q=0;Q<g;Q+=h){var L=(F+Q)/u;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var X=0;X<y;X+=d){var $=(B+X)/c;if(!($<0||$>=i.outHeight||Math.floor($)!==$))for(var it=0;it<x;it+=m){var tt=(V+it)/f;if(!(tt<0||tt>=i.outWidth||Math.floor(tt)!==tt)){var q=g*y*x-1-T.get(D,L,$,tt,N)===Q*y*x+X*x+it?1:0;q!==0&&(G+=R.get(D,L,$,tt,N)*q)}}}}A.set(G,D,O,k,z,N)}return A.toTensor()},e.prototype.cast=function(t,n){return K1(t,n,this)},e.prototype.reshape=function(t,n){return pd(t,n)},e.prototype.avgPool=function(t,n){return Dt(t,"avgPool"),this.pool(t,n,"avg").toFloat()},e.prototype.resizeBilinear=function(t,n,a,i){Dt(t,"resizeBilinear");for(var s=t.shape,u=s[0],c=s[1],f=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(Kt([u,n,a,h])),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],y=[i&&n>1?n-1:n,i&&a>1?a-1:a],x=0,w=g[0]/y[0],b=g[1]/y[1],C=0;C<u;C++)for(var A=0;A<n;A++)for(var T=w*A,R=Math.floor(T),D=T-R,N=Math.min(c-1,Math.ceil(T)),O=C*t.strides[0]+R*t.strides[1],k=C*t.strides[0]+N*t.strides[1],z=0;z<a;z++)for(var F=b*z,B=Math.floor(F),V=F-B,G=Math.min(f-1,Math.ceil(F)),Q=O+B*t.strides[2],L=k+B*t.strides[2],X=O+ +G*t.strides[2],$=k+G*t.strides[2],it=0;it<h;it++){var tt=d[Q+it],q=d[L+it],nt=tt+(d[X+it]-tt)*V,W=nt+(q+(d[$+it]-q)*V-nt)*D;m[x++]=W}return sn(m,[u,n,a,h])},e.prototype.resizeBilinearBackprop=function(t,n,a){Dt([t,n],"resizeBilinearBackprop");for(var i=n.shape,s=i[0],u=i[1],c=i[2],f=i[3],h=t.shape,d=h[1],m=h[2],g=new Float32Array(s*u*c*f),y=[a&&d>1?u-1:u,a&&m>1?c-1:c],x=[a&&d>1?d-1:d,a&&m>1?m-1:m],w=y[0]/x[0],b=y[1]/x[1],C=this.readSync(t.dataId),A=0,T=0;T<s;T++)for(var R=T*n.strides[0],D=0;D<d;D++)for(var N=D*w,O=Math.floor(N),k=Math.min(Math.ceil(N),u-1),z=R+O*n.strides[1],F=R+k*n.strides[1],B=N-O,V=1-B,G=0;G<m;G++)for(var Q=G*b,L=Math.floor(Q),X=Math.min(Math.ceil(Q),c-1),$=Q-L,it=1-$,tt=z+L*n.strides[2],q=z+X*n.strides[2],nt=F+L*n.strides[2],W=F+X*n.strides[2],Z=V*it,ot=V*$,xt=B*it,Ot=B*$,zt=0;zt<f;zt++){var _t=C[A++];g[tt+zt]+=_t*Z,g[q+zt]+=_t*ot,g[nt+zt]+=_t*xt,g[W+zt]+=_t*Ot}return ka(g,[s,c,u,f],n.dtype)},e.prototype.resizeNearestNeighbor=function(t,n,a,i){Dt(t,"resizeNearestNeighbor");for(var s=t.shape,u=s[0],c=s[1],f=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(u*n*a*h),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],y=[i&&n>1?n-1:n,i&&a>1?a-1:a],x=g[0]/y[0],w=g[1]/y[1],b=0,C=0;C<u;C++)for(var A=C*t.strides[0],T=0;T<n;T++)for(var R=x*T,D=A+Math.min(c-1,i?Math.round(R):Math.floor(R))*t.strides[1],N=0;N<a;N++)for(var O=w*N,k=D+Math.min(f-1,i?Math.round(O):Math.floor(O))*t.strides[2],z=0;z<h;z++){var F=d[k+z];m[b++]=F}return sn(m,[u,n,a,h],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,n,a){Dt([t,n],"resizeNearestNeighborBackprop");for(var i=n.shape,s=i[0],u=i[1],c=i[2],f=i[3],h=t.shape,d=h[1],m=h[2],g=new Float32Array(s*u*c*f),y=this.readSync(t.dataId),x=[a&&d>1?u-1:u,a&&m>1?c-1:c],w=[a&&d>1?d-1:d,a&&m>1?m-1:m],b=x[0]/w[0],C=x[1]/w[1],A=1/b,T=1/C,R=2*Math.ceil(A)+2,D=2*Math.ceil(T)+2,N=0;N<s;N++)for(var O=N*n.strides[0],k=0;k<u;k++)for(var z=O+k*n.strides[1],F=Math.floor(k*A),B=Math.floor(F-R/2),V=0;V<c;V++)for(var G=z+V*n.strides[2],Q=Math.floor(V*T),L=Math.floor(Q-D/2),X=0;X<f;X++){for(var $=0,it=0;it<R;it++){var tt=it+B;if(!(tt<0||tt>=d)){var q=O+tt*t.strides[1],nt=tt*b;if(k===Math.min(u-1,a?Math.round(nt):Math.floor(nt)))for(var W=0;W<D;W++){var Z=W+L;if(!(Z<0||Z>=m)){var ot=q+Z*t.strides[2],xt=Z*C;V===Math.min(c-1,a?Math.round(xt):Math.floor(xt))&&($+=y[ot+X])}}}}g[G+X]=$}return ka(g,n.shape,n.dtype)},e.prototype.batchNormalization=function(t,n,a,i,s,u){Dt([t,n,a,s,u],"batchNorm");for(var c=this.readSync(t.dataId),f=this.readSync(n.dataId),h=this.readSync(a.dataId),d=s?this.readSync(s.dataId):new Float32Array([1]),m=u?this.readSync(u.dataId):new Float32Array([0]),g=new Float32Array(c.length),y=m.length,x=d.length,w=h.length,b=f.length,C=0,A=0,T=0,R=0,D=0;D<c.length;++D)g[D]=m[C++]+(c[D]-f[A++])*d[T++]/Math.sqrt(h[R++]+i),C>=y&&(C=0),A>=b&&(A=0),T>=x&&(T=0),R>=w&&(R=0);return ka(g,t.shape)},e.prototype.localResponseNormalization4D=function(t,n,a,i,s){Dt(t,"localResponseNormalization4D");var u=t.shape[3],c=u-1,f=this.readSync(t.dataId),h=t.size,d=new Float32Array(h);function m(w){for(var b=w%u,C=w-b+Math.max(0,b-n),A=w-b+Math.min(b+n,c),T=0;C<=A;C++){var R=f[C];T+=R*R}return T}for(var g=0;g<h;g++){var y=m(g),x=f[g]*Math.pow(a+i*y,-s);d[g]=x}return ka(d,t.shape)},e.prototype.LRNGrad=function(t,n,a,i,s,u,c){Dt(t,"LRNGrad");for(var f=t.shape[3],h=this.readSync(t.dataId),d=this.readSync(n.dataId),m=this.readSync(a.dataId),g=new Float32Array(t.size),y=t.size,x=0;x<y;x++){for(var w=x%f,b=x-w+Math.max(0,w-i),C=x-w+Math.min(f,w+i+1),A=0,T=b;T<C;T++)A+=Math.pow(d[T],2);for(A=u*A+s,T=b;T<C;T++){var R=-2*u*c*d[T]*m[x]/A;x===T&&(R+=Math.pow(A,-c)),R*=h[x],g[T]+=R}}return ka(g,t.shape)},e.prototype.multinomial=function(t,n,a,i){Dt(t,"multinomial");for(var s=n?t:Ro(t),u=s.shape[0],c=s.shape[1],f=Ie([u,a],"int32"),h=this.readSync(f.dataId),d=this.readSync(s.dataId),m=0;m<u;++m){var g=m*c,y=new Float32Array(c-1);y[0]=d[g];for(var x=1;x<y.length;++x)y[x]=y[x-1]+d[g+x];for(var w=Ud(i.toString()),b=m*a,C=0;C<a;++C){var A=w();h[b+C]=y.length;for(var T=0;T<y.length;T++)if(A<y[T]){h[b+C]=T;break}}}return f},e.prototype.oneHot=function(t,n,a,i){Dt(t,"oneHot");var s=new Float32Array(t.size*n);s.fill(i);for(var u=this.readSync(t.dataId),c=0;c<t.size;++c)u[c]>=0&&u[c]<n&&(s[c*n+u[c]]=a);return ta(s,[t.size,n],"int32")},e.prototype.nonMaxSuppression=function(t,n,a,i,s){return Dt(t,"nonMaxSuppression"),$1(this.readSync(t.dataId),this.readSync(n.dataId),a,i,s)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,n){for(var a=t.shape[0],i=t.shape[1],s=ae(t.shape,"float32"),u=ae(t.shape,"float32"),c=sr(t).as2D(a,i),f=zr(t).as2D(a,i),h=0;h<a;h++)for(var d=c.slice([h,0],[1,i]),m=f.slice([h,0],[1,i]),g=Tn(d,m),y=this.readSync(this.fftImpl(g,n).dataId),x=0;x<i;x++){var w=eA(y,x);s.values[h*i+x]=w.real,u.values[h*i+x]=w.imag}return Tn(s.toTensor(),u.toTensor()).as2D(a,i)},e.prototype.fftImpl=function(t,n){var a=t.as1D(),i=a.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(a,i,n).as2D(t.shape[0],t.shape[1]);return n&&(s=Tn(sr(s).div(jt(i)),zr(s).div(jt(i)))),s}var u=this.readSync(t.dataId),c=(function(f){for(var h=new Float32Array(f.length/2),d=new Float32Array(f.length/2),m=0;m<f.length;m+=2)h[m/2]=f[m],d[m/2]=f[m+1];return{real:h,imag:d}})(this.fourierTransformByMatmul(u,i,n));return Tn(c.real,c.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,n,a){if(n===1)return t;var i=this.readSync(t.dataId),s=n/2,u=(function(b){for(var C=Math.ceil(b.length/4),A=new Float32Array(C),T=new Float32Array(C),R=0;R<b.length;R+=4)A[Math.floor(R/4)]=b[R],T[Math.floor(R/4)]=b[R+1];return{real:A,imag:T}})(i),c=Tn(u.real,u.imag).as1D(),f=(function(b){for(var C=Math.floor(b.length/4),A=new Float32Array(C),T=new Float32Array(C),R=2;R<b.length;R+=4)A[Math.floor(R/4)]=b[R],T[Math.floor(R/4)]=b[R+1];return{real:A,imag:T}})(i),h=Tn(f.real,f.imag).as1D();c=this.fftRadix2(c,s,a),h=this.fftRadix2(h,s,a);var d=(function(b,C){for(var A=new Float32Array(b/2),T=new Float32Array(b/2),R=0;R<Math.ceil(b/2);R++){var D=(C?2:-2)*Math.PI*(R/b);A[R]=Math.cos(D),T[R]=Math.sin(D)}return{real:A,imag:T}})(n,a),m=Tn(d.real,d.imag).mul(h),g=c.add(m),y=c.sub(m),x=sr(g).concat(sr(y)),w=zr(g).concat(zr(y));return Tn(x,w).as1D()},e.prototype.fourierTransformByMatmul=function(t,n,a){for(var i=new Float32Array(2*n),s=0;s<n;s++){for(var u=0,c=0,f=0;f<n;f++){var h=xB(s*f,n,a),d=eA(t,f);u+=d.real*h.real-d.imag*h.imag,c+=d.real*h.imag+d.imag*h.real}a&&(u/=n,c/=n),bB(i,u,c,s)}return i},e.prototype.depthToSpace=function(t,n,a){K(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),K(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});for(var i=t.shape[0],s=t.shape[1],u=t.shape[2],c=t.shape[3],f=s*n,h=u*n,d=c/(n*n),m=this.readSync(t.dataId),g=new Float32Array(i*f*h*d),y=0,x=0;x<i;++x)for(var w=0;w<f;++w)for(var b=Math.floor(w/n),C=w%n,A=0;A<h;++A)for(var T=Math.floor(A/n),R=(C*n+A%n)*d,D=0;D<d;++D){var N=D+R+c*(T+u*(b+s*x));g[y++]=m[N]}return ka(g,[i,f,h,d])},e.prototype.broadcastedBinaryOp=function(t,n,a,i){var s=ge(t.shape,n.shape),u=ae(s,a),c=this.readSync(t.dataId),f=this.readSync(n.dataId),h=ls(t.shape,s),d=ls(n.shape,s),m=u.values;if(h.length+d.length===0)for(var g=0;g<m.length;++g)m[g]=i(c[g%c.length],f[g%f.length]);else{var y=this.bufferSync(t),x=this.bufferSync(n),w=function(b){var C=u.indexToLoc(b),A=C.slice(-t.rank);h.forEach(function(N){return A[N]=0});var T=y.locToIndex(A),R=C.slice(-n.rank);d.forEach(function(N){return R[N]=0});var D=x.locToIndex(R);m[b]=i(c[T],f[D])};for(g=0;g<m.length;++g)w(g)}return u.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,n,a){var i=ge(t.shape,n.shape),s=ae(i,"float32"),u=ae(i,"float32"),c=this.readSync(t.dataId),f=this.readSync(n.dataId),h=ls(t.shape,i),d=ls(n.shape,i),m=s.values,g=u.values;if(h.length+d.length===0)for(var y=0;y<m.length;y++){var x=y%c.length,w=y%f.length,b=a(c[2*x],c[2*x+1],f[2*w],f[2*w+1]);m[y]=b.real,g[y]=b.imag}else{var C=this.bufferSync(this.data.get(t.dataId).complexTensors.real),A=this.bufferSync(this.data.get(n.dataId).complexTensors.real),T=function(R){var D=s.indexToLoc(R),N=D.slice(-t.rank);h.forEach(function(B){return N[B]=0});var O=C.locToIndex(N),k=D.slice(-n.rank);d.forEach(function(B){return k[B]=0});var z=A.locToIndex(k),F=a(c[2*O],c[2*O+1],f[2*z],f[2*z+1]);m[R]=F.real,g[R]=F.imag};for(y=0;y<m.length;y++)T(y)}return this.complex(s.toTensor(),u.toTensor())},e.prototype.split=function(t,n,a){return eO(t,n,a)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,n,a,i,s,u){for(var c=t.shape,f=c[0],h=c[1],d=c[2],m=c[3],g=n.shape[0],y=i[0],x=i[1],w=ae([g,y,x,m],t.dtype),b=this.readSync(n.dataId),C=this.readSync(a.dataId),A=this.readSync(t.dataId),T=t.strides,R=w.strides,D=0;D<g;D++){var N=4*D,O=b[N],k=b[N+1],z=b[N+2],F=b[N+3],B=C[D];if(!(B>=f))for(var V=y>1?(z-O)*(h-1)/(y-1):0,G=x>1?(F-k)*(d-1)/(x-1):0,Q=0;Q<y;Q++){var L=y>1?O*(h-1)+Q*V:.5*(O+z)*(h-1);if(L<0||L>h-1)for(var X=0;X<x;X++)for(var $=0;$<m;$++){var it=$+X*R[2]+Q*R[1]+D*R[0];w.values[it]=u}else if(s==="bilinear"){var tt=Math.floor(L),q=Math.ceil(L),nt=L-tt;for(X=0;X<x;X++)if((kt=x>1?k*(d-1)+X*G:.5*(k+F)*(d-1))<0||kt>d-1)for($=0;$<m;$++)it=$+X*R[2]+Q*R[1]+D*R[0],w.values[it]=u;else{var W=Math.floor(kt),Z=Math.ceil(kt),ot=kt-W;for($=0;$<m;$++){var xt=A[it=$+W*T[2]+tt*T[1]+B*T[0]],Ot=A[it=$+Z*T[2]+tt*T[1]+B*T[0]],zt=A[it=$+W*T[2]+q*T[1]+B*T[0]],_t=xt+(Ot-xt)*ot,Mt=zt+(A[it=$+Z*T[2]+q*T[1]+B*T[0]]-zt)*ot;it=$+X*R[2]+Q*R[1]+D*R[0],w.values[it]=_t+(Mt-_t)*nt}}}else for(X=0;X<x;++X){var kt;if((kt=x>1?k*(d-1)+X*G:.5*(k+F)*(d-1))<0||kt>d-1)for($=0;$<m;$++)it=$+X*R[2]+Q*R[1]+D*R[0],w.values[it]=u;else{var Ft=Math.round(kt),Pt=Math.round(L);for($=0;$<m;$++){var Ut=$+Ft*T[2]+Pt*T[1]+B*T[0],$t=$+X*R[2]+Q*R[1]+D*R[0];w.values[$t]=A[Ut]}}}}}return w.toTensor()},e.prototype.sparseToDense=function(t,n,a,i){var s=fd(0,t,a),u=s.sliceRank,c=s.numUpdates,f=s.sliceSize,h=s.strides,d=s.outputSize;return this.scatter(t,n,a,d,f,c,u,h,i,!1)},e.prototype.gatherND=function(t,n){var a=n.shape,i=a[a.length-1],s=W_(t,n),u=s[0],c=s[1],f=s[2],h=s[3];if(c===0)return sn([],u,t.dtype);for(var d=new bs([c,f],t.dtype),m=this.readSync(n.dataId),g=this.readSync(t.dataId),y=0;y<c;y++){for(var x=[],w=0,b=0;b<i;b++){var C=m[y*i+b];w+=C*h[b],x.push(C)}if(w<0||w>=t.size/f)throw new Error("Invalid indices: "+x+" does not index into "+t.shape);for(var A=0;A<f;A++)d.values[y*f+A]=g[w*f+A]}return d.toTensor().reshape(u)},e.prototype.scatterND=function(t,n,a){var i=fd(0,t,a),s=i.sliceRank,u=i.numUpdates,c=i.sliceSize,f=i.strides,h=i.outputSize,d=jt(0);return this.scatter(t,n,a,h,c,u,s,f,d,!0)},e.prototype.fill=function(t,n,a){var i=Mc(a=a||rl(n),Kt(t));return i.fill(n),at.makeTensor(i,t,a,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var n=Mc(t.dtype,Kt(t.shape));return this.makeOutput(n,t.shape,t.dtype)},e.prototype.linspace=function(t,n,a){return Y1(t,n,a)},e.prototype.scatter=function(t,n,a,i,s,u,c,f,h,d){var m=[i/s,s],g=this.readSync(t.dataId),y=this.readSync(n.dataId);if(i===0)return sn([],a,n.dtype);var x=new bs(m,n.dtype);x.values.fill(this.readSync(h.dataId)[0]);for(var w=0;w<u;w++){for(var b=[],C=0,A=0;A<c;A++){var T=g[w*c+A];b.push(T),C+=T*f[A]}if(C<0||C>=i/s)throw new Error("Invalid indices: "+b+" does not index into "+a);for(var R=0;R<s;R++)d?x.values[C*s+R]+=y[w*s+R]:x.values[C*s+R]=n.rank===0?y[0]:y[w*s+R]}return x.toTensor().reshape(a)},e})(Kd);at.registerBackend("cpu",function(){return new xU},1),nd({kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var e=r.inputs,t=r.backend,n=e.x,a=t;Dt(n,"square");for(var i=a.data.get(n.dataId).values,s=new Float32Array(i.length),u=0;u<i.length;++u){var c=i[u];s[u]=c*c}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}}),nd({kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var e=r.inputs,t=r.backend,n=e.x,a=t,i=new fe(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}});var wU=(function(){function r(){}return r.prototype.fetch=function(e,t){return fetch(e,t)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},r.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},r})();yt().get("IS_BROWSER")&&yt().setPlatform("browser",new wU);var Wy,SU=function(){return require("node-fetch")},EU=(function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(e,t){return yt().global.fetch!=null?yt().global.fetch(e,t):(Wy==null&&(Wy=SU()),Wy(e,t))},r.prototype.now=function(){var e=Rn.hrtime();return 1e3*e[0]+e[1]/1e6},r.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},r.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},r})();yt().get("IS_NODE")&&yt().setPlatform("node",new EU);var zb={float32:4,int32:4,uint16:2,uint8:1,bool:1},dd=4;function GO(r,e){for(var t={},n=0,a=function(u){var c=u.name,f=u.dtype,h=u.shape,d=Kt(h),m=void 0;if("quantization"in u){var g=u.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+u.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var y=zb[g.dtype],x=r.slice(n,n+d*y),w=g.dtype==="uint8"?new Uint8Array(x):new Uint16Array(x);if(f==="float32")m=Float32Array.from(w,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(w,function(D){return Math.round(D*g.scale+g.min)})}n+=d*y}else if(f==="string"){var b=Kt(u.shape);m=[];for(var C=0;C<b;C++){var A=new Uint32Array(r.slice(n,n+dd))[0];n+=dd;var T=new Uint8Array(r.slice(n,n+A));m.push(T),n+=A}}else{var R=zb[f];if(x=r.slice(n,n+d*R),f==="float32")m=new Float32Array(x);else if(f==="int32")m=new Int32Array(x);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(x)}n+=d*R}t[c]=sn(m,h,f)},i=0,s=e;i<s.length;i++)a(s[i]);return t}function CU(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var e=0,t=[];r.forEach(function(i){if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var n=new Uint8Array(e),a=0;return t.forEach(function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),n.buffer}var Fb=typeof ys<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function SA(r){return Fb?ys.byteLength(r):new Blob([r]).size}function Kx(r){var e=0;r.forEach(function(a){e+=a.byteLength});var t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(new Uint8Array(a),n),n+=a.byteLength}),t.buffer}function EA(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var e=r.split("/");return e[e.length-1]}function zf(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:SA(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:SA(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var Fr=(function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(e){r.getInstance().saveRouters.push(e)},r.registerLoadRouter=function(e){r.getInstance().loadRouters.push(e)},r.getSaveHandlers=function(e){return r.getHandlers(e,"save")},r.getLoadHandlers=function(e,t){return r.getHandlers(e,"load",t)},r.getHandlers=function(e,t,n){var a=[];return(t==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach(function(i){var s=i(e,n);s!==null&&a.push(s)}),a},r})(),ju="://",mo=(function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(e,t){K(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(ju)&&(e=e.slice(0,e.indexOf(ju))),K(e.length>0,function(){return"scheme must not be an empty string."});var n=r.getInstance();K(n.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),n.managers[e]=t},r.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r})();function Fp(r){if(r.indexOf(ju)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+mo.getSchemes().join(","));return{scheme:r.split(ju)[0],path:r.split(ju)[1]}}function CA(r,e,t){return t===void 0&&(t=!1),Ht(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d;return Gt(this,function(m){switch(m.label){case 0:return K(r!==e,function(){return"Old path and new path are the same: '"+r+"'"}),K((n=Fr.getLoadHandlers(r)).length>0,function(){return"Copying failed because no load handler is found for source URL "+r+"."}),K(n.length<2,function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."}),a=n[0],K((i=Fr.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),K(i.length<2,function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+e+"."}),s=i[0],u=Fp(r).scheme,c=Fp(r).path,f=u===Fp(r).scheme,[4,a.load()];case 1:return h=m.sent(),t&&f?[4,mo.getManager(u).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(h)];case 4:return d=m.sent(),!t||f?[3,6]:[4,mo.getManager(u).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var fs="models_store",ho="model_info_store";function XO(){if(!yt().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window,e=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Bb(r){var e=r.result;e.createObjectStore(fs,{keyPath:"modelPath"}),e.createObjectStore(ho,{keyPath:"modelPath"})}var Pu=(function(){function r(e){if(this.indexedDB=XO(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return r.prototype.save=function(e){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},r.prototype.load=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},r.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(a,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Bb(s)},s.onsuccess=function(){var u=s.result;if(t==null){var c=u.transaction(fs,"readonly"),f=c.objectStore(fs).get(n.modelPath);f.onsuccess=function(){if(f.result==null)return u.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(x){return u.close(),i(f.error)},c.oncomplete=function(){return u.close()}}else{var h,d=zf(t),m=u.transaction(ho,"readwrite"),g=m.objectStore(ho),y=g.put({modelPath:n.modelPath,modelArtifactsInfo:d});y.onsuccess=function(){var x=(h=u.transaction(fs,"readwrite")).objectStore(fs).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:d});x.onsuccess=function(){return a({modelArtifactsInfo:d})},x.onerror=function(w){var b=(g=m.objectStore(ho)).delete(n.modelPath);b.onsuccess=function(){return u.close(),i(x.error)},b.onerror=function(C){return u.close(),i(x.error)}}},y.onerror=function(x){return u.close(),i(y.error)},m.oncomplete=function(){h==null?u.close():h.oncomplete=function(){return u.close()}}}},s.onerror=function(u){return i(s.error)}})},r.URL_SCHEME="indexeddb://",r})(),AA=function(r){return yt().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Pu.URL_SCHEME)?(e=r.slice(Pu.URL_SCHEME.length),new Pu(e)):null;var e};Fr.registerSaveRouter(AA),Fr.registerLoadRouter(AA);var AU=(function(){function r(){this.indexedDB=XO()}return r.prototype.listModels=function(){return Ht(this,void 0,void 0,function(){var e=this;return Gt(this,function(t){return[2,new Promise(function(n,a){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Bb(i)},i.onsuccess=function(){var s=i.result,u=s.transaction(ho,"readonly"),c=u.objectStore(ho).getAll();c.onsuccess=function(){for(var f={},h=0,d=c.result;h<d.length;h++){var m=d[h];f[m.modelPath]=m.modelArtifactsInfo}n(f)},c.onerror=function(f){return s.close(),a(c.error)},u.oncomplete=function(){return s.close()}},i.onerror=function(s){return a(i.error)}})]})})},r.prototype.removeModel=function(e){return Ht(this,void 0,void 0,function(){var t=this;return Gt(this,function(n){var a;return e=(a=e).startsWith(Pu.URL_SCHEME)?a.slice(Pu.URL_SCHEME.length):a,[2,new Promise(function(i,s){var u=t.indexedDB.open("tensorflowjs",1);u.onupgradeneeded=function(){return Bb(u)},u.onsuccess=function(){var c,f=u.result,h=f.transaction(ho,"readwrite"),d=h.objectStore(ho),m=d.get(e);m.onsuccess=function(){if(m.result==null)return f.close(),s(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var g=d.delete(e),y=function(){var x=(c=f.transaction(fs,"readwrite")).objectStore(fs).delete(e);x.onsuccess=function(){return i(m.result.modelArtifactsInfo)},x.onerror=function(w){return s(m.error)}};g.onsuccess=y,g.onerror=function(x){return y(),f.close(),s(m.error)}},m.onerror=function(g){return f.close(),s(m.error)},h.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},u.onerror=function(c){return s(u.error)}})]})})},r})();if(yt().getBool("IS_BROWSER"))try{mo.registerManager(Pu.URL_SCHEME,new AU)}catch{}var vi="/",Fu="tensorflowjs_models",KO="info",NU="model_topology",TU="weight_specs",RU="weight_data",_U="model_metadata";function YO(r){return{info:[Fu,r,KO].join(vi),topology:[Fu,r,NU].join(vi),weightSpecs:[Fu,r,TU].join(vi),weightData:[Fu,r,RU].join(vi),modelMetadata:[Fu,r,_U].join(vi)}}function OU(r){var e=r.split(vi);if(e.length<3)throw new Error("Invalid key format: "+r);return e.slice(1,e.length-1).join(vi)}var Vu=(function(){function r(e){if(!yt().getBool("IS_BROWSER")||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=YO(this.modelPath)}return r.prototype.save=function(e){return Ht(this,void 0,void 0,function(){var t,n,a;return Gt(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=zf(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(s=e.weightData,Fb?ys.from(s).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(s))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}var s;return[2]})})},r.prototype.load=function(){return Ht(this,void 0,void 0,function(){var e,t,n,a,i,s,u;return Gt(this,function(c){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy),(u=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=(function(f){if(Fb){var h=ys.from(f,"base64");return h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}for(var d=atob(f),m=new Uint8Array(d.length),g=0;g<d.length;++g)m.set([d.charCodeAt(g)],g);return m.buffer})(u),[2,t]})})},r.URL_SCHEME="localstorage://",r})(),NA=function(r){return yt().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Vu.URL_SCHEME)?(e=r.slice(Vu.URL_SCHEME.length),new Vu(e)):null;var e};Fr.registerSaveRouter(NA),Fr.registerLoadRouter(NA);var DU=(function(){function r(){K(yt().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),K(window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return r.prototype.listModels=function(){return Ht(this,void 0,void 0,function(){var e,t,n,a,i,s;return Gt(this,function(u){for(e={},t=Fu+vi,n=vi+KO,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(t)&&i.endsWith(n)&&(s=OU(i),e[s]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},r.prototype.removeModel=function(e){return Ht(this,void 0,void 0,function(){var t,n;return Gt(this,function(a){var i;if(e=(i=e).startsWith(Vu.URL_SCHEME)?i.slice(Vu.URL_SCHEME.length):i,t=YO(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]})})},r})();if(yt().getBool("IS_BROWSER"))try{mo.registerManager(Vu.URL_SCHEME,new DU)}catch{}var IU="model",kU=".json",MU=".weights.bin";function TA(r){return new Promise(function(e){return setTimeout(e)}).then(r)}var Hy=(function(){function r(e){if(!yt().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(r.URL_SCHEME)&&(e=e.slice(r.URL_SCHEME.length)),e!=null&&e.length!==0||(e=IU),this.modelTopologyFileName=e+kU,this.weightDataFileName=e+MU}return r.prototype.save=function(e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u;return Gt(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,TA(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),e.weightData==null?[3,4]:((u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=t,[4,TA(function(){return u.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:zf(e)}]}})})},r.URL_SCHEME="downloads://",r})(),zU=(function(){function r(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return r.prototype.load=function(){return Ht(this,void 0,void 0,function(){var e,t,n=this;return Gt(this,function(a){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(i,s){var u=new FileReader;u.onload=function(c){var f=JSON.parse(c.target.result),h=f.modelTopology;if(h!=null){t.length===0&&i({modelTopology:h});var d=f.weightsManifest;if(d!=null){var m;try{m=n.checkManifestAndWeightFiles(d,t)}catch(w){return void s(w)}var g=[],y=[],x=[];d.forEach(function(w){w.paths.forEach(function(b){y.push(b),x.push(null)}),g.push.apply(g,w.weights)}),d.forEach(function(w){w.paths.forEach(function(b){var C=new FileReader;C.onload=function(A){var T=A.target.result,R=y.indexOf(b);x[R]=T,x.indexOf(null)===-1&&i({modelTopology:h,weightSpecs:g,weightData:Kx(x)})},C.onerror=function(A){return s("Failed to weights data from file of path '"+b+"'.")},C.readAsArrayBuffer(m[b])})})}else s(new Error("weightManifest field is missing from file "+e.name))}else s(new Error("modelTopology field is missing from file "+e.name))},u.onerror=function(c){return s("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},u.readAsText(e)})]})})},r.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],a=t.map(function(c){return EA(c.name)}),i={},s=0,u=e;s<u.length;s++)u[s].paths.forEach(function(c){var f=EA(c);if(n.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(n.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=t[a.indexOf(f)]});if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return i},r})();function RA(r,e,t,n){(function(i){K(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(r),(function(i,s){K(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),K(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),K(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})})(t=t??0,n=n??1);var a=0;return Promise.all(r.map(function(i){return i.then(function(s){var u=t+ ++a/r.length*(n-t);return e(u),s}),i}))}function $O(r,e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f,h;return Gt(this,function(d){switch(d.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?yt().platform.fetch:e.fetchFunc,n=r.map(function(m){return t(m,e.requestInit,{isBinary:!0})}),a=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=d.sent(),[3,4];case 2:return[4,RA(n,e.onProgress,a,i)];case 3:s=d.sent(),d.label=4;case 4:return u=s.map(function(m){return m.arrayBuffer()}),c=.5,f=1,e.onProgress!=null?[3,6]:[4,Promise.all(u)];case 5:return h=d.sent(),[3,8];case 6:return[4,RA(u,e.onProgress,c,f)];case 7:h=d.sent(),d.label=8;case 8:return[2,h]}})})}function _A(r){var e=this;return function(t,n,a){return n===void 0&&(n=""),Ht(e,void 0,void 0,function(){var i,s,u,c,f,h,d,m,g,y;return Gt(this,function(x){switch(x.label){case 0:if(i=t.map(function(){return!1}),s={},u=a!=null?a.map(function(){return!1}):[],c=[],t.forEach(function(w,b){var C=0;w.weights.forEach(function(A){var T="quantization"in A?A.quantization.dtype:A.dtype,R=zb[T]*Kt(A.shape),D=function(){i[b]=!0,s[b]==null&&(s[b]=[]),s[b].push({manifestEntry:A,groupOffset:C,sizeBytes:R})};a!=null?a.forEach(function(N,O){N===A.name&&(D(),u[O]=!0)}):D(),c.push(A.name),C+=R})}),!u.every(function(w){return w}))throw f=a.filter(function(w,b){return!u[b]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return h=i.reduce(function(w,b,C){return b&&w.push(C),w},[]),d=[],h.forEach(function(w){t[w].paths.forEach(function(b){var C=n+(n.endsWith("/")?"":"/")+b;d.push(C)})}),[4,r(d)];case 1:return m=x.sent(),g={},y=0,h.forEach(function(w){for(var b=t[w].paths.length,C=0,A=0;A<b;A++)C+=m[y+A].byteLength;for(var T=new ArrayBuffer(C),R=new Uint8Array(T),D=0,N=0;N<b;N++){var O=new Uint8Array(m[y+N]);R.set(O,D),D+=O.byteLength}s[w].forEach(function(k){var z=GO(T.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var F in z)g[F]=z[F]}),y+=b}),[2,g]}})})}}Fr.registerSaveRouter(function(r){return yt().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Hy.URL_SCHEME)?(e=r.slice(Hy.URL_SCHEME.length),e===void 0&&(e="model"),new Hy(e)):null;var e});var QO=(function(){function r(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(K(typeof t.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=yt().platform.fetch,K(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&K(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return r.prototype.save=function(e){return Ht(this,void 0,void 0,function(){var t,n,a,i;return Gt(this,function(s){switch(s.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:zf(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},r.prototype.load=function(){return Ht(this,void 0,void 0,function(){var e,t,n,a,i,s,u,c;return Gt(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=f.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,e.json()];case 3:return t=f.sent(),[3,5];case 4:throw f.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=t.modelTopology,i=t.weightsManifest,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:c=f.sent(),s=c[0],u=c[1],f.label=7;case 7:return[2,{modelTopology:a,weightSpecs:s,weightData:u}]}})})},r.prototype.loadWeights=function(e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f,h,d,m;return Gt(this,function(g){switch(g.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=(function(y){var x=y.lastIndexOf("/"),w=y.lastIndexOf("?"),b=y.substring(0,x),C=w>x?y.substring(w):"";return[b+"/",C]})(t),a=n[0],i=n[1],s=this.weightPathPrefix||a,u=[],c=0,f=e;c<f.length;c++)h=f[c],u.push.apply(u,h.weights);return d=[],e.forEach(function(y){y.paths.forEach(function(x){d.push(s+x+i)})}),[4,$O(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[u,Kx(m)]]}})})},r.URL_SCHEME_REGEX=/^https?:\/\//,r})();function Lb(r){return r.match(QO.URL_SCHEME_REGEX)!=null}var OA=function(r,e){return typeof fetch>"u"?null:(Array.isArray(r)?r.every(function(t){return Lb(t)}):Lb(r))?Ub(r,{onProgress:e}):null};function Ub(r,e){return new QO(r,e)}Fr.registerSaveRouter(OA),Fr.registerLoadRouter(OA);var Gy=(function(){function r(e){this.modelArtifacts=e}return r.prototype.load=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(e){return[2,this.modelArtifacts]})})},r})(),FU=(function(){function r(e){this.saveHandler=e}return r.prototype.save=function(e){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){return[2,this.saveHandler(e)]})})},r})(),lr=Object.freeze({browserFiles:function(r){return new zU(r)},browserHTTPRequest:function(r,e){return Ub(r,e)},concatenateArrayBuffers:Kx,decodeWeights:GO,encodeWeights:function(r,e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u=this;return Gt(this,function(c){switch(c.label){case 0:for(t=[],n=[],a=Array.isArray(r)?r.map(function(f){return f.name}):Object.keys(r),i=function(f){var h=a[f],d=Array.isArray(r)?r[f].tensor:r[h];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+h+"': "+d.dtype);var m={name:h,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var g=new Promise(function(y){return Ht(u,void 0,void 0,function(){var x,w,b,C,A,T,R;return Gt(this,function(D){switch(D.label){case 0:return[4,d.bytes()];case 1:for(x=D.sent(),w=x.reduce(function(N,O){return N+O.length},0)+dd*x.length,b=new Uint8Array(w),C=0,A=0;A<x.length;A++)T=x[A],R=new Uint8Array(new Uint32Array([T.length]).buffer),b.set(R,C),C+=dd,b.set(T,C),C+=T.length;return y(b),[2]}})})});n.push(g)}else n.push(d.data());e!=null&&(m.group=e),t.push(m)},s=0;s<a.length;++s)i(s);return[4,Promise.all(n)];case 1:return[2,{data:CU(c.sent()),specs:t}]}})})},fromMemory:function(r,e,t,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new Gy(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Gy({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Gy({modelTopology:r,weightSpecs:e,weightData:t,trainingConfig:n}))},getLoadHandlers:function(r,e){return Fr.getLoadHandlers(r,e)},getModelArtifactsInfoForJSON:zf,getSaveHandlers:function(r){return Fr.getSaveHandlers(r)},http:Ub,isHTTPScheme:Lb,loadWeights:function(r,e,t,n){return e===void 0&&(e=""),Ht(this,void 0,void 0,function(){return Gt(this,function(a){return[2,_A(function(i){return $O(i,{requestInit:n})})(r,e,t)]})})},registerLoadRouter:function(r){return Fr.registerLoadRouter(r)},registerSaveRouter:function(r){return Fr.registerSaveRouter(r)},weightsLoaderFactory:_A,withSaveHandler:function(r){return new FU(r)},copyModel:function(r,e){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){return[2,CA(r,e,!1)]})})},listModels:function(){return Ht(this,void 0,void 0,function(){var r,e,t,n,a,i,s;return Gt(this,function(u){switch(u.label){case 0:r=mo.getSchemes(),e={},t=0,n=r,u.label=1;case 1:return t<n.length?(a=n[t],[4,mo.getManager(a).listModels()]):[3,4];case 2:for(s in i=u.sent())e[a+ju+s]=i[s];u.label=3;case 3:return t++,[3,1];case 4:return[2,e]}})})},moveModel:function(r,e){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){return[2,CA(r,e,!0)]})})},removeModel:function(r){return Ht(this,void 0,void 0,function(){var e;return Gt(this,function(t){return e=Fp(r),[2,mo.getManager(e.scheme).removeModel(e.path)]})})}}),BU=rt({confusionMatrix_:function(r,e,t){var n=H(r,"labels","confusionMatrix"),a=H(e,"predictions","confusionMatrix");K(t==null||t>0&&Number.isInteger(t),function(){return"If provided, numClasses must be a positive integer, but got "+t}),K(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),K(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),K(n.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),K(t>0&&Number.isInteger(t),function(){return"numClasses is required to be a positive integer, but got "+t});var i=Ua(n.asType("int32"),t),s=Ua(a.asType("int32"),t);return i.transpose().matMul(s).asType("int32")}}),ZO=Object.freeze({confusionMatrix:BU}),LU=rt({fromPixels_:function(r,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var t=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(t&&t&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return at.fromPixels(r,e)}}),Vm=Object.freeze({toPixels:function(r,e){return Ht(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N,O;return Gt(this,function(k){switch(k.label){case 0:if(t=H(r,"img","toPixels"),r instanceof Ee||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(n=t.shape.slice(0,2),a=n[0],i=n[1],(s=t.rank===2?1:t.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,t.data()];case 1:return u=k.sent(),c=t.min(),f=t.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(h=k.sent(),d=h[0],m=h[1],g=d[0],y=m[0],c.dispose(),f.dispose(),t.dtype==="float32"){if(g<0||y>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+y+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(g<0||y>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+y+"].")}for(x=t.dtype==="float32"?255:1,w=new Uint8ClampedArray(i*a*4),b=0;b<a*i;++b)C=void 0,A=void 0,T=void 0,R=void 0,s===1?(C=u[b]*x,A=u[b]*x,T=u[b]*x,R=255):s===3?(C=u[3*b]*x,A=u[3*b+1]*x,T=u[3*b+2]*x,R=255):s===4&&(C=u[4*b]*x,A=u[4*b+1]*x,T=u[4*b+2]*x,R=u[4*b+3]*x),w[0+(D=4*b)]=Math.round(C),w[D+1]=Math.round(A),w[D+2]=Math.round(T),w[D+3]=Math.round(R);return e!=null&&(e.width=i,e.height=a,N=e.getContext("2d"),O=new ImageData(w,i,a),N.putImageData(O,0,0)),t!==r&&t.dispose(),[2,w]}})})},fromPixels:LU}),JO=(function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(e,t){return new e(t)},r})(),tD=(function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(e){r.getMap().classNameMap[e.className]=[e,e.fromConfig]},r})();function Mo(r){K(r.className!=null,function(){return"Class being registered does not have the static className property defined."}),K(typeof r.className=="string",function(){return"className is required to be a string, but got type "+typeof r.className}),K(r.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),tD.register(r)}var It=Object.freeze({Serializable:JO,SerializationMap:tD,registerClass:Mo}),UU=.001,eD=.1;function Xy(){return at.backend.floatPrecision()===32?UU:eD}function Ky(r,e,t){var n=!0;if(($n(r)||$n(e))&&(n=!1),$n(r)&&$n(e)&&(n=!0),n){var a=r.constructor.name,i=e.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(r)&&Array.isArray(e)){var s=Pa(r),u=Pa(e);if(!Pn(s,u))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+u+"]")}var c=$n(r)?r:Ci(r),f=$n(e)?e:Ci(e);if(c.length!==f.length)throw new Error("Arrays have different lengths actual: "+c.length+" vs expected: "+f.length+`.
Actual:   `+c+`.
Expected: `+f+".");for(var h=0;h<f.length;++h){var d=c[h],m=f[h];if(!t(d,m))throw new Error("Arrays differ: actual["+h+"] = "+d+", expected["+h+"] = "+m+`.
Actual:   `+c+`.
Expected: `+f+".")}}function Yy(r,e,t){return!isFinite(r)&&!isFinite(e)||!(isNaN(r)||isNaN(e)||Math.abs(r-e)>t)}var nD=Object.freeze({TEST_EPSILON_FLOAT16:eD,expectArraysClose:function(r,e,t){return t==null&&(t=Xy()),Ky(r,e,function(n,a){return Yy(n,a,t)})},testEpsilon:Xy,expectPromiseToFail:function(r,e){r().then(function(){return e.fail()},function(){return e()})},expectArraysEqual:function(r,e){var t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return fo(r)||fo(r[0])||fo(e)||fo(e[0])?Ky(r,t,function(n,a){return n==a}):Ky(r,e,function(n,a){return Yy(n,a,0)})},expectNumbersClose:function(r,e,t){if(t==null&&(t=Xy()),!Yy(r,e,t))throw new Error("Numbers differ: actual === "+r+", expected === "+e)},expectValuesInRange:function(r,e,t){for(var n=0;n<r.length;n++)if(r[n]<e||r[n]>t)throw new Error("Value out of range:"+r[n]+" low: "+e+", high: "+t)},expectArrayBuffersEqual:function(r,e){expect(new Float32Array(r)).toEqual(new Float32Array(e))}}),Yx="1.3.1",rD=Object.freeze({gpgpu_util:hL,webgl_util:lB,forceHalfFloat:function(){yt().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:IO,setWebGLContext:JR,GPGPUContext:AO}),Xa=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return ba(e,r),e.prototype.minimize=function(t,n,a){n===void 0&&(n=!1);var i=this.computeGradients(t,a),s=i.value,u=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:u[f.name]}});this.applyGradients(c)}else this.applyGradients(u);return re(u),n?s:(s.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,n){return G1(t,n)},e.prototype.dispose=function(){this.iterations_!=null&&re(this.iterations_)},e.prototype.saveIterations=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:jt(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(t){return Ht(this,void 0,void 0,function(){var n;return Gt(this,function(a){switch(a.label){case 0:return n=this,[4,t[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,t.slice(1)]}})})},e})(JO);Object.defineProperty(Xa,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var qm=(function(r){function e(t,n,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=t,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=at.backend.epsilon()),i}return ba(e,r),e.prototype.applyGradients=function(t){var n=this;(Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t)).forEach(function(a,i){var s=at.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:ft(function(){return ye(s).variable(!1)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:ft(function(){return ye(s).variable(!1)})});var u=Array.isArray(t)?t[i].tensor:t[a];if(u!=null){var c=n.accumulatedGrads[i].variable,f=n.accumulatedUpdates[i].variable;ft(function(){var h=c.mul(n.rho).add(u.square().mul(1-n.rho)),d=f.add(n.epsilon).sqrt().div(c.add(n.epsilon).sqrt()).mul(u),m=f.mul(n.rho).add(d.square().mul(1-n.rho));c.assign(h),f.assign(m);var g=d.mul(-n.learningRate).add(s);s.assign(g)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(re(this.accumulatedGrads.map(function(t){return t.variable})),re(this.accumulatedUpdates.map(function(t){return t.variable})))},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){var t;return Gt(this,function(n){switch(n.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){var n;return Gt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(t)];case 1:return t=a.sent(),n=t.length/2,this.accumulatedGrads=t.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=t.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,n){return new t(n.learningRate,n.rho,n.epsilon)},e.className="Adadelta",e})(Xa);Mo(qm);var Wm=(function(r){function e(t,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=t,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return ba(e,r),e.prototype.applyGradients=function(t){var n=this;(Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t)).forEach(function(a,i){var s=at.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:ft(function(){return Is(s.shape,n.initialAccumulatorValue).variable(!1)})});var u=Array.isArray(t)?t[i].tensor:t[a];if(u!=null){var c=n.accumulatedGrads[i].variable;ft(function(){var f=c.add(u.square());c.assign(f);var h=u.div(f.add(at.backend.epsilon()).sqrt()).mul(-n.learningRate).add(s);s.assign(h)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&re(this.accumulatedGrads.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,n){return new t(n.learningRate,n.initialAccumulatorValue)},e.className="Adagrad",e})(Xa);Mo(Wm);var Hm=(function(r){function e(t,n,a,i){i===void 0&&(i=null);var s=r.call(this)||this;return s.learningRate=t,s.beta1=n,s.beta2=a,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],ft(function(){s.accBeta1=jt(n).variable(),s.accBeta2=jt(a).variable()}),i==null&&(s.epsilon=at.backend.epsilon()),s}return ba(e,r),e.prototype.applyGradients=function(t){var n=this,a=Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t);ft(function(){var i=gn(1,n.accBeta1),s=gn(1,n.accBeta2);a.forEach(function(u,c){var f=at.registeredVariables[u];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:u+"/m",variable:ft(function(){return ye(f).variable(!1)})}),n.accumulatedSecondMoment[c]==null&&(n.accumulatedSecondMoment[c]={originalName:u+"/v",variable:ft(function(){return ye(f).variable(!1)})});var h=Array.isArray(t)?t[c].tensor:t[u];if(h!=null){var d=n.accumulatedFirstMoment[c].variable,m=n.accumulatedSecondMoment[c].variable,g=d.mul(n.beta1).add(h.mul(1-n.beta1)),y=m.mul(n.beta2).add(h.square().mul(1-n.beta2)),x=g.div(i),w=y.div(s);d.assign(g),m.assign(y);var b=x.div(w.sqrt().add(n.epsilon)).mul(-n.learningRate).add(f);f.assign(b)}}),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&re(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedSecondMoment!=null&&re(this.accumulatedSecondMoment.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){var t;return Gt(this,function(n){switch(n.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){var n,a=this;return Gt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),ft(function(){a.accBeta1.assign(Ss(a.beta1,a.iterations_+1)),a.accBeta2.assign(Ss(a.beta2,a.iterations_+1))}),n=t.length/2,this.accumulatedFirstMoment=t.slice(0,n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=t.slice(n,2*n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)},e.className="Adam",e})(Xa);Mo(Hm);var Gm=(function(r){function e(t,n,a,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var u=r.call(this)||this;return u.learningRate=t,u.beta1=n,u.beta2=a,u.epsilon=i,u.decay=s,u.accumulatedFirstMoment=[],u.accumulatedWeightedInfNorm=[],ft(function(){u.iteration=jt(0).variable(),u.accBeta1=jt(n).variable()}),i==null&&(u.epsilon=at.backend.epsilon()),u}return ba(e,r),e.prototype.applyGradients=function(t){var n=this,a=Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t);ft(function(){var i=gn(1,n.accBeta1),s=Sn(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach(function(u,c){var f=at.registeredVariables[u];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:u+"/m",variable:ye(f).variable(!1)}),n.accumulatedWeightedInfNorm[c]==null&&(n.accumulatedWeightedInfNorm[c]={originalName:u+"/v",variable:ye(f).variable(!1)});var h=Array.isArray(t)?t[c].tensor:t[u];if(h!=null){var d=n.accumulatedFirstMoment[c].variable,m=n.accumulatedWeightedInfNorm[c].variable,g=d.mul(n.beta1).add(h.mul(1-n.beta1)),y=m.mul(n.beta2),x=h.abs(),w=y.maximum(x);d.assign(g),m.assign(w);var b=s.div(i).mul(g.div(w.add(n.epsilon))).add(f);f.assign(b)}}),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&re(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedWeightedInfNorm!=null&&re(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},e.className="Adamax",e})(Xa);Mo(Gm);var Ff=(function(r){function e(t){var n=r.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return ba(e,r),e.prototype.applyGradients=function(t){var n=this;(Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t)).forEach(function(a,i){var s=Array.isArray(t)?t[i].tensor:t[a];if(s!=null){var u=at.registeredVariables[a];ft(function(){var c=n.c.mul(s).add(u);u.assign(c)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=ma(jt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,n){return new t(n.learningRate)},e.className="SGD",e})(Xa);Mo(Ff);var Xm=(function(r){function e(t,n,a){a===void 0&&(a=!1);var i=r.call(this,t)||this;return i.learningRate=t,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=jt(i.momentum),i}return ba(e,r),e.prototype.applyGradients=function(t){var n=this;(Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t)).forEach(function(a,i){var s=at.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:ft(function(){return ye(s).variable(!1)})});var u=n.accumulations[i].variable,c=Array.isArray(t)?t[i].tensor:t[a];c!=null&&ft(function(){var f,h=n.m.mul(u).add(c);f=n.useNesterov?n.c.mul(c.add(h.mul(n.m))).add(s):n.c.mul(h).add(s),u.assign(h),s.assign(f)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&re(this.accumulations.map(function(t){return t.variable}))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){return Gt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){return Gt(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulations=t.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)},e.className="Momentum",e})(Ff);Mo(Xm);var Km=(function(r){function e(t,n,a,i,s){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),s===void 0&&(s=!1);var u=r.call(this)||this;return u.learningRate=t,u.decay=n,u.momentum=a,u.epsilon=i,u.accumulatedMeanSquares=[],u.accumulatedMoments=[],u.accumulatedMeanGrads=[],u.centered=s,i==null&&(u.epsilon=at.backend.epsilon()),u}return ba(e,r),e.prototype.applyGradients=function(t){var n=this;(Array.isArray(t)?t.map(function(a){return a.name}):Object.keys(t)).forEach(function(a,i){var s=at.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:ft(function(){return ye(s).variable(!1)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:ft(function(){return ye(s).variable(!1)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:ft(function(){return ye(s).variable(!1)})});var u=Array.isArray(t)?t[i].tensor:t[a];if(u!=null){var c=n.accumulatedMeanSquares[i].variable,f=n.accumulatedMoments[i].variable;ft(function(){var h=c.mul(n.decay).add(u.square().mul(1-n.decay));if(n.centered){var d=n.accumulatedMeanGrads[i].variable,m=d.mul(n.decay).add(u.mul(1-n.decay)),g=f.mul(n.momentum).add(u.mul(n.learningRate).div(h.sub(m.square().add(n.epsilon)).sqrt()));c.assign(h),d.assign(m),f.assign(g);var y=s.sub(g);s.assign(y)}else{var x=c.mul(n.decay).add(u.square().mul(1-n.decay));g=f.mul(n.momentum).add(u.mul(n.learningRate).div(x.add(n.epsilon).sqrt())),c.assign(x),f.assign(g),y=s.sub(g),s.assign(y)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&re(this.accumulatedMeanSquares.map(function(t){return t.variable})),this.accumulatedMeanGrads!=null&&this.centered&&re(this.accumulatedMeanGrads.map(function(t){return t.variable})),this.accumulatedMoments!=null&&re(this.accumulatedMoments.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ht(this,void 0,void 0,function(){var t;return Gt(this,function(n){switch(n.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(t.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},e.prototype.setWeights=function(t){return Ht(this,void 0,void 0,function(){var n;return Gt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(t)];case 1:return t=a.sent(),n=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=t.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},e.className="RMSProp",e})(Xa);Mo(Km);var es=(function(){function r(){}return r.sgd=function(e){return new Ff(e)},r.momentum=function(e,t,n){return n===void 0&&(n=!1),new Xm(e,t,n)},r.rmsprop=function(e,t,n,a,i){return t===void 0&&(t=.9),n===void 0&&(n=0),a===void 0&&(a=null),i===void 0&&(i=!1),new Km(e,t,n,a,i)},r.adam=function(e,t,n,a){return e===void 0&&(e=.001),t===void 0&&(t=.9),n===void 0&&(n=.999),a===void 0&&(a=null),new Hm(e,t,n,a)},r.adadelta=function(e,t,n){return e===void 0&&(e=.001),t===void 0&&(t=.95),n===void 0&&(n=null),new qm(e,t,n)},r.adamax=function(e,t,n,a,i){return e===void 0&&(e=.002),t===void 0&&(t=.9),n===void 0&&(n=.999),a===void 0&&(a=null),i===void 0&&(i=0),new Gm(e,t,n,a,i)},r.adagrad=function(e,t){return t===void 0&&(t=.1),new Wm(e,t)},r})(),lo={sgd:es.sgd,momentum:es.momentum,adadelta:es.adadelta,adagrad:es.adagrad,rmsprop:es.rmsprop,adamax:es.adamax,adam:es.adam},jU=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(r){return r()};function Rc(){return new Promise(function(r){return jU(function(){return r()})})}wt=bU;const $x=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:qm,AdagradOptimizer:Wm,AdamOptimizer:Hm,AdamaxOptimizer:Gm,DataStorage:Xd,get ENV(){return Od},Environment:S1,KernelBackend:Kd,MomentumOptimizer:Xm,Optimizer:Xa,RMSPropOptimizer:Km,get Rank(){return od},get Reduction(){return Un},SGDOptimizer:Ff,Tensor:Ee,TensorBuffer:bs,Variable:Gu,abs:Ti,acos:Qd,acosh:Zd,add:se,addN:Sm,addStrict:fx,all:Af,any:Ku,argMax:Ri,argMin:Om,asin:Jd,asinh:tm,atan:em,atan2:Em,atanh:nm,avgPool:wf,avgPool3d:Ef,backend:tf,backend_util:tO,basicLSTMCell:Fx,batchNorm:gm,batchNorm2d:ym,batchNorm3d:bm,batchNorm4d:xm,batchNormalization:lx,batchNormalization2d:ox,batchNormalization3d:sx,batchNormalization4d:ux,batchToSpaceND:nf,booleanMaskAsync:Ax,browser:Vm,buffer:ae,cast:No,ceil:rm,clipByValue:er,clone:B1,complex:Tn,concat:Vn,concat1d:zd,concat2d:Fd,concat3d:Bd,concat4d:Ld,conv1d:vf,conv2d:Io,conv2dTranspose:yf,conv3d:gf,conv3dTranspose:Tx,cos:am,cosh:im,cumsum:L1,customGrad:zs,deprecationWarn:Jc,depthToSpace:jd,depthwiseConv2d:Us,diag:jx,disableDeprecationWarnings:T_,dispose:re,disposeVariables:R_,div:Sn,divStrict:hx,dot:Rx,dropout:Lm,elu:js,enableDebugMode:N_,enableProdMode:A_,engine:__,env:yt,equal:Do,equalStrict:bx,erf:om,exp:sm,expandDims:Qn,expm1:um,eye:rf,fft:fl,fill:Is,findBackend:F_,findBackendFactory:B_,floor:uf,floorDiv:df,frame:Mf,fused:Ns,gather:fa,gatherND:Bm,getBackend:M_,getKernel:E1,getKernelsForBackend:ed,grad:$_,grads:Q_,greater:Ls,greaterEqual:ul,greaterEqualStrict:xx,greaterStrict:wx,hammingWindow:Um,hannWindow:kf,ifft:As,imag:zr,image:xi,inTopKAsync:Vx,io:lr,irfft:Df,isFinite:ax,isInf:rx,isNaN:nx,keep:ma,leakyRelu:Rf,less:Nm,lessEqual:Tm,lessEqualStrict:Sx,lessStrict:Ex,linalg:Pm,linspace:Md,localResponseNormalization:Im,log:Va,log1p:lm,logSigmoid:ex,logSoftmax:of,logSumExp:zx,logicalAnd:Ga,logicalNot:wm,logicalOr:hf,logicalXor:cx,losses:qx,matMul:bf,math:ZO,max:Wa,maxPool:xf,maxPool3d:Sf,maximum:Ca,maximumStrict:px,mean:un,memory:sd,min:Nf,minimum:Bs,minimumStrict:dx,mod:Cm,modStrict:mx,moments:ko,movingAverage:Lx,mul:Jt,mulStrict:mf,multiRNNCell:Bx,multinomial:Pd,neg:Oo,nextFrame:Rc,norm:km,notEqual:Es,notEqualStrict:Cx,oneHot:Ua,ones:Sa,onesLike:Er,op:rt,outerProduct:_x,pad:ki,pad1d:U1,pad2d:j1,pad3d:Vd,pad4d:P1,pool:Mx,pow:Ss,powStrict:vx,prelu:_f,print:F1,prod:Tf,profile:O_,rand:V1,randomGamma:q1,randomNormal:qd,randomUniform:To,range:ef,ready:k_,real:sr,reciprocal:cm,registerBackend:L_,registerKernel:nd,relu:Mi,relu6:Dm,removeBackend:z_,reshape:Ms,reverse:va,reverse1d:Ox,reverse2d:Dx,reverse3d:Ix,reverse4d:kx,rfft:hl,round:fm,rsqrt:lf,scalar:jt,scatterND:Fm,selu:Of,separableConv2d:_m,serialization:It,setBackend:I_,setPlatform:U_,setdiff1dAsync:Wd,sigmoid:ol,sign:hm,signal:Px,sin:pm,sinh:dm,slice:nr,slice1d:ll,slice2d:Cf,slice3d:cl,slice4d:Cs,slice_util:Y_,softmax:Ro,softplus:sl,spaceToBatchND:af,sparseToDense:If,spectral:Ux,split:La,sqrt:Fs,square:$d,squaredDifference:Am,squaredDifferenceStrict:gx,squeeze:Ai,stack:Lr,step:ix,stft:jm,stridedSlice:Mm,sub:gn,subStrict:yx,sum:fr,tan:mm,tanh:cf,tensor:sn,tensor1d:zn,tensor2d:ta,tensor3d:ds,tensor4d:ka,tensor5d:k1,tensor6d:M1,tensor_util:pa,test_util:nD,tidy:ft,tile:bi,time:D_,topk:zm,train:lo,transpose:Qe,truncatedNormal:il,unregisterKernel:LR,unsortedSegmentSum:Rm,unstack:Ni,util:At,valueAndGrad:Z_,valueAndGrads:J_,variable:kd,variableGrads:G1,version_core:Yx,webgl:rD,where:qa,whereAsync:pf,zeros:Ie,zerosLike:ye},Symbol.toStringTag,{value:"Module"}));var aD=function(r,e){return(aD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(r,e)};function Nt(r,e){function t(){this.constructor=r}aD(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $y,Sc=function(){return(Sc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)};function ne(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){f.done?a(f.value):new t(function(h){h(f.value)}).then(s,u)}c((n=n.apply(r,[])).next())})}function Zt(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}function On(){return $y==null&&($y=tf().epsilon()),$y}function ga(){return"channelsLast"}var is=(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error),Ba=(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error),lt=(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error),he=(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error),PU=(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error);(function(r){function e(t){var n=r.call(this,t)||this;return Object.setPrototypeOf(n,e.prototype),n}return Nt(e,r),e})(Error);function Ts(r,e){if(Array.isArray(r)){for(var t=[],n=0;n<e;n++)t=t.concat(r);return t}return(t=new Array(e)).fill(r),t}function Ma(r,e){if(!r)throw new PU(e)}function DA(r,e){for(var t=0,n=0,a=r;n<a.length;n++)a[n]===e&&t++;return t}function or(r){return r.length===1?r[0]:r}function Ge(r){return Array.isArray(r)?r:[r]}function mi(r){var e=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function ss(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,function(e,t){return t.toUpperCase()})}var Qr={};function Qx(r){if(r==null)return null;var e={};return e.className=r.getClassName(),e.config=r.getConfig(),e}function jb(r){if(r!=null&&typeof r=="object")if(Array.isArray(r))r.forEach(function(i){return jb(i)});else for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e],a=r[n];a!=null&&typeof a=="object"&&(Array.isArray(a)||a.type!=="ndarray"||typeof a.value!="number"?jb(a):r[n]=a.value)}}function Bf(r,e,t,n,a){var i,s,u;if(e===void 0&&(e={}),t===void 0&&(t={}),n===void 0&&(n="object"),a===void 0&&(a=!1),typeof r=="string"){var c=r,f=void 0;if(c in t)f=t[c];else if(c in Qr)f=Qr[c];else if((f=e[c])==null)throw new lt("Unknown "+n+": "+r+`. This may be due to one of the following reasons:
1. The `+n+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+n+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return f}var h=r;if(h.className==null||h.config==null)throw new lt(n+": Improper config format: "+JSON.stringify(h)+`.
'className' and 'config' must set.`);var d=h.className,m=void 0,g=void 0;if(d in t?(m=(i=t[d])[0],g=i[1]):d in Qr?(m=(s=Qr.className)[0],g=s[1]):d in e&&(m=(u=e[d])[0],g=u[1]),m==null)throw new lt("Unknown "+n+": "+d+`. This may be due to one of the following reasons:
1. The `+n+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+n+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(g!=null){for(var y={},x=0,w=Object.keys(Qr);x<w.length;x++)y[D=w[x]]=Qr[D];for(var b=0,C=Object.keys(t);b<C.length;b++)y[D=C[b]]=t[D];h.config.customObjects=y;for(var A=Sc({},Qr),T=0,R=Object.keys(t);T<R.length;T++){var D=R[T];Qr[D]=t[D]}jb(h.config);var N=g(m,h.config,t,a);return Qr=Sc({},A),N}A=Sc({},Qr);for(var O=0,k=Object.keys(t);O<k.length;O++)D=k[O],Qr[D]=t[D];return N=new m(h.config),Qr=Sc({},A),N}function VU(r,e){return r<e?-1:r>e?1:0}function mp(r,e){return-1*VU(r,e)}function vo(r){if(r==null)return r;for(var e=[],t=0,n=r;t<n.length;t++){var a=n[t];e.indexOf(a)===-1&&e.push(a)}return e}function qU(r){if(r==null)throw new lt("Invalid value in obj: "+JSON.stringify(r));for(var e in r)if(r.hasOwnProperty(e))return!1;return!0}function pl(r,e,t){if(t!=null&&r.indexOf(t)<0)throw new lt(t+" is not a valid "+e+".  Valid values are "+r+" or null/undefined.")}function Zx(r,e,t,n){return n===void 0&&(n=1/0),Ma(t>=0),Ma(n>=t),Array.isArray(r)&&r.length>=t&&r.length<=n&&r.every(function(a){return typeof a===e})}function hr(r,e){Array.isArray(r)?(At.assert(r.length>0,function(){return e+" is unexpectedly an empty array."}),r.forEach(function(t,n){return hr(t,"element "+(n+1)+" of "+e)})):At.assert(Number.isInteger(r)&&r>0,function(){return"Expected "+e+" to be a positive integer, but got "+iD(r)+"."})}function iD(r){return r===null?"null":Array.isArray(r)?"["+r.map(function(e){return iD(e)}).join(",")+"]":typeof r=="string"?'"'+r+'"':""+r}function WU(r,e){var t,n=At.now();return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var s=At.now();return s-n<e?t:(n=s,t=r.apply(void 0,a))}}function oD(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}function Jx(r,e){return ft(function(){return Fs(fr(mf(r,r),e,!0))})}var Lf=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.getConfig=function(){return{}},e})(It.Serializable),sD=(function(r){function e(t){var n=r.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=t.maxValue!=null?t.maxValue:n.defaultMaxValue,n.axis=t.axis!=null?t.axis:n.defaultAxis,n}return Nt(e,r),e.prototype.apply=function(t){var n=this;return ft(function(){var a=Jx(t,n.axis),i=er(a,0,n.maxValue);return Jt(t,Sn(i,se(On(),a)))})},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e})(Lf);It.registerClass(sD);var uD=(function(r){function e(t){var n=r.call(this)||this;return n.defaultAxis=0,n.axis=t.axis!=null?t.axis:n.defaultAxis,n}return Nt(e,r),e.prototype.apply=function(t){var n=this;return ft(function(){return Sn(t,se(On(),Jx(t,n.axis)))})},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e})(Lf);It.registerClass(uD);var lD=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return Mi(t)},e.className="NonNeg",e})(Lf);It.registerClass(lD);var cD=(function(r){function e(t){var n=r.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=t.minValue!=null?t.minValue:n.defaultMinValue,n.maxValue=t.maxValue!=null?t.maxValue:n.defaultMaxValue,n.rate=t.rate!=null?t.rate:n.defaultRate,n.axis=t.axis!=null?t.axis:n.defaultAxis,n}return Nt(e,r),e.prototype.apply=function(t){var n=this;return ft(function(){var a=Jx(t,n.axis),i=se(Jt(n.rate,er(a,n.minValue,n.maxValue)),Jt(1-n.rate,a));return Jt(t,Sn(i,se(On(),a)))})},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e})(Lf);It.registerClass(cD);var IA={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Le(r){return Qx(r)}function kA(r,e){return e===void 0&&(e={}),Bf(r,It.SerializationMap.getMap().classNameMap,e,"constraint")}function Dn(r){return r==null?null:typeof r=="string"?kA({className:r in IA?IA[r]:r,config:{}}):r instanceof Lf?r:kA(r)}function HU(r){return new sD(r)}function GU(r){return new uD(r)}function XU(){return new lD}function KU(r){return new cD(r)}var YU=Object.freeze({maxNorm:HU,unitNorm:GU,nonNeg:XU,minMaxNorm:KU}),$U=["channelsFirst","channelsLast"],QU=["valid","same","causal"],ZU=["max","avg"],JU=["sum","mul","concat","ave"],Du=new Map;function kn(r){pl($U,"DataFormat",r)}function na(r){pl(QU,"PaddingMode",r)}function fD(r){pl(ZU,"PoolMode",r)}var _c=[],MA="/";function ms(r,e){_c.push(r);try{var t=e();return _c.pop(),t}catch(n){throw _c.pop(),n}}function tj(){return _c.length===0?"":_c.join(MA)+MA}function hD(r){if(!dD(r))throw new Error("Not a valid tensor name: '"+r+"'");return tj()+r}function pD(r){if(!dD(r))throw new Error("Not a valid tensor name: '"+r+"'");Du.has(r)||Du.set(r,0);var e=Du.get(r);if(Du.set(r,Du.get(r)+1),e>0){var t=r+"_"+e;return Du.set(t,1),t}return r}var ej=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function dD(r){return!!r.match(ej)}function nj(r){return r===parseInt(r.toString(),10)}function go(r,e,t){e==null&&(e=0),t==null&&(t=r.length);for(var n=1,a=e;a<t;++a)n*=r[a];return n}function mD(r){return r=Array.isArray(r)?new Float32Array(r):r,zn(r)}function Yu(r){return Nf(mD(r)).dataSync()[0]}function wo(r){return Wa(mD(r)).dataSync()[0]}function ya(r,e){if(e<r)throw new lt("end ("+e+") < begin ("+r+") is forbidden.");for(var t=[],n=r;n<e;++n)t.push(n);return t}function Uf(r,e){return r.asType(e)}function jf(r,e){e===void 0&&(e=-1);var t=r.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),r.reshape(t)}function rj(r,e){return ft(function(){if(r.shape.length!==2)throw new lt("repeat() expects a rank-2 tensor, but received a rank-"+r.shape.length+" tensor.");return Pb(jf(r,1),[1,e,1])})}function aj(r){var e=[go(r.shape)];return r.reshape(e)}function ij(r){if(r.rank<=1)throw new lt("batchFlatten requires a minimum rank of 2. Got rank: "+r.rank+".");var e=[r.shape[0],go(r.shape,1)];return r.reshape(e)}function vs(r,e,t){return ft(function(){switch(r.rank){case 1:return ll(r,e,t);case 2:return Cf(r,[e,0],[t,r.shape[1]]);case 3:return cl(r,[e,0,0],[t,r.shape[1],r.shape[2]]);case 4:return Cs(r,[e,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3]]);case 5:return nr(r,[e,0,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return nr(r,[e,0,0,0,0,0],[t,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new lt("sliceAlongFirstAxis() received an unsupported tensor rank: "+r.rank)}})}function Qy(r,e,t){return ft(function(){switch(r.rank){case 1:return ll(r,e,t);case 2:return Cf(r,[0,e],[r.shape[0],t]);case 3:return cl(r,[0,0,e],[r.shape[0],r.shape[1],t]);case 4:return Cs(r,[0,0,0,e],[r.shape[0],r.shape[1],r.shape[2],t]);default:throw new lt("sliceAlongLastAxis() received an unsupported tensor rank: "+r.rank)}})}function vp(r,e,t,n){return ft(function(){switch(r.rank){case 1:return ll(r,e,t);case 2:switch(n){case 1:return vs(r,e,t);case 2:return Qy(r,e,t);default:throw new lt("The axis is not within the rank of the tensor "+n)}case 3:switch(n){case 1:return vs(r,e,t);case 2:return cl(r,[0,e,0],[r.shape[0],t,r.shape[2]]);case 3:return Qy(r,e,t);default:throw new lt("The axis is not within the rank of the tensor "+n)}case 4:switch(n){case 1:return vs(r,e,t);case 2:return Cs(r,[0,e,0,0],[r.shape[0],t,r.shape[2],r.shape[3]]);case 3:return Cs(r,[0,0,e,0],[r.shape[0],r.shape[1],t,r.shape[3]]);case 4:return Qy(r,e,t);default:throw new lt("The axis is not within the rank of the tensor "+n)}default:throw new lt("sliceAlongLastAxis() received an unsupported tensor rank: "+r.rank)}})}function vD(r,e){var t;return e===void 0&&(e=-1),e<0&&(e=(t=r[0].rank)!==0?t:0),e===r[0].rank&&(e=-1),Vn(r,e)}function zA(r,e){switch(r.rank){case 1:return zd([r,e]);case 2:return Fd([r,e],0);case 3:return Bd([r,e],0);case 4:return Ld([r,e],0);default:throw new lt("concatAlongFirstAxis() received an unsupported tensor rank: "+r.rank)}}function Pb(r,e){if(Array.isArray(e)||(e=[e]),r.rank!==e.length)throw new lt("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+r.rank+")");return bi(r,e)}function Ym(r,e,t,n,a){return e===void 0&&(e=0),t===void 0&&(t=1),qd(r,e,t,n,a)}function wi(r,e,t,n){if(r.rank<2||e.rank<2)throw new he("dot requires both inputs to be rank >= 2 but got x shape = "+r.shape+" and y shape = "+e.shape);if(e.rank>=3&&r.shape.slice(-1)[0]!==(h=e.shape.slice(-2)[0]))throw new he("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+r.shape+" and  y shape = "+e.shape);if(r.rank===2&&e.rank===2){var a=!1,i=!1;return Ns.matMul({a:r,b:e,transposeA:a,transposeB:i,bias:n?Vb(r.rank,n,ga()):null,activation:t})}var s=r.shape.slice(),u=s.pop();r=r.reshape([-1,u]);var c=e.shape.slice(),f=c.pop(),h=c.pop(),d=c.concat([f]),m=Array.from({length:e.rank},function(y,x){return x===0?e.rank-2:x<=e.rank-2?x-1:x});e=e.transpose(m).reshape([h,-1]);var g=s.concat(d);return a=!1,i=!1,Ns.matMul({a:r,b:e,transposeA:a,transposeB:i,bias:n?Vb(r.rank,n,ga()):null,activation:t}).reshape(g)}function gD(r,e,t){return ft(function(){return e=Array.isArray(e)?zn(e,"int32"):e.toInt(),fa(r,e,t)})}function Pf(r){return mf(r,r)}function Vb(r,e,t){var n=e.shape;if(e.rank!==1&&e.rank!==r)throw new lt("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+r);if(r===5){if(t==="channelsFirst")return n.length===1?e.reshape([1,n[0],1,1,1]):e.reshape([1,n[3],n[0],n[1],n[2]]);if(t==="channelsLast")return n.length===1?e.reshape([1,1,1,1,n[0]]):e.reshape([1].concat(n))}else if(r===4){if(t==="channelsFirst")return n.length===1?e.reshape([1,n[0],1,1]):e.reshape([1,n[2],n[0],n[1]]);if(t==="channelsLast")return n.length===1?e.reshape([1,1,1,n[0]]):e.reshape([1].concat(n))}else if(r===3){if(t==="channelsFirst")return n.length===1?e.reshape([1,n[0],1]):e.reshape([1,n[1],n[0]]);if(t==="channelsLast")return n.length===1?e.reshape([1,1,n[0]]):e.reshape([1].concat(n))}else if(r<3)return e;throw new lt("Unsupported input rank by biasAdd: "+e.rank)}function Fi(r,e,t){return ft(function(){return t==null&&(t=ga()),kn(t),r.add(Vb(r.rank,e,t))})}function oj(r,e){if(e===void 0&&(e=1),e!==1)throw new he("Support for alpha values other than 1 ("+e+") is not implemented yet.");return js(r)}function sj(r){return ft(function(){return Sn(r,Ti(r).add(1))})}function yD(r,e,t,n){return ft(function(){return Lm(r,e,t,n)})}function uj(r){return ft(function(){var e=se(.5,Jt(.2,r));return er(e,0,1)})}function $u(r,e,t){return t===void 0&&(t=!1),t?r():e()}var lj=["fanIn","fanOut","fanAvg"],cj=["normal","uniform","truncatedNormal"];function fj(r){pl(lj,"FanMode",r)}function hj(r){pl(cj,"Distribution",r)}var Aa=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e})(It.Serializable),bD=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t,n){return Ie(t,n)},e.className="Zeros",e})(Aa);It.registerClass(bD);var tw=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t,n){return Sa(t,n)},e.className="Ones",e})(Aa);It.registerClass(tw);var xD=(function(r){function e(t){var n=r.call(this)||this;if(typeof t!="object")throw new lt("Expected argument of type ConstantConfig but got "+t);if(t.value===void 0)throw new lt("config must have value set but got "+t);return n.value=t.value,n}return Nt(e,r),e.prototype.apply=function(t,n){var a=this;return ft(function(){return Jt(jt(a.value),Sa(t,n))})},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e})(Aa);It.registerClass(xD);var wD=(function(r){function e(t){var n=r.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=t.minval||n.DEFAULT_MINVAL,n.maxval=t.maxval||n.DEFAULT_MAXVAL,n.seed=t.seed,n}return Nt(e,r),e.prototype.apply=function(t,n){return To(t,this.minval,this.maxval,n)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e})(Aa);It.registerClass(wD);var SD=(function(r){function e(t){var n=r.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return Nt(e,r),e.prototype.apply=function(t,n){if((n=n||"float32")!=="float32"&&n!=="int32")throw new he("randomNormal does not support dType "+n+".");return Ym(t,this.mean,this.stddev,n,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e})(Aa);It.registerClass(SD);var ED=(function(r){function e(t){var n=r.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return Nt(e,r),e.prototype.apply=function(t,n){if((n=n||"float32")!=="float32"&&n!=="int32")throw new he("truncatedNormal does not support dType "+n+".");return il(t,this.mean,this.stddev,n,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e})(Aa);It.registerClass(ED);var CD=(function(r){function e(t){var n=r.call(this)||this;return n.gain=t.gain!=null?t.gain:1,n}return Nt(e,r),e.prototype.apply=function(t,n){var a=this;return ft(function(){if(t.length!==2||t[0]!==t[1])throw new lt("Identity matrix initializer can only be used for 2D square matrices.");return Jt(a.gain,rf(t[0]))})},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e})(Aa);function pj(r,e){var t,n;if(e===void 0&&(e="channelsLast"),kn(e),r.length===2)t=r[0],n=r[1];else if([3,4,5].indexOf(r.length)!==-1)if(e==="channelsFirst"){var a=go(r,2);t=r[1]*a,n=r[0]*a}else e==="channelsLast"&&(a=go(r,0,r.length-2),t=r[r.length-2]*a,n=r[r.length-1]*a);else{var i=go(r);t=Math.sqrt(i),n=Math.sqrt(i)}return[t,n]}It.registerClass(CD);var Cr=(function(r){function e(t){var n=r.call(this)||this;if(t.scale<0)throw new lt("scale must be a positive float. Got: "+t.scale);return n.scale=t.scale==null?1:t.scale,n.mode=t.mode==null?"fanIn":t.mode,fj(n.mode),n.distribution=t.distribution==null?"normal":t.distribution,hj(n.distribution),n.seed=t.seed,n}return Nt(e,r),e.prototype.apply=function(t,n){var a=pj(t),i=a[0],s=a[1],u=this.scale;if(this.mode==="fanIn"?u/=Math.max(1,i):this.mode==="fanOut"?u/=Math.max(1,s):u/=Math.max(1,(i+s)/2),this.distribution==="normal"){var c=Math.sqrt(u);if((n=n||"float32")!=="float32"&&n!=="int32")throw new he(this.getClassName()+" does not support dType "+n+".");return il(t,0,c,n,this.seed)}var f=Math.sqrt(3*u);return To(t,-f,f,n)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e})(Aa);It.registerClass(Cr);var ew=(function(r){function e(t){return r.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="GlorotUniform",e})(Cr);It.registerClass(ew);var nw=(function(r){function e(t){return r.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="GlorotNormal",e})(Cr);It.registerClass(nw);var rw=(function(r){function e(t){return r.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="HeNormal",e})(Cr);It.registerClass(rw);var aw=(function(r){function e(t){return r.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="HeUniform",e})(Cr);It.registerClass(aw);var iw=(function(r){function e(t){return r.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="LeCunNormal",e})(Cr);It.registerClass(iw);var ow=(function(r){function e(t){return r.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})||this}return Nt(e,r),e.prototype.getClassName=function(){return Cr.className},e.className="LeCunNormal",e})(Cr);It.registerClass(ow);var AD=(function(r){function e(t){var n=r.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=t.gain==null?n.DEFAULT_GAIN:t.gain,n.seed=t.seed,n.seed!=null)throw new he("Random seed is not implemented for Orthogonal Initializer yet.");return n}return Nt(e,r),e.prototype.apply=function(t,n){var a=this;return ft(function(){if(t.length!==2)throw new he("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var i=Ym(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),s=Pm.gramSchmidt(i);return t[0]>t[1]&&(s=s.transpose()),Jt(a.gain,s)})},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e})(Aa);It.registerClass(AD);var FA={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function BA(r,e){return e===void 0&&(e={}),Bf(r,It.SerializationMap.getMap().classNameMap,e,"initializer")}function Te(r){return Qx(r)}function Ze(r){if(typeof r=="string"){var e=r in FA?FA[r]:r;if(e==="GlorotNormal")return new nw;if(e==="GlorotUniform")return new ew;if(e==="HeNormal")return new rw;if(e==="HeUniform")return new aw;if(e==="LeCunNormal")return new iw;if(e==="LeCunUniform")return new ow;var t={};return t.className=e,t.config={},BA(t)}return r instanceof Aa?r:BA(r)}function dj(){return new bD}function mj(){return new tw}function vj(r){return new xD(r)}function gj(r){return new wD(r)}function yj(r){return new SD(r)}function bj(r){return new ED(r)}function xj(r){return new CD(r)}function wj(r){return new Cr(r)}function Sj(r){return new ew(r)}function Ej(r){return new nw(r)}function Cj(r){return new rw(r)}function Aj(r){return new aw(r)}function Nj(r){return new iw(r)}function Tj(r){return new ow(r)}function Rj(r){return new AD(r)}var _j=Object.freeze({zeros:dj,ones:mj,constant:vj,randomUniform:gj,randomNormal:yj,truncatedNormal:bj,identity:xj,varianceScaling:wj,glorotUniform:Sj,glorotNormal:Ej,heNormal:Cj,heUniform:Aj,leCunNormal:Nj,leCunUniform:Tj,orthogonal:Rj}),Oj=0;function ND(){return Oj++}var gp={};function $m(r){return r===void 0&&(r=""),r in gp||(gp[r]=0),gp[r]+=1,r+gp[r].toString()}function qb(r){return Array.isArray(r)&&Array.isArray(r[0])}function md(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function le(r){var e;if(Array.isArray(r)){if(r.length!==1)throw new lt("Expected Tensor length to be 1; got "+r.length);e=r[0]}else e=r;return e}function We(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return(r=r)[0];throw new lt("Expected exactly 1 Shape; got "+r.length)}return r}function vd(r){for(var e=0,t=0,n=r;t<n.length;t++){var a=n[t];a.shape.length===0?e+=1:e+=a.shape.reduce(function(i,s){return i*s})}return e}var LA="Variable",TD=(function(){function r(e,t,n,a,i){t===void 0&&(t="float32"),n===void 0&&(n=LA),a===void 0&&(a=!0),i===void 0&&(i=null),this.dtype=t??"float32",this.shape=e.shape,this.id=ND(),n=n??LA,this.originalName=hD(n),this.name=pD(this.originalName),this.trainable_=a,this.constraint=i,this.val=kd(e,this.trainable_,this.name,this.dtype)}return r.prototype.read=function(){return this.assertNotDisposed(),this.val},r.prototype.write=function(e){return this.assertNotDisposed(),Dj(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},r.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},r.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(r.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e},enumerable:!0,configurable:!0}),r})();function Dj(r,e){if(r.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(e.shape))}function Wb(r){return r.map(function(e){return e.read()})}function sw(r){r.forEach(function(e){e[0].write(e[1])})}var jn=(function(){return function(r){this.dtype=r.dtype,this.shape=r.shape,r.shape!=null?this.ndim=r.shape.length:this.ndim=r.ndim,this.maxNDim=r.maxNDim,this.minNDim=r.minNDim,this.axes=r.axes||{}}})(),ha=(function(){return function(r,e,t,n,a,i,s){this.dtype=r,this.shape=e,this.sourceLayer=t,this.inputs=n,this.callArgs=a,this.outputTensorIndex=s,this.id=ND(),i!=null&&(this.originalName=hD(i),this.name=pD(this.originalName)),this.rank=e.length}})(),Ij=0,Qm=(function(){function r(e,t){this.callArgs=t,this.id=Ij++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var n=0,a=e.inboundLayers;n<a.length;n++){var i=a[n];i?.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return r.prototype.getConfig=function(){for(var e=[],t=0,n=this.inboundLayers;t<n.length;t++){var a=n[t];a!=null?e.push(a.name):e.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},r})(),kj=0,we=(function(r){function e(t){var n=r.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=kj++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var a=t.name;if(!a){var i=n.getClassName();a=mi(i)+"_"+$m(i)}if(n.name=a,n.trainable_=t.trainable==null||t.trainable,t.inputShape!=null||t.batchInputShape!=null){var s=void 0;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){var u=null;t.batchSize!=null&&(u=t.batchSize),s=[u].concat(t.inputShape)}n.batchInputShape=s;var c=t.dtype;c==null&&(c=t.inputDType),c==null&&(c="float32"),n.dtype=c}return t.weights!=null?n.initialWeights=t.weights:n.initialWeights=null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return Nt(e,r),e.nodeKey=function(t,n){return t.name+"_ib-"+n.toString()},e.prototype.getNodeAtIndex=function(t,n){if(this.inboundNodes.length===0)throw new Ba("The layer has never been called and thus has no defined "+n+".");if(this.inboundNodes.length<=t)throw new lt("Asked to get "+n+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return or(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return or(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new is("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new is("Layer "+this.name+" is not connected, no input to return.");return or(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new is("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new is("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return or(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map(function(t){return t()})},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach(function(n){return n.trainable=t}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(t){return t.trainable}):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(t){return!t.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=Ge(t),this.inputSpec!=null&&this.inputSpec.length!==0){var n=Ge(this.inputSpec);if(t.length!==n.length)throw new lt("Layer "+this.name+" expects "+n.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var a=0;a<t.length;a++){var i=t[a],s=n[a];if(s!=null){var u=i.rank;if(s.ndim!=null&&u!==s.ndim)throw new lt("Input "+a+" is incompatible with layer "+this.name+": expected ndim="+s.ndim+", found ndim="+u);if(s.maxNDim!=null&&u>s.maxNDim)throw new lt("Input "+a+" is incompatible with layer "+this.name+": expected max_ndim="+s.maxNDim+", found ndim="+u);if(s.minNDim!=null&&u<s.minNDim)throw new lt("Input "+a+" is incompatible with layer "+this.name+": expected min_ndim="+s.minNDim+", found ndim="+u+".");if(s.dtype!=null&&i.dtype!==s.dtype)throw new lt("Input "+a+" is incompatible with layer "+this.name+" : expected dtype="+s.dtype+", found dtype="+i.dtype+".");if(s.axes){var c=i.shape;for(var f in s.axes){var h=Number(f),d=s.axes[f],m=h>=0?c[h]:c[c.length+h];if(d!=null&&[d,null].indexOf(m)===-1)throw new lt("Input "+a+" is incompatible with layer "+this.name+": expected axis "+h+" of input shape to have value "+d+" but got shape "+c+".")}}if(s.shape!=null)for(var g=0;g<s.shape.length;++g){var y=s.shape[g],x=i.shape[g];if(y!=null&&x!=null&&y!==x)throw new lt("Input "+a+" is incompatible with layer "+this.name+": expected shape="+s.shape+", found shape="+i.shape+".")}}}}},e.prototype.call=function(t,n){return t},e.prototype.invokeCallHook=function(t,n){this._callHook!=null&&this._callHook(t,n)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,n){var a=this;n=n||{},this.assertNotDisposed();for(var i=Ge(t),s=!0,u=0,c=i;u<c.length;u++)if(!(c[u]instanceof ha)){s=!1;break}for(var f=!0,h=0,d=i;h<d.length;h++)if(d[h]instanceof ha){f=!1;break}if(s===f)throw new lt("Arguments to apply() must be all SymbolicTensors or all Tensors");return ms(this.name,function(){if(!a.built){a.assertInputCompatibility(t);for(var m=[],g=0,y=Ge(t);g<y.length;g++){var x=y[g];m.push(x.shape)}a.build(or(m)),a.built=!0,a.initialWeights&&a.setWeights(a.initialWeights),a._refCount===null&&f&&(a._refCount=1)}if(a.assertInputCompatibility(t),f){for(var w=[],b=0,C=Ge(D=a.call(t,n));b<C.length;b++){var A=C[b];i.indexOf(A)!==-1&&(A=A.clone()),w.push(A)}if(D=or(w),a.activityRegularizer!=null)throw new he("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return D}var T=Mj(t),R=a.computeOutputShape(T),D=void 0,N=zj(t);if(a.warnOnIncompatibleInputShape(Array.isArray(t)?T[0]:T),D=R!=null&&R.length>0&&Array.isArray(R[0])?R.map(function(O,k){return new ha(N,O,a,Ge(t),n,a.name,k)}):new ha(N,R,a,Ge(t),n,a.name),a.addInboundNode(t,D,null,null,T,R,n),a._refCount++,a.activityRegularizer!=null)throw new he("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return D})},e.prototype.warnOnIncompatibleInputShape=function(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var n=!1;this.batchInputShape.forEach(function(a,i){a!=null&&t[i]!=null&&t[i]!==a&&(n=!0)}),n&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new is("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],n=0,a=this.inboundNodes;n<a.length;n++){var i=a[n],s=JSON.stringify(i.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){var u=this.inboundNodes[0].outputShapes;return Array.isArray(u)&&Array.isArray(u[0])&&u.length===1?u[0]:u}throw new is("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new Ba("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return vd(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return t===void 0&&(t=!1),Wb(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var n=this;ft(function(){var a=n.weights;if(a.length!==t.length)throw new lt('You called setWeights(weights) on layer "'+n.name+'" with a weight list of length '+t.length+", but the layer was expecting "+a.length+" weights. Provided weights: "+t+"...");if(a.length!==0){for(var i=[],s=Wb(a),u=0;u<s.length;++u){var c=s[u],f=a[u],h=t[u];if(!At.arraysEqual(c.shape,h.shape))throw new lt("Layer weight shape "+c.shape+" not compatible with provided weight shape "+h.shape);i.push([f,h])}sw(i)}})},e.prototype.addWeight=function(t,n,a,i,s,u,c){if(this._addedWeightNames.indexOf(t)!==-1)throw new lt("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),a==null&&(a="float32"),this.fastWeightInitDuringBuild&&(i=Ze("zeros"));var f=i.apply(n,a),h=new TD(f,a,t,u,c);return f.dispose(),s!=null&&this.addLoss(function(){return s.apply(h.read())}),u==null&&(u=!0),u?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var n;t==null||Array.isArray(t)&&t.length===0||(t=Ge(t),this._losses!==void 0&&this._losses!==null&&(n=this.losses).push.apply(n,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,n){var a=this;if(!this.supportsMasking){if(n!=null){if(!Array.isArray(n))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");n.forEach(function(i){if(i!=null)throw new TypeError("Layer "+a.name+" does not support masking, but was passed an inputMask.")})}return null}return n},e.prototype.addInboundNode=function(t,n,a,i,s,u,c){c===void 0&&(c=null);var f=Ge(t);n=Ge(n),a=Ge(a),i=Ge(i),s=md(s),u=md(u);for(var h=[],d=[],m=[],g=0,y=f;g<y.length;g++){var x=y[g];h.push(x.sourceLayer),d.push(x.nodeIndex),m.push(x.tensorIndex)}new Qm({outboundLayer:this,inboundLayers:h,nodeIndices:d,tensorIndices:m,inputTensors:f,outputTensors:n,inputMasks:a,outputMasks:i,inputShapes:s,outputShapes:u},c);for(var w=0;w<n.length;w++)n[w].sourceLayer=this,n[w].nodeIndex=this.inboundNodes.length-1,n[w].tensorIndex=w},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach(function(t){return t.dispose()}),this.weights.length},e.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return--this._refCount==0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e})(It.Serializable);function Mj(r){for(var e=[],t=0,n=r=Ge(r);t<n.length;t++){var a=n[t];e.push(a.shape)}return or(e)}function zj(r){return"float32"}function RD(r,e,t){if((e==null||t!=null&&t>0)&&(e=r.sourceLayer,t=r.nodeIndex),e.inboundNodes.length===0)return[r];var n=e.inboundNodes[t];if(n.inboundLayers.length===0)return n.inputTensors;for(var a=[],i=0;i<n.inboundLayers.length;i++)for(var s=0,u=RD(n.inputTensors[i],n.inboundLayers[i],n.nodeIndices[i]);s<u.length;s++){var c=u[s];a.indexOf(c)===-1&&a.push(c)}return a}var UA,Vf=(function(r){function e(t){var n=r.call(this,{dtype:t.dtype,name:t.name!=null?t.name:$m("input").toString()})||this;if(t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new lt("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=t.batchInputShape;if(a==null){if(t.inputShape==null)throw new lt("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new lt("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=t.dtype||"float32";n.batchInputShape=a,n.dtype=i,n.inputSpec=[{shape:a}];var s=new ha(n.dtype,n.batchInputShape,n,[],{},n.name);return s.nodeIndex=0,s.tensorIndex=0,new Qm({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),n}return Nt(e,r),e.prototype.apply=function(t,n){throw new lt("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e})(we);function _D(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new lt("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=r.batchShape;r.shape!=null&&e==null&&(e=[null].concat(r.shape));var t=r.dtype;return t==null&&(t="float32"),new Vf({batchInputShape:e,name:r.name,dtype:t,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}function uo(r){return ne(this,void 0,void 0,function(){var e,t,n,a,i,s,u,c;return Zt(this,function(f){switch(f.label){case 0:if(r==null)return[2];for(a in e=[],t=[],n=[],r)typeof(i=r[a])!="number"&&(s=i,e.push(s.data()),t.push(a),n.push(s));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(u=f.sent(),c=0;c<u.length;++c)r[t[c]]=u[c][0];re(n),f.label=2;case 2:return[2]}})})}function OD(r){if(r!=null)for(var e in r){var t=r[e];typeof t!="number"&&t.dispose()}}It.registerClass(Vf),(function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"})(UA||(UA={}));var Fj=125,Qu=(function(){function r(){this.validationData=null}return r.prototype.setParams=function(e){this.params=e},r.prototype.onEpochBegin=function(e,t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return[2]})})},r.prototype.onEpochEnd=function(e,t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return[2]})})},r.prototype.onBatchBegin=function(e,t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return[2]})})},r.prototype.onBatchEnd=function(e,t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return[2]})})},r.prototype.onTrainBegin=function(e){return ne(this,void 0,void 0,function(){return Zt(this,function(t){return[2]})})},r.prototype.onTrainEnd=function(e){return ne(this,void 0,void 0,function(){return Zt(this,function(t){return[2]})})},r.prototype.setModel=function(e){},r})(),DD=(function(){function r(e,t){t===void 0&&(t=10),e==null&&(e=[]),this.callbacks=e,this.queueLength=t}return r.prototype.append=function(e){this.callbacks.push(e)},r.prototype.setParams=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setParams(e)},r.prototype.setModel=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setModel(e)},r.prototype.onEpochBegin=function(e,t){return ne(this,void 0,void 0,function(){var n,a;return Zt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onEpochBegin(e,t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onEpochEnd=function(e,t){return ne(this,void 0,void 0,function(){var n,a;return Zt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onEpochEnd(e,t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onBatchBegin=function(e,t){return ne(this,void 0,void 0,function(){var n,a;return Zt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onBatchBegin(e,t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onBatchEnd=function(e,t){return ne(this,void 0,void 0,function(){var n,a;return Zt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onBatchEnd(e,t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onTrainBegin=function(e){return ne(this,void 0,void 0,function(){var t,n;return Zt(this,function(a){switch(a.label){case 0:e==null&&(e={}),t=0,n=this.callbacks,a.label=1;case 1:return t<n.length?[4,n[t].onTrainBegin(e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},r.prototype.onTrainEnd=function(e){return ne(this,void 0,void 0,function(){var t,n;return Zt(this,function(a){switch(a.label){case 0:e==null&&(e={}),t=0,n=this.callbacks,a.label=1;case 1:return t<n.length?[4,n[t].onTrainEnd(e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},r})(),Bj=(function(r){function e(){return r.call(this)||this}return Nt(e,r),e.prototype.onEpochBegin=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return this.seen=0,this.totals={},[2]})})},e.prototype.onBatchEnd=function(t,n){return ne(this,void 0,void 0,function(){var a,i,s,u,c=this;return Zt(this,function(f){for(u in n==null&&(n={}),a=n.size==null?0:n.size,this.seen+=a,i=function(h){var d=n[h];if(typeof d=="number")s.totals.hasOwnProperty(h)||(s.totals[h]=0),s.totals[h]=s.totals[h]+d*a;else{var m=void 0;h in s.totals?m=s.totals[h]:s.totals[h]=0;var g=ft(function(){return se(c.totals[h],Jt(d,a))});s.totals[h]=g,m?.dispose()}},s=this,n)i(u);return[2]})})},e.prototype.onEpochEnd=function(t,n){return ne(this,void 0,void 0,function(){var a,i,s,u,c,f=this;return Zt(this,function(h){if(n!=null)for(a=function(d){if(i.totals[d]==null)return"continue";typeof i.totals[d]=="number"?n[d]=i.totals[d]/i.seen:ft(function(){var m=Jt(Sn(1,f.seen),f.totals[d]);n[d]=m,f.totals[d].dispose(),ma(n[d])})},i=this,s=0,u=this.params.metrics;s<u.length;s++)c=u[s],a(c);return[2]})})},e})(Qu),ID=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.onTrainBegin=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return this.epoch=[],this.history={},[2]})})},e.prototype.onEpochEnd=function(t,n){return ne(this,void 0,void 0,function(){var a;return Zt(this,function(i){for(a in n==null&&(n={}),this.epoch.push(t),n)this.history[a]==null&&(this.history[a]=[]),this.history[a].push(n[a]);return[2]})})},e.prototype.syncData=function(){return ne(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f,h;return Zt(this,function(d){switch(d.label){case 0:for(i in t=[],n=[],a=[],this.history)for(s=this.history[i],u=0;u<s.length;++u)typeof s[u]!="number"&&(c=s[u],t.push(c.data()),n.push(i),a.push(u));return[4,Promise.all(t)];case 1:for(f=d.sent(),h=0;h<f.length;++h)this.history[n[h]][a[h]].dispose(),this.history[n[h]][a[h]]=f[h][0];return[2]}})})},e})(Qu),kD=(function(r){function e(t,n){var a=r.call(this)||this;if(a.currentEpoch=0,a.yieldEvery=n||"auto",a.yieldEvery==="auto"&&(a.yieldEvery=Fj),a.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return At.isNumber(a.yieldEvery)&&(a.maybeWait=WU(a.maybeWait.bind(a),a.yieldEvery)),a.trainBegin=t.onTrainBegin,a.trainEnd=t.onTrainEnd,a.epochBegin=t.onEpochBegin,a.epochEnd=t.onEpochEnd,a.batchBegin=t.onBatchBegin,a.batchEnd=t.onBatchEnd,a.yield=t.onYield,a}return Nt(e,r),e.prototype.maybeWait=function(t,n,a){return ne(this,void 0,void 0,function(){var i;return Zt(this,function(s){switch(s.label){case 0:return i=[],this.yield==null?[3,2]:[4,uo(a)];case 1:s.sent(),i.push(this.yield(t,n,a)),s.label=2;case 2:return i.push(Rc()),[4,Promise.all(i)];case 3:return s.sent(),[2]}})})},e.prototype.onEpochBegin=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){switch(a.label){case 0:return this.currentEpoch=t,this.epochBegin==null?[3,3]:[4,uo(n)];case 1:return a.sent(),[4,this.epochBegin(t,n)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return ne(this,void 0,void 0,function(){var a;return Zt(this,function(i){switch(i.label){case 0:return a=[],this.epochEnd==null?[3,2]:[4,uo(n)];case 1:i.sent(),a.push(this.epochEnd(t,n)),i.label=2;case 2:return this.yieldEvery==="epoch"&&a.push(Rc()),[4,Promise.all(a)];case 3:return i.sent(),[2]}})})},e.prototype.onBatchBegin=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){switch(a.label){case 0:return this.batchBegin==null?[3,3]:[4,uo(n)];case 1:return a.sent(),[4,this.batchBegin(t,n)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return ne(this,void 0,void 0,function(){var a;return Zt(this,function(i){switch(i.label){case 0:return a=[],this.batchEnd==null?[3,2]:[4,uo(n)];case 1:i.sent(),a.push(this.batchEnd(t,n)),i.label=2;case 2:return this.yieldEvery==="batch"?a.push(Rc()):At.isNumber(this.yieldEvery)&&a.push(this.maybeWait(this.currentEpoch,t,n)),[4,Promise.all(a)];case 3:return i.sent(),[2]}})})},e.prototype.onTrainBegin=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){switch(n.label){case 0:return this.trainBegin==null?[3,3]:[4,uo(t)];case 1:return n.sent(),[4,this.trainBegin(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.onTrainEnd=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){switch(n.label){case 0:return this.trainEnd==null?[3,3]:[4,uo(t)];case 1:return n.sent(),[4,this.trainEnd(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e})(Qu);function MD(r,e){return r==null&&(r={}),r instanceof Qu?[r]:Array.isArray(r)&&r[0]instanceof Qu?r:Ge(r).map(function(t){return new kD(t,e)})}var zD=(function(){function r(){}return r.registerCallbackConstructor=function(e,t){At.assert(e>=0&&Number.isInteger(e),function(){return"Verbosity level is expected to be an integer >= 0, but got "+e}),r.checkForDuplicate(t),r.constructors[e]==null&&(r.constructors[e]=[]),r.constructors[e].push(t)},r.checkForDuplicate=function(e){for(var t in r.constructors)r.constructors[+t].forEach(function(n){if(n===e)throw new lt("Duplicate callback constructor.")})},r.clear=function(){r.constructors={}},r.createCallbacks=function(e){var t=[];for(var n in r.constructors){var a=+n;e>=a&&t.push.apply(t,r.constructors[a])}return t.map(function(i){return new i})},r.constructors={},r})();function FD(r,e,t,n,a,i,s,u,c){var f=new ID,h=[new Bj].concat(zD.createCallbacks(e));r!=null&&h.push.apply(h,r),h.push(f);var d=new DD(h);return d.setParams({epochs:t,initialEpoch:n,samples:a,steps:i,batchSize:s,verbose:e,doValidation:u,metrics:c}),{callbackList:d,history:f}}function da(r,e,t){return e===void 0&&(e={}),t===void 0&&(t=!1),Bf(r,It.SerializationMap.getMap().classNameMap,e,"layer",t)}function gd(r,e){return ft(function(){r.dtype!=="float32"&&(r=r.asType("float32"));var t=fr(Pf(r),e,!0),n=Is(t.shape,On()),a=Fs(Ca(t,n));return Sn(r,a)})}function Ps(r,e){return ft(function(){return un(Pf(gn(e,r)),-1)})}function Zm(r,e){return ft(function(){return un(Ti(gn(e,r)),-1)})}function dl(r,e){return ft(function(){var t=gn(r,e),n=er(Ti(r),On(),Number.MAX_VALUE),a=Ti(Sn(t,n));return Jt(100,un(a,-1))})}function Lj(r,e){return ft(function(){var t=er(e,On(),Number.MAX_VALUE),n=Va(se(1,t)),a=er(r,On(),Number.MAX_VALUE),i=Va(se(1,a));return un(Pf(gn(n,i)),-1)})}function Uj(r,e){return ft(function(){var t=Ca(0,gn(1,Jt(r,e)));return un(Pf(t),-1)})}function jj(r,e){return ft(function(){var t=Ca(0,gn(1,Jt(r,e)));return un(t,-1)})}function Pj(r,e){return ft(function(){var t=fr(Jt(r,e),-1),n=Wa(Jt(gn(1,r),e),-1);return Ca(0,se(1,gn(n,t)))})}function Vj(r,e){return ft(function(){var t=Math.log(2),n=gn(e,r),a=gn(se(n,sl(Jt(-2,n))),t);return un(a,-1)})}function Vc(r,e,t){return t===void 0&&(t=!1),ft(function(){if(t)e=Ro(e);else{var n=fr(e,e.shape.length-1,!0);e=Sn(e,n)}return e=er(e,On(),1-On()),Oo(fr(Jt(r.toFloat(),Va(e)),e.shape.length-1))})}function yd(r,e){return ft(function(){var t=uf(aj(r)).toInt(),n=(e=er(e,On(),1-On())).shape;return Vc(Ua(t,n[n.length-1]).reshape(n),e,!1)})}function qj(r,e){if(!At.arraysEqual(r.shape,e.shape))throw new lt("logits and labels must have the same shape, but got shapes "+JSON.stringify(r.shape)+" and "+JSON.stringify(e.shape));return ft(function(){var t=e.relu(),n=e.abs().neg();return t.sub(e.mul(r)).add(n.exp().log1p())})}function Jm(r,e){return ft(function(){var t;return t=er(e,On(),1-On()),t=Va(Sn(t,gn(1,t))),un(qj(r,t),-1)})}function Wj(r,e){return ft(function(){var t=er(r,On(),1),n=er(e,On(),1);return fr(Jt(r,Va(Sn(t,n))),-1)})}function Hj(r,e){return ft(function(){var t=Va(se(On(),e));return un(gn(e,Jt(r,t)),-1)})}function uw(r,e){return ft(function(){var t=gd(r,-1),n=gd(e,-1),a=Jt(t,n);return Oo(fr(a,-1))})}var bd={meanSquaredError:Ps,meanAbsoluteError:Zm,meanAbsolutePercentageError:dl,meanSquaredLogarithmicError:Lj,squaredHinge:Uj,hinge:jj,categoricalHinge:Pj,logcosh:Vj,categoricalCrossentropy:Vc,sparseCategoricalCrossentropy:yd,binaryCrossentropy:Jm,kullbackLeiblerDivergence:Wj,poisson:Hj,cosineProximity:uw};function Zy(r){if(typeof r=="string"){if(r in bd)return bd[r];var e="Unknown loss "+r;throw r.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+r+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new lt(e)}return r}function lw(r,e){return ft(function(){var t=Jt(.5,Er(e)),n=Uf(Ls(e,t),r.dtype);return un(Do(r,n),-1)})}function cw(r,e){return ft(function(){return Uf(Do(Ri(r,-1),Ri(e,-1)),"float32")})}function BD(r,e){return ft(function(){return Ga(r.equal(1),e.equal(1)).sum().cast("float32")})}function Gj(r,e){return ft(function(){return Ga(r.equal(1),e.equal(0)).sum().cast("float32")})}function Xj(r,e){return ft(function(){return Ga(r.equal(0),e.equal(1)).sum().cast("float32")})}function LD(r,e){return ft(function(){var t=BD(r,e),n=Xj(r,e),a=t.add(n);return qa(Ls(a,0),t.div(a),0).cast("float32")})}function Kj(r,e){return ft(function(){var t=BD(r,e),n=Gj(r,e),a=t.add(n);return qa(Ls(a,0),t.div(a),0).cast("float32")})}function UD(r,e){return Jm(r,e)}function jD(r,e){return r.rank===e.rank&&(r=r.squeeze([r.rank-1])),(e=e.argMax(-1)).dtype!==r.dtype&&(e=e.asType(r.dtype)),Do(r,e).asType("float32")}var Yj=Ps,$j=Ps,Qj=Zm,Zj=Zm,Jj=dl,tP=dl,fw=Vc,eP=uw,PD=yd,xd={binaryAccuracy:lw,categoricalAccuracy:cw,precision:LD,categoricalCrossentropy:fw,sparseCategoricalCrossentropy:PD,mse:Yj,MSE:$j,mae:Qj,MAE:Zj,mape:Jj,MAPE:tP,cosine:eP};function nP(r){if(typeof r=="string"&&r in xd)return xd[r];if(typeof r!="string"&&r!=null)return r;throw new lt("Unknown metric "+r)}function yp(r){if(Ma(r!==null,"Unknown LossOrMetricFn "+r),typeof r=="string")return r;for(var e=void 0,t=0,n=Object.keys(bd);t<n.length;t++){var a=n[t];if(bd[a]===r){e=a;break}}if(e!==void 0)return e;for(var i=0,s=Object.keys(xd);i<s.length;i++)if(a=s[i],xd[a]===r){e=a;break}return e!==void 0?e:r.name}function rP(r){var e={Adagrad:function(){return lo.adagrad(.01)},Adadelta:function(){return lo.adadelta(1,.95,On())},Adam:function(){return lo.adam(.001,.9,.999,On())},Adamax:function(){return lo.adamax(.002,.9,.999,On(),0)},RMSProp:function(){return lo.rmsprop(.001,.9,0,On())},SGD:function(){return lo.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,r in e)return e[r]();throw new lt("Unknown Optimizer "+r)}var jA=1048576;function PA(r,e,t){if(t===void 0&&(t=!1),r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!Hb(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){var n=JSON.stringify(r);n.length>jA&&console.warn('User-defined metadata of model "'+e+'" is too large in size (length='+n.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+jA+".")}}function Hb(r){if(r===null)return!0;if(typeof r=="object"){if(Object.getPrototypeOf(r)===Object.prototype){for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e];if(typeof n!="string"||!Hb(r[n]))return!1}return!0}if(Array.isArray(r)){for(var a=0,i=r;a<i.length;a++)if(!Hb(i[a]))return!1;return!0}return!1}var s=typeof r;return s==="string"||s==="number"||s==="boolean"}function aP(r,e,t,n){n===void 0&&(n=console.log);var a,i=oP(r),s=["Layer (type)","Output shape","Param #"];if(i?(e=e||65,t=t||[.45,.85,1]):(e=e||98,t=t||[.33,.55,.67,1]),t[t.length-1]<=1&&(t=t.map(function(m){return Math.floor(e*m)})),!i)for(var u in s.push("Receives inputs"),a=[],r.nodesByDepth)a.push.apply(a,r.nodesByDepth[u]);n("_".repeat(e)),wd(s,t,n),n("=".repeat(e));for(var c=r.layers,f=0;f<c.length;++f)i?sP(c[f],t,n):uP(c[f],t,a,n),n((f===c.length-1?"=":"_").repeat(e));r.checkTrainableWeightsConsistency();var h=iP(r),d=vd(r.nonTrainableWeights);n("Total params: "+(h+d)),n("Trainable params: "+h),n("Non-trainable params: "+d),n("_".repeat(e))}function iP(r){return r.collectedTrainableWeights!=null?vd(r.collectedTrainableWeights):vd(r.trainableWeights)}function oP(r){var e=!0,t=[],n=[];for(var a in r.nodesByDepth)t.push(r.nodesByDepth[a]);for(var i=0,s=t;i<s.length;i++){var u=s[i];if(u.length>1||u.length===1&&u[0].inboundLayers.length>1){e=!1;break}n.push.apply(n,u)}if(e)for(var c=0,f=r.layers;c<f.length;c++){for(var h=!1,d=0,m=f[c].inboundNodes;d<m.length;d++){var g=m[d];if(n.indexOf(g)!==-1){if(h){e=!1;break}h=!0}}if(!e)break}return e}function wd(r,e,t){t===void 0&&(t=console.log);for(var n="",a=0;a<r.length;++a)a>0&&(n=n.slice(0,n.length-1)+" "),n=(n+=r[a]).slice(0,e[a]),n+=" ".repeat(e[a]-n.length);t(n)}function sP(r,e,t){var n;try{n=JSON.stringify(r.outputShape)}catch{n="multiple"}wd([r.name+" ("+r.getClassName()+")",n,r.countParams().toString()],e,t)}function uP(r,e,t,n){var a;try{a=JSON.stringify(r.outputShape)}catch{a="multiple"}for(var i=[],s=0,u=r.inboundNodes;s<u.length;s++){var c=u[s];if(!(t!=null&&t.length>0&&t.indexOf(c)===-1))for(var f=0;f<c.inboundLayers.length;++f){var h=c.inboundLayers[f].name,d=c.nodeIndices[f],m=c.tensorIndices[f];i.push(h+"["+d+"]["+m+"]")}}var g=r.name,y=r.getClassName(),x=i.length===0?"":i[0];for(wd([g+" ("+y+")",a,r.countParams().toString(),x],e,n),f=1;f<i.length;++f)wd(["","","",i[f]],e,n)}function VD(r,e,t){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&e===0&&typeof t=="string"}function qc(r,e){if(r===null)return null;if(typeof r=="string")return ss(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){for(var t=[],n=r.length,a=0;a<n;++a){var i=r[a];VD(e,a,i)?t.push(i):t.push(qc(i,e))}return t}for(var s={},u=0,c=Object.keys(r);u<c.length;u++){var f=c[u],h=r[f];if(f==="name"&&typeof h=="string")s[f]=h;else{var d=ss(f);s[d]=qc(h,d)}}return s}function Gb(r,e){if(r==null)return null;if(typeof r=="string")return mi(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){for(var t=[],n=r.length,a=0;a<n;++a){var i=r[a];VD(e,a,i)?t.push(i):t.push(Gb(i,e))}return t}for(var s={},u=0,c=Object.keys(r);u<c.length;u++){var f=c[u],h=r[f],d=mi(f);s[d]=f!=="name"&&f!=="className"||typeof h!="string"?Gb(h,f):h}return s}var tv="1.3.1";function lP(r,e){if(r.dtype==null||r.dtype===e.dtype)return e;try{return No(e,r.dtype)}catch{throw new lt("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+r.name+"' ("+r.dtype+").")}}var Bu=(function(){function r(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof r)for(var t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(var n=0,a=e;n<a.length;n++){var i=a[n];this.add(i.key,i.value)}}}return r.prototype.add=function(e,t,n){if(this.id2Value[e.id]!=null)throw new lt("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=lP(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n),this},r.prototype.addFeed=function(e){this.add(e.key,e.value)},r.prototype.hasKey=function(e){return this.id2Value[e.id]!=null},r.prototype.names=function(){return Object.keys(this.name2Id)},r.prototype.getValue=function(e){if(e instanceof ha){if(this.id2Value[e.id]==null)throw new lt("Nonexistent key: "+e.name);return this.id2Value[e.id]}var t=this.name2Id[e];if(t==null)throw new lt("Feed dict has no SymbolicTensor name: "+e);return this.id2Value[t]},r.prototype.getMask=function(e){if(e instanceof ha){if(this.id2Value[e.id]==null)throw new lt("Nonexistent key: "+e.name);return this.id2Mask[e.id]}var t=this.name2Id[e];if(t==null)throw new lt("Feed dict has no SymbolicTensor name: "+e);return this.id2Mask[t]},r.prototype.disposeMasks=function(){this.id2Mask!=null&&re(this.id2Mask)},r})(),Jy={},VA={};function Ec(r,e,t,n){for(var a=t!=null&&t.training,i=Array.isArray(r),s=i?r:[r],u=s.map(function(tt){return tt.name}),c=[],f=e.names(),h=0,d=u;h<d.length;h++){var m=d[h];f.indexOf(m)!==-1?c.push(e.getValue(m)):c.push(null)}var g,y,x=u.join(",")+"|"+e.names().join(",");if(Jy[x]==null){var w=cP(s,e);g=w.sorted,y=w.recipientCounts,Jy[x]=g,VA[x]=y}g=Jy[x],y={},a||Object.assign(y,VA[x]);for(var b=new Bu(e),C=0;C<g.length;++C){var A=g[C],T=A.sourceLayer;if(!(T instanceof Vf)){for(var R=[],D=[],N=[],O=!1,k=0,z=A.inputs;k<z.length;k++){var F=z[k],B=b.getValue(F),V=b.getMask(F);R.push(B),D.push(V),V!=null&&(O=!0),a||(y[F.name]--,y[F.name]!==0||e.hasKey(F)||u.indexOf(F.name)!==-1||B.isDisposed||F.sourceLayer.stateful===!0||N.push(B))}O&&((t=t||{}).mask=D[0]);var G=Ge(T.apply(R,t)),Q=null;T.supportsMasking&&(Q=T.computeMask(R,D));for(var L=hP(A),X=Array.isArray(L)?L:[L],$=0;$<X.length;++$){b.hasKey(X[$])||b.add(X[$],G[$],Array.isArray(Q)?Q[0]:Q);var it=u.indexOf(X[$].name);it!==-1&&(c[it]=G[$])}a||re(N)}}return b.disposeMasks(),i?c:c[0]}function cP(r,e){At.assert(r!=null&&r.length>0,function(){return"Expected at least one fetch, got none"});var t=[],n={};if(r.length===1){var a=qA(r[0],e);t=a.sorted,n=a.recipientMap}else for(var i=new Set,s=0,u=r;s<u.length;s++){for(var c=qA(u[s],e),f=c.sorted,h=c.recipientMap,d=0,m=f;d<m.length;d++){var g=m[d];i.has(g.name)||(t.push(g),i.add(g.name))}var y=function(w){n[w]==null&&(n[w]=new Set),h[w].forEach(function(b){return n[w].add(b)})};for(var x in h)y(x)}return{sorted:t,recipientCounts:fP(n)}}function fP(r){var e={};for(var t in r)e[t]=r[t].size;return e}function qA(r,e){for(var t=new Set,n=[],a={},i=0,s=e.names();i<s.length;i++){var u=s[i];t.add(u)}var c=[],f=[];for(c.push(r);c.length>0;){var h=c[c.length-1];if(t.has(h.name))c.pop();else{var d=f[f.length-1]===c.length-1;if(h.inputs.length===0||d)c.pop(),n.push(h),t.add(h.name),d&&f.pop();else{f.push(c.length-1);for(var m=0,g=h.inputs;m<g.length;m++){var y=g[m];a[y.name]==null&&(a[y.name]=new Set),a[y.name].add(h.name),t.has(y.name)||c.push(y)}}}}return{sorted:n,recipientMap:a}}function hP(r){var e;if(r.sourceLayer.inboundNodes.length===1)e=r.sourceLayer.output;else{for(var t=null,n=0;n<r.sourceLayer.inboundNodes.length;++n)for(var a=0,i=r.sourceLayer.inboundNodes[n].outputTensors;a<i.length;a++)if(i[a].id===r.id){t=n;break}e=r.sourceLayer.getOutputAt(t)}return e}var pP=(function(r){function e(t){var n=r.call(this,{})||this;if(n.containerNodes=new Set,n.name=t.name,n.name==null){var a=n.getClassName().toLowerCase();n.name=$m(a)}if(n.supportsMasking=!1,n.trainable_=!0,Array.isArray(t.inputs)?n.inputs=t.inputs.slice():n.inputs=[t.inputs],Array.isArray(t.outputs)?n.outputs=t.outputs.slice():n.outputs=[t.outputs],vo(n.inputs).length!==n.inputs.length)throw new lt("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+n.inputs.map(function(te){return te.name}));vo(n.outputs).length!==n.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+n.outputs.map(function(te){return te.name})),n.inputLayers=[],n.inputLayersNodeIndices=[],n.inputLayersTensorIndices=[],n.outputLayers=[],n.outputLayersNodeIndices=[],n.outputLayersTensorIndices=[],n.layers=[],n.internalContainerRefs=[];for(var i=0,s=n.outputs;i<s.length;i++){var u=(z=s[i]).sourceLayer,c=z.nodeIndex,f=z.tensorIndex;n.outputLayers.push(u),n.outputLayersNodeIndices.push(c),n.outputLayersTensorIndices.push(f)}for(var h=0,d=n.inputs;h<d.length;h++)u=(z=d[h]).sourceLayer,c=z.nodeIndex,f=z.tensorIndex,Ma(c===0,"input layer has >1 nodes"),Ma(f===0,"input layer has >1 tensors"),n.inputLayers.push(u),n.inputLayersNodeIndices.push(c),n.inputLayersTensorIndices.push(f);n.inputNames=[],n.outputNames=[],n.feedInputShapes=[],n.feedInputNames=[],n.feedOutputNames=[];for(var m=0;m<n.inputLayers.length;m++){if(!((u=n.inputLayers[m])instanceof Vf))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+t.inputs+". Input "+m+" (0-based) originates from layer type "+u.getClassName()+".");n.inputNames.push(u.name),n.feedInputShapes.push(u.batchInputShape),n.feedInputNames.push(u.name)}for(var g=0,y=n.outputLayers;g<y.length;g++)u=y[g],n.outputNames.push(u.name);n.internalInputShapes=n.inputs.map(function(te){return te.shape}),n.internalOutputShapes=n.outputs.map(function(te){return te.shape});for(var x={},w={},b={},C={},A={},T=[],R=function(te,de,Re,tn,Zn,on){tn!=null&&Zn!=null&&on!=null||(tn=te.sourceLayer,Zn=te.nodeIndex,on=te.tensorIndex);var fn=tn.inboundNodes[Zn];if(Re.indexOf(fn)!==-1)throw new Ba("The tensor "+te.name+' at layer "'+tn.name+'" is part of a cycle.');if(de.indexOf(fn)===-1){n.containerNodes.add(e.nodeKey(tn,Zn)),tn.id in A||(A[tn.id]=Object.keys(A).length),Re.indexOf(fn)===-1&&Re.push(fn);for(var U=fn.inboundLayers.length,_=0;_<U;_++){var I=fn.inputTensors[_],Y=fn.inboundLayers[_],st=fn.nodeIndices[_],mt=fn.tensorIndices[_];R(I,de,Re,Y,st,mt)}for(de.push(fn);Re.indexOf(fn)>=0;)Re.splice(Re.indexOf(fn),1);T.push(fn)}},D=[],N=[],O=0,k=n.outputs;O<k.length;O++){var z=k[O];R(z,D,N)}for(var F=0,B=T.slice().reverse();F<B.length;F++){w[(Ut=B[F]).id]=Ut,Ut.id in x||(x[Ut.id]=0);var V=x[Ut.id],G=b[Ut.outboundLayer.id]==null?0:b[Ut.outboundLayer.id];for(V=Math.max(V,G),b[Ut.outboundLayer.id]=V,C[Ut.outboundLayer.id]=Ut.outboundLayer,x[Ut.id]=V,m=0;m<Ut.inboundLayers.length;m++){var Q=Ut.inboundLayers[m],L=(c=Ut.nodeIndices[m],Q.inboundNodes[c]),X=x[L.id]==null?0:x[L.id];x[L.id]=Math.max(V+1,X),w[L.id]=L}}var $={};for(var it in x)(V=x[it])in $||($[V]=[]),$[V].push(w[it]);var tt={};for(var q in b)(V=b[q])in tt||(tt[V]=[]),tt[V].push(C[q]);var nt=Object.keys(tt).map(function(te){return parseInt(te,10)}).sort(mp);n.layers=[];for(var W=0,Z=nt;W<Z.length;W++){var ot=tt[V=Z[W]];ot.sort(function(te,de){var Re=A[te.id],tn=A[de.id];return Re<tn?-1:Re>tn?1:0});for(var xt=0,Ot=ot;xt<Ot.length;xt++)(u=Ot[xt])instanceof e&&n.internalContainerRefs.push(u),n.layers.push(u)}n.layersByDepth=tt,nt=Object.keys($).map(function(te){return parseInt(te,10)}).sort(mp);for(var zt=n.inputs.slice(),_t=[],Mt=0,kt=nt;Mt<kt.length;Mt++)for(var Ft=0,Pt=$[V=kt[Mt]];Ft<Pt.length;Ft++){var Ut;if((u=(Ut=Pt[Ft]).outboundLayer)!=null){for(var $t=0,Wt=Ut.inputTensors;$t<Wt.length;$t++)if(z=Wt[$t],zt.indexOf(z)===-1)throw new Ba("Graph disconnected: cannot obtain value for tensor "+z+' at layer "'+u.name+'". The following previous layers were accessed without issue: '+_t);for(var Ae=0,cn=Ut.outputTensors;Ae<cn.length;Ae++)z=cn[Ae],zt.push(z);_t.push(u.name)}}n.nodesByDepth=$;for(var Et=n.layers.map(function(te){return te.name}),ze=function(te){var de=Et.filter(function(Re){return Re===te}).length;if(de!==1)throw new Ba('The name "'+te+'" is used '+de+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(Et))},Ne=0,yn=Et;Ne<yn.length;Ne++)ze(yn[Ne]);return n.outboundNodes=[],n.inboundNodes=[],new Qm({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:n.inputs,outputTensors:n.outputs,inputMasks:n.inputs.map(function(te){return null}),outputMasks:n.outputs.map(function(te){return null}),inputShapes:n.inputs.map(function(te){return te.shape}),outputShapes:n.outputs.map(function(te){return te.shape})}),n.built=!0,n._refCount=1,n}return Nt(e,r),e.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var n=0,a=this.layers;n<a.length;n++){var i=a[n];t.numDisposedVariables+=i.dispose().numDisposedVariables}for(var s=0,u=this.internalContainerRefs;s<u.length;s++){var c=u[s];t.numDisposedVariables+=c.dispose().numDisposedVariables}}return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach(function(n){n._trainableWeights.forEach(function(a){return a.trainable=t})}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new lt("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],n=0,a=this.layers;n<a.length;n++){var i=a[n];t=t.concat(i.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],n=0,a=this.layers;n<a.length;n++){var i=a[n];t.push.apply(t,i.nonTrainableWeights)}if(!this.trainable){for(var s=[],u=0,c=this.layers;u<c.length;u++)i=c[u],s.push.apply(s,i.trainableWeights);return s.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,n){n===void 0&&(n=!0);for(var a={},i=0,s=0,u=this.layers;s<u.length;s++)for(var c=0,f=u[s].weights;c<f.length;c++){var h=f[c];if(a[h.originalName]!=null)throw new lt("Duplicate weight name: "+h.originalName);a[h.originalName]=h,i++}var d=[];for(var m in t){if(a[m]!=null)d.push([a[m],t[m]]);else if(n)throw new lt("Provided weight data has no target variable: "+m);delete a[m]}if(n){var g=[];for(var y in a)g.push(y);if(g.length>0)throw new lt(g.length+" of "+i+" weights are not set: "+g)}sw(d)},e.prototype.updatedConfig=function(){var t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion="tfjs-layers "+tv,n.backend="TensorFlow.js",n},e.prototype.toJSON=function(t,n){n===void 0&&(n=!0);var a=Gb(this.updatedConfig());return n?JSON.stringify(a):a},e.prototype.call=function(t,n){var a=this;return ft(function(){t=Ge(t);for(var i=new Bu,s=0;s<a.inputs.length;++s)i.add(a.inputs[s],t[s]);return Ec(a.outputs,i,n)})},e.prototype.computeMask=function(t,n){var a=this;return ft(function(){var i;return t=Ge(t),i=n==null?Ts(null,t.length):Ge(n),a.runInternalGraph(t,i)[1]})},e.prototype.computeOutputShape=function(t){var n=md(t);if(n.length!==this.inputLayers.length)throw new lt("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var a={},i=0;i<n.length;i++){var s=this.inputLayers[i],u=n[i];a[k=s.name+"_0_0"]=u}var c=Object.keys(this.nodesByDepth).map(function(F){return parseInt(F,10)}).sort(mp);if(c.length>1)for(var f=0,h=c;f<h.length;f++)for(var d=h[f],m=0,g=this.nodesByDepth[d];m<g.length;m++){var y=g[m];if(s=y.outboundLayer,this.inputLayers.map(function(F){return F.id}).indexOf(s.id)===-1){for(var x=[],w=0;w<y.inboundLayers.length;w++){var b=y.inboundLayers[w],C=y.nodeIndices[w],A=y.tensorIndices[w],T=a[k=b.name+"_"+C+"_"+A];x.push(T)}var R=md(s.computeOutputShape(or(x))),D=s.inboundNodes.indexOf(y);for(w=0;w<R.length;w++)a[k=s.name+"_"+D+"_"+w]=R[w]}}var N=[],O=[];for(i=0;i<this.outputLayers.length;i++){s=this.outputLayers[i],D=this.outputLayersNodeIndices[i],A=this.outputLayersTensorIndices[i];var k=s.name+"_"+D+"_"+A;O.push(k)}for(i=0;i<O.length;i++){var z=O[i];Ma(z in a),N.push(a[z])}return or(N)},e.prototype.runInternalGraph=function(t,n){n==null&&(n=Ts(null,t.length));for(var a={},i=0;i<this.inputs.length;++i){var s=this.inputs[i],u=t[i],c=n[i];a[s.id]=[u,c]}for(var f=0,h=Object.keys(this.nodesByDepth).map(function(tt){return parseInt(tt,10)}).sort(mp);f<h.length;f++)for(var d=h[f],m=0,g=this.nodesByDepth[d];m<g.length;m++){for(var y=g[m],x=y.outboundLayer,w=y.inputTensors,b=y.outputTensors,C=new Array,A=0,T=w;A<T.length;A++)(s=T[A]).id in a&&C.push(a[s.id]);if(C.length===w.length){var R={},D=void 0,N=void 0,O=void 0,k=void 0;if(y.callArgs!=null&&(R=y.callArgs),C.length===1){var z=C[0],F=z[0],B=z[1];R.mask==null&&(R.mask=B),O=Ge(x.call(F,R)),k=Ge(x.computeMask(F,B)),D=[F],N=[B]}else D=C.map(function(tt){return tt[0]}),N=C.map(function(tt){return tt[1]}),R.mask==null&&(R.mask=N),O=Ge(x.call(D,R)),k=Ge(x.computeMask(D,N));if(x.activityRegularizer)throw new he("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(i=0;i<b.length;++i)s=b[i],u=O[i],c=k[i],a[s.id]=[u,c]}}for(var V=[],G=[],Q=[],L=0,X=this.outputs;L<X.length;L++){Ma((s=X[L]).id in a,"Could not compute output "+s.name+" : "+s.id);var $=a[s.id],it=$[0];c=$[1],Q.push(it.shape),V.push(it),G.push(c)}return[V,G,Q]},e.prototype.buildNodeConversionMap=function(t){for(var n,a={},i=0,s=this.layers;i<s.length;i++){var u=s[i];n=u instanceof e?1:0;for(var c=0;c<u.inboundNodes.length;c++){var f=e.nodeKey(u,c);this.containerNodes.has(f)&&(a[f]=n,n+=1)}}return a},e.prototype.getLayer=function(t,n){if(n!=null){if(this.layers.length<=n)throw new lt("Was asked to retrieve layer at index "+n+", but model only has "+this.layers.length+" layer(s).");return this.layers[n]}if(t==null)throw new lt("Provide either a layer name or layer index");for(var a=0,i=this.layers;a<i.length;a++){var s=i[a];if(s.name===t)return s}throw new lt("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return ft(function(){for(var n=[],a=0,i=t.layers;a<i.length;a++)for(var s=i[a],u=0;u<s.inboundNodes.length;++u){var c=e.nodeKey(s,u);t.containerNodes.has(c)&&n.push.apply(n,s.calculateLosses())}return n})},e.prototype.getConfig=function(){for(var t={name:this.name},n=this.buildNodeConversionMap(this.layers),a=[],i=0,s=this.layers;i<s.length;i++){for(var u=(R=s[i]).getClassName(),c=R.getConfig(),f=[],h=0;h<R.inboundNodes.length;h++){var d=R.inboundNodes[h],m=e.nodeKey(R,h),g={};if(this.containerNodes.has(m)){if(d.callArgs)try{JSON.stringify(d.callArgs),g=d.callArgs}catch{console.warn("Layer "+R.name+" was passed non-serializable keyword arguments: "+d.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),g={}}if(d.inboundLayers.length>0){for(var y=[],x=0;x<d.inboundLayers.length;x++){var w=d.inboundLayers[x],b=d.nodeIndices[x],C=d.tensorIndices[x];(N=n[e.nodeKey(w,b)])==null&&(N=0),y.push([w.name,N,C,g])}f.push(y)}}}var A={};A.name=R.name,A.className=u,A.config=c,A.inboundNodes=f,a.push(A)}t.layers=a;var T=[];for(x=0;x<this.inputLayers.length;x++){var R=this.inputLayers[x];b=this.inputLayersNodeIndices[x],m=e.nodeKey(R,b),this.containerNodes.has(m)&&((N=n[m])!==null&&N!==void 0||(N=0),C=this.inputLayersTensorIndices[x],T.push([R.name,N,C]))}t.inputLayers=T;var D=[];for(x=0;x<this.outputLayers.length;x++)if(R=this.outputLayers[x],b=this.outputLayersNodeIndices[x],m=e.nodeKey(R,b),this.containerNodes.has(m)){var N;(N=n[m])!==null&&N!==void 0||(N=0),C=this.outputLayersTensorIndices[x],D.push([R.name,N,C])}return t.outputLayers=D,t},e.fromConfig=function(t,n,a,i){i===void 0&&(i=!1);var s={},u={};function c(L,X){L.name in u?u[L.name].push(X):u[L.name]=[X]}function f(L,X){for(var $,it=[],tt=0,q=X;tt<q.length;tt++){var nt=q[tt],W=nt[0],Z=nt[1],ot=nt[2];if($=nt[3]==null?{}:nt[3],!(W in s))return void c(L,X);var xt=s[W];if(xt.inboundNodes.length<=Z)return void c(L,X);var Ot=xt.inboundNodes[Z];it.push(Ot.outputTensors[ot])}it.length>0&&L.apply(or(it),$)}function h(L){var X=L.name,$=da(L,n.customObjects!=null?n.customObjects:{});$.setFastWeightInitDuringBuild(i),s[X]=$,L.inboundNodes.forEach(function(it){if(!(it instanceof Array))throw new lt("Corrupted configuration, expected array for nodeData: "+it);c($,it)})}for(var d=n.name,m=n.layers,g=0,y=m;g<y.length;g++)h(b=y[g]);for(;!qU(u);)for(var x=0,w=m;x<w.length;x++){var b=w[x];if((Q=s[b.name]).name in u){var C=u[Q.name];delete u[Q.name];for(var A=0,T=C;A<T.length;A++)f(Q,T[A])}}for(var R=[],D=[],N=0,O=n.inputLayers;N<O.length;N++){var k=(b=O[N])[0],z=b[1],F=b[2];Ma(k in s);var B=(Q=s[k]).inboundNodes[z].outputTensors;R.push(B[F])}for(var V=0,G=n.outputLayers;V<G.length;V++){k=(b=G[V])[0],z=b[1],F=b[2],Ma(k in s);var Q;B=(Q=s[k]).inboundNodes[z].outputTensors,D.push(B[F])}return new t({inputs:R,outputs:D,name:d})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new lt("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,n=this.layers;t<n.length;t++)if(n[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;ft(function(){t.layers.forEach(function(n){n.stateful&&n.resetStates()})})},e})(we);function dP(r,e,t){var n=e.length;if(r==null||Array.isArray(r)&&r.length===0)return e.map(function(i){return null});if(n===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&e[0]in r?[r[e[0]]]:[r];if(Array.isArray(r)){if(r.length!==n)throw new Error("Provided "+t+" is an array of "+r.length+" element(s), but the model has "+n+" outputs. Make sure a set of weights is provided for each model output.");return r}if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){var a=[];return e.forEach(function(i){i in r?a.push(r[i]):a.push(null)}),a}throw new Error("The model has multiple ("+n+") outputs, so "+t+" must be either an array with "+n+" elements or an object with "+e+" keys. Provided "+t+" not understood: "+JSON.stringify(r))}function qD(r,e){return dP(r,e,"classWeight")}function WD(r,e,t,n){return ne(this,void 0,void 0,function(){var a,i,s,u,c;return Zt(this,function(f){switch(f.label){case 0:return t==null?[3,2]:(a=ft(function(){if(r.shape.length===1)return r.clone();if(r.shape.length===2){if(r.shape[1]>1)return r.argMax(1);if(r.shape[1]===1)return r.reshape([r.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+r.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+r.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),u=(s=Array).from,[4,a.data()]);case 1:return i=u.apply(s,[f.sent()]),re(a),c=[],i.forEach(function(h){if(t[h]==null)throw new Error("classWeight must contain all classes in the training data. The class "+h+" exists in the data but not in classWeight");c.push(t[h])}),[2,zn(c,"float32")];case 2:return[2,null]}})})}function mP(r,e){return Jt(r,e)}var vP=32;function HD(r,e){var t,n,a=e;t=a.xs,n=a.ys,At.assert(t!=null&&n!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e});var i=WA("input",r.inputNames,t),s=WA("output",r.outputNames,n),u=i[0].shape[0];At.assert(i.length===r.inputs.length,function(){return"LayersModel has "+r.inputs.length+" inputs, but the dataset provides "+i.length+" inputs.  (Expected input keys: "+JSON.stringify(r.inputNames)+")"}),At.assert(s.length===r.outputs.length,function(){return"LayersModel has "+r.outputs.length+" outputs, but the dataset provides "+s.length+" outputs.  (Expected output keys: "+JSON.stringify(r.outputNames)+")"});var c=function(m){At.assert(i[m].shape[0]===u,function(){return"Batch size mismatch: input "+r.inputNames[m]+" has "+i[m].shape[0]+"; expected  "+u+" based on input "+r.inputNames[0]+"."})};for(var f in i)c(f);var h=function(m){At.assert(s[m].shape[0]===u,function(){return"Batch size mismatch: output "+r.outputNames[m]+" has "+s[m].shape[0]+"; expected  "+u+" based on input "+r.inputNames[0]+"."})};for(var d in s)h(d);return{xs:i,ys:s}}function WA(r,e,t){if(t instanceof Ee)return[t];if(Array.isArray(t))return At.assert(t.length===e.length,function(){return"Received an array of "+t.length+" Tensors, but expected "+e.length+" to match the "+r+" keys "+e+"."}),t;for(var n=[],a=0,i=e;a<i.length;a++){var s=i[a];if(t[s]==null)throw new lt("The feature data generated by the dataset lacks the required "+r+" key '"+s+"'.");n.push(t[s])}return n}function gP(r){if(r.length===3)throw new he("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}function yP(r,e,t){return ne(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N,O,k,z,F,B,V,G,Q,L,X,$,it,tt;return Zt(this,function(q){switch(q.label){case 0:if(n=t.batchesPerEpoch!=null,At.assert(r.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),At.assert(t!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),At.assert(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+t.epochs}),At.assert(!n||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+t.batchesPerEpoch}),At.assert(t.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0,q.label=1;case 1:return q.trys.push([1,,26,27]),a=t.validationData!=null,i=void 0,s=void 0,a&&(HA(t.validationData)?At.assert(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+t.validationBatches}):(u=gP(t.validationData),i=u.xs,s=u.ys)),c=r.makeTrainFunction(),f=r.getDedupedMetricsNames(),h=void 0,h=a?f.slice().concat(f.map(function(nt){return"val_"+nt})):f.slice(),d=MD(t.callbacks,t.yieldEvery),m=t.verbose==null?1:t.verbose,g=FD(d,m,t.epochs,null,null,bP(e,t),null,a,h),y=g.callbackList,x=g.history,y.setModel(r),r.history=x,[4,y.onTrainBegin()];case 2:return q.sent(),r.stopTraining_=!1,w=t.initialEpoch==null?0:t.initialEpoch,[4,e.iterator()];case 3:b=q.sent(),q.label=4;case 4:return w<t.epochs?(C={},[4,y.onEpochBegin(w)]):[3,23];case 5:return q.sent(),A=0,T=0,n?[3,7]:[4,e.iterator()];case 6:b=q.sent(),q.label=7;case 7:return!n||A<t.batchesPerEpoch?[4,b.next()]:[3,21];case 8:return R=q.sent(),n&&R.done?(console.warn("You provided `batchesPerEpoch` as "+t.batchesPerEpoch+", but your dataset iterator ran out of data after "+A+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+t.batchesPerEpoch*t.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):R.value==null?[3,15]:(D=HD(r,R.value),N=D.xs,O=D.ys,(k={}).batch=T,k.size=N[0].shape[0],[4,y.onBatchBegin(T,k)]);case 9:if(q.sent(),z=[],t.classWeight==null)return[3,13];F=qD(t.classWeight,r.outputNames),tt=0,q.label=10;case 10:return tt<F.length?(V=(B=z).push,[4,WD(O[tt],null,F[tt])]):[3,13];case 11:V.apply(B,[q.sent()]),q.label=12;case 12:return++tt,[3,10];case 13:for(G=N.concat(O).concat(z),Q=c(G),re(G),tt=0;tt<f.length;++tt)L=f[tt],X=Q[tt],k[L]=X,ma(X);return[4,y.onBatchEnd(T,k)];case 14:q.sent(),OD(k),T++,A++,q.label=15;case 15:return(n?A>=t.batchesPerEpoch:R.done)?a?($=void 0,HA(t.validationData)?(it=Ge,[4,r.evaluateDataset(t.validationData,{batches:t.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return $=it.apply(void 0,[q.sent()]),[3,18];case 17:$=Ge(r.evaluate(i,s,{batchSize:t.validationBatchSize==null?vP:t.validationBatchSize,verbose:0})),q.label=18;case 18:for(tt=0;tt<r.metricsNames.length;++tt)C["val_"+r.metricsNames[tt]]=$[tt];q.label=19;case 19:return[3,21];case 20:return r.stopTraining_?[3,21]:[3,7];case 21:return[4,y.onEpochEnd(w,C)];case 22:return q.sent(),w++,r.stopTraining_?[3,23]:[3,4];case 23:return[4,y.onTrainEnd()];case 24:return q.sent(),[4,r.history.syncData()];case 25:return q.sent(),[2,r.history];case 26:return r.isTraining=!1,[7];case 27:return[2]}})})}function bP(r,e){var t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(r.size)&&(t=r.size),t}function HA(r){return typeof r.iterator=="function"}function xP(r){return typeof r.next=="function"}function wP(r,e,t){return ne(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m;return Zt(this,function(g){switch(g.label){case 0:if(n=(t=t||{}).batches!=null,a=r.testFunction,i=[],t.verbose>0)throw new he("Verbose mode is not implemented yet.");return At.assert(!n||t.batches>0&&Number.isInteger(t.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(t.batches)}),xP(e)?(u=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:u=g.sent(),g.label=3;case 3:s=u,c=0,f=0,h=function(){var y;return Zt(this,function(x){switch(x.label){case 0:return[4,s.next()];case 1:return y=x.sent(),i=ft(function(){if(y.value){var w=HD(r,y.value),b=w.xs,C=w.ys,A=b.concat(C),T=ft(function(){return a(A)});if(re(A),f===0)for(var R=0;R<T.length;++R)i.push(jt(0));var D=A[0].shape[0],N=function(O){var k=T[O],z=i[O];i[O]=ft(function(){return se(i[O],Jt(D,k))}),f>0&&re(z)};for(R=0;R<T.length;++R)N(R);re(T),c+=D,++f}return i}),y.done?(n&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+t.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},g.label=4;case 4:return!n||f<t.batches?[5,h()]:[3,6];case 5:return g.sent()==="break"?[3,6]:[3,4];case 6:for(d=0;d<i.length;++d)m=i[d],i[d]=Sn(i[d],c),re(m);return[2,or(i)]}})})}function Xb(r){At.assert(r>0&&Number.isInteger(r),function(){return"batchSize is required to be a positive integer, but got "+r})}function Cc(r,e,t){return r==null?[null]:Array.isArray(r)?r.map(function(n){return vs(n,e,t-e)}):vs(r,e,t-e)}function hw(r,e){return ft(function(){return r==null?null:Array.isArray(r)?r.map(function(t){return hw(t,e)}):gD(r,e.dtype==="int32"?e:e.toInt())})}function Kb(r,e){for(var t=[],n=0,a=null;n<r;)(a=n+e)>=r&&(a=r),t.push([n,a]),n=a;return t}function SP(r,e,t,n,a,i,s,u,c,f,h,d,m,g,y){return ne(this,void 0,void 0,function(){var x,w,b,C,A,T,R,D;return Zt(this,function(N){switch(N.label){case 0:return a==null&&(a=32),i==null&&(i=1),h==null&&(h=!0),m==null&&(m=0),x=!1,c!=null&&f!=null&&(x=!0),y!=null,(w=r.checkNumSamples(t,a,g,"steps_per_epoch"))!=null&&(b=ya(0,w)),s==null&&(s=1),C=FD(u,s,i,m,w,g,a,x,d),A=C.callbackList,T=C.history,A.setModel(r),r.history=T,[4,A.onTrainBegin()];case 1:N.sent(),r.stopTraining_=!1,R=function(O){var k,z,F,B,V;return Zt(this,function(G){switch(G.label){case 0:return[4,A.onEpochBegin(O)];case 1:if(G.sent(),k={},g==null)return[3,2];case 2:if(h==="batch")throw new he("batch shuffling is not implemneted yet");h&&At.shuffle(b),z=zn(b),F=Kb(w,a),B=function(Q){var L;return Zt(this,function(X){switch(X.label){case 0:return L={},[4,A.onBatchBegin(Q,L)];case 1:return X.sent(),ft(function(){var $=F[Q][0],it=F[Q][1],tt=vs(z,$,it-$);L.batch=Q,L.size=it-$;for(var q=hw(t,tt),nt=e(q),W=0;W<n.length;++W){var Z=n[W],ot=nt[W];L[Z]=ot,ma(ot)}if(Q===F.length-1&&x){var xt=r.testLoop(c,f,a);for(W=0;W<n.length;++W)Z=n[W],ot=xt[W],ma(ot),k["val_"+Z]=ot}}),[4,A.onBatchEnd(Q,L)];case 2:return X.sent(),OD(L),r.stopTraining_?[2,"break"]:[2]}})},V=0,G.label=3;case 3:return V<F.length?[5,B(V)]:[3,6];case 4:if(G.sent()==="break")return[3,6];G.label=5;case 5:return++V,[3,3];case 6:z.dispose(),G.label=7;case 7:return[4,A.onEpochEnd(O,k)];case 8:return G.sent(),r.stopTraining_?[2,"break"]:[2]}})},D=m,N.label=2;case 2:return D<i?[5,R(D)]:[3,5];case 3:if(N.sent()==="break")return[3,5];N.label=4;case 4:return++D,[3,2];case 5:return[4,A.onTrainEnd()];case 6:return N.sent(),[4,r.history.syncData()];case 7:return N.sent(),[2,r.history]}})})}function EP(r,e,t,n){return n===void 0&&(n={}),ne(this,void 0,void 0,function(){var a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N,O,k;return Zt(this,function(z){switch(z.label){case 0:if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0,z.label=1;case 1:return z.trys.push([1,,7,8]),Xb(d=n.batchSize==null?32:n.batchSize),m=!1,[4,r.standardizeUserData(e,t,n.sampleWeight,n.classWeight,m,d)];case 2:if(g=z.sent(),a=g[0],i=g[1],h=g[2],y=!1,x=void 0,!(n.validationData!=null&&n.validationData.length>0))return[3,4];if(y=!0,n.validationData.length!==2)throw n.validationData.length===3?new he("validationData including sample weights is not supported yet."):new lt("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+n.validationData+" is invalid.");return s=n.validationData[0],u=n.validationData[1],w=!0,[4,r.standardizeUserData(s,u,null,null,w,d)];case 3:return b=z.sent(),c=b[0],f=b[1],x=c.concat(f),[3,5];case 4:n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1?(y=!0,C=Math.floor(a[0].shape[0]*(1-n.validationSplit)),A=a[0].shape[0],c=Cc(a,C,A),a=Cc(a,0,C),f=Cc(i,C,A),i=Cc(i,0,C),x=c.concat(f)):n.validationSteps!=null&&(y=!0),z.label=5;case 5:return T=a.concat(i).concat(h),r.checkTrainableWeightsConsistency(),R=r.makeTrainFunction(),D=r.getDedupedMetricsNames(),N=void 0,O=void 0,y?(r.makeTestFunction(),N=r.testFunction,O=D.slice().concat(D.map(function(F){return"val_"+F}))):(N=null,x=[],O=D.slice()),k=MD(n.callbacks,n.yieldEvery),[4,SP(r,R,T,D,d,n.epochs,n.verbose,k,N,x,n.shuffle,O,n.initialEpoch,null,null)];case 6:return[2,z.sent()];case 7:return r.isTraining=!1,hs(a,e),hs(i,t),hs(c,s),hs(f,u),h!=null&&re(h),[7];case 8:return[2]}})})}function GD(r){var e=[];r instanceof Ee&&(r=[r]);for(var t=0;t<r.length;++t){var n=r[t];if(n.rank===1)e.push(jf(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(n)}}return e}function hs(r,e){if(r!=null){var t=[];if(e instanceof Ee)t.push(e.id);else if(Array.isArray(e))e.forEach(function(c){return t.push(c.id)});else if(e!=null)for(var n in e){var a=e[n];t.push(a.id)}var i=[];if(r instanceof Ee)t.indexOf(r.id)===-1&&i.push(r);else if(Array.isArray(r))r.forEach(function(c){t.indexOf(c.id)===-1&&i.push(c)});else if(r!=null)for(var s in r){var u=r[s];t.indexOf(u.id)===-1&&i.push(u)}i.forEach(function(c){c.isDisposed||c.dispose()})}}function CP(r){return r instanceof Ee}function Yb(r){return Array.isArray(r)}function GA(r){return!CP(r)&&!Yb(r)}function XA(r,e,t,n,a){if(a===void 0&&(a=""),e==null||e.length===0){if(r!=null){var i=!1;if(Yb(r)&&r.length>0)i=!0;else if(GA(r)){for(var s in r)if(r.hasOwnProperty(s)){i=!0;break}}else i=!0;if(i)throw new lt("Error when checking model "+a+" expected no data, but got "+r)}return[]}if(r==null)return e.map(function(w){return null});var u;if(GA(r)){r=r,u=[];for(var c=0,f=e;c<f.length;c++){var h=f[c];if(r[h]==null)throw new lt('No data provided for "'+h+'". Need data for each key in: '+e);u.push(r[h])}}else if(Yb(r)){if((r=r).length!==e.length)throw new lt("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+r);u=r}else{if(r=r,e.length>1)throw new lt("The model "+a+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+r.shape);u=[r]}if(u=GD(u),t!=null){for(var d=0;d<e.length;++d)if(t[d]!=null){var m=u[d];if(m.shape.length!==t[d].length)throw new lt("Error when checking "+a+": expected "+e[d]+" to have "+t[d].length+" dimension(s). but got array with shape "+m.shape);for(var g=0;g<t[d].length;++g)if(g!==0||n){var y=m.shape[g],x=t[d][g];if(x!=null&&x>=0&&y!==x)throw new lt("Error when checking "+a+": expected "+e[d]+" to have shape ["+t[d]+"], but got array with shape ["+m.shape+"].")}}}return u}function AP(r,e,t){var n=vo(r.map(function(i){return i.shape[0]}));n.sort();var a=vo(e.map(function(i){return i.shape[0]}));if(a.sort(),n.length>1)throw new lt("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(r.map(function(i){return i.shape})));if(a.length>1)throw new lt("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(i){return i.shape})));if(n.length>0&&a.length>0&&!At.arraysEqual(n,a))throw new lt("Input Tensors should have the same number of samples as target Tensors. Found "+n[0]+" input sample(s) and "+a[0]+" target sample(s).")}function NP(r,e,t){for(var n=[Ps,Jm,Vc],a=0;a<r.length;++a){var i=r[a],s=e[a],u=t[a];if(s!=null){if(s===Vc&&i.shape[i.shape.length-1]===1)throw new lt("You are passing a target array of shape "+i.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(n.indexOf(s)!==-1)for(var c=i.shape.slice(1),f=u.slice(1),h=0;h<c.length;++h){var d=c[h],m=f[h];if(m!=null&&d!==m)throw new lt("A target Tensor with shape "+i.shape+" was passed for an output of shape "+u+", while using a loss function that expects targets to have the same shape as the output.")}}}}function KA(r,e,t,n,a){var i;if(n===void 0&&(n=!0),a===void 0&&(a=""),Array.isArray(r)){if(r.length!==e.length)throw new lt("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+r.length+" Tensors(s).");i=r}else{if(e.length>1)throw new lt("The model expects "+e.length+" "+a+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(r.shape)+".");i=[r]}if(t!=null){for(var s=0;s<e.length;++s)if(t[s]!=null){var u=i[s];if(u.shape.length!==t[s].length)throw new lt("Error when checking "+a+": expected "+e[s]+" to have "+t[s].length+" dimension(s), but got array with shape "+JSON.stringify(u.shape));for(var c=0;c<t[s].length;++c)if(c!==0||n){var f=u.shape[c],h=t[s][c];if(h!=null&&h!==f)throw new lt("Error when checking "+a+": expected "+e[s]+" to have shape "+JSON.stringify(t[s])+" but got array with shape "+JSON.stringify(u.shape)+".")}}}}function TP(r,e){if(r==null||Array.isArray(r)&&r.length===0)return e.map(function(c){return[]});var t;if(typeof r=="string"||typeof r=="function")t=[r];else{if(!Array.isArray(r)&&typeof r!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+r);t=r}if(Array.isArray(t))return e.map(function(c){return t});for(var n=[],a=0,i=e;a<i.length;a++){var s=i[a],u=t.hasOwnProperty(s)?t[s]:[];Array.isArray(u)||(u=[u]),n.push(u)}return n}var RP="layers-model",gs=(function(r){function e(t){var n=r.call(this,t)||this;return n.isTraining=!1,n}return Nt(e,r),e.prototype.summary=function(t,n,a){if(a===void 0&&(a=console.log),!this.built)throw new lt("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");aP(this,t,n,a)},e.prototype.compile=function(t){var n=this;if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=rP(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Xa))throw new lt("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var a=[];if(Array.isArray(t.loss)||typeof t.loss=="string"||typeof t.loss=="function")if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new lt("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");var i=t.loss;a=i.map(function(w){return Zy(w)})}else{var s=Zy(t.loss);this.outputs.forEach(function(w){a.push(s)})}else{for(var u in t.loss=t.loss,t.loss)if(this.outputNames.indexOf(u)===-1)throw new lt('Unknown entry in loss dictionary: "'+u+'". Only expected the following keys: '+this.outputNames);for(var c=0,f=this.outputNames;c<f.length;c++){var h=f[c];t.loss[h]==null&&console.warn('Output "'+h+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+h+" during training"),a.push(Zy(t.loss[h]))}}this.lossFunctions=a,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var d=0;d<this.outputs.length;++d){var m=this.internalOutputShapes[d],g=this.outputNames[d];this.feedOutputNames.push(g),this.feedOutputShapes.push(m),this.feedLossFns.push(this.lossFunctions[d])}var y=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ms("loss",function(){for(var w=0;w<n.outputs.length;++w)if(y.indexOf(w)===-1){var b=n.lossFunctions[w];n.outputs.length>1&&(n.metricsTensors.push([b,w]),n.metricsNames.push(n.outputNames[w]+"_loss"))}});var x=TP(t.metrics,this.outputNames);ms("metric",function(){for(var w=function(C){if(y.indexOf(C)!==-1)return"continue";(function(A){for(var T,R,D,N=function(z){if(typeof z=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(z)!==-1){var F=n.internalOutputShapes[C];F[F.length-1]===1||n.lossFunctions[C]===Jm?["accuracy","acc"].indexOf(z)!==-1?R=lw:["crossentropy","ce"].indexOf(z)!==-1&&(R=UD):n.lossFunctions[C]===yd?["accuracy","acc"].indexOf(z)!==-1?R=jD:["crossentropy","ce"].indexOf(z)!==-1&&(R=PD):["accuracy","acc"].indexOf(z)!==-1?R=cw:["crossentropy","ce"].indexOf(z)!==-1&&(R=fw);var B=void 0;["accuracy","acc"].indexOf(z)!==-1?B="acc":["crossentropy","ce"].indexOf(z)!==-1&&(B="ce"),D=R,T=""+B}else{var V=nP(z);D=V,T=""+yp(z)}var G;ms(T,function(){G=D}),(function(Q,L,X){n.outputNames.length>1&&(L=n.outputNames[Q]+"_"+L),n.metricsNames.push(L),n.metricsTensors.push([X,Q])})(C,T,G)},O=0,k=A;O<k.length;O++)N(k[O])})(x[C])},b=0;b<n.outputs.length;++b)w(b)}),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,n,a){a===void 0&&(a={});var i=a.batchSize==null?32:a.batchSize;Xb(i);var s=this.standardizeUserDataXY(t,n,!0,i);try{var u=s[0].concat(s[1]);this.makeTestFunction();var c=this.testFunction;return or(this.testLoop(c,u,i,a.verbose,a.steps))}finally{hs(s[0],t),hs(s[1],n)}},e.prototype.evaluateDataset=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){return this.makeTestFunction(),[2,wP(this,t,n)]})})},e.prototype.checkNumSamples=function(t,n,a,i){var s;if(i===void 0&&(i="steps"),a!=null){if(s=null,n!=null)throw new lt("If "+i+" is set, batchSize must be null or undefined.Got batchSize = "+n)}else{if(t==null)throw new lt("Either the input data should have a defined shape, or "+i+" shoud be specified.");s=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return s},e.prototype.execute=function(t,n){if(Array.isArray(n)&&n.length===0)throw new lt("`outputs` is an empty Array, which is not allowed.");var a=Array.isArray(n),i=a?n:[n],s=this.retrieveSymbolicTensors(i),u=new Bu;if(t instanceof Ee&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new lt("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var c=0;c<this.inputs.length;++c)u.add(this.inputs[c],t[c])}else for(var f=0,h=this.inputs;f<h.length;f++){var d=h[f],m=t[d.name];if(m==null)throw new lt("No value is provided for the model's input "+d.name);u.add(d,m)}var g=Ec(s,u);return a?g:g[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var n=Ts(null,t.length),a=t.length,i=0,s=this.layers;i<s.length;i++){for(var u=s[i],c=Array.isArray(u.output)?u.output:[u.output],f=c.map(function(g){return g.name}),h=0;h<t.length;++h){var d=f.indexOf(t[h]);if(d!==-1&&(n[h]=c[d],a--),a===0)break}if(a===0)break}if(a>0){var m=[];throw n.forEach(function(g,y){g==null&&m.push(t[y])}),new lt("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(m))}return n},e.prototype.predictLoop=function(t,n,a){var i=this;return n===void 0&&(n=32),a===void 0&&(a=!1),ft(function(){var s=i.checkNumSamples(t);if(a)throw new he("Verbose predictLoop() is not implemented yet.");for(var u=Kb(s,n),c=i.outputs.map(function(d){return[]}),f=function(d){ft(function(){var m=u[d][0],g=u[d][1],y=Cc(t,m,g),x=[];if(Array.isArray(y))for(var w=0;w<y.length;++w)x.push({key:i.inputs[w],value:y[w]});else x.push({key:i.inputs[0],value:y});var b=new Bu(x);return Ec(i.outputs,b)}).forEach(function(m,g){return c[g].push(m)})},h=0;h<u.length;++h)f(h);return or(c.map(function(d){return Vn(d,0)}))})},e.prototype.predict=function(t,n){n===void 0&&(n={});var a=GD(t);KA(a,this.inputNames,this.feedInputShapes,!1);try{var i=n.batchSize==null?32:n.batchSize;return Xb(i),this.predictLoop(a,i)}finally{hs(a,t)}},e.prototype.predictOnBatch=function(t){KA(t,this.inputNames,this.feedInputShapes,!0);var n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)},e.prototype.standardizeUserDataXY=function(t,n,a,i){if(this.optimizer_==null)throw new Ba("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var s=[],u=0;u<this.feedOutputShapes.length;++u){var c=this.feedOutputShapes[u];this.feedLossFns[u]===yd?s.push(c.slice(0,c.length-1).concat([1])):s.push(c)}if(AP(t=XA(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=XA(n,this.feedOutputNames,s,!1,"target")),NP(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!=0)throw new lt("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+i+". Found: "+t[0].shape[0]+" sample(s).");return[t,n]},e.prototype.standardizeUserData=function(t,n,a,i,s,u){return s===void 0&&(s=!0),ne(this,void 0,void 0,function(){var c,f,h,d,m,g,y,x;return Zt(this,function(w){switch(w.label){case 0:if(c=this.standardizeUserDataXY(t,n,s,u),f=c[0],h=c[1],a!=null)throw new Error("sample weight is not supported yet.");if(d=null,i==null)return[3,4];m=qD(i,this.outputNames),d=[],g=0,w.label=1;case 1:return g<m.length?(x=(y=d).push,[4,WD(h[g],null,m[g])]):[3,4];case 2:x.apply(y,[w.sent()]),w.label=3;case 3:return++g,[3,1];case 4:return[2,[f,h,d]]}})})},e.prototype.testLoop=function(t,n,a,i,s){var u=this;return i===void 0&&(i=0),ft(function(){var c=u.checkNumSamples(n,a,s,"steps"),f=[];if(i>0)throw new he("Verbose mode is not implemented yet.");if(s!=null)throw new he("steps mode in testLoop() is not implemented yet");for(var h=Kb(c,a),d=zn(ya(0,c)),m=0;m<h.length;++m){var g=h[m][0],y=h[m][1],x=vs(d,g,y-g),w=hw(n,x),b=t(w);if(m===0)for(var C=0;C<b.length;++C)f.push(jt(0));for(C=0;C<b.length;++C){var A=b[C];f[C]=se(f[C],Jt(y-g,A))}}for(C=0;C<f.length;++C)f[C]=Sn(f[C],c);return f})},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,n=[],a=0;a<t.length;++a){var i=t[a],s=i;DA(t,i)>1&&(s+="_"+DA(t.slice(0,a),i)),n.push(s)}return n},e.prototype.makeTrainFunction=function(){var t=this;return function(n){var a=[],i=n.slice(0,t.inputs.length),s=n.slice(t.inputs.length,t.inputs.length+t.outputs.length),u=n.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),c=[],f=t.collectedTrainableWeights.map(function(h){return h.read()});return[t.optimizer_.minimize(function(){for(var h=[],d=0;d<t.inputs.length;++d)h.push({key:t.inputs[d],value:i[d]});var m,g=new Bu(h),y=Ec(t.outputs,g,{training:!0});for(d=0;d<t.lossFunctions.length;++d){var x=(0,t.lossFunctions[d])(s[d],y[d]);u[d]!=null&&(x=mP(x,u[d]));var w=un(x);a.push(w),m=d===0?x:se(m,x)}for(d=0;d<t.metricsTensors.length;++d){var b=void 0;if(t.outputs.length>1&&d<t.outputs.length)b=a[d];else{var C=t.metricsTensors[d][0],A=t.metricsTensors[d][1];b=un(C(s[A],y[A]))}ma(b),c.push(b)}return m=un(m),t.calculateLosses().forEach(function(T){m=se(m,T)}),m},!0,f)].concat(c)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(n){return ft(function(){for(var a,i=[],s=n.slice(0,t.inputs.length),u=n.slice(t.inputs.length,t.inputs.length+t.outputs.length),c=[],f=0;f<t.inputs.length;++f)c.push({key:t.inputs[f],value:s[f]});var h=new Bu(c),d=Ec(t.outputs,h);for(f=0;f<t.lossFunctions.length;++f){var m=t.lossFunctions[f],g=un(m(u[f],d[f]));a=f===0?g:se(a,g),i.push(a)}for(f=0;f<t.metricsTensors.length;++f){var y=t.metricsTensors[f][0],x=t.metricsTensors[f][1],w=un(y(u[x],d[x]));i.push(w)}return i})}},e.prototype.fit=function(t,n,a){return a===void 0&&(a={}),ne(this,void 0,void 0,function(){return Zt(this,function(i){return[2,EP(this,t,n,a)]})})},e.prototype.fitDataset=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){return[2,yP(this,t,n)]})})},e.prototype.trainOnBatch=function(t,n){return ne(this,void 0,void 0,function(){var a,i,s,u,c,f,h,d,m;return Zt(this,function(g){switch(g.label){case 0:return[4,this.standardizeUserData(t,n)];case 1:a=g.sent(),i=a[0],s=a[1],u=this.makeTrainFunction(),c=u(i.concat(s)),f=[],h=0,d=c,g.label=2;case 2:return h<d.length?[4,d[h].data()]:[3,5];case 3:m=g.sent(),f.push(m[0]),g.label=4;case 4:return h++,[3,2];case 5:return re(c),[2,or(f)]}})})},e.prototype.getNamedWeights=function(t){for(var n=[],a=t!=null&&t.trainableOnly,i=a?this.trainableWeights:this.weights,s=this.getWeights(a),u=0;u<i.length;++u)a&&!i[u].trainable||n.push({name:i[u].originalName,tensor:s[u]});return n},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=r.prototype.dispose.call(this);if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var n=sd().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-sd().numTensors}return t},e.prototype.getLossIdentifiers=function(){var t;if(typeof this.loss=="string")t=mi(this.loss);else if(Array.isArray(this.loss)){for(var n=0,a=this.loss;n<a.length;n++)if(typeof a[n]!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(function(h){return mi(h)})}else{var i=Object.keys(this.loss);t={};for(var s=this.loss,u=0,c=i;u<c.length;u++){var f=c[u];if(typeof s[f]!="string")throw new Error("Serialization of non-string loss is not supported.");t[f]=mi(s[f])}}return t},e.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[mi(yp(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(a){return mi(yp(a))});var t={};for(var n in this.metrics)t[n]=mi(yp(this.metrics[n]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var n,a,i=da(qc(t.optimizer_config));if(typeof t.loss=="string")n=ss(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(function(u){return ss(u)});else if(t.loss!=null)for(var s in n={},t.loss)n[s]=ss(t.loss[s]);if(Array.isArray(t.metrics))a=t.metrics.map(function(u){return ss(u)});else if(t.metrics!=null)for(var s in a={},t.metrics)a[s]=ss(t.metrics[s]);this.compile({loss:n,metrics:a,optimizer:i})},e.prototype.save=function(t,n){return ne(this,void 0,void 0,function(){var a,i,s,u,c,f,h,d,m,g,y,x,w,b;return Zt(this,function(C){switch(C.label){case 0:if(typeof t=="string"){if((a=lr.getSaveHandlers(t)).length===0)throw new lt("Cannot find any save handlers for URL '"+t+"'");if(a.length>1)throw new lt("Found more than one ("+a.length+") save handlers for URL '"+t+"'");t=a[0]}if(t.save==null)throw new lt("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,lr.encodeWeights(this.getNamedWeights(n))];case 1:return i=C.sent(),s=!1,u=null,c=this.toJSON(u,s),f={modelTopology:c,format:RP,generatedBy:"TensorFlow.js tfjs-layers v"+tv,convertedBy:null},n!=null&&n.includeOptimizer&&this.optimizer!=null?(f.trainingConfig=this.getTrainingConfig(),h="optimizer",x=(y=lr).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,x.apply(y,[C.sent(),h])];case 3:d=C.sent(),m=d.data,g=d.specs,(b=i.specs).push.apply(b,g),i.data=lr.concatenateArrayBuffers([i.data,m]),C.label=4;case 4:return this.userDefinedMetadata!=null&&(w=!0,PA(this.userDefinedMetadata,this.name,w),f.userDefinedMetadata=this.userDefinedMetadata),f.weightData=i.data,f.weightSpecs=i.specs,[2,t.save(f)]}})})},e.prototype.setUserDefinedMetadata=function(t){PA(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e.className="Model",e})(pP);function _P(r,e){return ne(this,void 0,void 0,function(){var t,n,a,i,s,u,c,f;return Zt(this,function(h){switch(h.label){case 0:return"modelTopology"in r||(r={modelTopology:r}),(t=(r=r).modelTopology).model_config!=null&&(t=t.model_config),n=qc(t),a=da(n,e),r.weightsManifest==null?[3,2]:[4,lr.loadWeights(r.weightsManifest,r.pathPrefix,a.weights.map(function(d){return d.originalName}))];case 1:for(i=h.sent(),s={},u=0,c=a.weights;u<c.length;u++)f=c[u],s[f.originalName]=i[f.originalName];a.loadWeights(s),re(i),h.label=2;case 2:return[2,a]}})})}function OP(r,e){return ne(this,void 0,void 0,function(){var t;return Zt(this,function(n){if(e==null&&(e={}),typeof r=="string"){if((t=lr.getLoadHandlers(r,e.onProgress)).length===0)t.push(lr.browserHTTPRequest(r,e));else if(t.length>1)throw new lt("Found more than one ("+t.length+") load handlers for URL '"+r+"'");r=t[0]}return[2,DP(r,void 0,e)]})})}function DP(r,e,t){return ne(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d;return Zt(this,function(m){switch(m.label){case 0:if(t==null&&(t={}),r.load==null)throw new lt("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,r.load()];case 1:if(n=m.sent(),(a=n.modelTopology).model_config!=null&&(a=a.model_config),i=t.strict==null||t.strict,s=n.weightData!=null&&n.weightSpecs!=null&&i,u=da(qc(a),e,s),(c=n.trainingConfig)!=null&&u.loadTrainingConfig(c),n.userDefinedMetadata!=null&&u.setUserDefinedMetadata(n.userDefinedMetadata),n.weightData==null)return[3,4];if(n.weightSpecs==null)throw new lt("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return f=IP(n.weightData,n.weightSpecs),h=f.modelWeights,d=f.optimizerWeights,u.loadWeights(h,i),u.optimizer!=null&&d.length>0?[4,u.optimizer.setWeights(d)]:[3,3];case 2:m.sent(),m.label=3;case 3:re(h),re(d.map(function(g){return g.tensor})),m.label=4;case 4:return[2,u]}})})}function IP(r,e){var t=lr.decodeWeights(r,e),n={},a=[];return e.forEach(function(i){i.group==="optimizer"?a.push({name:i.name,tensor:t[i.name]}):n[i.name]=t[i.name]}),{modelWeights:n,optimizerWeights:a}}It.registerClass(gs);var pw=(function(r){function e(t){var n=r.call(this,{inputs:[],outputs:[]})||this;if(t=t||{},n.trainable=!0,n.built=!1,n.name=t.name!=null?t.name:$m("sequential_"),t.layers!=null)for(var a=0,i=t.layers;a<i.length;a++){var s=i[a];n.add(s)}return n}return Nt(e,r),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some(function(n){return n<0}))throw new lt("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var n,a=t instanceof e||t instanceof gs;if(a){if((n=t).outputs.length!==1)throw new lt("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new lt("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new lt("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=_D({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(a)this.outputs=n.outputs,this.inputs=n.inputs;else{if(t.inboundNodes.length!==1)throw new lt("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(t.inboundNodes[0].outputTensors.length!==1)throw new lt("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=RD(this.outputs[0])}this.inboundNodes=[],new Qm({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Ts(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(u){return u.shape}),outputShapes:this.outputs[0].shape})}else{var s=t.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,n){return this.model==null&&this.build(),this.model.call(t,n)},e.prototype.build=function(t){if(We(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new gs({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),r.prototype.countParams.call(this)},e.prototype.summary=function(t,n,a){a===void 0&&(a=console.log),this.built||this.build(),r.prototype.summary.call(this,t,n,a)},e.prototype.setWeights=function(t){this.model==null&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,n,a){if(a===void 0&&(a={}),!this.built)throw new Ba("The model needs to be compiled before being used.");return this.model.evaluate(t,n,a)},e.prototype.evaluateDataset=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){if(!this.built)throw new Ba("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,n)]})})},e.prototype.predict=function(t,n){return n===void 0&&(n={}),this.model==null&&this.build(),this.model.predict(t,n)},e.prototype.predictOnBatch=function(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,n,a){return a===void 0&&(a={}),ne(this,void 0,void 0,function(){return Zt(this,function(i){if(!this.built)throw new Ba("The model needs to be compiled before being used.");return[2,this.model.fit(t,n,a)]})})},e.prototype.fitDataset=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){if(!this.built)throw new Ba("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,n)]})})},e.prototype.trainOnBatch=function(t,n){return ne(this,void 0,void 0,function(){return Zt(this,function(a){return[2,this.model.trainOnBatch(t,n)]})})},e.fromConfig=function(t,n,a,i){var s;i===void 0&&(i=!1);var u={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new lt("Legacy serialization format not supported yet.");s=n}else At.assert(n.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),s=n.layers,delete n.layers,u=n;var c=new t(u);if(!(c instanceof e))throw new he("Sequential.fromConfig called on non-Sequential input: "+c);for(var f=0,h=s;f<h.length;f++){var d=da(h[f],void 0,i);i&&d.setFastWeightInitDuringBuild(!0),c.add(d)}return c},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(this.model==null)throw new lt("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(this.model==null)throw new lt("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],n=0,a=this.layers;n<a.length;n++){var i=a[n],s={};s.className=i.getClassName(),s.config=i.getConfig(),t.push(s)}return{name:this.name,layers:t}},e.className="Sequential",e})(gs);function dw(r){return new gs(r)}function XD(r){return new pw(r)}function Sd(r,e){return e==null&&(e={}),OP(r,e)}function KD(r){return _D(r)}function kP(r,e){zD.registerCallbackConstructor(r,e)}It.registerClass(pw);var jr=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.getConfig=function(){return{}},e})(It.Serializable),MP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t,n){return n===void 0&&(n=1),oj(t,n)},e.className="elu",e})(jr);It.registerClass(MP);var zP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return Of(t)},e.className="selu",e})(jr);It.registerClass(zP);var FP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return Mi(t)},e.className="relu",e})(jr);It.registerClass(FP);var BP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return ft(function(){return Bs(6,Mi(t))})},e.className="relu6",e})(jr);It.registerClass(BP);var LP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return t},e.className="linear",e})(jr);It.registerClass(LP);var UP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return ol(t)},e.className="sigmoid",e})(jr);It.registerClass(UP);var jP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return uj(t)},e.className="hardSigmoid",e})(jr);It.registerClass(jP);var PP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return sl(t)},e.className="softplus",e})(jr);It.registerClass(PP);var VP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return sj(t)},e.className="softsign",e})(jr);It.registerClass(VP);var qP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t){return cf(t)},e.className="tanh",e})(jr);It.registerClass(qP);var YD=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t,n){return n===void 0&&(n=-1),Ro(t,n)},e.className="softmax",e})(jr);It.registerClass(YD);var WP=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.apply=function(t,n){return n===void 0&&(n=-1),of(t,n)},e.className="logSoftmax",e})(jr);function Ur(r){return r.getClassName()}function t0(r,e){return e===void 0&&(e={}),Bf(r,It.SerializationMap.getMap().classNameMap,e,"activation")}function So(r){var e;return r==null?t0(e={className:"linear",config:{}}):typeof r=="string"?((e={}).className=r,e.config={},t0(e)):r instanceof jr?r:t0(r)}function mw(r){if(r!=null&&typeof r!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+r)}It.registerClass(WP);var $D=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e})(It.Serializable),ev=(function(r){function e(t){var n=r.call(this)||this;return mw(t),n.l1=t==null||t.l1==null?.01:t.l1,n.l2=t==null||t.l2==null?.01:t.l2,n.hasL1=n.l1!==0,n.hasL2=n.l2!==0,n}return Nt(e,r),e.prototype.apply=function(t){var n=this;return ft(function(){var a=Ie([1]);return n.hasL1&&(a=se(a,fr(Jt(n.l1,Ti(t))))),n.hasL2&&(a=se(a,fr(Jt(n.l2,Pf(t))))),a.asScalar()})},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,n){return new t({l1:n.l1,l2:n.l2})},e.className="L1L2",e})($D);function HP(r){return mw(r),new ev({l1:r!=null?r.l1:null,l2:0})}function GP(r){return mw(r),new ev({l2:r!=null?r.l2:null,l1:0})}It.registerClass(ev);var YA={l1l2:"L1L2"};function pe(r){return Qx(r)}function $A(r,e){return e===void 0&&(e={}),Bf(r,It.SerializationMap.getMap().classNameMap,e,"regularizer")}function Je(r){return r==null?null:typeof r=="string"?$A({className:r in YA?YA[r]:r,config:{}}):r instanceof $D?r:$A(r)}var QD=(function(r){function e(t){var n=r.call(this,t??{})||this;return n.supportsMasking=!0,t!=null&&(n.maxValue=t.maxValue),n}return Nt(e,r),e.prototype.call=function(t,n){t=le(t);var a=Mi(t);return this.maxValue!=null&&(a=er(a,0,this.maxValue)),a},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={maxValue:this.maxValue},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="ReLU",e})(we);It.registerClass(QD);var ZD=(function(r){function e(t){var n=r.call(this,t??{})||this;return n.DEFAULT_ALPHA=.3,t==null&&(t={}),n.alpha=t.alpha==null?n.DEFAULT_ALPHA:t.alpha,n}return Nt(e,r),e.prototype.call=function(t,n){var a=le(t);return Rf(a,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={alpha:this.alpha},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="LeakyReLU",e})(we);It.registerClass(ZD);var JD=(function(r){function e(t){var n=r.call(this,t??{})||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),n.supportsMasking=!0,n.alphaInitializer=Ze(t.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=Je(t.alphaRegularizer),n.alphaConstraint=Dn(t.alphaConstraint),t.sharedAxes==null)n.sharedAxes=null;else if(Array.isArray(t.sharedAxes))n.sharedAxes=t.sharedAxes;else{if(typeof t.sharedAxes!="number")throw new lt("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);n.sharedAxes=[t.sharedAxes]}return n}return Nt(e,r),e.prototype.build=function(t){var n=(t=We(t)).slice(1);if(this.sharedAxes!=null)for(var a=0,i=this.sharedAxes;a<i.length;a++)n[(u=i[a])-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var s={};if(this.sharedAxes!=null)for(var u=1;u<t.length;++u)s[u]=t[u];this.inputSpec=[new jn({ndim:t.length,axes:s})],this.built=!0},e.prototype.call=function(t,n){return t=le(t),_f(t,this.alpha.read())},e.prototype.getConfig=function(){var t={alphaInitializer:Te(this.alphaInitializer),alphaRegularizer:pe(this.alphaRegularizer),alphaConstraint:Le(this.alphaConstraint),sharedAxes:this.sharedAxes},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="PReLU",e})(we);It.registerClass(JD);var tI=(function(r){function e(t){var n=r.call(this,t??{})||this;if(n.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==n.DEFAULT_ALPHA)throw new he("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return n.alpha=t.alpha==null?n.DEFAULT_ALPHA:t.alpha,n}return Nt(e,r),e.prototype.call=function(t,n){var a=le(t);return js(a)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={alpha:this.alpha},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="ELU",e})(we);It.registerClass(tI);var eI=(function(r){function e(t){var n=r.call(this,t??{})||this;return n.DEFAULT_THETA=1,t==null&&(t={}),n.theta=t.theta==null?n.DEFAULT_THETA:t.theta,n}return Nt(e,r),e.prototype.call=function(t,n){var a=le(t);return a.mul(Uf(a.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={theta:this.theta},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="ThresholdedReLU",e})(we);It.registerClass(eI);var nI=(function(r){function e(t){var n=r.call(this,t??{})||this;return n.DEFAULT_AXIS=1,t==null&&(t={}),n.softmax=new YD().apply,n.axis=t.axis==null?n.DEFAULT_AXIS:t.axis,n}return Nt(e,r),e.prototype.call=function(t,n){var a=le(t);return this.softmax(a,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={axis:this.axis},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Softmax",e})(we);function e0(r,e,t){if(typeof r=="number")return Ts(r,e);if(r.length!==e)throw new lt("The "+t+" argument must be an integer or tuple of "+e+" integers. Received: "+r.length+" elements.");for(var n=0;n<e;++n){var a=r[n];if(!nj(a))throw new lt("The "+t+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(r)+" including a non-integer number "+a)}return r}function Si(r,e,t,n,a){return a===void 0&&(a=1),r==null?r:(i=t==="same"?r:r-(e+(e-1)*(a-1))+1,Math.floor((i+n-1)/n));var i}function bp(r,e,t,n){if(r==null)return null;if(n==="valid")r=r*e+wo([t-e,0]);else{if(n!=="same")throw new lt("Unsupport padding mode: "+n+".");r*=e}return r}function vw(r,e){return ft(function(){return kn(e),e==="channelsFirst"?Qe(r,[0,2,3,1]):r})}function rI(r,e){return ft(function(){return kn(e),e==="channelsFirst"?Qe(r,[0,2,3,4,1]):r})}function XP(r,e,t,n,a,i,s){return n===void 0&&(n=1),a===void 0&&(a="valid"),s===void 0&&(s=1),ft(function(){if(i==null&&(i=ga()),kn(i),r.shape.length!==3)throw new lt("The input of a conv1dWithBias operation should be 3, but is "+r.shape.length+" instead.");if(e.shape.length!==3)throw new lt("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(t!=null&&t.shape.length!==1)throw new lt("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if(i==="channelsFirst"&&(r=Qe(r,[0,2,1])),a==="causal")throw new he("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=vf(r,e,n,a==="same"?"same":"valid","NWC",s);return t!=null&&(u=Fi(u,t)),u})}function QA(r,e,t,n,a,i,s,u){return n===void 0&&(n=[1,1]),a===void 0&&(a="valid"),u===void 0&&(u=null),ft(function(){if(i==null&&(i=ga()),kn(i),r.rank!==3&&r.rank!==4)throw new lt("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+r.rank+".");if(e.rank!==3&&e.rank!==4)throw new lt("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+r.rank+".");var c=vw(r,i);if(a==="causal")throw new he("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=Ns.conv2d({x:c,filter:e,strides:n,pad:a==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:t,activation:u}),i==="channelsFirst"&&(c=Qe(c,[0,3,1,2])),c})}function KP(r,e,t,n,a,i,s){return n===void 0&&(n=[1,1,1]),a===void 0&&(a="valid"),ft(function(){if(i==null&&(i=ga()),kn(i),r.rank!==4&&r.rank!==5)throw new lt("conv3dWithBias expects input to be of rank 4 or 5, but received "+r.rank+".");if(e.rank!==4&&e.rank!==5)throw new lt("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+r.rank+".");var u=rI(r,i);if(a==="causal")throw new he("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=gf(u,e,n,a==="same"?"same":"valid","NDHWC",s),t!=null&&(u=Fi(u,t)),i==="channelsFirst"&&(u=Qe(u,[0,4,1,2,3])),u})}It.registerClass(nI);var aI=(function(r){function e(t,n){var a=r.call(this,n)||this;if(a.bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(n),a.rank=t,hr(a.rank,"rank"),a.rank!==1&&a.rank!==2&&a.rank!==3)throw new he("Convolution layer for rank other than 1, 2, or 3 ("+a.rank+") is not implemented yet.");if(a.kernelSize=e0(n.kernelSize,t,"kernelSize"),a.strides=e0(n.strides==null?1:n.strides,t,"strides"),a.padding=n.padding==null?"valid":n.padding,na(a.padding),a.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,kn(a.dataFormat),a.activation=So(n.activation),a.useBias=n.useBias==null||n.useBias,a.biasInitializer=Ze(n.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=Dn(n.biasConstraint),a.biasRegularizer=Je(n.biasRegularizer),a.activityRegularizer=Je(n.activityRegularizer),a.dilationRate=e0(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),a.rank===1&&Array.isArray(a.dilationRate)&&a.dilationRate.length!==1)throw new lt("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(a.dilationRate));if(a.rank===2){if(typeof a.dilationRate=="number")a.dilationRate=[a.dilationRate,a.dilationRate];else if(a.dilationRate.length!==2)throw new lt("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(a.dilationRate))}else if(a.rank===3){if(typeof a.dilationRate=="number")a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(a.dilationRate.length!==3)throw new lt("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(a.dilationRate))}return a}return Nt(e,r),e.verifyArgs=function(t){if(Ma("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!Zx(t.kernelSize,"number",1,3))throw new lt("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ur(this.activation),useBias:this.useBias,biasInitializer:Te(this.biasInitializer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),biasConstraint:Le(this.biasConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e})(we),nv=(function(r){function e(t,n){var a=r.call(this,t,n)||this;return a.kernel=null,e.verifyArgs(n),a.filters=n.filters,hr(a.filters,"filters"),a.kernelInitializer=Ze(n.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=Dn(n.kernelConstraint),a.kernelRegularizer=Je(n.kernelRegularizer),a}return Nt(e,r),e.prototype.build=function(t){var n;t=We(t);var a=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[a]==null)throw new lt("The channel dimension of the input should be defined. Found "+t[a]);var i=t[a],s=this.kernelSize.concat([i,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[a]=i,n)}],this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i;t=le(t);var s=a.bias==null?null:a.bias.read(),u=oD(a.activation.getClassName());if(u!=null&&a.rank===2)i=QA(t,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate,u);else{if(a.rank===1)i=XP(t,a.kernel.read(),s,a.strides[0],a.padding,a.dataFormat,a.dilationRate[0]);else if(a.rank===2)i=QA(t,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate);else{if(a.rank!==3)throw new he("convolutions greater than 3D are not implemented yet.");i=KP(t,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate)}a.activation!=null&&(i=a.activation.apply(i))}return i})},e.prototype.computeOutputShape=function(t){t=We(t);for(var n=[],a=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2),i=0;i<a.length;++i){var s=Si(a[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(s)}var u=[t[0]];return this.dataFormat==="channelsLast"?(u=u.concat(n)).push(this.filters):(u.push(this.filters),u=u.concat(n)),u},e.prototype.getConfig=function(){var t={filters:this.filters,kernelInitializer:Te(this.kernelInitializer),kernelRegularizer:pe(this.kernelRegularizer),kernelConstraint:Le(this.kernelConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.verifyArgs=function(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new lt("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e})(aI),gw=(function(r){function e(t){var n=r.call(this,2,t)||this;return e.verifyArgs(t),n}return Nt(e,r),e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return delete t.rank,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&!Zx(t.kernelSize,"number",1,2))throw new lt("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e})(nv);It.registerClass(gw);var iI=(function(r){function e(t){var n=r.call(this,3,t)||this;return e.verifyArgs(t),n}return Nt(e,r),e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return delete t.rank,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&(!Array.isArray(t.kernelSize)||t.kernelSize.length!==1&&t.kernelSize.length!==3))throw new lt("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e})(nv);It.registerClass(iI);var oI=(function(r){function e(t){var n=r.call(this,t)||this;if(n.inputSpec=[new jn({ndim:4})],n.padding!=="same"&&n.padding!=="valid")throw new lt("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return Nt(e,r),e.prototype.build=function(t){var n;if((t=We(t)).length!==4)throw new lt("Input should have rank 4; Received input shape: "+JSON.stringify(t));var a=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[a]==null)throw new lt("The channel dimension of the inputs should be defined. Found `None`.");var i=t[a],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new jn({ndim:4,axes:(n={},n[a]=i,n)})],this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=le(t);if(i.shape.length!==4)throw new lt("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+i.shape.length);var s,u,c=i.shape,f=c[0];a.dataFormat==="channelsFirst"?(s=2,u=3):(s=1,u=2);var h=c[s],d=c[u],m=a.kernelSize[0],g=a.kernelSize[1],y=a.strides[0],x=a.strides[1],w=[f,bp(h,y,m,a.padding),bp(d,x,g,a.padding),a.filters];a.dataFormat!=="channelsLast"&&(i=Qe(i,[0,2,3,1]));var b=yf(i,a.kernel.read(),w,a.strides,a.padding);return a.dataFormat!=="channelsLast"&&(b=Qe(b,[0,3,1,2])),a.bias!=null&&(b=Fi(b,a.bias.read(),a.dataFormat)),a.activation!=null&&(b=a.activation.apply(b)),b})},e.prototype.computeOutputShape=function(t){var n,a,i,s=(t=We(t)).slice();this.dataFormat==="channelsFirst"?(n=1,a=2,i=3):(n=3,a=1,i=2);var u=this.kernelSize[0],c=this.kernelSize[1],f=this.strides[0],h=this.strides[1];return s[n]=this.filters,s[a]=bp(s[a],f,u,this.padding),s[i]=bp(s[i],h,c,this.padding),s},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return delete t.dilationRate,t},e.className="Conv2DTranspose",e})(gw);It.registerClass(oI);var YP=(function(r){function e(t,n){var a=r.call(this,t,n)||this;if(a.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,n.filters==null)throw new lt("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new lt("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new lt("SeparableConv"+a.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return a.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,a.depthwiseInitializer=Ze(n.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Je(n.depthwiseRegularizer),a.depthwiseConstraint=Dn(n.depthwiseConstraint),a.pointwiseInitializer=Ze(n.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Je(n.pointwiseRegularizer),a.pointwiseConstraint=Dn(n.pointwiseConstraint),a}return Nt(e,r),e.prototype.build=function(t){var n;if((t=We(t)).length<this.rank+2)throw new lt("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var a=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[a]==null||t[a]<0)throw new lt("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[a]));for(var i=t[a],s=this.kernelSize.concat([i,this.depthMultiplier]),u=[],c=0;c<this.rank;++c)u.push(1);u.push(i*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",u,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new jn({ndim:this.rank+2,axes:(n={},n[a]=i,n)})],this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i;if(t=le(t),a.rank===1)throw new he("1D separable convolution is not implemented yet.");return a.rank===2&&(a.dataFormat==="channelsFirst"&&(t=Qe(t,[0,2,3,1])),i=_m(t,a.depthwiseKernel.read(),a.pointwiseKernel.read(),a.strides,a.padding,a.dilationRate,"NHWC")),a.useBias&&(i=Fi(i,a.bias.read(),a.dataFormat)),a.activation!=null&&(i=a.activation.apply(i)),a.dataFormat==="channelsFirst"&&(i=Qe(i,[0,3,1,2])),i})},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Te(this.depthwiseInitializer),t.pointwiseInitializer=Te(this.pointwiseInitializer),t.depthwiseRegularizer=pe(this.depthwiseRegularizer),t.pointwiseRegularizer=pe(this.pointwiseRegularizer),t.depthwiseConstraint=Le(this.depthwiseConstraint),t.pointwiseConstraint=Le(this.pointwiseConstraint),t},e.className="SeparableConv",e})(nv),sI=(function(r){function e(t){return r.call(this,2,t)||this}return Nt(e,r),e.className="SeparableConv2D",e})(YP);It.registerClass(sI);var uI=(function(r){function e(t){var n=r.call(this,1,t)||this;return e.verifyArgs(t),n.inputSpec=[{ndim:3}],n}return Nt(e,r),e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return delete t.rank,delete t.dataFormat,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&!Zx(t.kernelSize,"number",1,1))throw new lt("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e})(nv);It.registerClass(uI);var lI=(function(r){function e(t){var n=r.call(this,t)||this;return typeof t.cropping=="number"?n.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?n.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:n.cropping=t.cropping,n.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,n.inputSpec=[{ndim:4}],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,n){var a=this;return ft(function(){return t=le(t),a.dataFormat==="channelsLast"?vp(vp(t,a.cropping[0][0],t.shape[1]-a.cropping[0][0]-a.cropping[0][1],2),a.cropping[1][0],t.shape[2]-a.cropping[1][1]-a.cropping[1][0],3):vp(vp(t,a.cropping[0][0],t.shape[2]-a.cropping[0][0]-a.cropping[0][1],3),a.cropping[1][0],t.shape[3]-a.cropping[1][1]-a.cropping[1][0],4)})},e.prototype.getConfig=function(){var t={cropping:this.cropping,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Cropping2D",e})(we);It.registerClass(lI);var cI=(function(r){function e(t){var n=r.call(this,t)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=t.size==null?n.DEFAULT_SIZE:t.size,n.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,n}return Nt(e,r),e.prototype.computeOutputShape=function(t){if(this.dataFormat==="channelsFirst"){var n=t[2]==null?null:this.size[0]*t[2],a=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,a]}return n=t[1]==null?null:this.size[0]*t[1],a=t[2]==null?null:this.size[1]*t[2],[t[0],n,a,t[3]]},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=le(t),s=i.shape;if(a.dataFormat==="channelsFirst"){i=Qe(i,[0,2,3,1]);var u=a.size[0]*s[2],c=a.size[1]*s[3],f=i.resizeNearestNeighbor([u,c]);return Qe(f,[0,3,1,2])}return u=a.size[0]*s[1],c=a.size[1]*s[2],i.resizeNearestNeighbor([u,c])})},e.prototype.getConfig=function(){var t={size:this.size,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="UpSampling2D",e})(we);function $P(r,e,t,n,a,i){return t===void 0&&(t=[1,1]),n===void 0&&(n="valid"),ft(function(){a==null&&(a=ga()),kn(a);var s=vw(r,a);if(r.rank!==4)throw new lt("Input for depthwiseConv2d is required to be 4-D, but is instead "+r.rank+"-D");if(e.rank!==4)throw new lt("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return s=Us(s,e,t,n==="same"?"same":"valid","NHWC",i),a==="channelsFirst"&&(s=Qe(s,[0,3,1,2])),s})}It.registerClass(cI);var fI=(function(r){function e(t){var n=r.call(this,2,t)||this;return n.depthwiseKernel=null,n.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,n.depthwiseInitializer=Ze(t.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=Dn(t.depthwiseConstraint),n.depthwiseRegularizer=Je(t.depthwiseRegularizer),n}return Nt(e,r),e.prototype.build=function(t){if((t=We(t)).length<4)throw new lt("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new lt("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[n]+").");var a=t[n],i=[this.kernelSize[0],this.kernelSize[1],a,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[a*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=$P(t=le(t),a.depthwiseKernel.read(),a.strides,a.padding,a.dataFormat,null);return a.useBias&&(i=Fi(i,a.bias.read(),a.dataFormat)),a.activation!=null&&(i=a.activation.apply(i)),i})},e.prototype.computeOutputShape=function(t){t=We(t);var n=this.dataFormat==="channelsFirst"?t[2]:t[1],a=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,s=Si(n,this.kernelSize[0],this.padding,this.strides[0]),u=Si(a,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,s,u]:[t[0],s,u,i]},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this);return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Te(this.depthwiseInitializer),t.depthwiseRegularizer=pe(this.depthwiseRegularizer),t.depthwiseConstraint=Le(this.depthwiseRegularizer),t},e.className="DepthwiseConv2D",e})(aI);It.registerClass(fI);var hI=(function(r){function e(t){var n=r.call(this,t)||this;return n.rate=Math.max(Math.min(t.rate,1),0),n.noiseShape=t.noiseShape,n.seed=t.seed,n.supportsMasking=!0,n}return Nt(e,r),e.prototype.getNoiseShape=function(t){if(this.noiseShape==null)return this.noiseShape;for(var n=t.shape,a=[],i=0;i<this.noiseShape.length;++i)a.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return a},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t);if(0<a.rate&&a.rate<1){var s=n.training!=null&&n.training,u=a.getNoiseShape(i);return $u(function(){return yD(i,a.rate,u,a.seed)},function(){return i},s)}return t})},e.prototype.getConfig=function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.prototype.dispose=function(){return r.prototype.dispose.call(this)},e.className="Dropout",e})(we);It.registerClass(hI);var pI=(function(r){function e(t){var n=r.call(this,t)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){var a=null;t.batchSize!=null&&(a=t.batchSize),n.batchInputShape=[a,t.inputDim]}return n.units=t.units,hr(n.units,"units"),n.activation=So(t.activation),t.useBias!=null&&(n.useBias=t.useBias),n.kernelInitializer=Ze(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=Ze(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=Dn(t.kernelConstraint),n.biasConstraint=Dn(t.biasConstraint),n.kernelRegularizer=Je(t.kernelRegularizer),n.biasRegularizer=Je(t.biasRegularizer),n.activityRegularizer=Je(t.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return Nt(e,r),e.prototype.build=function(t){var n,a=(t=We(t))[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[a,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(n={},n[-1]=a,n)}],this.built=!0},e.prototype.computeOutputShape=function(t){var n=(t=We(t)).slice();return n[n.length-1]=this.units,n},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i,s=le(t),u=oD(a.activation.getClassName());return u!=null?i=wi(s,a.kernel.read(),u,a.bias?a.bias.read():null):(i=wi(s,a.kernel.read()),a.bias!=null&&(i=Fi(i,a.bias.read())),a.activation!=null&&(i=a.activation.apply(i))),i})},e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),biasInitializer:Te(this.biasInitializer),kernelRegularizer:pe(this.kernelRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),biasConstraint:Le(this.biasConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Dense",e})(we);It.registerClass(pI);var dI=(function(r){function e(t){var n=r.call(this,t||{})||this;return n.inputSpec=[{minNDim:3}],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){for(var n=0,a=(t=We(t)).slice(1);n<a.length;n++)if(a[n]==null)throw new lt('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],go(t,1)]},e.prototype.call=function(t,n){var a=this;return ft(function(){return a.invokeCallHook(t,n),ij(le(t))})},e.className="Flatten",e})(we);It.registerClass(dI);var mI=(function(r){function e(t){var n=r.call(this,t)||this;return n.supportsMasking=!0,n.activation=So(t.activation),n}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t);return a.activation.apply(i)})},e.prototype.getConfig=function(){var t={activation:Ur(this.activation)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Activation",e})(we);It.registerClass(mI);var vI=(function(r){function e(t){var n=r.call(this,t)||this;return n.n=t.n,n.inputSpec=[{ndim:2}],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,n){var a=this;return ft(function(){return rj(t=le(t),a.n)})},e.prototype.getConfig=function(){var t={n:this.n},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="RepeatVector",e})(we);It.registerClass(vI);var gI=(function(r){function e(t){var n=r.call(this,t)||this;n.targetShape=t.targetShape;for(var a=0;a<n.targetShape.length;++a)n.isUnknown(n.targetShape[a])&&(n.targetShape[a]=null);return n}return Nt(e,r),e.prototype.isUnknown=function(t){return t<0||t==null},e.prototype.fixUnknownDimension=function(t,n){for(var a="Total size of new array must be unchanged.",i=n.slice(),s=1,u=null,c=0;c<i.length;++c){var f=i[c];if(this.isUnknown(f)){if(u!==null)throw new lt("Can only specifiy one unknown dimension.");u=c}else s*=f}var h=go(t);if(u!==null){if(s===0||h%s!=0)throw new lt(a);i[u]=h/s}else if(h!==s)throw new lt(a);return i},e.prototype.computeOutputShape=function(t){for(var n=!1,a=0;a<t.length;++a)if(this.isUnknown(t[a])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t),s=i.shape,u=s.slice(0,1).concat(a.fixUnknownDimension(s.slice(1),a.targetShape));return i.reshape(u)})},e.prototype.getConfig=function(){var t={targetShape:this.targetShape},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Reshape",e})(we);It.registerClass(gI);var yI=(function(r){function e(t){var n=r.call(this,t)||this;if(t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");var a=ya(1,t.dims.length+1);if(!At.arraysEqual(t.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=t.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new jn({ndim:n.dims.length+1})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){var n=(t=We(t)).slice();return this.dims.forEach(function(a,i){n[i+1]=t[a]}),n},e.prototype.call=function(t,n){return Qe(le(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var t={dims:this.dims},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Permute",e})(we);It.registerClass(yI);var bI=(function(r){function e(t){var n=r.call(this,t??{})||this;return n.supportsMasking=!0,n.maskValue=t!=null?t.maskValue==null?0:t.maskValue:0,n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,t),n},e.prototype.computeMask=function(t,n){var a=le(t);return Ku(Es(a,this.maskValue),-1)},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t),s=Ku(Es(i,a.maskValue),-1,!0);return i.mul(s.asType(i.dtype))})},e.className="Masking",e})(we);It.registerClass(bI);var xI=(function(r){function e(t){var n=r.call(this,t)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){var a=null;t.batchSize!=null&&(a=t.batchSize),t.inputLength==null?n.batchInputShape=[a,null]:n.batchInputShape=[a].concat(Ge(t.inputLength))}return n.inputDim=t.inputDim,hr(n.inputDim,"inputDim"),n.outputDim=t.outputDim,hr(n.outputDim,"outputDim"),n.embeddingsInitializer=Ze(t.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=Je(t.embeddingsRegularizer),n.activityRegularizer=Je(t.activityRegularizer),n.embeddingsConstraint=Dn(t.embeddingsConstraint),n.maskZero=t.maskZero,n.supportsMasking=t.maskZero,n.inputLength=t.inputLength,n}return Nt(e,r),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,n){var a=this;return ft(function(){return a.maskZero?(t=le(t),Es(t,ye(t))):null})},e.prototype.computeOutputShape=function(t){if(t=We(t),this.inputLength==null)return t.concat([this.outputDim]);var n=Ge(this.inputLength);if(n.length!==t.length-1)throw new lt('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var a=0,i=0;i<n.length;++i){var s=n[i],u=t[i+1];if(s!=null&&u!=null&&s!==u)throw new lt('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);s==null&&(n[a]=u),a++}return[t[0]].concat(n,[this.outputDim])},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t);return i.dtype!=="int32"&&(i=Uf(i,"int32")),gD(a.embeddings.read(),i.as1D()).reshape(We(a.computeOutputShape(i.shape)))})},e.prototype.getConfig=function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Te(this.embeddingsInitializer),embeddingsRegularizer:pe(this.embeddingsRegularizer),activityRegularizer:pe(this.activityRegularizer),embeddingsConstraint:Le(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Embedding",e})(we);It.registerClass(xI);var Vs=(function(r){function e(t){var n=r.call(this,t||{})||this;return n.supportsMasking=!0,n}return Nt(e,r),e.prototype.mergeFunction=function(t){throw new he},e.prototype.computeElementwiseOpOutputShape=function(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;for(var a=t.slice(0,t.length-n.length),i=0;i<n.length;++i){var s=t[t.length-n.length+i],u=n[i];if(s==null||u==null||s<0||u<0)a.push(null);else if(s===1)a.push(u);else if(u===1)a.push(s);else{if(s!==u)throw new lt("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));a.push(s)}}return a},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[We(t)]),(t=t).length<2)throw new lt("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var n=[],a=0,i=t;a<i.length;a++)(c=i[a])!=null&&c[0]!==null&&n.push(c[0]);if((n=vo(n)).length>1)throw new lt("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var s=t[0]==null?null:t[0].slice(1),u=1;u<t.length;++u){var c=t[u]==null?null:t[u].slice(1);s=this.computeElementwiseOpOutputShape(s,c)}var f=t.map(function(h){return h.length});t.indexOf(null)===-1&&vo(f).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){if(t=t,a.reshapeRequired){var i=[],s=t.map(function(O){return O.rank});if(s.indexOf(null)===-1){for(var u=wo(s),c=0,f=t;c<f.length;c++){for(var h=(x=f[c]).rank,d=0;d<u-h;++d)x=jf(x,1);i.push(x)}return a.mergeFunction(i)}for(var m=!1,g=0,y=t;g<y.length;g++){var x;if((h=(x=y[g]).rank)==null){var w=x.shape,b=w[0],C=w.slice(1).concat([b]),A=x.reshape([b].concat(go(w.slice(1))));A=(A=Qe(A,[1,0])).reshape(C),i.push(A),m=!0}else if(h>1){var T=ya(1,h).concat([0]);i.push(Qe(x,T)),m=!0}else i.push(x)}var R=a.mergeFunction(i),D=R.rank;if(m)if(D==null){var N=R.shape;C=[b=N[N.length-1]].concat(N.slice(0,N.length-1)),R=Qe(R.reshape([-1,b]),[1,0]).reshape(C)}else D>1&&(T=[D-1].concat(ya(0,D-1)),R=Qe(R,T));return R}return a.mergeFunction(t)})},e.prototype.computeOutputShape=function(t){var n;n=(t=t)[0]==null?null:t[0].slice(1);for(var a=1;a<t.length;++a){var i=t[a]==null?null:t[a].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}for(var s=[],u=0,c=t;u<c.length;u++)(i=c[u])!=null&&i[0]!==null&&s.push(i[0]);return n=(s=vo(s)).length===1?s.concat(n):[null].concat(n)},e.prototype.computeMask=function(t,n){return ft(function(){if(n==null)return null;if(!Array.isArray(n))throw new lt("`mask` should be an Array");if(!Array.isArray(t))throw new lt("`inputs` should be an Array");if(n.length!==t.length)throw new lt("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+n.length+")");if(n.every(function(s){return s==null}))return null;for(var a=(n=n.map(function(s){return s==null?s:Qn(s,0)}))[0],i=1;i<n.length-1;++i)a=Ga(a,n[i]);return a})},e})(we),wI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.mergeFunction=function(t){return ft(function(){for(var n=t[0].clone(),a=1;a<t.length;++a)n=se(n,t[a]);return n})},e.className="Add",e})(Vs);It.registerClass(wI);var SI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.mergeFunction=function(t){return ft(function(){for(var n=t[0].clone(),a=1;a<t.length;++a)n=Jt(n,t[a]);return n})},e.className="Multiply",e})(Vs);It.registerClass(SI);var EI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.mergeFunction=function(t){return ft(function(){for(var n=t[0].clone(),a=1;a<t.length;++a)n=se(n,t[a]);return Jt(1/t.length,n)})},e.className="Average",e})(Vs);It.registerClass(EI);var CI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.mergeFunction=function(t){return ft(function(){for(var n=t[0],a=1;a<t.length;++a)n=Ca(n,t[a]);return n})},e.className="Maximum",e})(Vs);It.registerClass(CI);var AI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.mergeFunction=function(t){return ft(function(){for(var n=t[0],a=1;a<t.length;++a)n=Bs(n,t[a]);return n})},e.className="Minimum",e})(Vs);It.registerClass(AI);var NI=(function(r){function e(t){var n=r.call(this,t)||this;return n.DEFAULT_AXIS=-1,t==null&&(t={}),n.axis=t.axis==null?n.DEFAULT_AXIS:t.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Nt(e,r),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||t.length===1)throw new lt("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var n=!0,a=0,i=t=t;a<i.length;a++)if((m=i[a])!=null){n=!1;break}if(!n){for(var s=[],u=0;u<t.length;++u){var c=t[u].slice();c.splice(this.axis,1);for(var f=!1,h=0,d=s;h<d.length;h++){var m=d[h];if(At.arraysEqual(m,c)){f=!0;break}}f||s.push(c)}if(s.length>1)throw new lt("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var n=this;return ft(function(){return vD(t,n.axis)})},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new lt("A `Concatenate` layer should be called on a list of inputs.");for(var n=t,a=n[0].slice(),i=this.axis<0?a.length+this.axis:this.axis,s=0,u=n.slice(1);s<u.length;s++){var c=u[s];if(a[i]==null||c[i]==null){a[i]=null;break}a[i]+=c[i]}return a},e.prototype.computeMask=function(t,n){var a=this;if(n==null)return null;if(!Array.isArray(n))throw new lt("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new lt("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new lt("Mismatch in the length of mask ("+n.length+") and the legnth of inputs ("+t.length+")");return ft(function(){var i=!0;if(n.forEach(function(f){f==null||(i=!1)}),i)return null;for(var s=[],u=0;u<t.length;++u)n[u]==null?s.push(Er(t[u]).asType("bool")):n[u].rank<t[u].rank?s.push(Qn(n[u],-1)):s.push(n[u]);var c=Vn(s,a.axis);return Af(c,-1,!1)})},e.prototype.getConfig=function(){var t={axis:this.axis},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Concatenate",e})(Vs);function mc(r,e){for(;r<0;)r+=e;return r}function QP(r,e,t){if(r.shape.length>3||e.shape.length>3)throw new he("batchDot is not implemented for tensors of 4D or higher rank yet");if(At.assert(r.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+r.shape.length}),At.assert(r.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length}),typeof t=="number"&&(t=[t,t]),r.dtype==="complex64"||e.dtype==="complex64")throw new he("batchDot is not implemented for complex64-type Tensors yet.");var n=r.shape.length,a=e.shape.length;t==null&&(t=[n-1,a-2]);var i=t;return ft(function(){var s,u;if(n>a){s=n-a;for(var c=[],f=0;f<s;++f)c.push(1);e=e.reshape(e.shape.concat(c))}else if(a>n){for(s=a-n,c=[],f=0;f<s;++f)c.push(1);r=r.reshape(r.shape.concat(c))}else s=0;if(r.shape.length===2&&e.shape.length===2)u=i[0]===i[1]?r.mulStrict(e).sum(i[0]):r.transpose([1,0]).mulStrict(e).sum(i[1]);else{var h=i[0]!==r.shape.length-1,d=i[1]===e.shape.length-1;u=r.matMul(e,h,d)}if(s>0){var m=void 0,g=[];for(f=m=n>a?n+a-3:n-1;f<m+s;++f)g.push(f);u=u.squeeze(g)}return u.shape.length===1&&(u=u.expandDims(1)),u})}It.registerClass(NI);var TI=(function(r){function e(t){var n=r.call(this,t)||this;return n.axes=t.axes,n.normalize=t.normalize!=null&&t.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Nt(e,r),e.prototype.build=function(t){At.assert(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var n=t[0],a=t[1];if(n.length>3||a.length>3)throw new he("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(n,a);if(n[i[0]]!==a[i[1]])throw new lt("Dimension incompatibility: "+n[i[0]]+" !== "+a[i[1]])},e.prototype.mergeFunction=function(t){if(t.length!==2)throw new lt("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var n,a=t[0],i=t[1];return n=Array.isArray(this.axes)?this.axes.map(function(s,u){return mc(s,t[u].shape.length)}):[mc(this.axes,a.shape.length),mc(this.axes,i.shape.length)],this.normalize&&(a=gd(a,n[0]),i=gd(i,n[1])),QP(a,i,n)},e.prototype.interpretAxes=function(t,n){return Array.isArray(this.axes)?this.axes:[mc(this.axes,t.length),mc(this.axes,n.length)]},e.prototype.computeOutputShape=function(t){At.assert(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var n=t[0].slice(),a=t[1].slice();if(n.length>3||a.length>3)throw new he("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(n,a);n.splice(i[0],1),a.splice(i[1],1),a.splice(0,1);var s=n.concat(a);return s.length===1&&s.push(1),s},e.prototype.computeMask=function(t,n){return null},e.prototype.getConfig=function(){var t={axes:this.axes,normalize:this.normalize},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="Dot",e})(Vs);It.registerClass(TI);var RI=(function(r){function e(t){var n=r.call(this,t)||this;return n.supportsMasking=!0,n.stddev=t.stddev,n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,t),n},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t);return $u(function(){return Ym(i.shape,0,a.stddev).add(i)},function(){return i},n.training||!1)})},e.className="GaussianNoise",e})(we);It.registerClass(RI);var _I=(function(r){function e(t){var n=r.call(this,t)||this;return n.supportsMasking=!0,n.rate=t.rate,n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,t),n},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n);var i=le(t);return a.rate>0&&a.rate<1?$u(function(){var s=Math.sqrt(a.rate/(1-a.rate));return i.mul(Ym(i.shape,1,s))},function(){return i},n.training||!1):i})},e.className="GaussianDropout",e})(we);It.registerClass(_I);var OI=(function(r){function e(t){var n=r.call(this,t)||this;return n.supportsMasking=!0,n.rate=t.rate,n.noiseShape=t.noiseShape,n}return Nt(e,r),e.prototype._getNoiseShape=function(t){return this.noiseShape||le(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=r.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,t),n},e.prototype.call=function(t,n){var a=this;return ft(function(){if(a.rate<1&&a.rate>0){var i=a._getNoiseShape(t);return $u(function(){var s=le(t),u=-1.7580993408473766,c=ul(To(i),a.rate);c=Uf(c,"float32");var f=Math.pow((1-a.rate)*(1+a.rate*Math.pow(u,2)),-.5),h=-f*u*a.rate;return s.mul(c).add(c.add(-1).mul(u)).mul(f).add(h)},function(){return le(t)},n.training||!1)}return t})},e.className="AlphaDropout",e})(we);function Wc(r,e,t,n,a,i){var s;if(i===void 0&&(i=.001),r.rank===2)s=ym(r,e,t,n,a,i);else if(r.rank===3)s=bm(r,e,t,n,a,i);else{if(r.rank!==4)throw new he("batchNormalization is not implemented for array of rank "+r.rank+" yet");s=xm(r,e,t,n,a,i)}return s}function ZP(r,e,t,n,a){return a===void 0&&(a=.001),ft(function(){var i=ko(r,n),s=i.mean,u=i.variance;return[Wc(r,s,u,t,e,a),s,u]})}function JP(r,e,t,n,a){return a===void 0&&(a=.001),ft(function(){for(var i=ko(r,n),s=i.mean,u=i.variance,c=[],f=0,h=ya(0,r.rank);f<h.length;f++){var d=h[f];n.indexOf(d)!==-1?c.push(1):c.push(r.shape[d])}var m=s.reshape(c),g=u.reshape(c),y=e==null?null:e.reshape(c),x=t==null?null:t.reshape(c);return[Wc(r,m,g,x,y,a),s,u]})}function t6(r,e,t,n,a){return a===void 0&&(a=.001),At.arraysEqual(n.slice().sort(),ya(0,r.rank-1))?ZP(r,e,t,n,a):JP(r,e,t,n,a)}It.registerClass(OI);var DI=(function(r){function e(t){var n=this;return t==null&&(t={}),(n=r.call(this,t)||this).supportsMasking=!0,n.axis=t.axis==null?-1:t.axis,n.momentum=t.momentum==null?.99:t.momentum,n.epsilon=t.epsilon==null?.001:t.epsilon,n.center=t.center==null||t.center,n.scale=t.scale==null||t.scale,n.betaInitializer=Ze(t.betaInitializer||"zeros"),n.gammaInitializer=Ze(t.gammaInitializer||"ones"),n.movingMeanInitializer=Ze(t.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=Ze(t.movingVarianceInitializer||"ones"),n.betaConstraint=Dn(t.betaConstraint),n.gammaConstraint=Dn(t.gammaConstraint),n.betaRegularizer=Je(t.betaRegularizer),n.gammaRegularizer=Je(t.gammaRegularizer),n}return Nt(e,r),e.prototype.build=function(t){var n;t=We(t);var a=this.axis>=0?this.axis:this.axis+t.length,i=t[a];if(i==null)throw new lt("Axis "+a+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new jn({ndim:t.length,axes:(n={},n[a]=i,n)})];var s=[i];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=n.training!=null&&n.training,s=le(t),u=s.shape,c=u.length,f=ya(0,c),h=a.axis>=0?a.axis:a.axis+c;f.splice(h,1);var d=Ts(1,c);d[h]=u[h];var m=f.slice();m.sort();var g=!At.arraysEqual(m,ya(0,c).slice(0,c-1));if(!i)return(function(){if(g){var A=a.movingMean.read().reshape(d),T=a.movingVariance.read().reshape(d),R=a.center?a.beta.read().reshape(d):null,D=a.scale?a.gamma.read().reshape(d):null;return Wc(s,A,T,R,D,a.epsilon)}return Wc(s,a.movingMean.read(),a.movingVariance.read(),a.beta==null?null:a.beta.read(),a.gamma==null?null:a.gamma.read(),a.epsilon)})();var y=t6(s,a.gamma.read(),a.beta.read(),f,a.epsilon),x=y[0],w=y[1],b=y[2],C=function(A,T,R){ft(function(){var D=1-R,N=A.read(),O=N.sub(T).mul(D);A.write(N.sub(O))})};return C(a.movingMean,w,a.momentum),C(a.movingVariance,b,a.momentum),x})},e.prototype.getConfig=function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Te(this.betaInitializer),gammaInitializer:Te(this.gammaInitializer),movingMeanInitializer:Te(this.movingMeanInitializer),movingVarianceInitializer:Te(this.movingVarianceInitializer),betaRegularizer:pe(this.betaRegularizer),gammaRegularizer:pe(this.gammaRegularizer),betaConstraint:Le(this.betaConstraint),gammaConstraint:Le(this.gammaConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="BatchNormalization",e})(we);It.registerClass(DI);var II=(function(r){function e(t){var n=this;if(t==null&&(t={}),(n=r.call(this,t)||this).axis=t.axis==null?-1:t.axis,typeof n.axis=="number"){if(!Number.isInteger(n.axis))throw new Error("Expected axis to be an integer, but received "+n.axis)}else{if(!Array.isArray(n.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(n.axis));for(var a=0,i=n.axis;a<i.length;a++){var s=i[a];if(!Number.isInteger(s))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(n.axis))}}return n.epsilon=t.epsilon==null?.001:t.epsilon,n.center=t.center==null||t.center,n.scale=t.scale==null||t.scale,n.betaInitializer=Ze(t.betaInitializer||"zeros"),n.gammaInitializer=Ze(t.gammaInitializer||"ones"),n.betaRegularizer=Je(t.betaRegularizer),n.gammaRegularizer=Je(t.gammaRegularizer),n.supportsMasking=!0,n}return Nt(e,r),e.prototype.build=function(t){var n=(t=We(t)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(var i=0,s=this.axis;i<s.length;i++){var u=s[i];if(u<0||u>=n)throw new Error("Invalid axis: "+u)}if(this.axis.length!==vo(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var c=this.axis.map(function(f){return t[f]});this.scale?this.gamma=this.addWeight("gamma",c,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",c,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},e.prototype.call=function(t,n){var a=this,i=le(t),s=i.shape,u=s.length;return ft(function(){for(var c=ko(i,a.axis,!0),f=c.mean,h=c.variance,d=Ts(1,u),m=0,g=a.axis;m<g.length;m++){var y=g[m];d[y]=s[y]}for(var x=function(R){return R!=null&&R.shape.length!==u&&a.axis!==[u-1]?R.reshape(d):R},w=x(a.gamma.read()),b=x(a.beta.read()),C=[],A=[],T=0;T<u;++T)a.axis.indexOf(T)!==-1?(C.push(s[T]),A.push(1)):(C.push(1),A.push(s[T]));return f=f.tile(C),h=h.tile(C),w=w.tile(A),b=b.tile(A),Wc(i,f,h,b,w,a.epsilon)})},e.prototype.getConfig=function(){var t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Te(this.betaInitializer),gammaInitializer:Te(this.gammaInitializer),betaRegularizer:pe(this.betaRegularizer),gammaRegularizer:pe(this.gammaRegularizer)},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="LayerNormalization",e})(we);function e6(r,e,t){return ft(function(){if(r.rank!==4)throw new lt("temporalPadding expects input tensor to be 4-D, but received a "+r.rank+"-D tensor.");if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new lt("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=ga()),t!=="channelsLast"&&t!=="channelsFirst")throw new lt("Unknown data format: "+t+". Supported data formats are 'channelsLast' and 'channelsFirst.");var n;return n=t==="channelsFirst"?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],ki(r,n)})}It.registerClass(II);var kI=(function(r){function e(t){var n=this;if(t==null&&(t={}),(n=r.call(this,t)||this).dataFormat=t.dataFormat==null?ga():t.dataFormat,t.padding==null)n.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")n.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new lt("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var a=void 0,i=void 0;if(typeof t.padding[0]=="number")a=[t.padding[0],t.padding[0]],i=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new lt("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(a=t.padding[0],t.padding[1].length!==2)throw new lt("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");i=t.padding[1]}n.padding=[a,i]}return n.inputSpec=[new jn({ndim:4})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){var n,a;return t=We(t),this.dataFormat==="channelsFirst"?(n=t[2]!=null&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,a=t[3]!=null&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],n,a]):(n=t[1]!=null&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,a=t[2]!=null&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],n,a,t[3]])},e.prototype.call=function(t,n){var a=this;return ft(function(){return e6(le(t),a.padding,a.dataFormat)})},e.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="ZeroPadding2D",e})(we);function rv(r,e,t,n,a,i){return ft(function(){var s;kn(a),fD(i),na(n),t==null&&(t=[1,1]),n==null&&(n="valid"),a==null&&(a=ga()),i==null&&(i="max"),r=vw(r,a);var u=n==="same"?"same":"valid";return s=i==="max"?xf(r,e,t,u):wf(r,e,t,u),a==="channelsFirst"&&(s=Qe(s,[0,3,1,2])),s})}function MI(r,e,t,n,a,i){return ft(function(){var s;kn(a),fD(i),na(n),t==null&&(t=[1,1,1]),n==null&&(n="valid"),a==null&&(a=ga()),i==null&&(i="max"),r=rI(r,a);var u=n==="same"?"same":"valid";return s=i==="max"?Sf(r,e,t,u):Ef(r,e,t,u),a==="channelsFirst"&&(s=Qe(s,[0,4,1,2,3])),s})}It.registerClass(kI);var zI=(function(r){function e(t){var n=this;if(t.poolSize==null&&(t.poolSize=2),n=r.call(this,t)||this,typeof t.poolSize=="number")n.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||t.poolSize.length!==1||typeof t.poolSize[0]!="number")throw new lt("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));n.poolSize=t.poolSize}if(hr(n.poolSize,"poolSize"),t.strides==null)n.strides=n.poolSize;else if(typeof t.strides=="number")n.strides=[t.strides];else{if(!Array.isArray(t.strides)||t.strides.length!==1||typeof t.strides[0]!="number")throw new lt("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));n.strides=t.strides}return hr(n.strides,"strides"),n.padding=t.padding==null?"valid":t.padding,na(n.padding),n.inputSpec=[new jn({ndim:3})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){var n=Si((t=We(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]},e.prototype.call=function(t,n){var a=this;return ft(function(){a.invokeCallHook(t,n),t=jf(le(t),2);var i=a.poolingFunction(le(t),[a.poolSize[0],1],[a.strides[0],1],a.padding,"channelsLast");return Ai(i,[2])})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e})(we),FI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),rv(t,n,a,i,s,"max")},e.className="MaxPooling1D",e})(zI);It.registerClass(FI);var BI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),rv(t,n,a,i,s,"avg")},e.className="AveragePooling1D",e})(zI);It.registerClass(BI);var LI=(function(r){function e(t){var n=this;if(t.poolSize==null&&(t.poolSize=[2,2]),(n=r.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)n.strides=n.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new lt("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");n.strides=t.strides}else n.strides=[t.strides,t.strides];return hr(n.poolSize,"poolSize"),hr(n.strides,"strides"),n.padding=t.padding==null?"valid":t.padding,n.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,kn(n.dataFormat),na(n.padding),n.inputSpec=[new jn({ndim:4})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){t=We(t);var n=this.dataFormat==="channelsFirst"?t[2]:t[1],a=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Si(n,this.poolSize[0],this.padding,this.strides[0]),a=Si(a,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,a]:[t[0],n,a,t[3]]},e.prototype.call=function(t,n){var a=this;return ft(function(){return a.invokeCallHook(t,n),a.poolingFunction(le(t),a.poolSize,a.strides,a.padding,a.dataFormat)})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e})(we),UI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),rv(t,n,a,i,s,"max")},e.className="MaxPooling2D",e})(LI);It.registerClass(UI);var jI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),rv(t,n,a,i,s,"avg")},e.className="AveragePooling2D",e})(LI);It.registerClass(jI);var PI=(function(r){function e(t){var n=this;if(t.poolSize==null&&(t.poolSize=[2,2,2]),(n=r.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)n.strides=n.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new lt("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");n.strides=t.strides}else n.strides=[t.strides,t.strides,t.strides];return hr(n.poolSize,"poolSize"),hr(n.strides,"strides"),n.padding=t.padding==null?"valid":t.padding,n.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,kn(n.dataFormat),na(n.padding),n.inputSpec=[new jn({ndim:5})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){t=We(t);var n=this.dataFormat==="channelsFirst"?t[2]:t[1],a=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Si(n,this.poolSize[0],this.padding,this.strides[0]),a=Si(a,this.poolSize[1],this.padding,this.strides[1]),i=Si(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,a,i]:[t[0],n,a,i,t[4]]},e.prototype.call=function(t,n){var a=this;return ft(function(){return a.invokeCallHook(t,n),a.poolingFunction(le(t),a.poolSize,a.strides,a.padding,a.dataFormat)})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e})(we),VI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),MI(t,n,a,i,s,"max")},e.className="MaxPooling3D",e})(PI);It.registerClass(VI);var qI=(function(r){function e(t){return r.call(this,t)||this}return Nt(e,r),e.prototype.poolingFunction=function(t,n,a,i,s){return kn(s),na(i),MI(t,n,a,i,s,"avg")},e.className="AveragePooling3D",e})(PI);It.registerClass(qI);var WI=(function(r){function e(t){var n=r.call(this,t)||this;return n.inputSpec=[new jn({ndim:3})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,n){throw new he},e})(we),HI=(function(r){function e(t){return r.call(this,t||{})||this}return Nt(e,r),e.prototype.call=function(t,n){return ft(function(){var a=le(t);return un(a,1)})},e.className="GlobalAveragePooling1D",e})(WI);It.registerClass(HI);var GI=(function(r){function e(t){return r.call(this,t||{})||this}return Nt(e,r),e.prototype.call=function(t,n){return ft(function(){var a=le(t);return Wa(a,1)})},e.className="GlobalMaxPooling1D",e})(WI);It.registerClass(GI);var XI=(function(r){function e(t){var n=r.call(this,t)||this;return n.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,kn(n.dataFormat),n.inputSpec=[new jn({ndim:4})],n}return Nt(e,r),e.prototype.computeOutputShape=function(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,n){throw new he},e.prototype.getConfig=function(){var t={dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e})(we),KI=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){var i=le(t);return a.dataFormat==="channelsLast"?un(i,[1,2]):un(i,[2,3])})},e.className="GlobalAveragePooling2D",e})(XI);It.registerClass(KI);var YI=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){var i=le(t);return a.dataFormat==="channelsLast"?Wa(i,[1,2]):Wa(i,[2,3])})},e.className="GlobalMaxPooling2D",e})(XI);function $I(r,e,t,n){if(Array.isArray(r)){if(e!=null||t!=null)throw new lt("When inputs is an array, neither initialState or constants should be provided");n!=null&&(t=r.slice(r.length-n,r.length),r=r.slice(0,r.length-n)),r.length>1&&(e=r.slice(1,r.length)),r=r[0]}function a(i){return i==null||Array.isArray(i)?i:[i]}return{inputs:r,initialState:e=a(e),constants:t=a(t)}}function QI(r,e,t,n,a,i,s,u){return n===void 0&&(n=!1),s===void 0&&(s=!1),u===void 0&&(u=!1),ft(function(){var c=e.shape.length;if(c<3)throw new lt("Input should be at least 3D, but is "+c+"D.");var f=[1,0].concat(ya(2,c));e=Qe(e,f),i!=null,s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&((a=a.asType("bool").asType("float32")).rank===c-1&&(a=Qn(a,-1)),a=Qe(a,f)),n&&(e=va(e,0),a!=null&&(a=va(a,0)));var h,d,m=[],g=t,y=e.shape[0],x=Ni(e);a!=null&&(d=Ni(a));for(var w,b=function(A){var T=x[A],R=ft(function(){return r(T,g)});if(a==null)h=R[0],g=R[1];else{var D=ft(function(){var N=d[A],O=Er(N).sub(N);return{output:R[0].mul(N).addStrict(g[0].mul(O)),newStates:g.map(function(k,z){return R[1][z].mul(N).addStrict(k.mul(O))})}});h=D.output,g=D.newStates}u&&m.push(h)},C=0;C<y;++C)b(C);return u&&(w=Lr(m,1)),[h,w,g]})}It.registerClass(YI);var qs=(function(r){function e(t){var n,a=r.call(this,t)||this;if(t.cell==null)throw new lt("cell property is missing for the constructor of RNN.");if((n=Array.isArray(t.cell)?new ww({cells:t.cell}):t.cell).stateSize==null)throw new lt("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return a.cell=n,a.returnSequences=t.returnSequences!=null&&t.returnSequences,a.returnState=t.returnState!=null&&t.returnState,a.goBackwards=t.goBackwards!=null&&t.goBackwards,a._stateful=t.stateful!=null&&t.stateful,a.unroll=t.unroll!=null&&t.unroll,a.supportsMasking=!0,a.inputSpec=[new jn({ndim:3})],a.stateSpec=null,a.states_=null,a.numConstants=null,a.keptStates=[],a}return Nt(e,r),e.prototype.getStates=function(){return this.states_==null?ya(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(t){return null}):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){qb(t)&&(t=t[0]),t=t;var n=this.cell.stateSize;Array.isArray(n)||(n=[n]);var a,i=n[0];if(a=this.returnSequences?[t[0],t[1],i]:[t[0],i],this.returnState){for(var s=[],u=0,c=n;u<c.length;u++){var f=c[u];s.push([t[0],f])}return[a].concat(s)}return a},e.prototype.computeMask=function(t,n){var a=this;return ft(function(){Array.isArray(n)&&(n=n[0]);var i=a.returnSequences?n:null;if(a.returnState){var s=a.states.map(function(u){return null});return[i].concat(s)}return i})},Object.defineProperty(e.prototype,"states",{get:function(){if(this.states_==null){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[],a=0;a<t;++a)n.push(null);return n}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(this.numConstants!=null)throw new he("Constants support is not implemented in RNN yet.");qb(t)&&(t=t[0]),t=t;var n=this.stateful?t[0]:null,a=t[t.length-1];this.inputSpec[0]=new jn({shape:[n,null,a]});var i,s=[t[0]].concat(t.slice(2));if(this.cell.build(s),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!At.arraysEqual(this.stateSpec.map(function(u){return u.shape[u.shape.length-1]}),i))throw new lt("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=i.map(function(u){return new jn({shape:[null,u]})});this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,n){var a=this;n===void 0&&(n=!1),ft(function(){if(!a.stateful)throw new is("Cannot call resetStates() on an RNN Layer that is not stateful.");var i=a.inputSpec[0].shape[0];if(i==null)throw new lt("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(a.states_==null)Array.isArray(a.cell.stateSize)?a.states_=a.cell.stateSize.map(function(h){return Ie([i,h])}):a.states_=[Ie([i,a.cell.stateSize])];else if(t==null)re(a.states_),a.keptStates!=null&&(re(a.keptStates),a.keptStates=[]),Array.isArray(a.cell.stateSize)?a.states_=a.cell.stateSize.map(function(h){return Ie([i,h])}):a.states_[0]=Ie([i,a.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==a.states_.length)throw new lt("Layer "+a.name+" expects "+a.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);n===!0?a.keptStates.push(a.states_.slice()):re(a.states_);for(var s=0;s<a.states_.length;++s){var u=t[s],c=Array.isArray(a.cell.stateSize)?a.cell.stateSize[s]:a.cell.stateSize,f=[i,c];if(!At.arraysEqual(u.shape,f))throw new lt("State "+s+" is incompatible with layer "+a.name+": expected shape="+f+", received shape="+u.shape);a.states_[s]=u}}a.states_=a.states_.map(function(h){return ma(h.clone())})})},e.prototype.apply=function(t,n){var a=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});var s=$I(t,a,i,this.numConstants);t=s.inputs,a=s.initialState,i=s.constants;var u=[],c=[];if(a!=null){n.initialState=a,u=u.concat(a),this.stateSpec=[];for(var f=0,h=a;f<h.length;f++){var d=h[f];this.stateSpec.push(new jn({shape:d.shape}))}c=c.concat(this.stateSpec)}if(i!=null&&(n.constants=i,u=u.concat(i),this.numConstants=i.length),u[0]instanceof ha){var m=[t].concat(u),g=this.inputSpec.concat(c),y=this.inputSpec;this.inputSpec=g;var x=r.prototype.apply.call(this,m,n);return this.inputSpec=y,x}return r.prototype.apply.call(this,t,n)},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=n==null?null:n.mask,s=n==null?null:n.training,u=n==null?null:n.initialState;t=le(t),u==null&&(u=a.stateful?a.states_:a.getInitialState(t));var c=Array.isArray(a.cell.stateSize)?a.cell.stateSize.length:1;if(u.length!==c)throw new lt("RNN Layer has "+c+" state(s) but was passed "+u.length+" initial state(s).");a.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var f={training:s},h=QI(function(x,w){var b=a.cell.call([x].concat(w),f);return[b[0],b.slice(1)]},t,u,a.goBackwards,i,null,a.unroll,a.returnSequences),d=h[0],m=h[1],g=h[2];a.stateful&&a.resetStates(g,s);var y=a.returnSequences?m:d;return a.returnState?[y].concat(g):y})},e.prototype.getInitialState=function(t){var n=this;return ft(function(){var a=Ie(t.shape);return a=jf(a=fr(a,[1,2])),Array.isArray(n.cell.stateSize)?n.cell.stateSize.map(function(i){return i>1?Pb(a,[1,i]):a}):n.cell.stateSize>1?[Pb(a,[1,n.cell.stateSize])]:[a]})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(t){r.prototype.setFastWeightInitDuringBuild.call(this,t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)},e.prototype.getConfig=function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);var n=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:n};var a=r.prototype.getConfig.call(this);return Object.assign(t,a),t},e.fromConfig=function(t,n,a){a===void 0&&(a={});var i=da(n.cell,a);return new t(Object.assign(n,{cell:i}))},e.className="RNN",e})(we);It.registerClass(qs);var qf=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Nt(e,r),e})(we),yw=(function(r){function e(t){var n=r.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,hr(n.units,"units"),n.activation=So(t.activation==null?n.DEFAULT_ACTIVATION:t.activation),n.useBias=t.useBias==null||t.useBias,n.kernelInitializer=Ze(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Ze(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Ze(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Je(t.kernelRegularizer),n.recurrentRegularizer=Je(t.recurrentRegularizer),n.biasRegularizer=Je(t.biasRegularizer),n.kernelConstraint=Dn(t.kernelConstraint),n.recurrentConstraint=Dn(t.recurrentConstraint),n.biasConstraint=Dn(t.biasConstraint),n.dropout=Yu([1,wo([0,t.dropout==null?0:t.dropout])]),n.recurrentDropout=Yu([1,wo([0,t.recurrentDropout==null?0:t.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Nt(e,r),e.prototype.build=function(t){t=We(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){if((t=t).length!==2)throw new lt("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var i=t[1];t=t[0];var s,u=n.training!=null&&n.training;0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Zu(function(){return Er(t)},a.dropout,u)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Zu(function(){return Er(i)},a.recurrentDropout,u));var c=a.dropoutMask,f=a.recurrentDropoutMask;s=wi(c!=null?Jt(t,c):t,a.kernel.read()),a.bias!=null&&(s=Fi(s,a.bias.read())),f!=null&&(i=Jt(i,f));var h=se(s,wi(i,a.recurrentKernel.read()));return a.activation!=null&&(h=a.activation.apply(h)),[h,h]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="SimpleRNNCell",e})(qf);It.registerClass(yw);var ZI=(function(r){function e(t){return t.cell=new yw(t),r.call(this,t)||this}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){a.cell.dropoutMask!=null&&(re(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(re(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,u=n==null?null:n.initialState;return r.prototype.call.call(a,t,{mask:i,training:s,initialState:u})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},e.fromConfig=function(t,n){return new t(n)},e.className="SimpleRNN",e})(qs);It.registerClass(ZI);var bw=(function(r){function e(t){var n=r.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,hr(n.units,"units"),n.activation=So(t.activation===void 0?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=So(t.recurrentActivation===void 0?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=t.useBias==null||t.useBias,n.kernelInitializer=Ze(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Ze(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Ze(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Je(t.kernelRegularizer),n.recurrentRegularizer=Je(t.recurrentRegularizer),n.biasRegularizer=Je(t.biasRegularizer),n.kernelConstraint=Dn(t.kernelConstraint),n.recurrentConstraint=Dn(t.recurrentConstraint),n.biasConstraint=Dn(t.biasConstraint),n.dropout=Yu([1,wo([0,t.dropout==null?0:t.dropout])]),n.recurrentDropout=Yu([1,wo([0,t.recurrentDropout==null?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Nt(e,r),e.prototype.build=function(t){var n=(t=We(t))[t.length-1];this.kernel=this.addWeight("kernel",[n,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){if((t=t).length!==2)throw new lt("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var i=n.training!=null&&n.training,s=t[1];t=t[0],0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Zu(function(){return Er(t)},a.dropout,i,3)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Zu(function(){return Er(s)},a.recurrentDropout,i,3));var u,c,f,h=a.dropoutMask,d=a.recurrentDropoutMask;0<a.dropout&&a.dropout<1&&(t=Jt(t,h[0]));var m=wi(t,a.kernel.read());a.useBias&&(m=Fi(m,a.bias.read())),0<a.recurrentDropout&&a.recurrentDropout<1&&(s=Jt(s,d[0]));var g=a.recurrentKernel.read(),y=La(g,[2*a.units,a.units],g.rank-1),x=y[0],w=y[1],b=wi(s,x),C=La(m,3,m.rank-1),A=C[0],T=C[1],R=C[2],D=La(b,2,b.rank-1),N=D[0],O=D[1];u=a.recurrentActivation.apply(se(A,N)),c=a.recurrentActivation.apply(se(T,O));var k=wi(Jt(c,s),w);f=a.activation.apply(se(R,k));var z=se(Jt(u,s),Jt(se(1,Oo(u)),f));return[z,z]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),recurrentActivation:Ur(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="GRUCell",e})(qf);It.registerClass(bw);var JI=(function(r){function e(t){return t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new bw(t),r.call(this,t)||this}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){a.cell.dropoutMask!=null&&(re(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(re(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,u=n==null?null:n.initialState;return r.prototype.call.call(a,t,{mask:i,training:s,initialState:u})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),recurrentActivation:Ur(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},e.fromConfig=function(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)},e.className="GRU",e})(qs);It.registerClass(JI);var xw=(function(r){function e(t){var n=r.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,hr(n.units,"units"),n.activation=So(t.activation===void 0?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=So(t.recurrentActivation===void 0?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=t.useBias==null||t.useBias,n.kernelInitializer=Ze(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Ze(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Ze(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=t.unitForgetBias,n.kernelRegularizer=Je(t.kernelRegularizer),n.recurrentRegularizer=Je(t.recurrentRegularizer),n.biasRegularizer=Je(t.biasRegularizer),n.kernelConstraint=Dn(t.kernelConstraint),n.recurrentConstraint=Dn(t.recurrentConstraint),n.biasConstraint=Dn(t.biasConstraint),n.dropout=Yu([1,wo([0,t.dropout==null?0:t.dropout])]),n.recurrentDropout=Yu([1,wo([0,t.recurrentDropout==null?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Nt(e,r),e.prototype.build=function(t){var n,a,i=(t=We(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[i,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var s=this.biasInitializer,u=this.units;a=new((n=(function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return Nt(f,c),f.prototype.apply=function(h,d){var m=s.apply([u]),g=new tw().apply([u]),y=s.apply([2*u]);return zA(zA(m,g),y)},f})(Aa)).className="CustomInit",n)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,n){var a=this;return ft(function(){var i=n.training!=null&&n.training;if((t=t).length!==3)throw new lt("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var s=t[1],u=t[2];t=t[0],0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Zu(function(){return Er(t)},a.dropout,i,4)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Zu(function(){return Er(s)},a.recurrentDropout,i,4));var c,f,h,d,m=a.dropoutMask,g=a.recurrentDropoutMask;0<a.dropout&&a.dropout<1&&(t=Jt(t,m[0]));var y=wi(t,a.kernel.read());0<a.recurrentDropout&&a.recurrentDropout<1&&(s=Jt(s,g[0])),y=se(y,wi(s,a.recurrentKernel.read())),a.useBias&&(y=Fi(y,a.bias.read()));var x=La(y,4,y.rank-1),w=x[0],b=x[1],C=x[2],A=x[3];c=a.recurrentActivation.apply(w),f=a.recurrentActivation.apply(b),h=se(Jt(f,u),Jt(c,a.activation.apply(C))),d=a.recurrentActivation.apply(A);var T=Jt(d,a.activation.apply(h));return[T,T,h]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),recurrentActivation:Ur(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.className="LSTMCell",e})(qf);It.registerClass(xw);var t3=(function(r){function e(t){return t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new xw(t),r.call(this,t)||this}return Nt(e,r),e.prototype.call=function(t,n){var a=this;return ft(function(){a.cell.dropoutMask!=null&&(re(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(re(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,u=n==null?null:n.initialState;return r.prototype.call.call(a,t,{mask:i,training:s,initialState:u})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Ur(this.activation),recurrentActivation:Ur(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Te(this.kernelInitializer),recurrentInitializer:Te(this.recurrentInitializer),biasInitializer:Te(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:pe(this.kernelRegularizer),recurrentRegularizer:pe(this.recurrentRegularizer),biasRegularizer:pe(this.biasRegularizer),activityRegularizer:pe(this.activityRegularizer),kernelConstraint:Le(this.kernelConstraint),recurrentConstraint:Le(this.recurrentConstraint),biasConstraint:Le(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},e.fromConfig=function(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)},e.className="LSTM",e})(qs);It.registerClass(t3);var ww=(function(r){function e(t){var n=r.call(this,t)||this;return n.cells=t.cells,n}return Nt(e,r),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],n=0,a=this.cells.slice().reverse();n<a.length;n++){var i=a[n];Array.isArray(i.stateSize)?t.push.apply(t,i.stateSize):t.push(i.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,n){var a=this;return ft(function(){for(var i=(t=t).slice(1),s=[],u=0,c=a.cells.slice().reverse();u<c.length;u++){var f=c[u];Array.isArray(f.stateSize)?s.push(i.splice(0,f.stateSize.length)):s.push(i.splice(0,1))}s.reverse();for(var h,d=[],m=0;m<a.cells.length;++m)f=a.cells[m],i=s[m],h=m===0?[t[0]].concat(i):[h[0]].concat(i),h=f.call(h,n),d.push(h.slice(1));i=[];for(var g=0,y=d.slice().reverse();g<y.length;g++){var x=y[g];i.push.apply(i,x)}return[h[0]].concat(i)})},e.prototype.build=function(t){var n;qb(t)&&(t=t[0]),t=t,this.cells.forEach(function(a,i){ms("RNNCell_"+i,function(){a.build(t),n=Array.isArray(a.stateSize)?a.stateSize[0]:a.stateSize,t=[t[0],n]})}),this.built=!0},e.prototype.getConfig=function(){for(var t=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];t.push({className:i.getClassName(),config:i.getConfig()})}var s={cells:t},u=r.prototype.getConfig.call(this);return Object.assign(s,u),s},e.fromConfig=function(t,n,a){a===void 0&&(a={});for(var i=[],s=0,u=n.cells;s<u.length;s++){var c=u[s];i.push(da(c,a))}return new t({cells:i})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];t.push.apply(t,i.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];t.push.apply(t,i.nonTrainableWeights)}if(!this.trainable){for(var s=[],u=0,c=this.cells;u<c.length;u++)i=c[u],s.push.apply(s,i.trainableWeights);return s.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];t.push.apply(t,i.weights)}return Wb(t)},e.prototype.setWeights=function(t){for(var n=[],a=0,i=this.cells;a<i.length;a++)for(var s=i[a],u=s.weights.length,c=t.splice(u),f=0;f<s.weights.length;++f)n.push([s.weights[f],c[f]]);sw(n)},e.className="StackedRNNCells",e})(qf);function Zu(r,e,t,n){function a(){return yD(r(),e)}if(t===void 0&&(t=null),n===void 0&&(n=1),n>1){for(var i=[],s=0;s<n;s++)i.push($u(a,r,t));return i.map(function(u){return ma(u.clone())})}return ma($u(a,r,t).clone())}It.registerClass(ww);var e3=(function(r){function e(t){var n=r.call(this,t)||this;return n.layer=t.layer,n}return Nt(e,r),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(t){this.layer!=null&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.prototype.setFastWeightInitDuringBuild=function(t){r.prototype.setFastWeightInitDuringBuild.call(this,t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)},e.fromConfig=function(t,n,a){a===void 0&&(a={});var i=da(n.layer,a);delete n.layer;var s={layer:i};return Object.assign(s,n),new t(s)},e})(we),n3=(function(r){function e(t){var n=r.call(this,t)||this;return n.supportsMasking=!0,n}return Nt(e,r),e.prototype.build=function(t){if((t=We(t)).length<3)throw new lt("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];var n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),r.prototype.build.call(this,t)},e.prototype.computeOutputShape=function(t){var n=[(t=We(t))[0]].concat(t.slice(2)),a=this.layer.computeOutputShape(n),i=t[1];return[a[0],i].concat(a.slice(1))},e.prototype.call=function(t,n){var a=this;return ft(function(){return QI(function(i,s){return[le(a.layer.call(i,n)),[]]},t=le(t),[],!1,null,null,!1,!0)[1]})},e.className="TimeDistributed",e})(e3);function n6(r){pl(JU,"BidirectionalMergeMode",r)}It.registerClass(n3);var r6="concat",r3=(function(r){function e(t){var n=r.call(this,t)||this,a=t.layer.getConfig(),i={};i.className=t.layer.getClassName(),i.config=a,n.forwardLayer=da(i),a.goBackwards=a.goBackwards!==!0;var s={};if(s.className=t.layer.getClassName(),s.config=a,n.backwardLayer=da(s),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=t.mergeMode===void 0?r6:t.mergeMode,n6(n.mergeMode),t.weights)throw new he("weights support is not implemented for Bidirectional layer yet.");return n._stateful=t.layer.stateful,n.returnSequences=t.layer.returnSequences,n.returnState=t.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=t.layer.inputSpec,n.numConstants=null,n}return Nt(e,r),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var n=t.length,a=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,a)),this.backwardLayer.setWeights(t.slice(a))},e.prototype.computeOutputShape=function(t){var n,a,i,s=this.forwardLayer.computeOutputShape(t);return Array.isArray(s)&&Array.isArray(s[0])||(s=[s]),s=s,this.returnState&&(i=s.slice(1)),n=s[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,a=[n]):a=this.mergeMode==null?[n,n.slice()]:[n],this.returnState?this.mergeMode==null?a.concat(i).concat(i.slice()):[n].concat(i).concat(i.slice()):or(a)},e.prototype.apply=function(t,n){var a=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});var s=$I(t,a,i,this.numConstants);if(t=s.inputs,a=s.initialState,i=s.constants,Array.isArray(t)&&(a=t.slice(1),t=t[0]),(a==null||a.length===0)&&i==null)return r.prototype.apply.call(this,t,n);var u=[],c=[];if(a!=null){var f=a.length;if(f%2>0)throw new lt("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=a,u.push.apply(u,a);var h=a.map(function(C){return new jn({shape:C.shape})});this.forwardLayer.stateSpec=h.slice(0,f/2),this.backwardLayer.stateSpec=h.slice(f/2),c.push.apply(c,h)}if(i!=null)throw new he("Support for constants in Bidirectional layers is not implemented yet.");for(var d=u[0]instanceof ha,m=0,g=u;m<g.length;m++)if(g[m]instanceof ha!==d)throw new lt("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(d){var y=[t].concat(u),x=this.inputSpec.concat(c),w=this.inputSpec;this.inputSpec=x;var b=r.prototype.apply.call(this,y,n);return this.inputSpec=w,b}return r.prototype.apply.call(this,t,n)},e.prototype.call=function(t,n){var a=this;return ft(function(){if(n.mask!=null)throw new he("The support for masking is not implemented for Bidirectional layers yet.");var i,s,u,c,f=n.initialState;if(f==null)i=a.forwardLayer.call(t,n),s=a.backwardLayer.call(t,n);else{var h=f.slice(0,f.length/2),d=f.slice(f.length/2);i=a.forwardLayer.call(t,Object.assign(n,{initialState:h})),s=a.backwardLayer.call(t,Object.assign(n,{initialState:d}))}return a.returnState&&(Array.isArray(i)&&(u=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),a.returnSequences&&(s=va(s,1)),a.mergeMode==="concat"?c=vD([i,s]):a.mergeMode==="sum"?c=se(i,s):a.mergeMode==="ave"?c=Jt(.5,se(i,s)):a.mergeMode==="mul"?c=Jt(i,s):a.mergeMode==null&&(c=[i,s]),a.returnState?a.mergeMode==null?c.concat(u):[c].concat(u):c})},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var n=this;ms(this.forwardLayer.name,function(){n.forwardLayer.build(t)}),ms(this.backwardLayer.name,function(){n.backwardLayer.build(t)}),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(t){r.prototype.setFastWeightInitDuringBuild.call(this,t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)},e.prototype.getConfig=function(){var t={mergeMode:this.mergeMode},n=r.prototype.getConfig.call(this);return Object.assign(t,n),t},e.fromConfig=function(t,n){var a=da(n.layer);if(delete n.layer,n.numConstants!=null)throw new he("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var i=n;return i.layer=a,new t(i)},e.className="Bidirectional",e})(e3);function a6(r){return new Vf(r)}function i6(r){return new tI(r)}function o6(r){return new QD(r)}function s6(r){return new ZD(r)}function u6(r){return new JD(r)}function l6(r){return new nI(r)}function c6(r){return new eI(r)}function f6(r){return new uI(r)}function h6(r){return new gw(r)}function p6(r){return new oI(r)}function d6(r){return new iI(r)}function m6(r){return new sI(r)}function v6(r){return new lI(r)}function g6(r){return new cI(r)}function y6(r){return new fI(r)}function b6(r){return new mI(r)}function x6(r){return new pI(r)}function w6(r){return new hI(r)}function S6(r){return new dI(r)}function E6(r){return new vI(r)}function C6(r){return new gI(r)}function A6(r){return new yI(r)}function N6(r){return new xI(r)}function T6(r){return new wI(r)}function R6(r){return new EI(r)}function _6(r){return new NI(r)}function O6(r){return new CI(r)}function D6(r){return new AI(r)}function I6(r){return new SI(r)}function k6(r){return new TI(r)}function M6(r){return new DI(r)}function z6(r){return new II(r)}function F6(r){return new kI(r)}function Sw(r){return new BI(r)}function B6(r){return Sw(r)}function L6(r){return Sw(r)}function Ew(r){return new jI(r)}function U6(r){return Ew(r)}function j6(r){return Ew(r)}function Cw(r){return new qI(r)}function P6(r){return Cw(r)}function V6(r){return Cw(r)}function q6(r){return new HI(r)}function W6(r){return new KI(r)}function a3(r){return new GI(r)}function i3(r){return new YI(r)}function o3(r){return new FI(r)}function s3(r){return new UI(r)}function H6(r){return new VI(r)}function G6(r){return new JI(r)}function X6(r){return new bw(r)}function K6(r){return new t3(r)}function Y6(r){return new xw(r)}function $6(r){return new ZI(r)}function Q6(r){return new yw(r)}function Z6(r){return new qs(r)}function J6(r){return new ww(r)}function tV(r){return new r3(r)}function eV(r){return new n3(r)}It.registerClass(r3);var nV=a3,rV=i3,aV=o3,iV=s3;function oV(r){return new RI(r)}function sV(r){return new _I(r)}function uV(r){return new OI(r)}function lV(r){return new bI(r)}var u3=Object.freeze({inputLayer:a6,elu:i6,reLU:o6,leakyReLU:s6,prelu:u6,softmax:l6,thresholdedReLU:c6,conv1d:f6,conv2d:h6,conv2dTranspose:p6,conv3d:d6,separableConv2d:m6,cropping2D:v6,upSampling2d:g6,depthwiseConv2d:y6,activation:b6,dense:x6,dropout:w6,flatten:S6,repeatVector:E6,reshape:C6,permute:A6,embedding:N6,add:T6,average:R6,concatenate:_6,maximum:O6,minimum:D6,multiply:I6,dot:k6,batchNormalization:M6,layerNormalization:z6,zeroPadding2d:F6,averagePooling1d:Sw,avgPool1d:B6,avgPooling1d:L6,averagePooling2d:Ew,avgPool2d:U6,avgPooling2d:j6,averagePooling3d:Cw,avgPool3d:P6,avgPooling3d:V6,globalAveragePooling1d:q6,globalAveragePooling2d:W6,globalMaxPooling1d:a3,globalMaxPooling2d:i3,maxPooling1d:o3,maxPooling2d:s3,maxPooling3d:H6,gru:G6,gruCell:X6,lstm:K6,lstmCell:Y6,simpleRNN:$6,simpleRNNCell:Q6,rnn:Z6,stackedRNNCells:J6,bidirectional:tV,timeDistributed:eV,globalMaxPool1d:nV,globalMaxPool2d:rV,maxPool1d:aV,maxPool2d:iV,Layer:we,RNN:qs,RNNCell:qf,input:KD,gaussianNoise:oV,gaussianDropout:sV,alphaDropout:uV,masking:lV});function cV(r,e){return lw(r,e)}function fV(r,e){return UD(r,e)}function hV(r,e){return jD(r,e)}function pV(r,e){return cw(r,e)}function dV(r,e){return fw(r,e)}function mV(r,e){return LD(r,e)}function vV(r,e){return Kj(r,e)}function gV(r,e){return uw(r,e)}function yV(r,e){return Zm(r,e)}function bV(r,e){return dl(r,e)}function xV(r,e){return dl(r,e)}function wV(r,e){return dl(r,e)}function SV(r,e){return Ps(r,e)}function EV(r,e){return Ps(r,e)}function CV(r,e){return Ps(r,e)}var AV=Object.freeze({binaryAccuracy:cV,binaryCrossentropy:fV,sparseCategoricalAccuracy:hV,categoricalAccuracy:pV,categoricalCrossentropy:dV,precision:mV,recall:vV,cosineProximity:gV,meanAbsoluteError:yV,meanAbsolutePercentageError:bV,MAPE:xV,mape:wV,meanSquaredError:SV,MSE:EV,mse:CV}),NV=Object.freeze({modelFromJSON:_P});function TV(r){return new ev(r)}function RV(r){return HP(r)}function _V(r){return GP(r)}var OV=Object.freeze({l1l2:TV,l1:RV,l2:_V}),l3=(function(r){function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.model=null,t}return Nt(e,r),e.prototype.setModel=function(t){if(!(t instanceof gs))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e})(Qu);function xp(r,e){return r<e}function ZA(r,e){return r>e}var c3=(function(r){function e(t){var n=r.call(this)||this;if(t==null&&(t={}),t.restoreBestWeights)throw new he("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=t.monitor||"val_loss",n.minDelta=Math.abs(t.minDelta||0),n.patience=t.patience||0,n.verbose=t.verbose||0,n.mode=t.mode||"auto",n.baseline=t.baseline,["auto","min","max"].indexOf(n.mode)===-1&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),n.mode==="min"?n.monitorFunc=xp:n.mode==="max"||n.monitor.indexOf("acc")!==-1?n.monitorFunc=ZA:n.monitorFunc=xp,n.monitorFunc===xp&&(n.minDelta*=-1),n}return Nt(e,r),e.prototype.onTrainBegin=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===xp?1/0:-1/0,[2]})})},e.prototype.onEpochEnd=function(t,n){return ne(this,void 0,void 0,function(){var a;return Zt(this,function(i){switch(i.label){case 0:return[4,uo(n)];case 1:return i.sent(),(a=this.getMonitorValue(n))==null?[2]:(this.monitorFunc(a-this.minDelta,this.best)?(this.best=a,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)),[2])}})})},e.prototype.onTrainEnd=function(t){return ne(this,void 0,void 0,function(){return Zt(this,function(n){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},e.prototype.getMonitorValue=function(t){t==null&&(t={});var n=t[this.monitor];return n==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),n},e})(l3);function DV(r){return new c3(r)}var IV={earlyStopping:DV},di,JA,$b=function(){return($b=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)};function Rs(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){f.done?a(f.value):new t(function(h){h(f.value)}).then(s,u)}c((n=n.apply(r,[])).next())})}function _s(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(di||(di={})),(function(r){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(JA||(JA={}));var Aw={};function kV(r,e){var t={tfOpName:r,category:"custom",inputs:[],attrs:[],customExecutor:e};Aw[r]=t}function f3(r){return Aw[r]}function MV(r){delete Aw[r]}function P(r,e,t,n){var a=e.inputParams[r];if(a&&a.inputIndexStart!==void 0){var i=a.inputIndexStart,s=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?i+1:a.inputIndexEnd;if(a.type==="tensor")return ur(e.inputNames[a.inputIndexStart],t,n);if(a.type==="tensors")return e.inputNames.slice(i,s).map(function(f){return ur(f,t,n)});var u=Array.prototype.slice.call(ur(e.inputNames.slice(i)[0],t,n).dataSync());return a.type==="number"?u[0]:u}var c=e.attrParams[r];return c&&c.value}function ur(r,e,t){var n=Oc(r),a=n[0],i=n[1],s=t.currentContextIds.find(function(u){return!!e[Ed(a,u)]});return s!==void 0?e[Ed(a,s)][i]:void 0}function zV(r,e,t){return e[Ed(r,t.currentContextId)]}function Bp(r,e){var t=Oc(r),n=t[0],a=t[1];return[Ed(n,e&&e.currentContextId),a]}function Ed(r,e){return e?r+"-"+e:r}function Oc(r){var e=r.lastIndexOf(":");return e===-1?[r,0]:[r.substring(0,e),Number(r.substring(e+1))]}function n0(r,e){for(var t=[],n=0;n<r.length;n+=e)t.push(r.slice(n,n+e));return t}var FV=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],BV=Object.freeze({json:FV}),LV=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],UV=Object.freeze({json:LV}),jV=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],PV=Object.freeze({json:jV}),VV=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],qV=Object.freeze({json:VV}),WV=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],HV=Object.freeze({json:WV}),GV=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],XV=Object.freeze({json:GV}),KV=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],YV=Object.freeze({json:KV}),$V=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],QV=Object.freeze({json:$V}),ZV=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],JV=Object.freeze({json:ZV}),t5=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],e5=Object.freeze({json:t5}),n5=[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],r5=Object.freeze({json:n5}),a5=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],i5=Object.freeze({json:a5}),o5=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],s5=Object.freeze({json:o5}),u5=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],l5=Object.freeze({json:u5}),c5=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],f5=Object.freeze({json:c5}),h5=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],p5=Object.freeze({json:h5}),d5=(function(){function r(){var e=[BV,UV,PV,qV,HV,XV,YV,e5,JV,QV,r5,i5,s5,l5,f5,p5],t=[].concat.apply([],e.map(function(n){return n.json}));this.opMappers=t.reduce(function(n,a){return n[a.tfOpName]=a,n},{})}return Object.defineProperty(r,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),r.prototype.transformGraph=function(e){var t=this,n=[],a=[],i=e.node.reduce(function(f,h){return f[h.name]=t.mapNode(h),h.op==="Placeholder"&&n.push(f[h.name]),h.op==="Const"&&a.push(f[h.name]),f},{}),s=[],u=[],c=Object.keys(i);return c.forEach(function(f){var h=i[f];h.inputNames.forEach(function(d){var m=Bp(d)[0];h.inputs.push(i[m]),i[m].children.push(h)}),h.inputs.length===0&&s.push(h)}),c.forEach(function(f){var h=i[f];h.children.length===0&&u.push(h)}),{nodes:i,inputs:s,outputs:u,weights:a,placeholders:n}},r.prototype.mapNode=function(e){var t=f3(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(function(a){return a.startsWith("^")?a.substr(1):a}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return t.inputs!=null&&(n.inputParams=t.inputs.reduce(function(a,i){return a[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},a},{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce(function(a,i){var s=i.type,u=void 0;switch(i.type){case"string":(u=Qb(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=Qb(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":(u=a1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=a1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":(u=Jb(e.attr,i.tfName,i.defaultValue||0))===void 0&&i.tfDeprecatedName&&(u=Jb(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":(u=r1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=r1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":(u=Zb(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=Zb(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":(u=o1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=o1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":(u=n1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=n1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":(u=i1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=i1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":(u=t1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=t1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":(u=e1(e.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(u=e1(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+i.type+" for op: "+e.op)}return a[i.name]={value:u,type:s},a},{})),n},r})();function m5(r){var e=yt().global;if(e.atob!==void 0)return e.atob(r);if(typeof ys<"u")return new ys(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function h3(r,e){var t=Array.isArray(r)?String.fromCharCode.apply(null,r):m5(r);return e?t:t.toLowerCase()}function Qb(r,e,t,n){n===void 0&&(n=!1);var a=r[e];return a!=null?h3(a.s,n):t}function Zb(r,e,t){var n=r[e];return n?n.b:t}function Jb(r,e,t){var n=r[e]||{},a=n.i!=null?n.i:n.f!=null?n.f:t;return typeof a=="number"?a:parseInt(a,10)}function p3(r){switch(typeof r=="string"&&(r=di[r]),r){case di.DT_FLOAT:return"float32";case di.DT_INT32:case di.DT_INT64:return"int32";case di.DT_BOOL:return"bool";case di.DT_DOUBLE:return"float32";case di.DT_STRING:return"string";default:return null}}function t1(r,e,t){var n=r[e];return n&&n.type?p3(n.type):t}function e1(r,e,t){var n=r[e];return n&&n.list&&n.list.type?n.list.type.map(function(a){return p3(a)}):t}function d3(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(function(e){return typeof e.size=="number"?e.size:parseInt(e.size,10)}):[]}function n1(r,e,t){var n=r[e];return n&&n.shape?d3(n.shape):t}function r1(r,e,t){var n=r[e];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(function(a){return typeof a=="number"?a:parseInt(a,10)}):t}function a1(r,e,t,n){n===void 0&&(n=!1);var a=r[e];return a&&a.list&&a.list.s?a.list.s.map(function(i){return h3(i,n)}):t}function i1(r,e,t){var n=r[e];return n&&n.list&&n.list.shape?n.list.shape.map(function(a){return d3(a)}):t}function o1(r,e,t){var n=r[e];return n&&n.list&&n.list.b?n.list.b:t}var v5=(function(){function r(e,t,n){var a=this;this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(function(i){return a.getInput(i)}),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce(function(i,s){return i[s]=a.getAttr(s),i},{}))}return r.prototype.getInput=function(e){return ur(e,this.tensorMap,this.context)},r.prototype.getAttr=function(e,t){var n=this.node.rawAttrs[e];if(n.tensor!=null)return ur(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return Jb(this.node.rawAttrs,e,t);if(n.s!=null)return Qb(this.node.rawAttrs,e,t);if(n.b!=null)return Zb(this.node.rawAttrs,e,t);if(n.shape!=null)return n1(this.node.rawAttrs,e,t);if(n.type!=null)return t1(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return r1(this.node.rawAttrs,e,t);if(n.list.s!=null)return a1(this.node.rawAttrs,e,t);if(n.list.shape!=null)return i1(this.node.rawAttrs,e,t);if(n.list.b!=null)return o1(this.node.rawAttrs,e,t);if(n.list.type!=null)return e1(this.node.rawAttrs,e,t)}return t},r})(),g5=function(r,e,t){switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[se(P("a",r,e,t),P("b",r,e,t))];case"AddN":return[Sm(P("tensors",r,e,t))];case"FloorMod":case"Mod":return[Cm(P("a",r,e,t),P("b",r,e,t))];case"Mul":return[Jt(P("a",r,e,t),P("b",r,e,t))];case"RealDiv":case"Div":return[Sn(P("a",r,e,t),P("b",r,e,t))];case"FloorDiv":return[df(P("a",r,e,t),P("b",r,e,t))];case"Sub":return[gn(P("a",r,e,t),P("b",r,e,t))];case"Minimum":return[Bs(P("a",r,e,t),P("b",r,e,t))];case"Maximum":return[Ca(P("a",r,e,t),P("b",r,e,t))];case"Pow":return[Ss(P("a",r,e,t),P("b",r,e,t))];case"SquaredDifference":return[Am(P("a",r,e,t),P("b",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},y5=function(r,e,t){switch(r.op){case"Abs":case"ComplexAbs":return[Ti(P("x",r,e,t))];case"Acos":return[Qd(P("x",r,e,t))];case"Acosh":return[Zd(P("x",r,e,t))];case"Asin":return[Jd(P("x",r,e,t))];case"Asinh":return[tm(P("x",r,e,t))];case"Atan":return[em(P("x",r,e,t))];case"Atan2":return[Em(P("x",r,e,t),P("y",r,e,t))];case"Atanh":return[nm(P("x",r,e,t))];case"Ceil":return[rm(P("x",r,e,t))];case"Complex":return[Tn(P("real",r,e,t),P("imag",r,e,t))];case"Cos":return[am(P("x",r,e,t))];case"Cosh":return[im(P("x",r,e,t))];case"Elu":return[js(P("x",r,e,t))];case"Erf":return[om(P("x",r,e,t))];case"Exp":return[sm(P("x",r,e,t))];case"Expm1":return[um(P("x",r,e,t))];case"Floor":return[uf(P("x",r,e,t))];case"Log":return[Va(P("x",r,e,t))];case"Log1p":return[lm(P("x",r,e,t))];case"Imag":return[zr(P("x",r,e,t))];case"Neg":return[Oo(P("x",r,e,t))];case"Reciprocal":return[cm(P("x",r,e,t))];case"Real":return[sr(P("x",r,e,t))];case"Relu":return[Mi(P("x",r,e,t))];case"Round":return[fm(P("x",r,e,t))];case"Selu":return[Of(P("x",r,e,t))];case"Sigmoid":return[ol(P("x",r,e,t))];case"Sin":return[pm(P("x",r,e,t))];case"Sign":return[hm(P("x",r,e,t))];case"Sinh":return[dm(P("x",r,e,t))];case"Softplus":return[sl(P("x",r,e,t))];case"Sqrt":return[Fs(P("x",r,e,t))];case"Square":return[$d(P("x",r,e,t))];case"Tanh":return[cf(P("x",r,e,t))];case"Tan":return[mm(P("x",r,e,t))];case"Relu6":case"ClipByValue":return[er(P("x",r,e,t),P("clipValueMin",r,e,t),P("clipValueMax",r,e,t))];case"Rsqrt":return[lf(ur(r.inputNames[0],e,t))];case"Prod":return[Tf(P("x",r,e,t),P("axes",r,e,t))];case"LeakyRelu":return[Rf(P("x",r,e,t),P("alpha",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},b5=(function(){function r(e,t,n,a,i,s,u){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=s,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.id=r.nextId++}return Object.defineProperty(r.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),r.prototype.clearAndClose=function(){this.tensors.forEach(function(e){return e.tensor.dispose()}),this.tensors=[],this.closed_=!0},r.prototype.size=function(){return this.tensors.length},r.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.tensors.length)throw new Error("Tried to read from index "+e+", but array size is: "+this.tensors.length);var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},r.prototype.readMany=function(e){var t=this;return e.map(function(n){return t.read(n)})},r.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+`,
          because the value dtype is `+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=t.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");n.tensor=t,n.written=!0,this.tensors[e]=n},r.prototype.writeMany=function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+e.length+" is not the same as tensors size: "+t.length+".");e.forEach(function(a,i){return n.write(a,t[i])})},r.prototype.gather=function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(!e){e=[];for(var n=0;n<this.size();n++)e.push(n)}if(e.length===0)return sn([],[0].concat(this.elementShape));var a=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,a[0].shape,"TensorArray shape mismatch: "),Lr(a,0)},r.prototype.concat=function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(this.size()===0)return sn([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var a=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,a[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+a[0].shape+")"),Vn(a,0)},r.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var n=Math.max.apply(Math,e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(e,Ni(t,0))},r.prototype.split=function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var a=0,i=e.map(function(h){return a+=h});if(a!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+a+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var s=a===0?0:t.size/a,u=[];ft(function(){t=t.reshape([1,a,s]);for(var h=0;h<e.length;++h){var d=[0,h===0?0:i[h-1],0],m=[1,e[h],s];u[h]=nr(t,d,m).reshape(n.elementShape)}return u});for(var c=[],f=0;f<e.length;f++)c[f]=f;this.writeMany(c,u)},r.prototype.assertShapesMatchAllowUndefinedSize=function(e,t,n){n===void 0&&(n=""),At.assert(this.shapesEqualAllowUndefinedSize(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})},r.prototype.shapesEqualAllowUndefinedSize=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==-1&&t[n]!==-1&&e[n]!==t[n])return!1;return!0},r.nextId=0,r})();function x5(r,e,t){return Rs(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N,O,k,z,F,B,V,G,Q,L,X,$,it,tt,q;return _s(this,function(nt){switch(nt.label){case 0:switch(r.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[P("pred",r,e,t).clone()]];case 2:return n=P("pred",r,e,t),a=P("data",r,e,t),[4,n.data()];case 3:return[2,nt.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(i=r.inputNames.find(function(W){return ur(W,e,t)!==void 0}))?[ur(i,e,t).clone()]:void 0];case 5:return s=P("frameName",r,e,t),u=P("tensor",r,e,t),t.enterFrame(s),[2,[u.clone()]];case 6:return c=P("tensor",r,e,t),t.exitFrame(),[2,[c.clone()]];case 7:return f=P("tensor",r,e,t),t.nextIteration(),[2,[f.clone()]];case 8:return h=P("size",r,e,t),d=P("dtype",r,e,t),m=P("elementShape",r,e,t),g=P("dynamicSize",r,e,t),y=P("clearAfterRead",r,e,t),x=P("identicalElementShapes",r,e,t),w=P("name",r,e,t),b=new b5(w,d,h,m,x,g,y),t.addTensorArray(b),[2,[jt(b.id),jt(1)]];case 9:return C=P("tensorArrayId",r,e,t),A=P("index",r,e,t),T=P("tensor",r,e,t),t.getTensorArray(C).write(A,T),[2,[jt(1)]];case 10:return R=P("tensorArrayId",r,e,t),D=P("index",r,e,t),[2,[t.getTensorArray(R).read(D)]];case 11:return N=P("tensorArrayId",r,e,t),O=P("indices",r,e,t),k=P("dtype",r,e,t),[2,[t.getTensorArray(N).gather(O,k)]];case 12:return z=P("tensorArrayId",r,e,t),F=P("indices",r,e,t),B=P("tensor",r,e,t),t.getTensorArray(z).scatter(F,B),[2,[jt(1)]];case 13:return V=P("tensorArrayId",r,e,t),G=t.getTensorArray(V),Q=P("dtype",r,e,t),[2,[G.concat(Q)]];case 14:return L=P("tensorArrayId",r,e,t),X=P("tensor",r,e,t),$=P("lengths",r,e,t),t.getTensorArray(L).split($,X),[2,[jt(1)]];case 15:return it=P("tensorArrayId",r,e,t),tt=t.getTensorArray(it),[2,[jt(tt.size(),"int32")]];case 16:return q=P("tensorArrayId",r,e,t),t.getTensorArray(q).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+r.op+" is not implemented")}})})}var w5=function(r,e,t){var n,a;switch(r.op){case"Conv1D":var i=P("stride",r,e,t),s=P("pad",r,e,t),u=P("dataFormat",r,e,t).toUpperCase(),c=P("dilation",r,e,t);return[vf(P("x",r,e,t),P("filter",r,e,t),i,s,u,c)];case"Conv2D":i=P("strides",r,e,t),s=P("pad",r,e,t),u=P("dataFormat",r,e,t).toUpperCase();var f=P("dilations",r,e,t);return[Io(P("x",r,e,t),P("filter",r,e,t),[i[1],i[2]],s,u,[f[1],f[2]])];case"_FusedConv2D":var h=(n=P("fusedOps",r,e,t))[0],d=n[1],m=h==="biasadd",g=d==="prelu",y=h==="fusedbatchnorm",x=P("numArgs",r,e,t);if(m){if(g&&x!==2)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!g&&x!==1)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(y)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");i=P("strides",r,e,t),s=P("pad",r,e,t),u=P("dataFormat",r,e,t).toUpperCase(),f=P("dilations",r,e,t);var w=(a=P("args",r,e,t))[0],b=a[1];return[Ns.conv2d({x:P("x",r,e,t),filter:P("filter",r,e,t),strides:[i[1],i[2]],pad:s,dataFormat:u,dilations:[f[1],f[2]],bias:w,activation:d,preluActivationWeights:b})];case"Conv2DBackpropInput":case"Conv2dTranspose":var C=P("outputShape",r,e,t);return i=P("strides",r,e,t),s=P("pad",r,e,t),[yf(P("x",r,e,t),P("filter",r,e,t),C,[i[1],i[2]],s)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return i=P("strides",r,e,t),s=P("pad",r,e,t),f=P("dilations",r,e,t),u=P("dataFormat",r,e,t).toUpperCase(),[Us(P("input",r,e,t),P("filter",r,e,t),[i[1],i[2]],s,u,[f[1],f[2]])];case"Conv3D":return i=P("strides",r,e,t),s=P("pad",r,e,t),u=P("dataFormat",r,e,t).toUpperCase(),f=P("dilations",r,e,t),[gf(P("x",r,e,t),P("filter",r,e,t),[i[1],i[2],i[3]],s,u,[f[1],f[2],f[3]])];case"AvgPool":i=P("strides",r,e,t),s=P("pad",r,e,t);var A=P("kernelSize",r,e,t);return[wf(P("x",r,e,t),[A[1],A[2]],[i[1],i[2]],s)];case"MaxPool":return i=P("strides",r,e,t),s=P("pad",r,e,t),A=P("kernelSize",r,e,t),[xf(P("x",r,e,t),[A[1],A[2]],[i[1],i[2]],s)];case"AvgPool3D":return i=P("strides",r,e,t),s=P("pad",r,e,t),A=P("kernelSize",r,e,t),[Ef(P("x",r,e,t),[A[1],A[2],A[3]],[i[1],i[2],i[3]],s)];case"MaxPool3D":return i=P("strides",r,e,t),s=P("pad",r,e,t),A=P("kernelSize",r,e,t),[Sf(P("x",r,e,t),[A[1],A[2],A[3]],[i[1],i[2],i[3]],s)];default:throw TypeError("Node type "+r.op+" is not implemented")}},S5=function(r,e,t){switch(r.op){case"Fill":var n=P("shape",r,e,t),a=P("dtype",r,e,t),i=P("value",r,e,t);return[Is(n,i,a)];case"LinSpace":var s=P("start",r,e,t),u=P("stop",r,e,t),c=P("num",r,e,t);return[Md(s,u,c)];case"Multinomial":var f=P("logits",r,e,t),h=P("numSamples",r,e,t),d=P("seed",r,e,t);return[Pd(f,h,d)];case"OneHot":var m=P("indices",r,e,t),g=P("depth",r,e,t),y=P("onValue",r,e,t),x=P("offValue",r,e,t);return[Ua(m,g,y,x)];case"Ones":return[Sa(P("shape",r,e,t),P("dtype",r,e,t))];case"OnesLike":return[Er(P("x",r,e,t))];case"RandomUniform":return[To(P("shape",r,e,t),P("minval",r,e,t),P("maxval",r,e,t),P("dtype",r,e,t))];case"Range":s=P("start",r,e,t);var w=P("stop",r,e,t),b=P("step",r,e,t);return[ef(s,w,b,P("dtype",r,e,t))];case"TruncatedNormal":n=P("shape",r,e,t);var C=P("mean",r,e,t),A=P("stdDev",r,e,t);return d=P("seed",r,e,t),[il(n,C,A,P("dtype",r,e,t),d)];case"Zeros":return[Ie(P("shape",r,e,t),P("dtype",r,e,t))];case"ZerosLike":return[ye(P("x",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}};function E5(r,e,t){return Rs(this,void 0,void 0,function(){var n,a,i,s,u;return _s(this,function(c){switch(c.label){case 0:switch(r.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return n=P("boxes",r,e,t),a=P("scores",r,e,t),i=P("maxOutputSize",r,e,t),s=P("iouThreshold",r,e,t),u=P("scoreThreshold",r,e,t),[4,xi.nonMaxSuppressionAsync(n,a,i,s,u)];case 2:return[2,[c.sent()]];case 3:return[4,pf(P("condition",r,e,t).asType("bool"))];case 4:return[2,[c.sent()]];case 5:return[2,Wd(P("x",r,e,t),P("y",r,e,t))];case 6:throw TypeError("Node type "+r.op+" is not implemented")}})})}var C5=function(r,e,t){if(r.op==="TopKV2"){var n=P("x",r,e,t),a=P("k",r,e,t),i=P("sorted",r,e,t),s=zm(n,a,i);return[s.values,s.indices]}else throw TypeError("Node type "+r.op+" is not implemented")},A5=function(r,e,t){switch(r.op){case"Const":return e[r.name];case"PlaceholderWithDefault":var n=P("default",r,e,t);return[ur(r.name,e,t)||n];case"Placeholder":return[ur(r.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[P("x",r,e,t).clone()];case"IdentityN":return P("x",r,e,t).map(function(f){return f.clone()});case"Snapshot":return[P("x",r,e,t).clone()];case"Shape":return[zn(P("x",r,e,t).shape,"int32")];case"ShapeN":return P("x",r,e,t).map(function(f){return zn(f.shape)});case"Size":return[jt(P("x",r,e,t).size,"int32")];case"Rank":return[jt(P("x",r,e,t).rank,"int32")];case"NoOp":return[];case"Print":var a=P("x",r,e,t),i=P("data",r,e,t),s=P("message",r,e,t),u=P("summarize",r,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<i.length;c++)console.log(Array.prototype.slice.call(i[c].dataSync()).slice(0,u));return[a];default:throw TypeError("Node type "+r.op+" is not implemented")}},N5=function(r,e,t){switch(r.op){case"ResizeBilinear":var n=P("images",r,e,t),a=P("size",r,e,t),i=P("alignCorners",r,e,t);return[xi.resizeBilinear(n,[a[0],a[1]],i)];case"ResizeNearestNeighbor":return n=P("images",r,e,t),a=P("size",r,e,t),i=P("alignCorners",r,e,t),[xi.resizeNearestNeighbor(n,[a[0],a[1]],i)];case"CropAndResize":var s=P("image",r,e,t),u=P("boxes",r,e,t),c=P("boxInd",r,e,t),f=P("cropSize",r,e,t),h=P("method",r,e,t),d=P("extrapolationValue",r,e,t);return[xi.cropAndResize(s,u,c,f,h,d)];default:throw TypeError("Node type "+r.op+" is not implemented")}},T5=function(r,e,t){switch(r.op){case"Equal":return[Do(P("a",r,e,t),P("b",r,e,t))];case"NotEqual":return[Es(P("a",r,e,t),P("b",r,e,t))];case"Greater":return[Ls(P("a",r,e,t),P("b",r,e,t))];case"GreaterEqual":return[ul(P("a",r,e,t),P("b",r,e,t))];case"Less":return[Nm(P("a",r,e,t),P("b",r,e,t))];case"LessEqual":return[Tm(P("a",r,e,t),P("b",r,e,t))];case"LogicalAnd":return[Ga(P("a",r,e,t),P("b",r,e,t))];case"LogicalNot":return[wm(P("a",r,e,t))];case"LogicalOr":return[hf(P("a",r,e,t),P("b",r,e,t))];case"Select":return[qa(P("condition",r,e,t),P("a",r,e,t),P("b",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},R5=function(r,e,t){switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[bf(P("a",r,e,t),P("b",r,e,t),P("transposeA",r,e,t),P("transposeB",r,e,t))];case"Transpose":return[Qe(P("x",r,e,t),P("perm",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},_5=function(r,e,t){switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[gm(P("x",r,e,t),P("mean",r,e,t),P("variance",r,e,t),P("offset",r,e,t),P("scale",r,e,t),P("epsilon",r,e,t))];case"LRN":return[Im(P("x",r,e,t),P("radius",r,e,t),P("bias",r,e,t),P("alpha",r,e,t),P("beta",r,e,t))];case"Softmax":return[Ro(P("x",r,e,t))];case"LogSoftmax":return[of(P("x",r,e,t))];case"SparseToDense":return[If(P("sparseIndices",r,e,t),P("outputShape",r,e,t),P("sparseValues",r,e,t),P("defaultValue",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},O5=function(r,e,t){switch(r.op){case"Max":var n=P("axis",r,e,t),a=P("keepDims",r,e,t);return[Wa(P("x",r,e,t),n,a)];case"Mean":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[un(P("x",r,e,t),n,a)];case"Min":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[Nf(P("x",r,e,t),n,a)];case"Sum":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[fr(P("x",r,e,t),n,a)];case"All":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[Af(P("x",r,e,t),n,a)];case"Any":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[Ku(P("x",r,e,t),n,a)];case"ArgMax":return n=P("axis",r,e,t),[Ri(P("x",r,e,t),n)];case"ArgMin":return n=P("axis",r,e,t),[Om(P("x",r,e,t),n)];case"Prod":return n=P("axis",r,e,t),a=P("keepDims",r,e,t),[Tf(P("x",r,e,t),n,a)];default:throw TypeError("Node type "+r.op+" is not implemented")}},D5=function(r,e,t){switch(r.op){case"ConcatV2":case"Concat":var n=P("axis",r,e,t),a=P("tensors",r,e,t);return[Vn(a,n)];case"GatherV2":case"Gather":n=P("axis",r,e,t);var i=P("x",r,e,t),s=P("indices",r,e,t);return[fa(i,s.asType("int32"),n)];case"ReverseV2":case"Reverse":return n=P("axis",r,e,t),i=P("x",r,e,t),[va(i,n)];case"Slice":var u=P("begin",r,e,t),c=P("size",r,e,t);return[nr(P("x",r,e,t),u,c)];case"StridedSlice":u=P("begin",r,e,t);var f=P("end",r,e,t),h=P("strides",r,e,t),d=P("beginMask",r,e,t),m=P("endMask",r,e,t),g=P("ellipsisMask",r,e,t),y=P("newAxisMask",r,e,t),x=P("shrinkAxisMask",r,e,t),w=P("x",r,e,t);if(u.length===1&&w.shape.length>1)for(var b=1;b<w.shape.length;b++)u.push(0),f.push(w.shape[b]),h.push(h[0]);return[Mm(w,u,f,h,d,m,g,y,x)];case"Pack":return ft(function(){var k=P("axis",r,e,t),z=P("tensors",r,e,t),F=z[0].shape,B=z[0].squeeze().shape,V=z.map(function(G){var Q=At.arraysEqual(G.shape,F);if(!Q&&!At.arraysEqual(G.squeeze().shape,B))throw new Error("the input tensors shape does not match");return Q?G:G.reshape(F)});return[Lr(V,k)]});case"Unpack":return ft(function(){var k=P("axis",r,e,t),z=P("tensor",r,e,t);return Ni(z,k)});case"Tile":var C=P("reps",r,e,t);return[bi(P("x",r,e,t),C)];case"Split":case"SplitV":n=P("axis",r,e,t);var A=P("numOrSizeSplits",r,e,t);return La(P("x",r,e,t),A,n);case"ScatterNd":s=P("indices",r,e,t);var T=P("values",r,e,t),R=P("shape",r,e,t);return[Fm(s,T,R)];case"GatherNd":var D=P("x",r,e,t);return s=P("indices",r,e,t),[Bm(D,s)];case"SparseToDense":s=P("sparseIndices",r,e,t),R=P("outputShape",r,e,t);var N=P("sparseValues",r,e,t),O=P("defaultValue",r,e,t);return[If(s,N,R,N.dtype===O.dtype?O:O.asType(N.dtype))];default:throw TypeError("Node type "+r.op+" is not implemented")}},I5=function(r,e,t){switch(r.op){case"FFT":return[fl(P("x",r,e,t))];case"IFFT":return[As(P("x",r,e,t))];case"RFFT":return[hl(P("x",r,e,t))];case"IRFFT":return[Df(P("x",r,e,t))];default:throw TypeError("Node type "+r.op+" is not implemented")}},k5=function(r,e,t){switch(r.op){case"Cast":return[No(P("x",r,e,t),P("dtype",r,e,t))];case"ExpandDims":var n=P("axis",r,e,t);return[Qn(P("x",r,e,t),n)];case"Squeeze":return n=P("axis",r,e,t),[Ai(P("x",r,e,t),n)];case"Reshape":return[Ms(P("x",r,e,t),P("shape",r,e,t))];case"PadV2":case"Pad":return[ki(P("x",r,e,t),n0(P("padding",r,e,t),2),P("constantValue",r,e,t))];case"SpaceToBatchND":var a=P("blockShape",r,e,t),i=n0(P("paddings",r,e,t),2);return[af(P("x",r,e,t),a,i)];case"BatchToSpaceND":a=P("blockShape",r,e,t);var s=n0(P("crops",r,e,t),2);return[nf(P("x",r,e,t),a,s)];case"DepthToSpace":var u=P("blockSize",r,e,t),c=P("dataFormat",r,e,t).toUpperCase();return[jd(P("x",r,e,t),u,c)];default:throw TypeError("Node type "+r.op+" is not implemented")}};function tN(r,e,t){var n=(function(a,i,s){switch(a.category){case"arithmetic":return g5(a,i,s);case"basic_math":return y5(a,i,s);case"control":return x5(a,i,s);case"convolution":return w5(a,i,s);case"creation":return S5(a,i,s);case"dynamic":return E5(a,i,s);case"evaluation":return C5(a,i,s);case"image":return N5(a,i,s);case"graph":return A5(a,i,s);case"logical":return T5(a,i,s);case"matrices":return R5(a,i,s);case"normalization":return _5(a,i,s);case"reduction":return O5(a,i,s);case"slice_join":return D5(a,i,s);case"spectral":return I5(a,i,s);case"transformation":return k5(a,i,s);case"custom":var u=f3(a.op);if(u&&u.customExecutor)return u.customExecutor(new v5(a,i,s));throw TypeError("Custom op "+a.op+" is not registered.");default:throw TypeError("Unknown op '"+a.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(r,e,t);return n instanceof Promise?n.then(function(a){return[].concat(a)}):[].concat(n)}var eN=(function(){function r(e,t){this.weightMap=e,this.tensorArrayMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return r.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(r.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),r.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e},r.prototype.contextIdforContexts=function(e){return e?e.map(function(t){return t.id===0&&t.iterationId===0?"":t.frameName+"-"+t.iterationId}).join("/"):""},r.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},r.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},r.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},r.prototype.getWeight=function(e){return this.weightMap[e]},r.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},r.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},r})();function nN(r,e,t){for(var n=new Set,a=[],i=null,s=null,u=new Set,c=e.slice();c.length>0;){var f=c.pop();(m3(f)||B5(f))&&i==null&&(s=(i=f).children.map(function(h){return h.name}).filter(function(h){return n.has(h)})),n.add(f.name),t[f.name]==null&&r[f.name]==null&&(f.inputs.length!==0?f.inputs.forEach(function(h){u.has(h.name)||(u.add(h.name),c.push(h))}):a.push(f.name))}return{inputs:r,outputs:e,usedNodes:n,missingInputs:a,dynamicNode:i,syncInputs:s}}function M5(r,e,t){var n=t.usedNodes,a=t.inputs,i=[];Object.keys(a).map(function(f){return r.nodes[f]}).forEach(function(f){n.has(f.name)&&i.push(f)}),r.weights.forEach(function(f){n.has(f.name)&&i.push(f)});for(var s=new Set,u=[];i.length>0;){var c=i.pop();s.add(c.name),e[c.name]||u.push(c),c.children.forEach(function(f){!s.has(f.name)&&n.has(f.name)&&f.inputs.every(function(h){return s.has(h.name)})&&i.push(f)})}return u}var z5=["Switch","Merge","Enter","Exit","NextIteration"],F5=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function m3(r){return z5.indexOf(r.op)>=0}function B5(r){return F5.indexOf(r.op)>=0}var L5=(function(){function r(e){this.graph=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=e.placeholders,this._outputs=e.outputs}return Object.defineProperty(r.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map(function(n){return e[n].map(function(a){return a.id})});this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this.placeholders.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this._outputs.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(e){return e.name})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this.outputs.map(function(e){return e.name})},enumerable:!0,configurable:!0}),r.prototype.getCompilationKey=function(e,t){var n=e.map(function(i){return i.name}).sort(),a=t.map(function(i){return i.name}).sort();return n.join(this.SEPERATOR)+"--"+a.join(this.SEPERATOR)},r.prototype.compile=function(e,t){var n=nN(e,t,this.weightMap),a=n.missingInputs,i=n.dynamicNode,s=n.syncInputs;if(i!=null)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+s+"]");if(a.length>0){var u=t.map(function(f){return f.name}),c=Object.keys(e);throw new Error("Cannot compute the outputs ["+u+"] from the provided inputs ["+c+"]. Missing the following inputs: ["+a+"]")}return M5(this.graph,this.weightMap,n)},r.prototype.execute=function(e,t){var n=this,a=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),this.checkOutputs(t);var i=a.map(function(h){return n.graph.nodes[h]}),s=t.map(function(h){return n.graph.nodes[Oc(h)[0]]}),u=this.getCompilationKey(i,s),c=this.compiledMap.get(u);c==null&&(c=this.compile(e,s),this.compiledMap.set(u,c));var f={};return ft(function(){var h=new eN(n._weightMap,f),d=$b({},n.weightMap);Object.keys(e).forEach(function(b){d[b]=[e[b]]});for(var m=n.getFrozenTensorIds(d),g={},y=0;y<c.length;y++){var x=c[y];if(!d[x.name]){var w=tN(x,d,h);if(w instanceof Promise)throw new Error("The execution of the op '"+x.op+"' returned a promise. Please use model.executeAsync() instead.");d[x.name]=w,n.checkTensorForDisposal(x.name,x,d,h,m,t,g)}}return t.map(function(b){return ur(b,d,h)})})},r.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map(function(n){return e[n]}).map(function(n){return n.map(function(a){return a.id})}));return new Set(t)},r.prototype.checkTensorForDisposal=function(e,t,n,a,i,s,u){t.category!=="control"&&s.indexOf(e)===-1&&(n[e].forEach(function(c){c!=null&&(u[c.id]=(u[c.id]||0)+t.children.length)}),t.inputs.forEach(function(c){if(c.category!=="control"){var f=zV(c.name,n,a);f?.forEach(function(h){if(h&&!i.has(h.id)){var d=u[h.id];d===1?(h.dispose(),delete u[h.id]):d!=null&&u[h.id]--}})}}))},r.prototype.executeAsync=function(e,t){return Rs(this,void 0,void 0,function(){var n,a,i,s,u,c,f=this;return _s(this,function(h){switch(h.label){case 0:return this.checkInputs(e),this.checkInputShapeAndType(e),this.checkOutputs(t),n={},a=new eN(this._weightMap,n),[4,this.executeWithControlFlow(e,a,t)];case 1:return i=h.sent(),s=t.map(function(d){return ur(d,i,a)}),u=new Set(s.map(function(d){return d.id})),c=new Set(Object.keys(e).map(function(d){return e[d].id})),Object.keys(i).forEach(function(d){i[d].forEach(function(m){!m||m.isDisposed||u.has(m.id)||c.has(m.id)||f.weightIds.indexOf(m.id)!==-1||m.dispose()})}),[2,s]}})})},r.prototype.executeWithControlFlow=function(e,t,n){return Rs(this,void 0,void 0,function(){var a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T=this;return _s(this,function(R){switch(R.label){case 0:a=Object.keys(e),i=a.map(function(D){return T.graph.nodes[D]}),s=n.map(function(D){return T.graph.nodes[Oc(D)[0]]}),u=nN(e,s,this.weightMap),c=u.usedNodes,f=u.missingInputs,h=u.dynamicNode,d=u.syncInputs,m=i.concat(this.graph.weights).map(function(D){return{node:D,contexts:t.currentContext}}),g=$b({},this.weightMap),Object.keys(e).forEach(function(D){g[D]=[e[D]]}),y={},x=this.getFrozenTensorIds(g),w={},R.label=1;case 1:return m.length>0?(b=this.processStack(i,m,t,g,w,x,n,y,c),[4,Promise.all(b)]):[3,3];case 2:return R.sent(),[3,1];case 3:if(h==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(C=s.filter(function(D){return!m3(D)&&!ur(D.name,g,t)}).map(function(D){return D.name})).length>0)throw A="",h!=null&&(A="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+d+"]"),new Error("Cannot compute the outputs ["+C+"] from the provided inputs ["+a+"]. Consider providing the following inputs: ["+f+"]. "+A);return[2,g]}})})},r.prototype.processStack=function(e,t,n,a,i,s,u,c,f){for(var h=this,d=[],m=function(){var y=t.pop();n.currentContext=y.contexts;var x="";if(y.node.op==="Enter"&&P("isConstant",y.node,a,n)&&(x=Bp(y.node.name,n)[0]),e.indexOf(y.node)===-1){var w=tN(y.node,a,n);x||(x=Bp(y.node.name,n)[0]);var b=n.currentContext;w instanceof Promise?d.push(w.then(function(C){return a[x]=C,n.currentContext=b,h.checkTensorForDisposal(x,y.node,a,n,s,u,c),h.processChildNodes(y.node,t,n,a,i,f),C})):(a[x]=w,g.checkTensorForDisposal(x,y.node,a,n,s,u,c),g.processChildNodes(y.node,t,n,a,i,f))}else g.processChildNodes(y.node,t,n,a,i,f)},g=this;t.length>0;)m();return d},r.prototype.processChildNodes=function(e,t,n,a,i,s){e.children.forEach(function(u){var c=Bp(u.name,n)[0];!i[c]&&s.has(u.name)&&(u.op==="Merge"?u.inputNames.some(function(f){return!!ur(f,a,n)})&&(i[c]=!0,t.push({contexts:n.currentContext,node:u})):u.inputNames.every(function(f){return!!ur(f,a,n)})&&(i[c]=!0,t.push({contexts:n.currentContext,node:u})))})},r.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach(function(t){return e.weightMap[t].forEach(function(n){return n.dispose()})})},r.prototype.checkInputShapeAndType=function(e){var t=this;Object.keys(e).forEach(function(n){var a=e[n],i=t.graph.nodes[n];if(i.attrParams.shape&&i.attrParams.shape.value){var s=i.attrParams.shape.value,u=s.length===a.shape.length&&a.shape.every(function(c,f){return s[f]===-1||s[f]===c});At.assert(u,function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+a.shape+"]"})}i.attrParams.dtype&&i.attrParams.dtype.value&&At.assert(a.dtype===i.attrParams.dtype.value,function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+a.dtype})})},r.prototype.checkInputs=function(e){var t=this,n=Object.keys(e).filter(function(a){return!t.graph.nodes[a]});if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},r.prototype.checkOutputs=function(e){var t=this;e.forEach(function(n){var a=Oc(n)[0];if(!t.graph.nodes[a])throw new Error("The output '"+n+"' is not found in the graph")})},r})(),U5="?tfjs-format=file",j5="model.json",v3=(function(){function r(e,t){t===void 0&&(t={}),this.modelUrl=e,this.loadOptions=t,this.version="n/a",t==null&&(this.loadOptions={})}return Object.defineProperty(r.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),r.prototype.findIOHandler=function(){var e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=lr.browserHTTPRequest(e,this.loadOptions);else{var t=lr.getLoadHandlers(e,this.loadOptions.onProgress);if(t.length===0)t.push(lr.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for URL '"+[e]+"'");this.handler=t[0]}},r.prototype.load=function(){return Rs(this,void 0,void 0,function(){var e,t,n;return _s(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return e=a.sent(),t=e.modelTopology,this.version=t.versions.producer+"."+t.versions.minConsumer,n=lr.decodeWeights(e.weightData,e.weightSpecs),this.executor=new L5(d5.Instance.transformGraph(t)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}})})},r.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},r.prototype.normalizeInputs=function(e){if(!(e instanceof Ee||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+e.length+" input tensors.");return this.inputNodes.reduce(function(t,n,a){return t[n]=e[a],t},{})},r.prototype.normalizeOutputs=function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]},r.prototype.execute=function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]},r.prototype.executeAsync=function(e,t){return Rs(this,void 0,void 0,function(){var n;return _s(this,function(a){switch(a.label){case 0:return e=this.normalizeInputs(e),t=this.normalizeOutputs(t),[4,this.executor.executeAsync(e,t)];case 1:return[2,(n=a.sent()).length>1?n:n[0]]}})})},r.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce(function(t,n){return t[n]=[e[n]],t},{})},r.prototype.dispose=function(){this.executor.dispose()},r})();function Nw(r,e){return e===void 0&&(e={}),Rs(this,void 0,void 0,function(){var t;return _s(this,function(n){switch(n.label){case 0:if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return e==null&&(e={}),e.fromTFHub&&r.load==null&&(r.endsWith("/")||(r+="/"),r=""+r+j5+U5),[4,(t=new v3(r,e)).load()];case 1:return n.sent(),[2,t]}})})}var g3="1.3.1",y3=function(r,e){return(y3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(r,e)};function Me(r,e){function t(){this.constructor=r}y3(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Bt(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){f.done?a(f.value):new t(function(h){h(f.value)}).then(s,u)}c((n=n.apply(r,[])).next())})}function Lt(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}function Ws(r,e){return r(e={exports:{}},e.exports),e.exports}var P5=Ws(function(r){(function(e,t,n){function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function i(s,u){var c=new function(d){var m,g=this,y=(m=4022871197,function(x){x=x.toString();for(var w=0;w<x.length;w++){var b=.02519603282416938*(m+=x.charCodeAt(w));b-=m=b>>>0,m=(b*=m)>>>0,m+=4294967296*(b-=m)}return 23283064365386963e-26*(m>>>0)});g.next=function(){var x=2091639*g.s0+23283064365386963e-26*g.c;return g.s0=g.s1,g.s1=g.s2,g.s2=x-(g.c=0|x)},g.c=1,g.s0=y(" "),g.s1=y(" "),g.s2=y(" "),g.s0-=y(d),g.s0<0&&(g.s0+=1),g.s1-=y(d),g.s1<0&&(g.s1+=1),g.s2-=y(d),g.s2<0&&(g.s2+=1),y=null}(s),f=u&&u.state,h=c.next;return h.int32=function(){return 4294967296*c.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.alea=i})(0,r)}),V5=Ws(function(r){(function(e,t,n){function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function i(s,u){var c=new function(d){var m=this,g="";m.x=0,m.y=0,m.z=0,m.w=0,m.next=function(){var x=m.x^m.x<<11;return m.x=m.y,m.y=m.z,m.z=m.w,m.w^=m.w>>>19^x^x>>>8},d===(0|d)?m.x=d:g+=d;for(var y=0;y<g.length+64;y++)m.x^=0|g.charCodeAt(y),m.next()}(s),f=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=c.next,h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.xor128=i})(0,r)}),q5=Ws(function(r){(function(e,t,n){function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function i(s,u){var c=new function(d){var m=this,g="";m.next=function(){var x=m.x^m.x>>>2;return m.x=m.y,m.y=m.z,m.z=m.w,m.w=m.v,(m.d=m.d+362437|0)+(m.v=m.v^m.v<<4^x^x<<1)|0},m.x=0,m.y=0,m.z=0,m.w=0,m.v=0,d===(0|d)?m.x=d:g+=d;for(var y=0;y<g.length+64;y++)m.x^=0|g.charCodeAt(y),y==g.length&&(m.d=m.x<<10^m.x>>>4),m.next()}(s),f=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=c.next,h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.xorwow=i})(0,r)}),W5=Ws(function(r){(function(e,t,n){function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function i(s,u){s==null&&(s=+new Date);var c=new function(d){var m=this;m.next=function(){var g,y,x=m.x,w=m.i;return g=x[w],y=(g^=g>>>7)^g<<24,y^=(g=x[w+1&7])^g>>>10,y^=(g=x[w+3&7])^g>>>3,y^=(g=x[w+4&7])^g<<7,g=x[w+7&7],y^=(g^=g<<13)^g<<9,x[w]=y,m.i=w+1&7,y},(function(g,y){var x,w=[];if(y===(0|y))w[0]=y;else for(y=""+y,x=0;x<y.length;++x)w[7&x]=w[7&x]<<15^y.charCodeAt(x)+w[x+1&7]<<13;for(;w.length<8;)w.push(0);for(x=0;x<8&&w[x]===0;++x);for(x==8?w[7]=-1:w[x],g.x=w,g.i=0,x=256;x>0;--x)g.next()})(m,d)}(s),f=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=c.next,h.quick=h,f&&(f.x&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.xorshift7=i})(0,r)}),H5=Ws(function(r){(function(e,t,n){function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function i(s,u){s==null&&(s=+new Date);var c=new function(d){var m=this;m.next=function(){var g,y,x=m.w,w=m.X,b=m.i;return m.w=x=x+1640531527|0,y=w[b+34&127],g=w[b=b+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=w[b]=y^g,m.i=b,y+(x^x>>>16)|0},(function(g,y){var x,w,b,C,A,T=[],R=128;for(y===(0|y)?(w=y,y=null):(y+="\0",w=0,R=Math.max(R,y.length)),b=0,C=-32;C<R;++C)y&&(w^=y.charCodeAt((C+32)%y.length)),C===0&&(A=w),w^=w<<10,w^=w>>>15,w^=w<<4,w^=w>>>13,C>=0&&(A=A+1640531527|0,b=(x=T[127&C]^=w+A)==0?b+1:0);for(b>=128&&(T[127&(y&&y.length||0)]=-1),b=127,C=512;C>0;--C)w=T[b+34&127],x=T[b=b+1&127],w^=w<<13,x^=x<<17,w^=w>>>15,x^=x>>>12,T[b]=w^x;g.w=A,g.X=T,g.i=b})(m,d)}(s),f=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=c.next,h.quick=h,f&&(f.X&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.xor4096=i})(0,r)}),G5=Ws(function(r){(function(e,t,n){function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function i(s,u){var c=new function(d){var m=this,g="";m.next=function(){var x=m.b,w=m.c,b=m.d,C=m.a;return x=x<<25^x>>>7^w,w=w-b|0,b=b<<24^b>>>8^C,C=C-x|0,m.b=x=x<<20^x>>>12^w,m.c=w=w-b|0,m.d=b<<16^w>>>16^C,m.a=C-x|0},m.a=0,m.b=0,m.c=-1640531527,m.d=1367130551,d===Math.floor(d)?(m.a=d/4294967296|0,m.b=0|d):g+=d;for(var y=0;y<g.length+20;y++)m.b^=0|g.charCodeAt(y),m.next()}(s),f=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=c.next,h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}t&&t.exports?t.exports=i:this.tychei=i})(0,r)}),os=Ws(function(r){(function(e,t){var n,a=this,i=256,s=6,u="random",c=t.pow(i,s),f=t.pow(2,52),h=2*f,d=i-1;function m(w,b,C){var A=[],T=y((function N(O,k){var z,F=[],B=typeof O;if(k&&B=="object")for(z in O)try{F.push(N(O[z],k-1))}catch{}return F.length?F:B=="string"?O:O+"\0"})((b=b==1?{entropy:!0}:b||{}).entropy?[w,x(e)]:w??(function(){try{var N;return n&&(N=n.randomBytes)?N=N(i):(N=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(N)),x(N)}catch{var O=a.navigator,k=O&&O.plugins;return[+new Date,a,k,a.screen,x(e)]}})(),3),A),R=new function(N){var O,k=N.length,z=this,F=0,B=z.i=z.j=0,V=z.S=[];for(k||(N=[k++]);F<i;)V[F]=F++;for(F=0;F<i;F++)V[F]=V[B=d&B+N[F%k]+(O=V[F])],V[B]=O;(z.g=function(G){for(var Q,L=0,X=z.i,$=z.j,it=z.S;G--;)Q=it[X=d&X+1],L=L*i+it[d&(it[X]=it[$=d&$+Q])+(it[$]=Q)];return z.i=X,z.j=$,L})(i)}(A),D=function(){for(var N=R.g(s),O=c,k=0;N<f;)N=(N+k)*i,O*=i,k=R.g(1);for(;N>=h;)N/=2,O/=2,k>>>=1;return(N+k)/O};return D.int32=function(){return 0|R.g(4)},D.quick=function(){return R.g(4)/4294967296},D.double=D,y(x(R.S),e),(b.pass||C||function(N,O,k,z){return z&&(z.S&&g(z,R),N.state=function(){return g(R,{})}),k?(t[u]=N,O):N})(D,T,"global"in b?b.global:this==t,b.state)}function g(w,b){return b.i=w.i,b.j=w.j,b.S=w.S.slice(),b}function y(w,b){for(var C,A=w+"",T=0;T<A.length;)b[d&T]=d&(C^=19*b[d&T])+A.charCodeAt(T++);return x(b)}function x(w){return String.fromCharCode.apply(0,w)}if(t["seed"+u]=m,y(t.random(),e),r.exports){r.exports=m;try{n=require("crypto")}catch{}}})([],Math)});os.alea=P5,os.xor128=V5,os.xorwow=q5,os.xorshift7=W5,os.xor4096=H5,os.tychei=G5;var X5=os,b3=X5.alea;function K5(r,e){return Cd(r,e)}function Cd(r,e,t,n){if(t===void 0&&(t=new Map),n===void 0&&(n=new Set),r==null)return null;if(n.has(r))throw new Error("Circular references are not supported.");if(t.has(r))return t.get(r);var a=e(r);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(Ju(r)){var i=Array.isArray(r)?[]:{};for(var s in n.add(r),r){var u=Cd(r[s],e,t,n);i[s]=u}return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: "+r)}return t.set(r,a.value),a.value}function Y5(r,e){return e===void 0&&(e=w3),x3(r,e)}function x3(r,e,t){t===void 0&&(t=new Set);var n=r[0];if(t.has(n))throw new Error("Circular references are not supported.");var a=e(r);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(Ju(n)){var i=Array.isArray(n)?[]:{};t.add(n);var s=function(c){var f=x3(r.map(function(h){return h[c]}),e,t);i[c]=f};for(var u in n)s(u);return t.delete(n),i}throw new Error("Can't recurse into non-iterable type: "+n)}return a.value}function w3(r){return r===null?null:Ju(r[0])?{value:null,recurse:!0}:{value:r,recurse:!1}}function S3(r,e){return Bt(this,void 0,void 0,function(){var t,n,a,i,s,u;return Lt(this,function(c){switch(c.label){case 0:t=new Map,Cd(r,e,t),n=0,a=Array.from(t.keys()),c.label=1;case 1:return n<a.length?(i=a[n],(s=t.get(i))instanceof Promise?[4,s]:[3,3]):[3,4];case 2:u=c.sent(),t.set(i,u),c.label=3;case 3:return n++,[3,1];case 4:return[2,Cd(r,e,t)]}})})}function Ju(r){return r!=null&&!ArrayBuffer.isView(r)&&(Array.isArray(r)||typeof r=="object"&&!(r instanceof Ee))}function $5(r){return r==null||Q5(r)||Array.isArray(r)||typeof r=="object"&&r instanceof Ee||At.isTypedArray(r)}function Q5(r){return r===null||typeof r!="object"&&typeof r!="function"}function Z5(r){return K5(r,J5)}function J5(r){return r instanceof Ee?{value:r.clone(),recurse:!1}:Ju(r)?{value:null,recurse:!0}:{value:r,recurse:!1}}var E3=(function(){function r(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}return r.prototype.wrap=function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity},r.prototype.get=function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]},r.prototype.set=function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t},r.prototype.length=function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e},r.prototype.isFull=function(){return this.length()===this.capacity},r.prototype.isEmpty=function(){return this.length()===0},r.prototype.push=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)},r.prototype.pushAll=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];this.push(a)}},r.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e},r.prototype.unshift=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)},r.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e},r.prototype.shuffleExcise=function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n},r})(),tq=(function(r){function e(){return r.call(this,e.INITIAL_CAPACITY)||this}return Me(e,r),e.prototype.isFull=function(){return!1},e.prototype.push=function(t){r.prototype.isFull.call(this)&&this.expand(),r.prototype.push.call(this,t)},e.prototype.unshift=function(t){r.prototype.isFull.call(this)&&this.expand(),r.prototype.unshift.call(this,t)},e.prototype.expand=function(){for(var t=2*this.capacity,n=new Array(t),a=this.length(),i=0;i<a;i++)n[i]=this.get(this.wrap(this.begin+i));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=a},e.INITIAL_CAPACITY=32,e})(E3);function C3(r){return new rq(r)}function Tw(r){return new aq(r)}function eq(r,e){return new A3(r,e)}function nq(r,e){return e===void 0&&(e=po.FAIL),new pq(r,e)}var po,Fn=(function(){function r(){}return r.prototype.toArray=function(){return Bt(this,void 0,void 0,function(){var e,t;return Lt(this,function(n){switch(n.label){case 0:return e=[],[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:(e.push(t.value),[4,this.next()]);case 3:return t=n.sent(),[3,2];case 4:return[2,e]}})})},r.prototype.toArrayForTest=function(){return Bt(this,void 0,void 0,function(){var e,t,n;return Lt(this,function(a){switch(a.label){case 0:return e=this.prefetch(100),t=[],[4,e.next()];case 1:n=a.sent(),a.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,e.next()]);case 3:return n=a.sent(),[3,2];case 4:return[2,t]}})})},r.prototype.resolveFully=function(){return Bt(this,void 0,void 0,function(){var e;return Lt(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:e=t.sent(),t.label=2;case 2:return e.done?[3,4]:[4,this.next()];case 3:return e=t.sent(),[3,2];case 4:return[2]}})})},r.prototype.resolveWhile=function(e){return Bt(this,void 0,void 0,function(){var t,n;return Lt(this,function(a){switch(a.label){case 0:return[4,this.next()];case 1:t=a.sent(),n=e(t.value),a.label=2;case 2:return t.done||!n?[3,4]:[4,this.next()];case 3:return t=a.sent(),n=e(t.value),[3,2];case 4:return[2]}})})},r.prototype.handleErrors=function(e){return new fq(this,e)},r.prototype.filter=function(e){return new lq(this,e)},r.prototype.map=function(e){return new cq(this,e)},r.prototype.mapAsync=function(e){return new rN(this,e)},r.prototype.serialMapAsync=function(e){return new rN(this,e).serial()},r.prototype.flatmap=function(e){return new hq(this,e)},r.prototype.forEachAsync=function(e){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,this.map(e).resolveFully()]})})},r.prototype.serialForEach=function(e){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,this.serialMapAsync(e).resolveWhile(function(n){return n===!0})]})})},r.prototype.rowMajorBatch=function(e,t){return t===void 0&&(t=!0),new uq(this,e,t)},r.prototype.columnMajorBatch=function(e,t,n){return t===void 0&&(t=!0),n===void 0&&(n=w3),this.rowMajorBatch(e,t).map(function(a){return Y5(a,n)})},r.prototype.concatenate=function(e,t){return new A3(C3([this,e]),t)},r.prototype.take=function(e){return e<0||e==null?this:new sq(this,e)},r.prototype.skip=function(e){return e<0||e==null?this:new oq(this,e)},r.prototype.prefetch=function(e){return new N3(this,e)},r.prototype.shuffle=function(e,t){return new dq(this,e,t)},r.prototype.serial=function(){return new iq(this)},r})(),rq=(function(r){function e(t){var n=r.call(this)||this;return n.items=t,n.trav=0,n}return Me(e,r),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:Z5(t),done:!1}])})})},e})(Fn),aq=(function(r){function e(t){var n=r.call(this)||this;return n.nextFn=t,n}return Me(e,r),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){try{return[2,this.nextFn()]}catch(n){throw n.message="Error thrown while iterating through a dataset: "+n.message,n}return[2]})})},e})(Fn),iq=(function(r){function e(t){var n=r.call(this)||this;return n.upstream=t,n.lastRead=Promise.resolve({value:null,done:!1}),n}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,this.upstream.next()]})})},e})(Fn),oq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.maxCount=n,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){switch(n.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=n.sent()).done?[2,t]:(re(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},e})(Fn),sq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.maxCount=n,a.count=0,a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e})(Fn),uq=(function(r){function e(t,n,a){a===void 0&&(a=!0);var i=r.call(this)||this;return i.upstream=t,i.batchSize=n,i.enableSmallLastBatch=a,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){var t,n;return Lt(this,function(a){switch(a.label){case 0:t=[],a.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(n=a.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(n.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e})(Fn),lq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.predicate=n,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){switch(n.label){case 0:return[4,this.upstream.next()];case 1:return(t=n.sent()).done||this.predicate(t.value)?[2,t]:(re(t.value),[3,0]);case 2:return[2]}})})},e})(Fn),cq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.transform=n,a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s,u,c;return Lt(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:if((t=f.sent()).done)return[2,{value:null,done:!0}];for(n=pa.getTensorsInContainer(t.value),a=this.transform(t.value),i=pa.getTensorsInContainer(a),s=0,u=n;s<u.length;s++)c=u[s],pa.isTensorInList(c,i)||c.dispose();return[2,{value:a,done:!1}]}})})},e})(Fn),fq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.handler=n,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e})(Fn),rN=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.transform=n,a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s,u,c;return Lt(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:return(t=f.sent()).done?[2,{value:null,done:!0}]:(n=pa.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(a=f.sent(),i=pa.getTensorsInContainer(a),s=0,u=n;s<u.length;s++)c=u[s],pa.isTensorInList(c,i)||c.dispose();return[2,{value:a,done:!1}]}})})},e})(Fn),Rw=(function(r){function e(){var t=r.call(this)||this;return t.outputQueue=new tq,t.lastRead=Promise.resolve({value:null,done:!1}),t}return Me(e,r),e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){switch(t.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e})(Fn),hq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.transform=n,a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s,u,c;return Lt(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:if((t=f.sent()).done)return[2,!1];for(n=pa.getTensorsInContainer(t.value),a=this.transform(t.value),i=pa.getTensorsInContainer(a),this.outputQueue.pushAll(a),s=0,u=n;s<u.length;s++)c=u[s],pa.isTensorInList(c,i)||c.dispose();return[2,!0]}})})},e})(Rw),A3=(function(r){function e(t,n){var a=r.call(this)||this;return a.baseErrorHandler=n,a.lastRead=null,a.iterator=null,a.moreIterators=t,a}return Me(e,r),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return Bt(this,void 0,void 0,function(){var n,a;return Lt(this,function(i){switch(i.label){case 0:return[4,t];case 1:return i.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((n=i.sent()).done)return[2,{value:null,done:!0}];this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),i.label=3;case 3:return[4,this.iterator.next()];case 4:return(a=i.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,a]}})})},e})(Fn);(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})(po||(po={}));var pq=(function(r){function e(t,n){n===void 0&&(n=po.FAIL);var a=r.call(this)||this;return a.iterators=t,a.mismatchMode=n,a.count=0,a.currentPromise=null,a}return Me(e,r),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return Bt(this,void 0,void 0,function(){function n(u){return u instanceof Fn?{value:u.next().then(function(c){return a++,c.done&&i++,c.value}),recurse:!1}:{value:null,recurse:!0}}var a,i,s;return Lt(this,function(u){switch(u.label){case 0:return[4,t];case 1:return u.sent(),a=0,i=0,[4,S3(this.iterators,n)];case 2:if(s=u.sent(),a===i)return[2,{value:null,done:!0}];if(i>0)switch(this.mismatchMode){case po.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case po.SHORTEST:return[2,{value:null,done:!0}];case po.LONGEST:}return this.count++,[2,{value:s,done:!1}]}})})},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},e})(Fn),N3=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.bufferSize=n,a.buffer=new E3(n),a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e})(Fn),dq=(function(r){function e(t,n,a){var i=r.call(this,t,n)||this;return i.upstream=t,i.windowSize=n,i.upstreamExhausted=!1,i.random=b3(a||At.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return Me(e,r),e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t=this;return Lt(this,function(n){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return Bt(this,void 0,void 0,function(){var t,n;return Lt(this,function(a){switch(a.label){case 0:this.upstreamExhausted||this.refill(),a.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(n=a.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,n]);case 3:return[2,{value:null,done:!0}]}})})},e})(N3),Wf=(function(){function r(){this.size=null}return r.prototype.batch=function(e,t){var n=this;t===void 0&&(t=!0);var a=this;return At.assert(e>0,function(){return`batchSize needs to be positive, but it is
      `+e}),xr(function(){return Bt(n,void 0,void 0,function(){return Lt(this,function(i){switch(i.label){case 0:return[4,a.iterator()];case 1:return[2,i.sent().columnMajorBatch(e,t,mq)]}})})},this.size===1/0||this.size==null?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e))},r.prototype.concatenate=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){var a,i;return Lt(this,function(s){switch(s.label){case 0:return[4,n.iterator()];case 1:return i=(a=s.sent()).concatenate,[4,e.iterator()];case 2:return[2,i.apply(a,[s.sent()])]}})})},this.size===1/0||e.size===1/0?1/0:this.size!=null&&e.size!=null?this.size+e.size:null)},r.prototype.filter=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().filter(function(i){return ft(function(){return e(i)})})]}})})},this.size===1/0?1/0:null)},r.prototype.forEachAsync=function(e){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){switch(t.label){case 0:return[4,this.iterator()];case 1:return[2,t.sent().forEachAsync(e)]}})})},r.prototype.forEach=function(e){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return Jc("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(e)]})})},r.prototype.map=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().map(function(i){return ft(function(){return e(i)})})]}})})},this.size)},r.prototype.mapAsync=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().mapAsync(e)]}})})},this.size)},r.prototype.prefetch=function(e){var t=this;if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().prefetch(e)]}})})},this.size)},r.prototype.repeat=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){var a=this;return Lt(this,function(i){return[2,eq(Tw(function(){return Bt(a,void 0,void 0,function(){var s;return Lt(this,function(u){switch(u.label){case 0:return s={},[4,n.iterator()];case 1:return[2,(s.value=u.sent(),s.done=!1,s)]}})})}).take(e))]})})},this.size!=null&&e>0?this.size*e:e===0?0:this.size!=null&&(e===void 0||e<0)?1/0:null)},r.prototype.skip=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().skip(e)]}})})},this.size!=null&&e>=0&&this.size>=e?this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?0:null)},r.prototype.shuffle=function(e,t,n){var a=this;if(n===void 0&&(n=!0),e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var i=this,s=b3(t||At.now().toString());return xr(function(){return Bt(a,void 0,void 0,function(){var u;return Lt(this,function(c){switch(c.label){case 0:return u=s.int32(),n&&(u+=s.int32()),[4,i.iterator()];case 1:return[2,c.sent().shuffle(e,u.toString())]}})})},this.size)},r.prototype.take=function(e){var t=this,n=this;return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().take(e)]}})})},this.size!=null&&this.size>e?e:this.size!=null&&this.size<=e?this.size:null)},r.prototype.toArray=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(e){switch(e.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,e.sent().toArray()]}})})},r.prototype.toArrayForTest=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(e){switch(e.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,e.sent().toArrayForTest()]}})})},r.MAX_BUFFER_SIZE=1e4,r})();function xr(r,e){return e===void 0&&(e=null),new((function(t){function n(){var a=t!==null&&t.apply(this,arguments)||this;return a.size=e,a}return Me(n,t),n.prototype.iterator=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(a){return[2,r()]})})},n})(Wf))}function Ac(r){var e=this;return xr(function(){return Bt(e,void 0,void 0,function(){return Lt(this,function(t){return[2,C3(r)]})})},r.length)}function s1(r){var e,t=this;if(!Ju(r))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(r))for(var n=0;n<r.length;n++)e=e==null?r[n].size:Math.min(e,r[n].size);else if(r instanceof Object)for(var a in r)e=e==null?r[a].size:Math.min(e,r[a].size);return xr(function(){return Bt(t,void 0,void 0,function(){return Lt(this,function(i){switch(i.label){case 0:return[4,S3(r,function(s){if(s instanceof Wf)return{value:s.iterator(),recurse:!1};if(Ju(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,nq(i.sent(),po.SHORTEST)]}})})},e)}function mq(r){return r===null?null:$5(r[0])?{value:vq(r),recurse:!1}:{value:null,recurse:!0}}function vq(r){if(r.length===0)throw new Error("Can't make a batch of zero elements.");return r[0]instanceof Ee?Lr(r):sn(r)}var T3=(function(r){function e(t){var n=r.call(this)||this;return n.input=t,n}return Me(e,r),e.prototype.iterator=function(){return Bt(this,void 0,void 0,function(){var t,n;return Lt(this,function(a){switch(a.label){case 0:return[4,this.input.iterator()];case 1:return t=a.sent(),n=t.decodeUTF8(),[2,n.split(`
`).map(function(i){return i.endsWith("\r")&&(i=i.slice(0,-1)),i})]}})})},e})(Wf),wp='"',vc=Symbol("out"),aN=Symbol("field"),Sp=Symbol("quote"),r0=Symbol("quoteafterquote"),iN=Symbol("quoteinquote"),R3=(function(r){function e(t,n){var a=r.call(this)||this;return a.input=t,a.hasHeader=!0,a.fullColumnNames=null,a.columnNamesValidated=!1,a.columnConfigs=null,a.configuredColumnsOnly=!1,a.delimiter=",",a.delimWhitespace=!1,a.base=new T3(t),n||(n={}),a.hasHeader=n.hasHeader!==!1,a.fullColumnNames=n.columnNames,a.columnConfigs=n.columnConfigs,a.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(At.assert(n.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),a.delimWhitespace=!0,a.delimiter=" "):a.delimiter=n.delimiter?n.delimiter:",",a}return Me(e,r),e.prototype.columnNames=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},e.prototype.setColumnNames=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s,u,c=this;return Lt(this,function(f){switch(f.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=f.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&At.assert(t.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+c.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=t),n=this.fullColumnNames.reduce(function(h,d){return h[d]=h[d]+1||1,h},{}),a=Object.keys(n).filter(function(h){return n[h]>1}),At.assert(a.length===0,function(){return"Duplicate column names found: "+a.toString()}),this.columnConfigs){for(i=0,s=Object.keys(this.columnConfigs);i<s.length;i++)if(u=s[i],this.fullColumnNames.indexOf(u)===-1)throw new Error('The key "'+u+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},e.prototype.maybeReadHeaderLine=function(){return Bt(this,void 0,void 0,function(){var t,n;return Lt(this,function(a){switch(a.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,a.sent().next()];case 2:if((t=a.sent()).done)throw new Error("No data was found for CSV parsing.");return n=t.value,[2,this.parseRow(n,!1)];case 3:return[2,null]}})})},e.prototype.iterator=function(){return Bt(this,void 0,void 0,function(){var t,n=this;return Lt(this,function(a){switch(a.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:a.sent(),a.label=2;case 2:return[4,this.base.iterator()];case 3:return t=a.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(i){return n.makeDataElement(i)})]}})})},e.prototype.makeDataElement=function(t){for(var n=this.parseRow(t),a={},i={},s=0;s<this.fullColumnNames.length;s++){var u=this.fullColumnNames[s],c=this.columnConfigs?this.columnConfigs[u]:null;if(!this.configuredColumnsOnly||c){var f=n[s],h=null;if(f==="")if(c&&c.default!==void 0)h=c.default;else{if(c&&(c.required||c.isLabel))throw new Error("Required column "+u+" is empty in this line: "+t);h=void 0}else{var d=Number(f);if(isNaN(d))h=c&&c.dtype==="bool"?this.getBoolean(f):f;else if(c&&c.dtype)switch(c.dtype){case"float32":h=d;break;case"int32":h=Math.floor(d);break;case"bool":h=this.getBoolean(f);break;default:h=d}else h=d}c&&c.isLabel?i[u]=h:a[u]=h}}return Object.keys(i).length===0?a:{xs:a,ys:i}},e.prototype.getBoolean=function(t){return t==="1"||t.toLowerCase()==="true"?1:0},e.prototype.parseRow=function(t,n){n===void 0&&(n=!0);for(var a=[],i=0,s=t.length,u=vc,c=0;c<s;c++)switch(u){case vc:switch(t.charAt(c)){case wp:i=c+1,u=Sp;break;case this.delimiter:if(i=c+1,this.delimiter===" "&&this.delimWhitespace)break;a.push(""),u=vc;break;default:u=aN,i=c}break;case aN:t.charAt(c)===this.delimiter&&(a.push(t.substring(i,c)),u=vc,i=c+1);break;case Sp:t.charAt(c)===wp&&(u=r0);break;case r0:switch(t.charAt(c)){case this.delimiter:a.push(t.substring(i,c-1)),u=vc,i=c+1;break;case wp:u=Sp;break;default:u=iN}break;case iN:t.charAt(c)===wp&&(u=Sp)}if(u===r0?a.push(t.substring(i,s-1)):a.push(t.substring(i)),n&&a.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+a);return a},e})(Wf),gq=(function(r){function e(t){var n=r.call(this)||this;n.microphoneConfig=t,n.isClosed=!1,n.fftSize=t.fftSize||1024;var a=Math.log2(n.fftSize);if(n.fftSize<0||a<4||a>14||!Number.isInteger(a))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=t.numFramesPerSpectrogram||43,n.sampleRateHz=t.sampleRateHz,n.columnTruncateLength=t.columnTruncateLength||n.fftSize,n.audioTrackConstraints=t.audioTrackConstraints,n.smoothingTimeConstant=t.smoothingTimeConstant||0,n.includeSpectrogram=t.includeSpectrogram!==!1,n.includeWaveform=t.includeWaveform===!0,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}return Me(e,r),e.prototype.summary=function(){return"microphone"},e.create=function(t){return t===void 0&&(t={}),Bt(this,void 0,void 0,function(){var n;return Lt(this,function(a){switch(a.label){case 0:if(yt().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return a.sent(),[2,n]}})})},e.prototype.start=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i;return Lt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return t.stream=s.sent(),[3,3];case 2:throw n=s.sent(),new Error("Error thrown while initializing video stream: "+n.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(a=window.AudioContext||window.webkitAudioContext,this.audioContext=new a,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return i=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,i.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s;return Lt(this,function(u){switch(u.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return a=u.sent(),this.includeSpectrogram&&(i=this.flattenQueue(a.freqDataQueue),t=this.getTensorFromAudioDataArray(i,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(s=this.flattenQueue(a.timeDataQueue),n=this.getTensorFromAudioDataArray(s,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:n},done:!1}]}})})},e.prototype.capture=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.getAudioData=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i=this;return Lt(this,function(s){return t=[],n=[],a=0,[2,new Promise(function(u){var c=setInterval(function(){i.includeSpectrogram&&(i.analyser.getFloatFrequencyData(i.freqData),i.freqData[0]===-1/0&&u({freqDataQueue:t,timeDataQueue:n}),t.push(i.freqData.slice(0,i.columnTruncateLength))),i.includeWaveform&&(i.analyser.getFloatTimeDomainData(i.timeData),n.push(i.timeData.slice())),++a===i.numFrames&&(clearInterval(c),u({freqDataQueue:t,timeDataQueue:n}))},i.fftSize/i.sampleRateHz*1e3)})]})})},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var n=t[0].length,a=new Float32Array(t.length*n);return t.forEach(function(i,s){return a.set(i,s*n)}),a},e.prototype.getTensorFromAudioDataArray=function(t,n){var a=new Float32Array(At.sizeFromShape(n));return a.set(t,a.length-t.length),sn(a,n)},e})(Fn),yq=(function(r){function e(t,n){var a=r.call(this)||this;if(a.webcamVideoElement=t,a.webcamConfig=n,a.isClosed=!0,a.resize=!1,a.needToResize())if(a.resize=!0,a.cropSize=[a.webcamConfig.resizeHeight,a.webcamConfig.resizeWidth],a.cropBoxInd=zn([0],"int32"),a.webcamConfig.centerCrop){var i=1*a.webcamConfig.resizeWidth/a.webcamVideoElement.width,s=1*a.webcamConfig.resizeHeight/a.webcamVideoElement.height,u=(1-i)/2,c=(1-s)/2,f=u+i,h=s+c;a.cropBox=ta([c,u,h,f],[1,4])}else a.cropBox=ta([0,0,1,1],[1,4]);return a}return Me(e,r),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return n===void 0&&(n={}),Bt(this,void 0,void 0,function(){var a;return Lt(this,function(i){switch(i.label){case 0:if(yt().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(a=new e(t,n)).start()];case 1:return i.sent(),[2,a]}})})},e.prototype.start=function(){return Bt(this,void 0,void 0,function(){var t,n,a=this;return Lt(this,function(i){switch(i.label){case 0:this.webcamConfig.facingMode&&At.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+a.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),i.label=1;case 1:return i.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=i.sent(),[3,4];case 3:throw(n=i.sent()).message="Error thrown while initializing video stream: "+n.message,n;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(s){console.log(s),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(s){a.webcamVideoElement.onloadedmetadata=function(){s()}})]}})})},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){if(this.isClosed)return[2,{value:null,done:!0}];try{t=Vm.fromPixels(this.webcamVideoElement)}catch(a){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(a))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(a){throw new Error("Error thrown cropping the video: "+a.message)}finally{t.dispose()}return[2]})})},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var n=this;return ft(function(){var a,i=t.toFloat().expandDims(0),s=(a=xi.cropAndResize(i,n.cropBox,n.cropBoxInd,n.cropSize,"bilinear")).shape;return a.reshape(s.slice(1))})},e.prototype.capture=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.stop=function(){this.stream.getTracks().forEach(function(t){return t.stop()});try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},e})(Fn),_3=(function(){return function(){}})(),O3=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Me(e,r),e.prototype.split=function(t){return new bq(this,t)},e})(Fn),bq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.impl=new xq(t,n),a}return Me(e,r),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,this.impl.next()]})})},e})(O3),xq=(function(r){function e(t,n){var a=r.call(this)||this;return a.upstream=t,a.separator=n,a.carryover="",a}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return Bt(this,void 0,void 0,function(){var t,n,a,i,s;return Lt(this,function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:if((t=u.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((n=t.value.split(this.separator))[0]=this.carryover+n[0],a=0,i=n.slice(0,-1);a<i.length;a++)s=i[a],this.outputQueue.push(s);return this.carryover=n[n.length-1],[2,!0]}})})},e})(Rw),wq=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Me(e,r),e.prototype.decodeUTF8=function(){return new Sq(this)},e})(Fn),Sq=(function(r){function e(t){var n=r.call(this)||this;return n.upstream=t,n.impl=new Eq(t),n}return Me(e,r),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,this.impl.next()]})})},e})(O3),Eq=(function(r){function e(t){var n=r.call(this)||this;if(n.upstream=t,yt().get("IS_BROWSER"))n.decoder=new TextDecoder("utf-8");else{var a=require("string_decoder").StringDecoder;n.decoder=new a("utf8")}return n}return Me(e,r),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return Bt(this,void 0,void 0,function(){var t,n,a;return Lt(this,function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:return(t=i.sent()).done?[2,!1]:(n=t.value,a=yt().get("IS_BROWSER")?this.decoder.decode(n,{stream:!0}):this.decoder.write(ys.from(n.buffer)),this.outputQueue.push(a),[2,!0])}})})},e})(Rw),D3=(function(r){function e(t,n){n===void 0&&(n={});var a=r.call(this)||this;return a.file=t,a.options=n,At.assert(t instanceof Uint8Array||!!yt().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),a.offset=n.offset||0,a.chunkSize=n.chunkSize||1048576,a}return Me(e,r),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return Bt(this,void 0,void 0,function(){var t,n,a=this;return Lt(this,function(i){switch(i.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(s,u){var c=a.offset+a.chunkSize;if(a.file instanceof Uint8Array)s(new Uint8Array(a.file.slice(a.offset,c)));else{var f=new FileReader;f.onload=function(d){var m=f.result;if(m instanceof ArrayBuffer&&(m=new Uint8Array(m)),!(m instanceof Uint8Array))return u(new TypeError("FileReader returned unknown type."));s(m)},f.onabort=function(d){return u(new Error("Aborted"))},f.onerror=function(d){return u(new Error(d.type))};var h=a.file.slice(a.offset,c);f.readAsArrayBuffer(h)}a.offset=c}),n={},[4,t]);case 1:return[2,(n.value=i.sent(),n.done=!1,n)]}})})},e})(wq);function Cq(r,e){return e===void 0&&(e={}),Bt(this,void 0,void 0,function(){var t,n,a,i,s;return Lt(this,function(u){switch(u.label){case 0:return typeof r=="string"?t=r:(t=r.url,n=Aq(r)),[4,At.fetch(t,n)];case 1:return(a=u.sent()).ok?(s=Uint8Array.bind,[4,a.arrayBuffer()]):[3,3];case 2:return i=new(s.apply(Uint8Array,[void 0,u.sent()])),[2,new D3(i,e)];case 3:throw new Error(a.statusText)}})})}var Aq=function(r){return{method:r.method,headers:r.headers,body:r.body,mode:r.mode,credentials:r.credentials,cache:r.cache,redirect:r.redirect,referrer:r.referrer,integrity:r.integrity}};function I3(r){return typeof r=="string"&&r.substr(0,7)==="file://"}var k3=(function(r){function e(t,n){n===void 0&&(n={});var a=r.call(this)||this;return a.input=t,a.options=n,a}return Me(e,r),e.prototype.iterator=function(){return Bt(this,void 0,void 0,function(){var t;return Lt(this,function(n){return I3(this.input)&&yt().get("IS_NODE")&&(t=require("fs"),this.input=t.readFileSync(this.input.substr(7))),[2,new D3(this.input,this.options)]})})},e})(_3),M3=(function(r){function e(t,n){n===void 0&&(n={});var a=r.call(this)||this;return a.url=t,a.fileOptions=n,a}return Me(e,r),e.prototype.iterator=function(){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return I3(this.url)?[2,new k3(this.url,this.fileOptions).iterator()]:[2,Cq(this.url,this.fileOptions)]})})},e})(_3);function Nq(r,e){return e===void 0&&(e={}),new R3(new M3(r),e)}function Tq(r){var e=this,t=Tw(r);return xr(function(){return Bt(e,void 0,void 0,function(){return Lt(this,function(n){return[2,t]})})})}function Rq(r){var e=this;return xr(function(){return Bt(e,void 0,void 0,function(){var t;return Lt(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return t=n.sent(),[2,Tw(function(){return t.next()})]}})})})}function _q(r,e){return Bt(this,void 0,void 0,function(){return Lt(this,function(t){return[2,yq.create(r,e)]})})}function Oq(r){return Bt(this,void 0,void 0,function(){return Lt(this,function(e){return[2,gq.create(r)]})})}var z3="1.3.1";const Dq=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:R3,Dataset:Wf,FileDataSource:k3,TextLineDataset:T3,URLDataSource:M3,array:Ac,csv:Nq,func:Tq,generator:Rq,microphone:Oq,version_data:z3,webcam:_q,zip:s1},Symbol.toStringTag,{value:"Module"}));var Iq="1.3.1",kq={"tfjs-core":Yx,"tfjs-data":z3,"tfjs-layers":tv,"tfjs-converter":g3,tfjs:Iq};const Mq=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:qm,AdagradOptimizer:Wm,AdamOptimizer:Hm,AdamaxOptimizer:Gm,Callback:l3,CallbackList:DD,CustomCallback:kD,DataStorage:Xd,get ENV(){return Od},EarlyStopping:c3,Environment:S1,GraphModel:v3,History:ID,InputSpec:jn,KernelBackend:Kd,LayerVariable:TD,LayersModel:gs,MomentumOptimizer:Xm,Optimizer:Xa,RMSPropOptimizer:Km,RNN:qs,get Rank(){return od},get Reduction(){return Un},SGDOptimizer:Ff,Sequential:pw,SymbolicTensor:ha,Tensor:Ee,TensorBuffer:bs,Variable:Gu,abs:Ti,acos:Qd,acosh:Zd,add:se,addN:Sm,addStrict:fx,all:Af,any:Ku,argMax:Ri,argMin:Om,asin:Jd,asinh:tm,atan:em,atan2:Em,atanh:nm,avgPool:wf,avgPool3d:Ef,backend:tf,backend_util:tO,basicLSTMCell:Fx,batchNorm:gm,batchNorm2d:ym,batchNorm3d:bm,batchNorm4d:xm,batchNormalization:lx,batchNormalization2d:ox,batchNormalization3d:sx,batchNormalization4d:ux,batchToSpaceND:nf,booleanMaskAsync:Ax,browser:Vm,buffer:ae,callbacks:IV,cast:No,ceil:rm,clipByValue:er,clone:B1,complex:Tn,concat:Vn,concat1d:zd,concat2d:Fd,concat3d:Bd,concat4d:Ld,constraints:YU,conv1d:vf,conv2d:Io,conv2dTranspose:yf,conv3d:gf,conv3dTranspose:Tx,cos:am,cosh:im,cumsum:L1,customGrad:zs,data:Dq,deprecationWarn:Jc,depthToSpace:jd,depthwiseConv2d:Us,deregisterOp:MV,diag:jx,disableDeprecationWarnings:T_,dispose:re,disposeVariables:R_,div:Sn,divStrict:hx,dot:Rx,dropout:Lm,elu:js,enableDebugMode:N_,enableProdMode:A_,engine:__,env:yt,equal:Do,equalStrict:bx,erf:om,exp:sm,expandDims:Qn,expm1:um,eye:rf,fft:fl,fill:Is,findBackend:F_,findBackendFactory:B_,floor:uf,floorDiv:df,frame:Mf,fused:Ns,gather:fa,gatherND:Bm,getBackend:M_,getKernel:E1,getKernelsForBackend:ed,grad:$_,grads:Q_,greater:Ls,greaterEqual:ul,greaterEqualStrict:xx,greaterStrict:wx,hammingWindow:Um,hannWindow:kf,ifft:As,imag:zr,image:xi,inTopKAsync:Vx,initializers:_j,input:KD,io:lr,irfft:Df,isFinite:ax,isInf:rx,isNaN:nx,keep:ma,layers:u3,leakyRelu:Rf,less:Nm,lessEqual:Tm,lessEqualStrict:Sx,lessStrict:Ex,linalg:Pm,linspace:Md,loadGraphModel:Nw,loadLayersModel:Sd,localResponseNormalization:Im,log:Va,log1p:lm,logSigmoid:ex,logSoftmax:of,logSumExp:zx,logicalAnd:Ga,logicalNot:wm,logicalOr:hf,logicalXor:cx,losses:qx,matMul:bf,math:ZO,max:Wa,maxPool:xf,maxPool3d:Sf,maximum:Ca,maximumStrict:px,mean:un,memory:sd,metrics:AV,min:Nf,minimum:Bs,minimumStrict:dx,mod:Cm,modStrict:mx,model:dw,models:NV,moments:ko,movingAverage:Lx,mul:Jt,mulStrict:mf,multiRNNCell:Bx,multinomial:Pd,neg:Oo,nextFrame:Rc,norm:km,notEqual:Es,notEqualStrict:Cx,oneHot:Ua,ones:Sa,onesLike:Er,op:rt,outerProduct:_x,pad:ki,pad1d:U1,pad2d:j1,pad3d:Vd,pad4d:P1,pool:Mx,pow:Ss,powStrict:vx,prelu:_f,print:F1,prod:Tf,profile:O_,rand:V1,randomGamma:q1,randomNormal:qd,randomUniform:To,range:ef,ready:k_,real:sr,reciprocal:cm,registerBackend:L_,registerCallbackConstructor:kP,registerKernel:nd,registerOp:kV,regularizers:OV,relu:Mi,relu6:Dm,removeBackend:z_,reshape:Ms,reverse:va,reverse1d:Ox,reverse2d:Dx,reverse3d:Ix,reverse4d:kx,rfft:hl,round:fm,rsqrt:lf,scalar:jt,scatterND:Fm,selu:Of,separableConv2d:_m,sequential:XD,serialization:It,setBackend:I_,setPlatform:U_,setdiff1dAsync:Wd,sigmoid:ol,sign:hm,signal:Px,sin:pm,sinh:dm,slice:nr,slice1d:ll,slice2d:Cf,slice3d:cl,slice4d:Cs,slice_util:Y_,softmax:Ro,softplus:sl,spaceToBatchND:af,sparseToDense:If,spectral:Ux,split:La,sqrt:Fs,square:$d,squaredDifference:Am,squaredDifferenceStrict:gx,squeeze:Ai,stack:Lr,step:ix,stft:jm,stridedSlice:Mm,sub:gn,subStrict:yx,sum:fr,tan:mm,tanh:cf,tensor:sn,tensor1d:zn,tensor2d:ta,tensor3d:ds,tensor4d:ka,tensor5d:k1,tensor6d:M1,tensor_util:pa,test_util:nD,tidy:ft,tile:bi,time:D_,topk:zm,train:lo,transpose:Qe,truncatedNormal:il,unregisterKernel:LR,unsortedSegmentSum:Rm,unstack:Ni,util:At,valueAndGrad:Z_,valueAndGrads:J_,variable:kd,variableGrads:G1,version:kq,version_converter:g3,version_core:Yx,version_layers:tv,webgl:rD,where:qa,whereAsync:pf,zeros:Ie,zerosLike:ye},Symbol.toStringTag,{value:"Module"})),Eo=Kc(Mq);var ns={},oN;function F3(){if(oN)return ns;oN=1;Object.defineProperty(ns,"__esModule",{value:!0}),ns.cropTensor=ns.capture=void 0;var r=Eo;function e(n,a){return r.tidy(function(){var i=r.browser.fromPixels(n),s=t(i,a),u=s.expandDims(0);return u.toFloat().div(r.scalar(127)).sub(r.scalar(1))})}ns.capture=e;function t(n,a,i){var s=Math.min(n.shape[0],n.shape[1]),u=n.shape[0]/2,c=u-s/2,f=n.shape[1]/2,h=f-s/2;if(a&&!i){var d=n.slice([c,h,0],[s,s,3]);d=d.reshape([s*s,1,3]);var m=[.2989,.587,.114];return d=r.mul(d,m),d=d.reshape([s,s,3]),d=r.sum(d,-1),d=r.expandDims(d,-1),d}return n.slice([c,h,0],[s,s,3])}return ns.cropTensor=t,ns}var oa={},sN;function B3(){if(sN)return oa;sN=1;Object.defineProperty(oa,"__esModule",{value:!0}),oa.cropTo=oa.resizeMinTo=oa.resizeMaxTo=oa.resize=void 0;var r=function(){return document.createElement("canvas")};function e(i,s,u){u===void 0&&(u=r()),u.width=i.width*s,u.height=i.height*s;var c=u.getContext("2d");return c.drawImage(i,0,0,u.width,u.height),u}oa.resize=e;function t(i,s,u){u===void 0&&(u=r());var c=Math.max(i.width,i.height);return e(i,s/c,u)}oa.resizeMaxTo=t;function n(i,s,u){u===void 0&&(u=r());var c=Math.min(i.width,i.height);return e(i,s/c,u)}oa.resizeMinTo=n;function a(i,s,u,c){u===void 0&&(u=!1),c===void 0&&(c=r());var f=i.width,h=i.height;i instanceof HTMLVideoElement&&(f=i.videoWidth,h=i.videoHeight);var d=Math.min(f,h),m=s/d,g=Math.ceil(f*m),y=Math.ceil(h*m),x=g-s,w=y-s;c.width=c.height=s;var b=c.getContext("2d");return b.drawImage(i,~~(x/2)*-1,~~(w/2)*-1,g,y),u&&(b.scale(-1,1),b.drawImage(c,s*-1,0)),c}return oa.cropTo=a,oa}var gc={},uN;function L3(){if(uN)return gc;uN=1;Object.defineProperty(gc,"__esModule",{value:!0}),gc.version=void 0;var r="0.8.4-alpha2";return gc.version=r,gc}var lN;function U3(){return lN||(lN=1,(function(r){var e=Jo&&Jo.__awaiter||function(N,O,k,z){function F(B){return B instanceof k?B:new k(function(V){V(B)})}return new(k||(k=Promise))(function(B,V){function G(X){try{L(z.next(X))}catch($){V($)}}function Q(X){try{L(z.throw(X))}catch($){V($)}}function L(X){X.done?B(X.value):F(X.value).then(G,Q)}L((z=z.apply(N,O||[])).next())})},t=Jo&&Jo.__generator||function(N,O){var k={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},z,F,B,V;return V={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function G(L){return function(X){return Q([L,X])}}function Q(L){if(z)throw new TypeError("Generator is already executing.");for(;k;)try{if(z=1,F&&(B=L[0]&2?F.return:L[0]?F.throw||((B=F.return)&&B.call(F),0):F.next)&&!(B=B.call(F,L[1])).done)return B;switch(F=0,B&&(L=[L[0]&2,B.value]),L[0]){case 0:case 1:B=L;break;case 4:return k.label++,{value:L[1],done:!1};case 5:k.label++,F=L[1],L=[0];continue;case 7:L=k.ops.pop(),k.trys.pop();continue;default:if(B=k.trys,!(B=B.length>0&&B[B.length-1])&&(L[0]===6||L[0]===2)){k=0;continue}if(L[0]===3&&(!B||L[1]>B[0]&&L[1]<B[3])){k.label=L[1];break}if(L[0]===6&&k.label<B[1]){k.label=B[1],B=L;break}if(B&&k.label<B[2]){k.label=B[2],k.ops.push(L);break}B[2]&&k.ops.pop(),k.trys.pop();continue}L=O.call(N,k)}catch(X){L=[6,X],F=0}finally{z=B=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.loadFromFiles=r.load=r.loadTruncatedMobileNet=r.CustomMobileNet=r.getTopKClasses=r.IMAGE_SIZE=void 0;var n=Eo,a=Eo,i=F3(),s=B3(),u=L3(),c=1,f="conv_pw_13_relu",h="out_relu",d=.25,m=.35;r.IMAGE_SIZE=224;var g=function(N){return N.packageVersion=N.packageVersion||u.version,N.packageName=N.packageName||"@teachablemachine/image",N.timeStamp=N.timeStamp||new Date().toISOString(),N.userMetadata=N.userMetadata||{},N.modelName=N.modelName||"untitled",N.labels=N.labels||[],N.imageSize=N.imageSize||r.IMAGE_SIZE,N},y=function(N){return!!N&&Array.isArray(N.labels)},x=function(N,O){if(N===1){if(O!==.25&&O!==.5&&O!==.75&&O!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d}else if(O!==.35&&O!==.5&&O!==.75&&O!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",m.toFixed(2)),m;return O},w=function(N){if(N=N||{},N.checkpointUrl&&N.trainingLayer)return(N.alpha||N.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[N.checkpointUrl,N.trainingLayer];if(N.version=N.version||c,N.version===1){N.alpha=N.alpha||d,N.alpha=x(N.version,N.alpha),console.log("Loading mobilenet "+N.version+" and alpha "+N.alpha);var O=N.alpha.toFixed(2);return O==="1.00"&&(O="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+O+"_"+r.IMAGE_SIZE+"/model.json",f]}else{if(N.version===2)return N.alpha=N.alpha||m,N.alpha=x(N.version,N.alpha),console.log("Loading mobilenet "+N.version+" and alpha "+N.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+N.alpha.toFixed(2)+"_"+r.IMAGE_SIZE+"_no_top/model.json",h];throw new Error("MobileNet V"+N.version+" doesn't exist")}},b=function(N){return e(void 0,void 0,void 0,function(){var O,k;return t(this,function(z){switch(z.label){case 0:return typeof N!="string"?[3,3]:[4,fetch(N)];case 1:return k=z.sent(),[4,k.json()];case 2:return O=z.sent(),[3,4];case 3:if(y(N))O=N;else throw new Error("Invalid Metadata provided");z.label=4;case 4:return[2,g(O)]}})})};function C(N,O,k){return k===void 0&&(k=3),e(this,void 0,void 0,function(){var z;return t(this,function(F){switch(F.label){case 0:return[4,O.data()];case 1:return z=F.sent(),[2,n.tidy(function(){k=Math.min(k,z.length);for(var B=[],V=0;V<z.length;V++)B.push({value:z[V],index:V});B.sort(function(X,$){return $.value-X.value});for(var G=new Float32Array(k),Q=new Int32Array(k),V=0;V<k;V++)G[V]=B[V].value,Q[V]=B[V].index;for(var L=[],V=0;V<Q.length;V++)L.push({className:N[Q[V]],probability:G[V]});return L})]}})})}r.getTopKClasses=C;var A=(function(){function N(O,k){this.model=O,this._metadata=g(k)}return Object.defineProperty(N,"EXPECTED_IMAGE_SIZE",{get:function(){return r.IMAGE_SIZE},enumerable:!1,configurable:!0}),N.prototype.getMetadata=function(){return this._metadata},N.prototype.getTotalClasses=function(){var O=this.model.output,k=O.shape[1];return k},N.prototype.getClassLabels=function(){return this._metadata.labels},N.prototype.predictTopK=function(O,k,z){return k===void 0&&(k=10),z===void 0&&(z=!1),e(this,void 0,void 0,function(){var F,B,V,G=this;return t(this,function(Q){switch(Q.label){case 0:return F=s.cropTo(O,this._metadata.imageSize,z),B=n.tidy(function(){var L=i.capture(F,G._metadata.grayscale);return G.model.predict(L)}),[4,C(this._metadata.labels,B,k)];case 1:return V=Q.sent(),a.dispose(B),[2,V]}})})},N.prototype.predict=function(O,k){return k===void 0&&(k=!1),e(this,void 0,void 0,function(){var z,F,B,V,G,Q=this;return t(this,function(L){switch(L.label){case 0:return z=s.cropTo(O,this._metadata.imageSize,k),F=n.tidy(function(){var X=i.capture(z,Q._metadata.grayscale);return Q.model.predict(X)}),[4,F.data()];case 1:for(B=L.sent(),V=[],G=0;G<B.length;G++)V.push({className:this._metadata.labels[G],probability:B[G]});return a.dispose(F),[2,V]}})})},N.prototype.dispose=function(){this.truncatedModel.dispose()},N})();r.CustomMobileNet=A;function T(N){return e(this,void 0,void 0,function(){var O,k,z,F,B,V,G,B,V,G;return t(this,function(Q){switch(Q.label){case 0:return O=w(N),k=O[0],z=O[1],[4,n.loadLayersModel(k)];case 1:return F=Q.sent(),N&&N.version===1?(B=F.getLayer(z),V=n.model({inputs:F.inputs,outputs:B.output}),G=n.sequential(),G.add(V),G.add(n.layers.flatten()),[2,G]):(B=F.getLayer(z),V=n.model({inputs:F.inputs,outputs:B.output}),G=n.sequential(),G.add(V),G.add(n.layers.globalAveragePooling2d({})),[2,G])}})})}r.loadTruncatedMobileNet=T;function R(N,O){return e(this,void 0,void 0,function(){var k,z,F;return t(this,function(B){switch(B.label){case 0:return[4,n.loadLayersModel(N)];case 1:return k=B.sent(),O?[4,b(O)]:[3,3];case 2:return F=B.sent(),[3,4];case 3:F=null,B.label=4;case 4:return z=F,[2,new A(k,z)]}})})}r.load=R;function D(N,O,k){return e(this,void 0,void 0,function(){var z,F,B,V;return t(this,function(G){switch(G.label){case 0:return[4,n.loadLayersModel(n.io.browserFiles([N,O]))];case 1:return z=G.sent(),[4,new Response(k).json()];case 2:return F=G.sent(),k?[4,b(F)]:[3,4];case 3:return V=G.sent(),[3,5];case 4:V=null,G.label=5;case 5:return B=V,[2,new A(z,B)]}})})}r.loadFromFiles=D})(Jo)),Jo}var Ir={},Lp={exports:{}},zq=Lp.exports,cN;function Fq(){return cN||(cN=1,(function(r){(function(e,t,n){function a(c){var f=this,h=u();f.next=function(){var d=2091639*f.s0+f.c*23283064365386963e-26;return f.s0=f.s1,f.s1=f.s2,f.s2=d-(f.c=d|0)},f.c=1,f.s0=h(" "),f.s1=h(" "),f.s2=h(" "),f.s0-=h(c),f.s0<0&&(f.s0+=1),f.s1-=h(c),f.s1<0&&(f.s1+=1),f.s2-=h(c),f.s2<0&&(f.s2+=1),h=null}function i(c,f){return f.c=c.c,f.s0=c.s0,f.s1=c.s1,f.s2=c.s2,f}function s(c,f){var h=new a(c),d=f&&f.state,m=h.next;return m.int32=function(){return h.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,d&&(typeof d=="object"&&i(d,h),m.state=function(){return i(h,{})}),m}function u(){var c=4022871197,f=function(h){h=h.toString();for(var d=0;d<h.length;d++){c+=h.charCodeAt(d);var m=.02519603282416938*c;c=m>>>0,m-=c,m*=c,c=m>>>0,m-=c,c+=m*4294967296}return(c>>>0)*23283064365386963e-26};return f}t&&t.exports?t.exports=s:this.alea=s})(zq,r)})(Lp)),Lp.exports}var Up={exports:{}},Bq=Up.exports,fN;function Lq(){return fN||(fN=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var d=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^d^d>>>8},u===(u|0)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=f.charCodeAt(h)|0,c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(Bq,r)})(Up)),Up.exports}var jp={exports:{}},Uq=jp.exports,hN;function jq(){return hN||(hN=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(d^d<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,u===(u|0)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=f.charCodeAt(h)|0,h==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c.v=u.v,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(Uq,r)})(jp)),jp.exports}var Pp={exports:{}},Pq=Pp.exports,pN;function Vq(){return pN||(pN=1,(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var h=c.x,d=c.i,m,g;return m=h[d],m^=m>>>7,g=m^m<<24,m=h[d+1&7],g^=m^m>>>10,m=h[d+3&7],g^=m^m>>>3,m=h[d+4&7],g^=m^m<<7,m=h[d+7&7],m=m^m<<13,g^=m^m<<9,h[d]=g,c.i=d+1&7,g};function f(h,d){var m,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,m=0;m<d.length;++m)g[m&7]=g[m&7]<<15^d.charCodeAt(m)+g[m+1&7]<<13;for(;g.length<8;)g.push(0);for(m=0;m<8&&g[m]===0;++m);for(m==8?g[7]=-1:g[m],h.x=g,h.i=0,m=256;m>0;--m)h.next()}f(c,u)}function i(u,c){return c.x=u.x.slice(),c.i=u.i,c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(h.x&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(Pq,r)})(Pp)),Pp.exports}var Vp={exports:{}},qq=Vp.exports,dN;function Wq(){return dN||(dN=1,(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var h=c.w,d=c.X,m=c.i,g,y;return c.w=h=h+1640531527|0,y=d[m+34&127],g=d[m=m+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[m]=y^g,c.i=m,y+(h^h>>>16)|0};function f(h,d){var m,g,y,x,w,b=[],C=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,C=Math.max(C,d.length)),y=0,x=-32;x<C;++x)d&&(g^=d.charCodeAt((x+32)%d.length)),x===0&&(w=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(w=w+1640531527|0,m=b[x&127]^=g+w,y=m==0?y+1:0);for(y>=128&&(b[(d&&d.length||0)&127]=-1),y=127,x=512;x>0;--x)g=b[y+34&127],m=b[y=y+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,b[y]=g^m;h.w=w,h.X=b,h.i=y}f(c,u)}function i(u,c){return c.i=u.i,c.w=u.w,c.X=u.X.slice(),c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(h.X&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(qq,r)})(Vp)),Vp.exports}var qp={exports:{}},Hq=qp.exports,mN;function Gq(){return mN||(mN=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.b,m=c.c,g=c.d,y=c.a;return d=d<<25^d>>>7^m,m=m-g|0,g=g<<24^g>>>8^y,y=y-d|0,c.b=d=d<<20^d>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^y,c.a=y-d|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,u===Math.floor(u)?(c.a=u/4294967296|0,c.b=u|0):f+=u;for(var h=0;h<f.length+20;h++)c.b^=f.charCodeAt(h)|0,c.next()}function i(u,c){return c.a=u.a,c.b=u.b,c.c=u.c,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(Hq,r)})(qp)),qp.exports}var a0={exports:{}};const Xq={},Kq=Object.freeze(Object.defineProperty({__proto__:null,default:Xq},Symbol.toStringTag,{value:"Module"})),j3=Kc(Kq);var vN;function Yq(){return vN||(vN=1,(function(r){(function(e,t){var n=(0,eval)("this"),a=256,i=6,s=52,u="random",c=t.pow(a,i),f=t.pow(2,s),h=f*2,d=a-1,m;function g(T,R,D){var N=[];R=R==!0?{entropy:!0}:R||{};var O=b(w(R.entropy?[T,A(e)]:T??C(),3),N),k=new y(N),z=function(){for(var F=k.g(i),B=c,V=0;F<f;)F=(F+V)*a,B*=a,V=k.g(1);for(;F>=h;)F/=2,B/=2,V>>>=1;return(F+V)/B};return z.int32=function(){return k.g(4)|0},z.quick=function(){return k.g(4)/4294967296},z.double=z,b(A(k.S),e),(R.pass||D||function(F,B,V,G){return G&&(G.S&&x(G,k),F.state=function(){return x(k,{})}),V?(t[u]=F,B):F})(z,O,"global"in R?R.global:this==t,R.state)}t["seed"+u]=g;function y(T){var R,D=T.length,N=this,O=0,k=N.i=N.j=0,z=N.S=[];for(D||(T=[D++]);O<a;)z[O]=O++;for(O=0;O<a;O++)z[O]=z[k=d&k+T[O%D]+(R=z[O])],z[k]=R;(N.g=function(F){for(var B,V=0,G=N.i,Q=N.j,L=N.S;F--;)B=L[G=d&G+1],V=V*a+L[d&(L[G]=L[Q=d&Q+B])+(L[Q]=B)];return N.i=G,N.j=Q,V})(a)}function x(T,R){return R.i=T.i,R.j=T.j,R.S=T.S.slice(),R}function w(T,R){var D=[],N=typeof T,O;if(R&&N=="object")for(O in T)try{D.push(w(T[O],R-1))}catch{}return D.length?D:N=="string"?T:T+"\0"}function b(T,R){for(var D=T+"",N,O=0;O<D.length;)R[d&O]=d&(N^=R[d&O]*19)+D.charCodeAt(O++);return A(R)}function C(){try{var T;return m&&(T=m.randomBytes)?T=T(a):(T=new Uint8Array(a),(n.crypto||n.msCrypto).getRandomValues(T)),A(T)}catch{var R=n.navigator,D=R&&R.plugins;return[+new Date,n,D,n.screen,A(e)]}}function A(T){return String.fromCharCode.apply(0,T)}if(b(t.random(),e),r.exports){r.exports=g;try{m=j3}catch{}}})([],Math)})(a0)),a0.exports}var i0,gN;function $q(){if(gN)return i0;gN=1;var r=Fq(),e=Lq(),t=jq(),n=Vq(),a=Wq(),i=Gq(),s=Yq();return s.alea=r,s.xor128=e,s.xorwow=t,s.xorshift7=n,s.xor4096=a,s.tychei=i,i0=s,i0}var yN;function Qq(){if(yN)return Ir;yN=1;var r=Ir&&Ir.__extends||(function(){var y=function(x,w){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,C){b.__proto__=C}||function(b,C){for(var A in C)C.hasOwnProperty(A)&&(b[A]=C[A])},y(x,w)};return function(x,w){y(x,w);function b(){this.constructor=x}x.prototype=w===null?Object.create(w):(b.prototype=w.prototype,new b)}})(),e=Ir&&Ir.__awaiter||function(y,x,w,b){function C(A){return A instanceof w?A:new w(function(T){T(A)})}return new(w||(w=Promise))(function(A,T){function R(O){try{N(b.next(O))}catch(k){T(k)}}function D(O){try{N(b.throw(O))}catch(k){T(k)}}function N(O){O.done?A(O.value):C(O.value).then(R,D)}N((b=b.apply(y,x||[])).next())})},t=Ir&&Ir.__generator||function(y,x){var w={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},b,C,A,T;return T={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function R(N){return function(O){return D([N,O])}}function D(N){if(b)throw new TypeError("Generator is already executing.");for(;w;)try{if(b=1,C&&(A=N[0]&2?C.return:N[0]?C.throw||((A=C.return)&&A.call(C),0):C.next)&&!(A=A.call(C,N[1])).done)return A;switch(C=0,A&&(N=[N[0]&2,A.value]),N[0]){case 0:case 1:A=N;break;case 4:return w.label++,{value:N[1],done:!1};case 5:w.label++,C=N[1],N=[0];continue;case 7:N=w.ops.pop(),w.trys.pop();continue;default:if(A=w.trys,!(A=A.length>0&&A[A.length-1])&&(N[0]===6||N[0]===2)){w=0;continue}if(N[0]===3&&(!A||N[1]>A[0]&&N[1]<A[3])){w.label=N[1];break}if(N[0]===6&&w.label<A[1]){w.label=A[1],A=N;break}if(A&&w.label<A[2]){w.label=A[2],w.ops.push(N);break}A[2]&&w.ops.pop(),w.trys.pop();continue}N=x.call(y,w)}catch(O){N=[6,O],C=0}finally{b=A=0}if(N[0]&5)throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.createTeachable=Ir.TeachableMobileNet=void 0;var n=Eo,a=Eo,i=F3(),s=U3(),u=$q(),c=.15,f=function(y){return typeof y.dataId=="object"&&typeof y.shape=="object"};function h(y,x){var w=new Array(x).fill(0);return w[y]=1,w}function d(y,x){for(var w,b=y.length,C=y.slice(),A=b-1;A>0;A-=1){var T=void 0;x?T=Math.floor(x()*(A+1)):T=Math.floor(Math.random()*(A+1)),w=[C[T],C[A]],C[A]=w[0],C[T]=w[1]}return C}var m=(function(y){r(x,y);function x(w,b){var C=y.call(this,n.sequential(),b)||this;return C.totalSamples=0,C.examples=[],C.truncatedModel=w,C}return Object.defineProperty(x.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),x.prototype.addExample=function(w,b){return e(this,void 0,void 0,function(){var C,A,T;return t(this,function(R){return C=f(b)?b:i.capture(b,this._metadata.grayscale),A=this.truncatedModel.predict(C),T=A.dataSync(),C.dispose(),A.dispose(),this.examples[w].push(T),this.totalSamples++,[2]})})},x.prototype.predict=function(w,b){return b===void 0&&(b=!1),e(this,void 0,void 0,function(){return t(this,function(C){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,y.prototype.predict.call(this,w,b)]})})},x.prototype.predictTopK=function(w,b,C){return b===void 0&&(b=10),C===void 0&&(C=!1),e(this,void 0,void 0,function(){return t(this,function(A){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,y.prototype.predictTopK.call(this,w,b,C)]})})},x.prototype.prepare=function(){for(var w in this.examples)if(w.length===0)throw new Error("Add some examples before training");var b=this.convertToTfDataset();this.trainDataset=b.trainDataset,this.validationDataset=b.validationDataset},x.prototype.convertToTfDataset=function(){for(var w=0;w<this.examples.length;w++)this.examples[w]=d(this.examples[w],this.seed);for(var b=[],C=[],A=function(k){var z=h(k,T.numClasses),F=T.examples[k].length,B=Math.ceil(c*F),V=F-B,G=T.examples[k].slice(0,V).map(function(L){return{data:L,label:z}}),Q=T.examples[k].slice(V).map(function(L){return{data:L,label:z}});b=b.concat(G),C=C.concat(Q)},T=this,w=0;w<this.examples.length;w++)A(w);b=d(b,this.seed),C=d(C,this.seed);var R=n.data.array(b.map(function(k){return k.data})),D=n.data.array(C.map(function(k){return k.data})),N=n.data.array(b.map(function(k){return k.label})),O=n.data.array(C.map(function(k){return k.label}));return{trainDataset:n.data.zip({xs:R,ys:N}),validationDataset:n.data.zip({xs:D,ys:O})}},x.prototype.save=function(w,b){return e(this,void 0,void 0,function(){return t(this,function(C){return[2,this.model.save(w,b)]})})},x.prototype.train=function(w,b){return b===void 0&&(b={}),e(this,void 0,void 0,function(){var C,A,T,R,D,N,O,k,z,F=this;return t(this,function(B){switch(B.label){case 0:if(C=b.onTrainEnd||(function(){}),b.onTrainEnd=function(V){F.__stopTrainingResolve&&(F.__stopTrainingResolve(),F.__stopTrainingResolve=null),C(V)},this.isPrepared||this.prepare(),A=this.getLabels().length,a.util.assert(A===this.numClasses,function(){return"Can not train, has "+A+" labels and "+F.numClasses+" classes"}),T=this.truncatedModel.outputs[0].shape.slice(1),R=n.util.sizeFromShape(T),this.seed?D=n.initializers.varianceScaling({seed:3.14}):D=n.initializers.varianceScaling({}),this.trainingModel=n.sequential({layers:[n.layers.dense({inputShape:[R],units:w.denseUnits,activation:"relu",kernelInitializer:D,useBias:!0}),n.layers.dense({kernelInitializer:D,useBias:!1,activation:"softmax",units:this.numClasses})]}),N=n.train.adam(w.learningRate),this.trainingModel.compile({optimizer:N,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(w.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return O=this.trainDataset.batch(w.batchSize),k=this.validationDataset.batch(w.batchSize),[4,this.trainingModel.fitDataset(O,{epochs:w.epochs,validationData:k,callbacks:b})];case 1:return B.sent(),z=n.sequential(),z.add(this.truncatedModel),z.add(this.trainingModel),this.model=z,N.dispose(),[2,this.model]}})})},x.prototype.prepareDataset=function(){for(var w=0;w<this.numClasses;w++)this.examples[w]=[]},x.prototype.setLabel=function(w,b){this._metadata.labels[w]=b},x.prototype.setLabels=function(w){this._metadata.labels=w,this.prepareDataset()},x.prototype.getLabel=function(w){return this._metadata.labels[w]},x.prototype.getLabels=function(){return this._metadata.labels},x.prototype.setName=function(w){this._metadata.modelName=w},x.prototype.getName=function(){return this._metadata.modelName},x.prototype.stopTraining=function(){var w=this,b=new Promise(function(C,A){w.trainingModel.stopTraining=!0,w.__stopTrainingResolve=C});return b},x.prototype.dispose=function(){this.trainingModel.dispose(),y.prototype.dispose.call(this)},x.prototype.calculateAccuracyPerClass=function(){return e(this,void 0,void 0,function(){var w,b,C,A,T,R,D,N,O,k,X,z,F,B,V,G,Q,L,X,$=this;return t(this,function(it){switch(it.label){case 0:return w=this.validationDataset.mapAsync(function(tt){return e($,void 0,void 0,function(){return t(this,function(q){return[2,tt.xs]})})}),b=this.validationDataset.mapAsync(function(tt){return e($,void 0,void 0,function(){return t(this,function(q){return[2,tt.ys]})})}),C=Math.min(b.size,32),A=Math.ceil(b.size/C),T=w.batch(C),R=b.batch(C),[4,T.iterator()];case 1:return D=it.sent(),[4,R.iterator()];case 2:N=it.sent(),O=[],k=[],X=0,it.label=3;case 3:return X<A?[4,D.next()]:[3,7];case 4:return z=it.sent(),F=this.trainingModel.predict(z.value),B=F.argMax(1),O.push(B),[4,N.next()];case 5:V=it.sent(),G=V.value.argMax(1),k.push(G),z.value.dispose(),F.dispose(),V.value.dispose(),it.label=6;case 6:return X++,[3,3];case 7:if(Q=n.concat(k),L=n.concat(O),A!==1)for(X=0;X<O.length;X++)O[X].dispose(),k[X].dispose();return[2,{reference:Q,predictions:L}]}})})},x.prototype.setSeed=function(w){this.seed=u(w)},x})(s.CustomMobileNet);Ir.TeachableMobileNet=m;function g(y,x){return e(this,void 0,void 0,function(){var w;return t(this,function(b){switch(b.label){case 0:return[4,s.loadTruncatedMobileNet(x)];case 1:return w=b.sent(),[2,new m(w,y)]}})})}return Ir.createTeachable=g,Ir}var sa={};function Wp(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wp=function(t){return typeof t}:Wp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(r)}function _w(r,e,t){var n=t.value;if(typeof n!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(Wp(n)));var a=!1;return{configurable:!0,get:function(){if(a||this===r.prototype||this.hasOwnProperty(e)||typeof n!="function")return n;var s=n.bind(this);return a=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return s},set:function(c){n=c,delete this[e]}}),a=!1,s},set:function(s){n=s}}}function P3(r){var e;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?e=Reflect.ownKeys(r.prototype):(e=Object.getOwnPropertyNames(r.prototype),typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(r.prototype)))),e.forEach(function(t){if(t!=="constructor"){var n=Object.getOwnPropertyDescriptor(r.prototype,t);typeof n.value=="function"&&Object.defineProperty(r.prototype,t,_w(r,t,n))}}),r}function Zq(){return arguments.length===1?P3.apply(void 0,arguments):_w.apply(void 0,arguments)}const Jq=Object.freeze(Object.defineProperty({__proto__:null,boundClass:P3,boundMethod:_w,default:Zq},Symbol.toStringTag,{value:"Module"})),V3=Kc(Jq);var bN;function t8(){if(bN)return sa;bN=1;var r=sa&&sa.__decorate||function(c,f,h,d){var m=arguments.length,g=m<3?f:d===null?d=Object.getOwnPropertyDescriptor(f,h):d,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,f,h,d);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(g=(m<3?y(g):m>3?y(f,h,g):y(f,h))||g);return m>3&&g&&Object.defineProperty(f,h,g),g},e=sa&&sa.__awaiter||function(c,f,h,d){function m(g){return g instanceof h?g:new h(function(y){y(g)})}return new(h||(h=Promise))(function(g,y){function x(C){try{b(d.next(C))}catch(A){y(A)}}function w(C){try{b(d.throw(C))}catch(A){y(A)}}function b(C){C.done?g(C.value):m(C.value).then(x,w)}b((d=d.apply(c,f||[])).next())})},t=sa&&sa.__generator||function(c,f){var h={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,m,g,y;return y={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function x(b){return function(C){return w([b,C])}}function w(b){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,m&&(g=b[0]&2?m.return:b[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,b[1])).done)return g;switch(m=0,g&&(b=[b[0]&2,g.value]),b[0]){case 0:case 1:g=b;break;case 4:return h.label++,{value:b[1],done:!1};case 5:h.label++,m=b[1],b=[0];continue;case 7:b=h.ops.pop(),h.trys.pop();continue;default:if(g=h.trys,!(g=g.length>0&&g[g.length-1])&&(b[0]===6||b[0]===2)){h=0;continue}if(b[0]===3&&(!g||b[1]>g[0]&&b[1]<g[3])){h.label=b[1];break}if(b[0]===6&&h.label<g[1]){h.label=g[1],g=b;break}if(g&&h.label<g[2]){h.label=g[2],h.ops.push(b);break}g[2]&&h.ops.pop(),h.trys.pop();continue}b=f.call(c,h)}catch(C){b=[6,C],m=0}finally{d=g=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(sa,"__esModule",{value:!0}),sa.Webcam=void 0;var n=V3,a=B3(),i={facingMode:"user",frameRate:24},s=function(c){return c.facingMode=c.facingMode||i.facingMode,c.frameRate=c.frameRate||i.frameRate,c.aspectRatio=c.aspectRatio||i.aspectRatio,c},u=(function(){function c(f,h,d){f===void 0&&(f=400),h===void 0&&(h=400),d===void 0&&(d=!1),this.width=f,this.height=h,this.flip=d}return c.prototype.getWebcam=function(f){if(f===void 0&&(f={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");f.width=640;var h=s(f),d=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:h}).then(function(m){return d.srcObject=m,d.addEventListener("loadedmetadata",function(g){var y=d.videoWidth,x=d.videoHeight;d.width=y,d.height=x}),d},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},c.prototype.setup=function(f){return f===void 0&&(f={}),e(this,void 0,void 0,function(){var h;return t(this,function(d){switch(d.label){case 0:return this.webcam?[3,2]:(h=this,[4,this.getWebcam(f)]);case 1:h.webcam=d.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),d.label=2;case 2:return[2]}})})},c.prototype.play=function(){var f=this.webcam.play();return f},c.prototype.pause=function(){this.webcam.pause()},c.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},c.prototype.update=function(){this.renderCameraToCanvas()},c.prototype.stopStreamedVideo=function(f){var h=f.srcObject,d=h.getTracks();d.forEach(function(m){m.stop()}),f.srcObject=null},c.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var f=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var h=a.cropTo(this.webcam,this.width,this.flip);f.drawImage(h,0,0)}}},r([n.default],c.prototype,"getWebcam",null),r([n.default],c.prototype,"setup",null),r([n.default],c.prototype,"play",null),r([n.default],c.prototype,"pause",null),r([n.default],c.prototype,"stop",null),r([n.default],c.prototype,"update",null),r([n.default],c.prototype,"stopStreamedVideo",null),r([n.default],c.prototype,"renderCameraToCanvas",null),c})();return sa.Webcam=u,sa}var xN;function e8(){return xN||(xN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=U3();Object.defineProperty(r,"IMAGE_SIZE",{enumerable:!0,get:function(){return e.IMAGE_SIZE}}),Object.defineProperty(r,"CustomMobileNet",{enumerable:!0,get:function(){return e.CustomMobileNet}}),Object.defineProperty(r,"load",{enumerable:!0,get:function(){return e.load}}),Object.defineProperty(r,"loadFromFiles",{enumerable:!0,get:function(){return e.loadFromFiles}}),Object.defineProperty(r,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return e.loadTruncatedMobileNet}});var t=Qq();Object.defineProperty(r,"TeachableMobileNet",{enumerable:!0,get:function(){return t.TeachableMobileNet}}),Object.defineProperty(r,"createTeachable",{enumerable:!0,get:function(){return t.createTeachable}});var n=t8();Object.defineProperty(r,"Webcam",{enumerable:!0,get:function(){return n.Webcam}});var a=L3();Object.defineProperty(r,"version",{enumerable:!0,get:function(){return a.version}})})(_y)),_y}var wN=e8();function n8(){const[r,e]=ht.useState(null),[t,n]=ht.useState(null),[a,i]=ht.useState(!0),[s,u]=ht.useState(!1),[c,f]=ht.useState([{id:"0",name:"Class 1",samples:[]},{id:"1",name:"Class 2",samples:[]}]),[h,d]=ht.useState(0),[m,g]=ht.useState(null),[y,x]=ht.useState([]),w=ht.useRef();ht.useEffect(()=>{let O=null,k=!0;async function z(){i(!0);try{if(O=new wN.Webcam(224,224,!0),await O.setup(),k)if(await O.play(),O.canvas){n(O);const G=await wN.createTeachable({tfjsVersion:"1.3.1"});G.setLabels(["Class 1","Class 2"]),e(G)}else throw new Error("Webcam canvas not initialized correctly");else O.stop()}catch(F){console.error("Initialization error:",F),g(F.message||"Failed to initialize webcam or model.")}finally{k&&i(!1)}}return z(),()=>{if(k=!1,O&&O.canvas)try{O.stop()}catch(F){console.warn("Failed to stop webcam:",F)}w.current&&cancelAnimationFrame(w.current)}},[]);const b=()=>{const O=c.length.toString();f([...c,{id:O,name:`Class ${c.length+1}`,samples:[]}])},C=O=>{f(c.filter(k=>k.id!==O))},A=(O,k)=>{f(c.map(z=>z.id===O?{...z,name:k}:z))},T=async O=>{if(!t){g("Webcam not ready to capture sample.");return}g(null);try{t.update();const k=document.createElement("canvas");k.width=t.canvas.width,k.height=t.canvas.height,k.getContext("2d").drawImage(t.canvas,0,0);const z=k.toDataURL();if(f(F=>F.map(B=>B.id===O?{...B,samples:[...B.samples,z]}:B)),r){const F=c.findIndex(B=>B.id===O);F!==-1?(r.examples[F]||(r.examples[F]=[]),await r.addExample(F,k),console.log(`Sample added for class ${O}`)):g(`Class with ID ${O} not found.`)}else g("Model not ready yet, but image captured for UI.")}catch(k){console.error("Error adding sample:",k),g(k.message||"Failed to add sample to model")}},R=async()=>{if(!r){g("Model not loaded, cannot train.");return}u(!0),d(0),g(null);try{c.forEach((O,k)=>{r.setLabel(k,O.name)}),await r.train({denseUnits:100,epochs:50,learningRate:.001,batchSize:16},{onEpochEnd:(O,k)=>{d(Math.round((O+1)/50*100))}}),D()}catch(O){console.error("Training error",O)}finally{u(!1)}},D=ht.useCallback(()=>{if(!r||!t)return;const O=async()=>{t.update();const k=await r.predict(t.canvas);x(k),w.current=requestAnimationFrame(O)};w.current=requestAnimationFrame(O)},[r,t]);return{webcam:t,classes:c,isModelLoading:a,isTraining:s,trainingProgress:h,predictions:y,lastError:m,addClass:b,removeClass:C,updateClassName:A,addSample:T,trainModel:R,startPrediction:D,stopPrediction:()=>{w.current&&cancelAnimationFrame(w.current)}}}function Hc({children:r,onClick:e,variant:t="primary",className:n="",...a}){const i="px-4 py-2 rounded-lg font-medium transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",s={primary:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-500/30",secondary:"bg-zinc-800 hover:bg-zinc-700 text-white border border-zinc-700",danger:"bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-500/30",success:"bg-green-500 hover:bg-green-600 text-white shadow-lg shadow-green-500/30"};return J.jsx("button",{onClick:e,className:`${i} ${s[t]} ${n}`,...a,children:r})}function q3({classData:r,onRename:e,onRemove:t,onRecordStart:n,onRecordStop:a}){const i=ht.useRef(null);return ht.useEffect(()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},[r.samples.length]),J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden flex flex-col h-[600px]",children:[J.jsxs("div",{className:"p-4 border-b border-zinc-800 flex items-center justify-between bg-zinc-800/30",children:[J.jsx("input",{type:"text",value:r.name,onChange:s=>e(r.id,s.target.value),className:"bg-transparent text-lg font-semibold text-white focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1 flex-1 mr-2"}),J.jsx("button",{onClick:()=>t(r.id),className:"text-zinc-500 hover:text-red-500 transition-colors p-2",children:J.jsx(VF,{className:"w-5 h-5"})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 relative",ref:i,children:[J.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.samples.map((s,u)=>J.jsx("img",{src:s,className:"w-full aspect-square object-cover rounded bg-black"},u))}),r.samples.length===0&&J.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-zinc-500 space-y-2",children:[J.jsx(HF,{className:"w-8 h-8 opacity-50"}),J.jsx("p",{className:"text-sm",children:"Add Image Samples"})]})]}),J.jsx("div",{className:"p-4 border-t border-zinc-800 bg-zinc-800/10",children:J.jsxs("button",{onClick:n,className:"w-full py-3 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg flex items-center justify-center gap-2 font-medium transition-all active:scale-95 select-none",children:[J.jsx(MR,{className:"w-5 h-5"}),"Capture Image"]})})]})}function Ow({text:r="Loading..."}){return J.jsxs("div",{className:"flex flex-col items-center justify-center p-8 space-y-4",children:[J.jsx(LF,{className:"w-8 h-8 animate-spin text-blue-500"}),J.jsx("p",{className:"text-zinc-400 text-sm",children:r})]})}function r8({webcam:r}){const e=ht.useRef(null);return ht.useEffect(()=>{e.current&&r&&r.canvas&&(e.current.innerHTML="",e.current.appendChild(r.canvas))},[r]),J.jsx("div",{ref:e,className:"rounded-lg overflow-hidden [&>canvas]:w-full [&>canvas]:h-auto"})}function a8(){const{webcam:r,classes:e,isModelLoading:t,isTraining:n,trainingProgress:a,predictions:i,lastError:s,addClass:u,removeClass:c,updateClassName:f,addSample:h,trainModel:d}=n8(),m=g=>{h(g)};return J.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:J.jsxs("div",{className:"max-w-[1600px] mx-auto",children:[J.jsxs("header",{className:"flex items-center justify-between mb-8",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx(nl,{to:"/",className:"p-2 hover:bg-zinc-800 rounded-full transition-colors",children:J.jsx(x1,{className:"w-6 h-6"})}),J.jsxs("div",{className:"flex flex-col",children:[J.jsx("h1",{className:"text-2xl font-bold",children:"Image Project"}),J.jsx("span",{className:"text-zinc-400 text-sm",children:"Train a model to recognize images"})]})]}),n&&J.jsxs("div",{className:"flex items-center gap-4 bg-zinc-900 px-4 py-2 rounded-full border border-zinc-800",children:[J.jsx("span",{className:"animate-pulse text-blue-400 font-medium",children:"Training Model..."}),J.jsx("div",{className:"w-32 h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${a}%`}})}),J.jsxs("span",{className:"text-sm font-mono",children:[a,"%"]})]})]}),s&&J.jsxs("div",{className:"mb-6 bg-red-500/10 border border-red-500/50 text-red-400 p-4 rounded-xl flex items-center justify-between",children:[J.jsxs("span",{children:["Error: ",s]}),J.jsx("button",{onClick:()=>window.location.reload(),className:"underline text-sm hover:text-white",children:"Reload"})]}),t?J.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:J.jsx(Ow,{text:"Initializing input and loading MobileNet..."})}):J.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[J.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[e.map(g=>J.jsx("div",{children:J.jsx(q3,{classData:g,onRename:f,onRemove:c,onRecordStart:()=>m(g.id),onRecordStop:()=>{}})},g.id)),J.jsxs("button",{onClick:u,className:"w-full py-4 border-2 border-dashed border-zinc-800 rounded-xl text-zinc-500 hover:text-white hover:border-zinc-700 hover:bg-zinc-900 transition-all flex items-center justify-center gap-2",children:[J.jsx(td,{className:"w-5 h-5"}),"Add Class"]})]}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full flex flex-col items-center text-center",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Training"}),J.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6",children:[J.jsx("div",{className:"p-4 bg-zinc-950 rounded-lg border border-zinc-900 w-full max-w-xs",children:J.jsxs("div",{className:"space-y-4 text-left text-sm text-zinc-400",children:[J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Epochs"}),J.jsx("span",{className:"text-white",children:"50"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Batch Size"}),J.jsx("span",{className:"text-white",children:"16"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Learning Rate"}),J.jsx("span",{className:"text-white",children:"0.001"})]})]})}),J.jsx(Hc,{onClick:d,disabled:n||e.some(g=>g.samples.length===0),className:"w-full max-w-xs py-3 text-lg",children:n?"Training...":"Train Model"}),e.some(g=>g.samples.length===0)&&J.jsx("p",{className:"text-orange-500 text-sm",children:"Add samples to all classes first"})]})]})}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full sticky top-6",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Preview"}),J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"aspect-square bg-black rounded-lg overflow-hidden border border-zinc-800 relative",children:[J.jsx(r8,{webcam:r}),!i.length&&!n&&J.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:J.jsx("p",{className:"text-zinc-400",children:"Train model to start predicting"})})]}),J.jsx("div",{className:"space-y-3",children:i.map((g,y)=>J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex justify-between text-sm",children:[J.jsx("span",{className:"font-medium text-white",children:g.className}),J.jsxs("span",{className:"text-zinc-400",children:[(g.probability*100).toFixed(0),"%"]})]}),J.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:`h-full transition-all duration-100 ${g.probability>.8?"bg-green-500":"bg-blue-500"}`,style:{width:`${g.probability*100}%`}})})]},y))})]})]})})]})]})})}var o0={},s0={},u0,SN;function W3(){return SN||(SN=1,u0=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[t]=a;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(e,t);if(u.value!==a||u.enumerable!==!0)return!1}return!0}),u0}var l0,EN;function av(){if(EN)return l0;EN=1;var r=W3();return l0=function(){return r()&&!!Symbol.toStringTag},l0}var c0,CN;function H3(){return CN||(CN=1,c0=Object),c0}var f0,AN;function i8(){return AN||(AN=1,f0=Error),f0}var h0,NN;function o8(){return NN||(NN=1,h0=EvalError),h0}var p0,TN;function s8(){return TN||(TN=1,p0=RangeError),p0}var d0,RN;function u8(){return RN||(RN=1,d0=ReferenceError),d0}var m0,_N;function G3(){return _N||(_N=1,m0=SyntaxError),m0}var v0,ON;function Hf(){return ON||(ON=1,v0=TypeError),v0}var g0,DN;function l8(){return DN||(DN=1,g0=URIError),g0}var y0,IN;function c8(){return IN||(IN=1,y0=Math.abs),y0}var b0,kN;function f8(){return kN||(kN=1,b0=Math.floor),b0}var x0,MN;function h8(){return MN||(MN=1,x0=Math.max),x0}var w0,zN;function p8(){return zN||(zN=1,w0=Math.min),w0}var S0,FN;function d8(){return FN||(FN=1,S0=Math.pow),S0}var E0,BN;function m8(){return BN||(BN=1,E0=Math.round),E0}var C0,LN;function v8(){return LN||(LN=1,C0=Number.isNaN||function(e){return e!==e}),C0}var A0,UN;function g8(){if(UN)return A0;UN=1;var r=v8();return A0=function(t){return r(t)||t===0?t:t<0?-1:1},A0}var N0,jN;function y8(){return jN||(jN=1,N0=Object.getOwnPropertyDescriptor),N0}var T0,PN;function ml(){if(PN)return T0;PN=1;var r=y8();if(r)try{r([],"length")}catch{r=null}return T0=r,T0}var R0,VN;function iv(){if(VN)return R0;VN=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return R0=r,R0}var _0,qN;function b8(){if(qN)return _0;qN=1;var r=typeof Symbol<"u"&&Symbol,e=W3();return _0=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},_0}var O0,WN;function X3(){return WN||(WN=1,O0=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),O0}var D0,HN;function K3(){if(HN)return D0;HN=1;var r=H3();return D0=r.getPrototypeOf||null,D0}var I0,GN;function x8(){if(GN)return I0;GN=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",a=function(c,f){for(var h=[],d=0;d<c.length;d+=1)h[d]=c[d];for(var m=0;m<f.length;m+=1)h[m+c.length]=f[m];return h},i=function(c,f){for(var h=[],d=f,m=0;d<c.length;d+=1,m+=1)h[m]=c[d];return h},s=function(u,c){for(var f="",h=0;h<u.length;h+=1)f+=u[h],h+1<u.length&&(f+=c);return f};return I0=function(c){var f=this;if(typeof f!="function"||e.apply(f)!==n)throw new TypeError(r+f);for(var h=i(arguments,1),d,m=function(){if(this instanceof d){var b=f.apply(this,a(h,arguments));return Object(b)===b?b:this}return f.apply(c,a(h,arguments))},g=t(0,f.length-h.length),y=[],x=0;x<g;x++)y[x]="$"+x;if(d=Function("binder","return function ("+s(y,",")+"){ return binder.apply(this,arguments); }")(m),f.prototype){var w=function(){};w.prototype=f.prototype,d.prototype=new w,w.prototype=null}return d},I0}var k0,XN;function Gf(){if(XN)return k0;XN=1;var r=x8();return k0=Function.prototype.bind||r,k0}var M0,KN;function Dw(){return KN||(KN=1,M0=Function.prototype.call),M0}var z0,YN;function Iw(){return YN||(YN=1,z0=Function.prototype.apply),z0}var F0,$N;function w8(){return $N||($N=1,F0=typeof Reflect<"u"&&Reflect&&Reflect.apply),F0}var B0,QN;function Y3(){if(QN)return B0;QN=1;var r=Gf(),e=Iw(),t=Dw(),n=w8();return B0=n||r.call(t,e),B0}var L0,ZN;function kw(){if(ZN)return L0;ZN=1;var r=Gf(),e=Hf(),t=Dw(),n=Y3();return L0=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return n(r,t,i)},L0}var U0,JN;function S8(){if(JN)return U0;JN=1;var r=kw(),e=ml(),t;try{t=[].__proto__===Array.prototype}catch(s){if(!s||typeof s!="object"||!("code"in s)||s.code!=="ERR_PROTO_ACCESS")throw s}var n=!!t&&e&&e(Object.prototype,"__proto__"),a=Object,i=a.getPrototypeOf;return U0=n&&typeof n.get=="function"?r([n.get]):typeof i=="function"?function(u){return i(u==null?u:a(u))}:!1,U0}var j0,tT;function Mw(){if(tT)return j0;tT=1;var r=X3(),e=K3(),t=S8();return j0=r?function(a){return r(a)}:e?function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return e(a)}:t?function(a){return t(a)}:null,j0}var P0,eT;function $3(){if(eT)return P0;eT=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Gf();return P0=t.call(r,e),P0}var V0,nT;function Q3(){if(nT)return V0;nT=1;var r,e=H3(),t=i8(),n=o8(),a=s8(),i=u8(),s=G3(),u=Hf(),c=l8(),f=c8(),h=f8(),d=h8(),m=p8(),g=d8(),y=m8(),x=g8(),w=Function,b=function(_t){try{return w('"use strict"; return ('+_t+").constructor;")()}catch{}},C=ml(),A=iv(),T=function(){throw new u},R=C?(function(){try{return arguments.callee,T}catch{try{return C(arguments,"callee").get}catch{return T}}})():T,D=b8()(),N=Mw(),O=K3(),k=X3(),z=Iw(),F=Dw(),B={},V=typeof Uint8Array>"u"||!N?r:N(Uint8Array),G={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":D&&N?N([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":B,"%AsyncGenerator%":B,"%AsyncGeneratorFunction%":B,"%AsyncIteratorPrototype%":B,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":w,"%GeneratorFunction%":B,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":D&&N?N(N([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!D||!N?r:N(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":C,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":a,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!D||!N?r:N(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":D&&N?N(""[Symbol.iterator]()):r,"%Symbol%":D?Symbol:r,"%SyntaxError%":s,"%ThrowTypeError%":R,"%TypedArray%":V,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":F,"%Function.prototype.apply%":z,"%Object.defineProperty%":A,"%Object.getPrototypeOf%":O,"%Math.abs%":f,"%Math.floor%":h,"%Math.max%":d,"%Math.min%":m,"%Math.pow%":g,"%Math.round%":y,"%Math.sign%":x,"%Reflect.getPrototypeOf%":k};if(N)try{null.error}catch(_t){var Q=N(N(_t));G["%Error.prototype%"]=Q}var L=function _t(Mt){var kt;if(Mt==="%AsyncFunction%")kt=b("async function () {}");else if(Mt==="%GeneratorFunction%")kt=b("function* () {}");else if(Mt==="%AsyncGeneratorFunction%")kt=b("async function* () {}");else if(Mt==="%AsyncGenerator%"){var Ft=_t("%AsyncGeneratorFunction%");Ft&&(kt=Ft.prototype)}else if(Mt==="%AsyncIteratorPrototype%"){var Pt=_t("%AsyncGenerator%");Pt&&N&&(kt=N(Pt.prototype))}return G[Mt]=kt,kt},X={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},$=Gf(),it=$3(),tt=$.call(F,Array.prototype.concat),q=$.call(z,Array.prototype.splice),nt=$.call(F,String.prototype.replace),W=$.call(F,String.prototype.slice),Z=$.call(F,RegExp.prototype.exec),ot=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,xt=/\\(\\)?/g,Ot=function(Mt){var kt=W(Mt,0,1),Ft=W(Mt,-1);if(kt==="%"&&Ft!=="%")throw new s("invalid intrinsic syntax, expected closing `%`");if(Ft==="%"&&kt!=="%")throw new s("invalid intrinsic syntax, expected opening `%`");var Pt=[];return nt(Mt,ot,function(Ut,$t,Wt,Ae){Pt[Pt.length]=Wt?nt(Ae,xt,"$1"):$t||Ut}),Pt},zt=function(Mt,kt){var Ft=Mt,Pt;if(it(X,Ft)&&(Pt=X[Ft],Ft="%"+Pt[0]+"%"),it(G,Ft)){var Ut=G[Ft];if(Ut===B&&(Ut=L(Ft)),typeof Ut>"u"&&!kt)throw new u("intrinsic "+Mt+" exists, but is not available. Please file an issue!");return{alias:Pt,name:Ft,value:Ut}}throw new s("intrinsic "+Mt+" does not exist!")};return V0=function(Mt,kt){if(typeof Mt!="string"||Mt.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof kt!="boolean")throw new u('"allowMissing" argument must be a boolean');if(Z(/^%?[^%]*%?$/,Mt)===null)throw new s("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ft=Ot(Mt),Pt=Ft.length>0?Ft[0]:"",Ut=zt("%"+Pt+"%",kt),$t=Ut.name,Wt=Ut.value,Ae=!1,cn=Ut.alias;cn&&(Pt=cn[0],q(Ft,tt([0,1],cn)));for(var Et=1,ze=!0;Et<Ft.length;Et+=1){var Ne=Ft[Et],yn=W(Ne,0,1),te=W(Ne,-1);if((yn==='"'||yn==="'"||yn==="`"||te==='"'||te==="'"||te==="`")&&yn!==te)throw new s("property names with quotes must have matching quotes");if((Ne==="constructor"||!ze)&&(Ae=!0),Pt+="."+Ne,$t="%"+Pt+"%",it(G,$t))Wt=G[$t];else if(Wt!=null){if(!(Ne in Wt)){if(!kt)throw new u("base intrinsic for "+Mt+" exists, but the property is not available.");return}if(C&&Et+1>=Ft.length){var de=C(Wt,Ne);ze=!!de,ze&&"get"in de&&!("originalValue"in de.get)?Wt=de.get:Wt=Wt[Ne]}else ze=it(Wt,Ne),Wt=Wt[Ne];ze&&!Ae&&(G[$t]=Wt)}}return Wt},V0}var q0,rT;function Xf(){if(rT)return q0;rT=1;var r=Q3(),e=kw(),t=e([r("%String.prototype.indexOf%")]);return q0=function(a,i){var s=r(a,!!i);return typeof s=="function"&&t(a,".prototype.")>-1?e([s]):s},q0}var W0,aT;function E8(){if(aT)return W0;aT=1;var r=av()(),e=Xf(),t=e("Object.prototype.toString"),n=function(u){return r&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:t(u)==="[object Arguments]"},a=function(u){return n(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&t(u)!=="[object Array]"&&"callee"in u&&t(u.callee)==="[object Function]"},i=(function(){return n(arguments)})();return n.isLegacyArguments=a,W0=i?n:a,W0}var H0,iT;function C8(){if(iT)return H0;iT=1;var r=Xf(),e=av()(),t=$3(),n=ml(),a;if(e){var i=r("RegExp.prototype.exec"),s={},u=function(){throw s},c={toString:u,valueOf:u};typeof Symbol.toPrimitive=="symbol"&&(c[Symbol.toPrimitive]=u),a=function(m){if(!m||typeof m!="object")return!1;var g=n(m,"lastIndex"),y=g&&t(g,"value");if(!y)return!1;try{i(m,c)}catch(x){return x===s}}}else{var f=r("Object.prototype.toString"),h="[object RegExp]";a=function(m){return!m||typeof m!="object"&&typeof m!="function"?!1:f(m)===h}}return H0=a,H0}var G0,oT;function A8(){if(oT)return G0;oT=1;var r=Xf(),e=C8(),t=r("RegExp.prototype.exec"),n=Hf();return G0=function(i){if(!e(i))throw new n("`regex` must be a RegExp");return function(u){return t(i,u)!==null}},G0}var X0,sT;function N8(){if(sT)return X0;sT=1;const r=(function*(){}).constructor;return X0=()=>r,X0}var K0,uT;function T8(){if(uT)return K0;uT=1;var r=Xf(),e=A8(),t=e(/^\s*(?:function)?\*/),n=av()(),a=Mw(),i=r("Object.prototype.toString"),s=r("Function.prototype.toString"),u=N8();return K0=function(f){if(typeof f!="function")return!1;if(t(s(f)))return!0;if(!n){var h=i(f);return h==="[object GeneratorFunction]"}if(!a)return!1;var d=u();return d&&a(f)===d.prototype},K0}var Y0,lT;function R8(){if(lT)return Y0;lT=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(C){C!==n&&(e=null)}else e=null;var a=/^\s*class\b/,i=function(A){try{var T=r.call(A);return a.test(T)}catch{return!1}},s=function(A){try{return i(A)?!1:(r.call(A),!0)}catch{return!1}},u=Object.prototype.toString,c="[object Object]",f="[object Function]",h="[object GeneratorFunction]",d="[object HTMLAllCollection]",m="[object HTML document.all class]",g="[object HTMLCollection]",y=typeof Symbol=="function"&&!!Symbol.toStringTag,x=!(0 in[,]),w=function(){return!1};if(typeof document=="object"){var b=document.all;u.call(b)===u.call(document.all)&&(w=function(A){if((x||!A)&&(typeof A>"u"||typeof A=="object"))try{var T=u.call(A);return(T===d||T===m||T===g||T===c)&&A("")==null}catch{}return!1})}return Y0=e?function(A){if(w(A))return!0;if(!A||typeof A!="function"&&typeof A!="object")return!1;try{e(A,null,t)}catch(T){if(T!==n)return!1}return!i(A)&&s(A)}:function(A){if(w(A))return!0;if(!A||typeof A!="function"&&typeof A!="object")return!1;if(y)return s(A);if(i(A))return!1;var T=u.call(A);return T!==f&&T!==h&&!/^\[object HTML/.test(T)?!1:s(A)},Y0}var $0,cT;function _8(){if(cT)return $0;cT=1;var r=R8(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(c,f,h){for(var d=0,m=c.length;d<m;d++)t.call(c,d)&&(h==null?f(c[d],d,c):f.call(h,c[d],d,c))},a=function(c,f,h){for(var d=0,m=c.length;d<m;d++)h==null?f(c.charAt(d),d,c):f.call(h,c.charAt(d),d,c)},i=function(c,f,h){for(var d in c)t.call(c,d)&&(h==null?f(c[d],d,c):f.call(h,c[d],d,c))};function s(u){return e.call(u)==="[object Array]"}return $0=function(c,f,h){if(!r(f))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=h),s(c)?n(c,f,d):typeof c=="string"?a(c,f,d):i(c,f,d)},$0}var Q0,fT;function O8(){return fT||(fT=1,Q0=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Q0}var Z0,hT;function D8(){if(hT)return Z0;hT=1;var r=O8(),e=typeof globalThis>"u"?lR:globalThis;return Z0=function(){for(var n=[],a=0;a<r.length;a++)typeof e[r[a]]=="function"&&(n[n.length]=r[a]);return n},Z0}var J0={exports:{}},tb,pT;function I8(){if(pT)return tb;pT=1;var r=iv(),e=G3(),t=Hf(),n=ml();return tb=function(i,s,u){if(!i||typeof i!="object"&&typeof i!="function")throw new t("`obj` must be an object or a function`");if(typeof s!="string"&&typeof s!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,f=arguments.length>4?arguments[4]:null,h=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,m=!!n&&n(i,s);if(r)r(i,s,{configurable:h===null&&m?m.configurable:!h,enumerable:c===null&&m?m.enumerable:!c,value:u,writable:f===null&&m?m.writable:!f});else if(d||!c&&!f&&!h)i[s]=u;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},tb}var eb,dT;function k8(){if(dT)return eb;dT=1;var r=iv(),e=function(){return!!r};return e.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},eb=e,eb}var nb,mT;function M8(){if(mT)return nb;mT=1;var r=Q3(),e=I8(),t=k8()(),n=ml(),a=Hf(),i=r("%Math.floor%");return nb=function(u,c){if(typeof u!="function")throw new a("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||i(c)!==c)throw new a("`length` must be a positive 32-bit integer");var f=arguments.length>2&&!!arguments[2],h=!0,d=!0;if("length"in u&&n){var m=n(u,"length");m&&!m.configurable&&(h=!1),m&&!m.writable&&(d=!1)}return(h||d||!f)&&(t?e(u,"length",c,!0,!0):e(u,"length",c)),u},nb}var rb,vT;function z8(){if(vT)return rb;vT=1;var r=Gf(),e=Iw(),t=Y3();return rb=function(){return t(r,e,arguments)},rb}var gT;function F8(){return gT||(gT=1,(function(r){var e=M8(),t=iv(),n=kw(),a=z8();r.exports=function(s){var u=n(arguments),c=s.length-(arguments.length-1);return e(u,1+(c>0?c:0),!0)},t?t(r.exports,"apply",{value:a}):r.exports.apply=a})(J0)),J0.exports}var ab,yT;function Z3(){if(yT)return ab;yT=1;var r=_8(),e=D8(),t=F8(),n=Xf(),a=ml(),i=Mw(),s=n("Object.prototype.toString"),u=av()(),c=typeof globalThis>"u"?lR:globalThis,f=e(),h=n("String.prototype.slice"),d=n("Array.prototype.indexOf",!0)||function(w,b){for(var C=0;C<w.length;C+=1)if(w[C]===b)return C;return-1},m={__proto__:null};u&&a&&i?r(f,function(x){var w=new c[x];if(Symbol.toStringTag in w&&i){var b=i(w),C=a(b,Symbol.toStringTag);if(!C&&b){var A=i(b);C=a(A,Symbol.toStringTag)}if(C&&C.get){var T=t(C.get);m["$"+x]=T}}}):r(f,function(x){var w=new c[x],b=w.slice||w.set;if(b){var C=t(b);m["$"+x]=C}});var g=function(w){var b=!1;return r(m,function(C,A){if(!b)try{"$"+C(w)===A&&(b=h(A,1))}catch{}}),b},y=function(w){var b=!1;return r(m,function(C,A){if(!b)try{C(w),b=h(A,1)}catch{}}),b};return ab=function(w){if(!w||typeof w!="object")return!1;if(!u){var b=h(s(w),8,-1);return d(f,b)>-1?b:b!=="Object"?!1:y(w)}return a?g(w):null},ab}var ib,bT;function B8(){if(bT)return ib;bT=1;var r=Z3();return ib=function(t){return!!r(t)},ib}var xT;function L8(){return xT||(xT=1,(function(r){var e=E8(),t=T8(),n=Z3(),a=B8();function i(Et){return Et.call.bind(Et)}var s=typeof BigInt<"u",u=typeof Symbol<"u",c=i(Object.prototype.toString),f=i(Number.prototype.valueOf),h=i(String.prototype.valueOf),d=i(Boolean.prototype.valueOf);if(s)var m=i(BigInt.prototype.valueOf);if(u)var g=i(Symbol.prototype.valueOf);function y(Et,ze){if(typeof Et!="object")return!1;try{return ze(Et),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=a;function x(Et){return typeof Promise<"u"&&Et instanceof Promise||Et!==null&&typeof Et=="object"&&typeof Et.then=="function"&&typeof Et.catch=="function"}r.isPromise=x;function w(Et){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Et):a(Et)||W(Et)}r.isArrayBufferView=w;function b(Et){return n(Et)==="Uint8Array"}r.isUint8Array=b;function C(Et){return n(Et)==="Uint8ClampedArray"}r.isUint8ClampedArray=C;function A(Et){return n(Et)==="Uint16Array"}r.isUint16Array=A;function T(Et){return n(Et)==="Uint32Array"}r.isUint32Array=T;function R(Et){return n(Et)==="Int8Array"}r.isInt8Array=R;function D(Et){return n(Et)==="Int16Array"}r.isInt16Array=D;function N(Et){return n(Et)==="Int32Array"}r.isInt32Array=N;function O(Et){return n(Et)==="Float32Array"}r.isFloat32Array=O;function k(Et){return n(Et)==="Float64Array"}r.isFloat64Array=k;function z(Et){return n(Et)==="BigInt64Array"}r.isBigInt64Array=z;function F(Et){return n(Et)==="BigUint64Array"}r.isBigUint64Array=F;function B(Et){return c(Et)==="[object Map]"}B.working=typeof Map<"u"&&B(new Map);function V(Et){return typeof Map>"u"?!1:B.working?B(Et):Et instanceof Map}r.isMap=V;function G(Et){return c(Et)==="[object Set]"}G.working=typeof Set<"u"&&G(new Set);function Q(Et){return typeof Set>"u"?!1:G.working?G(Et):Et instanceof Set}r.isSet=Q;function L(Et){return c(Et)==="[object WeakMap]"}L.working=typeof WeakMap<"u"&&L(new WeakMap);function X(Et){return typeof WeakMap>"u"?!1:L.working?L(Et):Et instanceof WeakMap}r.isWeakMap=X;function $(Et){return c(Et)==="[object WeakSet]"}$.working=typeof WeakSet<"u"&&$(new WeakSet);function it(Et){return $(Et)}r.isWeakSet=it;function tt(Et){return c(Et)==="[object ArrayBuffer]"}tt.working=typeof ArrayBuffer<"u"&&tt(new ArrayBuffer);function q(Et){return typeof ArrayBuffer>"u"?!1:tt.working?tt(Et):Et instanceof ArrayBuffer}r.isArrayBuffer=q;function nt(Et){return c(Et)==="[object DataView]"}nt.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&nt(new DataView(new ArrayBuffer(1),0,1));function W(Et){return typeof DataView>"u"?!1:nt.working?nt(Et):Et instanceof DataView}r.isDataView=W;var Z=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ot(Et){return c(Et)==="[object SharedArrayBuffer]"}function xt(Et){return typeof Z>"u"?!1:(typeof ot.working>"u"&&(ot.working=ot(new Z)),ot.working?ot(Et):Et instanceof Z)}r.isSharedArrayBuffer=xt;function Ot(Et){return c(Et)==="[object AsyncFunction]"}r.isAsyncFunction=Ot;function zt(Et){return c(Et)==="[object Map Iterator]"}r.isMapIterator=zt;function _t(Et){return c(Et)==="[object Set Iterator]"}r.isSetIterator=_t;function Mt(Et){return c(Et)==="[object Generator]"}r.isGeneratorObject=Mt;function kt(Et){return c(Et)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=kt;function Ft(Et){return y(Et,f)}r.isNumberObject=Ft;function Pt(Et){return y(Et,h)}r.isStringObject=Pt;function Ut(Et){return y(Et,d)}r.isBooleanObject=Ut;function $t(Et){return s&&y(Et,m)}r.isBigIntObject=$t;function Wt(Et){return u&&y(Et,g)}r.isSymbolObject=Wt;function Ae(Et){return Ft(Et)||Pt(Et)||Ut(Et)||$t(Et)||Wt(Et)}r.isBoxedPrimitive=Ae;function cn(Et){return typeof Uint8Array<"u"&&(q(Et)||xt(Et))}r.isAnyArrayBuffer=cn,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Et){Object.defineProperty(r,Et,{enumerable:!1,value:function(){throw new Error(Et+" is not supported in userland")}})})})(s0)),s0}var ob,wT;function U8(){return wT||(wT=1,ob=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),ob}var Ep={exports:{}},ST;function j8(){return ST||(ST=1,typeof Object.create=="function"?Ep.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Ep.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Ep.exports}var ET;function P8(){return ET||(ET=1,(function(r){var e={},t=Object.getOwnPropertyDescriptors||function(Z){for(var ot=Object.keys(Z),xt={},Ot=0;Ot<ot.length;Ot++)xt[ot[Ot]]=Object.getOwnPropertyDescriptor(Z,ot[Ot]);return xt},n=/%[sdj%]/g;r.format=function(W){if(!D(W)){for(var Z=[],ot=0;ot<arguments.length;ot++)Z.push(u(arguments[ot]));return Z.join(" ")}for(var ot=1,xt=arguments,Ot=xt.length,zt=String(W).replace(n,function(Mt){if(Mt==="%%")return"%";if(ot>=Ot)return Mt;switch(Mt){case"%s":return String(xt[ot++]);case"%d":return Number(xt[ot++]);case"%j":try{return JSON.stringify(xt[ot++])}catch{return"[Circular]"}default:return Mt}}),_t=xt[ot];ot<Ot;_t=xt[++ot])A(_t)||!z(_t)?zt+=" "+_t:zt+=" "+u(_t);return zt},r.deprecate=function(W,Z){if(typeof Rn<"u"&&Rn.noDeprecation===!0)return W;if(typeof Rn>"u")return function(){return r.deprecate(W,Z).apply(this,arguments)};var ot=!1;function xt(){if(!ot){if(Rn.throwDeprecation)throw new Error(Z);Rn.traceDeprecation?console.trace(Z):console.error(Z),ot=!0}return W.apply(this,arguments)}return xt};var a={},i=/^$/;if(e.NODE_DEBUG){var s=e.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+s+"$","i")}r.debuglog=function(W){if(W=W.toUpperCase(),!a[W])if(i.test(W)){var Z=Rn.pid;a[W]=function(){var ot=r.format.apply(r,arguments);console.error("%s %d: %s",W,Z,ot)}}else a[W]=function(){};return a[W]};function u(W,Z){var ot={seen:[],stylize:f};return arguments.length>=3&&(ot.depth=arguments[2]),arguments.length>=4&&(ot.colors=arguments[3]),C(Z)?ot.showHidden=Z:Z&&r._extend(ot,Z),O(ot.showHidden)&&(ot.showHidden=!1),O(ot.depth)&&(ot.depth=2),O(ot.colors)&&(ot.colors=!1),O(ot.customInspect)&&(ot.customInspect=!0),ot.colors&&(ot.stylize=c),d(ot,W,ot.depth)}r.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function c(W,Z){var ot=u.styles[Z];return ot?"\x1B["+u.colors[ot][0]+"m"+W+"\x1B["+u.colors[ot][1]+"m":W}function f(W,Z){return W}function h(W){var Z={};return W.forEach(function(ot,xt){Z[ot]=!0}),Z}function d(W,Z,ot){if(W.customInspect&&Z&&V(Z.inspect)&&Z.inspect!==r.inspect&&!(Z.constructor&&Z.constructor.prototype===Z)){var xt=Z.inspect(ot,W);return D(xt)||(xt=d(W,xt,ot)),xt}var Ot=m(W,Z);if(Ot)return Ot;var zt=Object.keys(Z),_t=h(zt);if(W.showHidden&&(zt=Object.getOwnPropertyNames(Z)),B(Z)&&(zt.indexOf("message")>=0||zt.indexOf("description")>=0))return g(Z);if(zt.length===0){if(V(Z)){var Mt=Z.name?": "+Z.name:"";return W.stylize("[Function"+Mt+"]","special")}if(k(Z))return W.stylize(RegExp.prototype.toString.call(Z),"regexp");if(F(Z))return W.stylize(Date.prototype.toString.call(Z),"date");if(B(Z))return g(Z)}var kt="",Ft=!1,Pt=["{","}"];if(b(Z)&&(Ft=!0,Pt=["[","]"]),V(Z)){var Ut=Z.name?": "+Z.name:"";kt=" [Function"+Ut+"]"}if(k(Z)&&(kt=" "+RegExp.prototype.toString.call(Z)),F(Z)&&(kt=" "+Date.prototype.toUTCString.call(Z)),B(Z)&&(kt=" "+g(Z)),zt.length===0&&(!Ft||Z.length==0))return Pt[0]+kt+Pt[1];if(ot<0)return k(Z)?W.stylize(RegExp.prototype.toString.call(Z),"regexp"):W.stylize("[Object]","special");W.seen.push(Z);var $t;return Ft?$t=y(W,Z,ot,_t,zt):$t=zt.map(function(Wt){return x(W,Z,ot,_t,Wt,Ft)}),W.seen.pop(),w($t,kt,Pt)}function m(W,Z){if(O(Z))return W.stylize("undefined","undefined");if(D(Z)){var ot="'"+JSON.stringify(Z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return W.stylize(ot,"string")}if(R(Z))return W.stylize(""+Z,"number");if(C(Z))return W.stylize(""+Z,"boolean");if(A(Z))return W.stylize("null","null")}function g(W){return"["+Error.prototype.toString.call(W)+"]"}function y(W,Z,ot,xt,Ot){for(var zt=[],_t=0,Mt=Z.length;_t<Mt;++_t)it(Z,String(_t))?zt.push(x(W,Z,ot,xt,String(_t),!0)):zt.push("");return Ot.forEach(function(kt){kt.match(/^\d+$/)||zt.push(x(W,Z,ot,xt,kt,!0))}),zt}function x(W,Z,ot,xt,Ot,zt){var _t,Mt,kt;if(kt=Object.getOwnPropertyDescriptor(Z,Ot)||{value:Z[Ot]},kt.get?kt.set?Mt=W.stylize("[Getter/Setter]","special"):Mt=W.stylize("[Getter]","special"):kt.set&&(Mt=W.stylize("[Setter]","special")),it(xt,Ot)||(_t="["+Ot+"]"),Mt||(W.seen.indexOf(kt.value)<0?(A(ot)?Mt=d(W,kt.value,null):Mt=d(W,kt.value,ot-1),Mt.indexOf(`
`)>-1&&(zt?Mt=Mt.split(`
`).map(function(Ft){return"  "+Ft}).join(`
`).slice(2):Mt=`
`+Mt.split(`
`).map(function(Ft){return"   "+Ft}).join(`
`))):Mt=W.stylize("[Circular]","special")),O(_t)){if(zt&&Ot.match(/^\d+$/))return Mt;_t=JSON.stringify(""+Ot),_t.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(_t=_t.slice(1,-1),_t=W.stylize(_t,"name")):(_t=_t.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),_t=W.stylize(_t,"string"))}return _t+": "+Mt}function w(W,Z,ot){var xt=W.reduce(function(Ot,zt){return zt.indexOf(`
`)>=0,Ot+zt.replace(/\u001b\[\d\d?m/g,"").length+1},0);return xt>60?ot[0]+(Z===""?"":Z+`
 `)+" "+W.join(`,
  `)+" "+ot[1]:ot[0]+Z+" "+W.join(", ")+" "+ot[1]}r.types=L8();function b(W){return Array.isArray(W)}r.isArray=b;function C(W){return typeof W=="boolean"}r.isBoolean=C;function A(W){return W===null}r.isNull=A;function T(W){return W==null}r.isNullOrUndefined=T;function R(W){return typeof W=="number"}r.isNumber=R;function D(W){return typeof W=="string"}r.isString=D;function N(W){return typeof W=="symbol"}r.isSymbol=N;function O(W){return W===void 0}r.isUndefined=O;function k(W){return z(W)&&Q(W)==="[object RegExp]"}r.isRegExp=k,r.types.isRegExp=k;function z(W){return typeof W=="object"&&W!==null}r.isObject=z;function F(W){return z(W)&&Q(W)==="[object Date]"}r.isDate=F,r.types.isDate=F;function B(W){return z(W)&&(Q(W)==="[object Error]"||W instanceof Error)}r.isError=B,r.types.isNativeError=B;function V(W){return typeof W=="function"}r.isFunction=V;function G(W){return W===null||typeof W=="boolean"||typeof W=="number"||typeof W=="string"||typeof W=="symbol"||typeof W>"u"}r.isPrimitive=G,r.isBuffer=U8();function Q(W){return Object.prototype.toString.call(W)}function L(W){return W<10?"0"+W.toString(10):W.toString(10)}var X=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function $(){var W=new Date,Z=[L(W.getHours()),L(W.getMinutes()),L(W.getSeconds())].join(":");return[W.getDate(),X[W.getMonth()],Z].join(" ")}r.log=function(){console.log("%s - %s",$(),r.format.apply(r,arguments))},r.inherits=j8(),r._extend=function(W,Z){if(!Z||!z(Z))return W;for(var ot=Object.keys(Z),xt=ot.length;xt--;)W[ot[xt]]=Z[ot[xt]];return W};function it(W,Z){return Object.prototype.hasOwnProperty.call(W,Z)}var tt=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(Z){if(typeof Z!="function")throw new TypeError('The "original" argument must be of type Function');if(tt&&Z[tt]){var ot=Z[tt];if(typeof ot!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(ot,tt,{value:ot,enumerable:!1,writable:!1,configurable:!0}),ot}function ot(){for(var xt,Ot,zt=new Promise(function(kt,Ft){xt=kt,Ot=Ft}),_t=[],Mt=0;Mt<arguments.length;Mt++)_t.push(arguments[Mt]);_t.push(function(kt,Ft){kt?Ot(kt):xt(Ft)});try{Z.apply(this,_t)}catch(kt){Ot(kt)}return zt}return Object.setPrototypeOf(ot,Object.getPrototypeOf(Z)),tt&&Object.defineProperty(ot,tt,{value:ot,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(ot,t(Z))},r.promisify.custom=tt;function q(W,Z){if(!W){var ot=new Error("Promise was rejected with a falsy value");ot.reason=W,W=ot}return Z(W)}function nt(W){if(typeof W!="function")throw new TypeError('The "original" argument must be of type Function');function Z(){for(var ot=[],xt=0;xt<arguments.length;xt++)ot.push(arguments[xt]);var Ot=ot.pop();if(typeof Ot!="function")throw new TypeError("The last argument must be of type Function");var zt=this,_t=function(){return Ot.apply(zt,arguments)};W.apply(this,ot).then(function(Mt){Rn.nextTick(_t.bind(null,null,Mt))},function(Mt){Rn.nextTick(q.bind(null,Mt,_t))})}return Object.setPrototypeOf(Z,Object.getPrototypeOf(W)),Object.defineProperties(Z,t(W)),Z}r.callbackify=nt})(o0)),o0}var V8=P8();var J3=function(r,e){return(J3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(r,e)};function q8(r,e){function t(){this.constructor=r}J3(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var u1=function(){return(u1=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)};function rn(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){var h;f.done?a(f.value):(h=f.value,h instanceof t?h:new t(function(d){d(h)})).then(s,u)}c((n=n.apply(r,[])).next())})}function an(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}function ir(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function zw(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n,a,i=t.call(r),s=[];try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function Dc(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(zw(arguments[e]));return r}function W8(r){return rn(this,void 0,void 0,function(){var e,t,n,a,i,s,u;return an(this,function(c){switch(c.label){case 0:return e="http://",t="https://",n="file://",r.indexOf(e)!==0&&r.indexOf(t)!==0?[3,3]:[4,fetch(r)];case 1:return[4,c.sent().json()];case 2:return[2,c.sent()];case 3:return r.indexOf(n)!==0?[3,5]:(a=require("fs"),i=V8.promisify(a.readFile),u=(s=JSON).parse,[4,i(r.slice(n.length),{encoding:"utf-8"})]);case 4:return[2,u.apply(s,[c.sent()])];case 5:throw new Error("Unsupported URL scheme in metadata URL: "+r+". Supported schemes are: http://, https://, and (node.js-only) file://")}})})}var qu=null;function Gc(r){return qu==null&&(qu=tf().epsilon()),ft(function(){var e=ko(r),t=e.mean,n=e.variance;return Sn(gn(r,t),se(Fs(n),qu))})}function H8(r){if(r.length<2)throw new Error("Cannot normalize a Float32Array with fewer than 2 elements.");return qu==null&&(qu=tf().epsilon()),ft(function(){var e=ko(zn(r)),t=e.mean,n=e.variance,a=t.arraySync(),i=Math.sqrt(n.arraySync()),s=Array.from(r).map(function(u){return(u-a)/(i+qu)});return new Float32Array(s)})}function G8(){return window.AudioContext||window.webkitAudioContext}function X8(r){return rn(this,void 0,void 0,function(){return an(this,function(e){return[2,navigator.mediaDevices.getUserMedia({audio:r==null||r,video:!1})]})})}var l1=(function(){function r(e){var t=this;if(e==null)throw new Error("Required configuration object is missing for BrowserFftFeatureExtractor constructor");if(e.spectrogramCallback==null)throw new Error("spectrogramCallback cannot be null or undefined");if(!(e.numFramesPerSpectrogram>0))throw new Error("Invalid value in numFramesPerSpectrogram: "+e.numFramesPerSpectrogram);if(e.suppressionTimeMillis<0)throw new Error("Expected suppressionTimeMillis to be >= 0, but got "+e.suppressionTimeMillis);if(this.suppressionTimeMillis=e.suppressionTimeMillis,this.spectrogramCallback=e.spectrogramCallback,this.numFrames=e.numFramesPerSpectrogram,this.sampleRateHz=e.sampleRateHz||44100,this.fftSize=e.fftSize||1024,this.frameDurationMillis=this.fftSize/this.sampleRateHz*1e3,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.overlapFactor=e.overlapFactor,this.includeRawAudio=e.includeRawAudio,At.assert(this.overlapFactor>=0&&this.overlapFactor<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+t.overlapFactor}),this.columnTruncateLength>this.fftSize)throw new Error("columnTruncateLength "+this.columnTruncateLength+" exceeds fftSize ("+this.fftSize+").");this.audioContextConstructor=G8()}return r.prototype.start=function(e){return rn(this,void 0,void 0,function(){var t,n,a;return an(this,function(i){switch(i.label){case 0:if(this.frameIntervalTask!=null)throw new Error("Cannot start already-started BrowserFftFeatureExtractor");return t=this,[4,X8(e)];case 1:return t.stream=i.sent(),this.audioContext=new this.audioContextConstructor({sampleRate:this.sampleRateHz}),n=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=0,n.connect(this.analyser),this.freqDataQueue=[],this.freqData=new Float32Array(this.fftSize),this.includeRawAudio&&(this.timeDataQueue=[],this.timeData=new Float32Array(this.fftSize)),a=Math.max(1,Math.round(this.numFrames*(1-this.overlapFactor))),this.tracker=new K8(a,Math.round(this.suppressionTimeMillis/this.frameDurationMillis)),this.frameIntervalTask=setInterval(this.onAudioFrame.bind(this),this.fftSize/this.sampleRateHz*1e3),[2]}})})},r.prototype.onAudioFrame=function(){return rn(this,void 0,void 0,function(){var e,t,n,a;return an(this,function(i){switch(i.label){case 0:return this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0?[2]:(this.freqDataQueue.push(this.freqData.slice(0,this.columnTruncateLength)),this.includeRawAudio&&(this.analyser.getFloatTimeDomainData(this.timeData),this.timeDataQueue.push(this.timeData.slice())),this.freqDataQueue.length>this.numFrames&&this.freqDataQueue.shift(),this.tracker.tick()?(e=CT(this.freqDataQueue),t=AT(e,[1,this.numFrames,this.columnTruncateLength,1]),n=void 0,this.includeRawAudio&&(a=CT(this.timeDataQueue),n=AT(a,[1,this.numFrames*this.fftSize])),[4,this.spectrogramCallback(t,n)]):[3,2]);case 1:i.sent()&&this.tracker.suppress(),re([t,n]),i.label=2;case 2:return[2]}})})},r.prototype.stop=function(){return rn(this,void 0,void 0,function(){return an(this,function(e){if(this.frameIntervalTask==null)throw new Error("Cannot stop because there is no ongoing streaming activity.");return clearInterval(this.frameIntervalTask),this.frameIntervalTask=null,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop(),[2]})})},r.prototype.setConfig=function(e){throw new Error("setConfig() is not implemented for BrowserFftFeatureExtractor.")},r.prototype.getFeatures=function(){throw new Error("getFeatures() is not implemented for BrowserFftFeatureExtractor. Use the spectrogramCallback field of the constructor config instead.")},r})();function CT(r){var e=r[0].length,t=new Float32Array(r.length*e);return r.forEach(function(n,a){return t.set(n,a*e)}),t}function AT(r,e){var t=new Float32Array(At.sizeFromShape(e));return t.set(r,t.length-r.length),sn(t,e)}var K8=(function(){function r(e,t){var n=this;this.period=e,this.suppressionTime=t??0,this.counter=0,At.assert(this.period>0,function(){return"Expected period to be positive, but got "+n.period})}return r.prototype.tick=function(){return this.counter++,this.counter%this.period==0&&(this.suppressionOnset==null||this.counter-this.suppressionOnset>this.suppressionTime)},r.prototype.suppress=function(){this.suppressionOnset=this.counter},r})();function Ad(r){var e=0;r.forEach(function(a){e+=a.byteLength});var t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(new Uint8Array(a),n),n+=a.byteLength}),t.buffer}function Y8(r){var e=0;r.forEach(function(a){return e+=a.length});var t=new Float32Array(e),n=0;return r.forEach(function(a){t.set(a,n),n+=a.length}),t}function NT(r){if(r==null)throw new Error("Received null or undefind string");for(var e=unescape(encodeURIComponent(r)),t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function TT(r){if(r==null)throw new Error("Received null or undefind buffer");var e=new Uint8Array(r);return decodeURIComponent(escape(String.fromCharCode.apply(String,Dc(e))))}function $8(){function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function Q8(r,e){return Math.floor((e-r)*Math.random())+r}function Z8(r,e,t){return At.assert(t>0&&t<1,function(){return"validationSplit is expected to be >0 and <1, but got "+t}),ft(function(){for(var n=Ri(e,-1).dataSync(),a=[],i=0;i<n.length;++i){var s=n[i];a[s]==null&&(a[s]=[]),a[s].push(i)}var u=a.length,c=[],f=[];for(a.map(function(g){return At.shuffle(g)}),i=0;i<u;++i)for(var h=a[i],d=Math.round(h.length*(1-t)),m=0;m<h.length;++m)m<d?c.push(h[m]):f.push(h[m]);return{trainXs:fa(r,c),trainYs:fa(e,c),valXs:fa(r,f),valYs:fa(e,f)}})}function J8(r,e,t){var n,a,i,s,u,c,f,h;At.assert(t>0&&t<1,function(){return"validationSplit is expected to be >0 and <1, but got "+t});for(var d=!Array.isArray(r[0]),m=e,g=[],y=0;y<m.length;++y){var x=m[y];g[x]==null&&(g[x]=[]),g[x].push(y)}var w=g.length,b=[],C=[];for(g.map(function(it){return At.shuffle(it)}),y=0;y<w;++y)for(var A=g[y],T=Math.round(A.length*(1-t)),R=0;R<A.length;++R)R<T?b.push(A[R]):C.push(A[R]);if(d){var D=[],N=[],O=[],k=[];try{for(var z=ir(b),F=z.next();!F.done;F=z.next()){var B=F.value;D.push(r[B]),N.push(e[B])}}catch(it){n={error:it}}finally{try{F&&!F.done&&(a=z.return)&&a.call(z)}finally{if(n)throw n.error}}try{for(var V=ir(C),G=V.next();!G.done;G=V.next())B=G.value,O.push(r[B]),k.push(e[B])}catch(it){i={error:it}}finally{try{G&&!G.done&&(s=V.return)&&s.call(V)}finally{if(i)throw i.error}}return{trainXs:D,trainYs:N,valXs:O,valYs:k}}D=[],N=[],O=[],k=[];try{for(var Q=ir(b),L=Q.next();!L.done;L=Q.next())B=L.value,D.push(r[B]),N.push(e[B])}catch(it){u={error:it}}finally{try{L&&!L.done&&(c=Q.return)&&c.call(Q)}finally{if(u)throw u.error}}try{for(var X=ir(C),$=X.next();!$.done;$=X.next())B=$.value,O.push(r[B]),k.push(e[B])}catch(it){f={error:it}}finally{try{$&&!$.done&&(h=X.return)&&h.call(X)}finally{if(f)throw f.error}}return{trainXs:D,trainYs:N,valXs:O,valYs:k}}var Hp="TFJSSCDS",tW=1,Wu="_background_noise_",RT=(function(){function r(e){if(this.examples={},this.label2Ids={},e!=null)for(var t=aW(e),n=0,a=0;a<t.manifest.length;++a){var i=t.manifest[a],s=i.spectrogramNumFrames*i.spectrogramFrameSize;i.rawAudioNumSamples!=null&&(s+=i.rawAudioNumSamples),s*=4,this.addExample(nW({spec:i,data:t.data.slice(n,n+s)})),n+=s}}return r.prototype.addExample=function(e){At.assert(e!=null,function(){return"Got null or undefined example"}),At.assert(e.label!=null&&e.label.length>0,function(){return"Expected label to be a non-empty string, but got "+JSON.stringify(e.label)});var t=$8();return this.examples[t]=e,e.label in this.label2Ids||(this.label2Ids[e.label]=[]),this.label2Ids[e.label].push(t),t},r.prototype.merge=function(e){var t,n,a,i;At.assert(e!==this,function(){return"Cannot merge a dataset into itself"});var s=e.getVocabulary();try{for(var u=ir(s),c=u.next();!c.done;c=u.next()){var f=c.value,h=e.getExamples(f);try{for(var d=(a=void 0,ir(h)),m=d.next();!m.done;m=d.next()){var g=m.value;this.addExample(g.example)}}catch(y){a={error:y}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}}catch(y){t={error:y}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}},r.prototype.getExampleCounts=function(){var e={};for(var t in this.examples){var n=this.examples[t];n.label in e||(e[n.label]=0),e[n.label]++}return e},r.prototype.getExamples=function(e){var t=this;At.assert(e!=null,function(){return"Expected label to be a string, but got "+JSON.stringify(e)}),At.assert(e in this.label2Ids,function(){return'No example of label "'+e+'" exists in dataset'});var n=[];return this.label2Ids[e].forEach(function(a){n.push({uid:a,example:t.examples[a]})}),n},r.prototype.getData=function(e,t){var n=this;At.assert(this.size()>0,function(){return"Cannot get spectrograms as tensors because the dataset is empty"});var a=this.getVocabulary();e!=null?At.assert(a.indexOf(e)!==-1,function(){return"Label "+e+" is not in the vocabulary ("+JSON.stringify(a)+")"}):At.assert(a.length>1,function(){return"One-hot encoding of labels requires the vocabulary to have at least two words, but it has only "+a.length+" word."}),t==null&&(t={});var i,s,u=this.getSortedUniqueNumFrames();u.length===1?(i=t.numFrames==null?u[0]:t.numFrames,s=t.hopFrames==null?1:t.hopFrames):(i=t.numFrames,At.assert(i!=null&&Number.isInteger(i)&&i>0,function(){return"There are "+u.length+" unique lengths among the "+n.size()+" examples of this Dataset, hence numFrames is required. But it is not provided."}),At.assert(i<=u[0],function(){return"numFrames ("+i+") exceeds the minimum numFrames ("+u[0]+") among the examples of the Dataset."}),s=t.hopFrames,At.assert(s!=null&&Number.isInteger(s)&&s>0,function(){return"There are "+u.length+" unique lengths among the "+n.size()+" examples of this Dataset, hence hopFrames is required. But it is not provided."}));var c=t.normalize==null||t.normalize;return ft(function(){for(var f,h,d,m=[],g=[],y=[],x=0;x<a.length;++x){var w=a[x];if(e==null||w===e){var b=n.label2Ids[w],C=function(W){var Z,ot,xt=n.examples[W].spectrogram,Ot=xt.frameSize;d==null?d=Ot:At.assert(Ot===d,function(){return"Mismatch in frameSize  ("+Ot+" vs "+d+")"});var zt=xt.data.length/Ot,_t=null;w!==Wu&&(_t=xt.keyFrameIndex==null?sW(xt).dataSync()[0]:xt.keyFrameIndex);var Mt=ds(xt.data,[zt,Ot,1]),kt=iW(zt,_t,i,s),Ft=function($t){var Wt=ft(function(){var Ae=nr(Mt,[$t[0],0,0],[$t[1]-$t[0],-1,-1]);return c?Gc(Ae):Ae});t.getDataset?g.push(Wt.dataSync()):m.push(Wt),e==null&&y.push(x)};try{for(var Pt=(Z=void 0,ir(kt)),Ut=Pt.next();!Ut.done;Ut=Pt.next())Ft(Ut.value)}catch($t){Z={error:$t}}finally{try{Ut&&!Ut.done&&(ot=Pt.return)&&ot.call(Pt)}finally{if(Z)throw Z.error}}re(Mt)};try{for(var A=(f=void 0,ir(b)),T=A.next();!T.done;T=A.next())C(T.value)}catch(W){f={error:W}}finally{try{T&&!T.done&&(h=A.return)&&h.call(A)}finally{if(f)throw f.error}}}}t.augmentByMixingNoiseRatio!=null&&n.augmentByMixingNoise(t.getDataset?g:m,y,t.augmentByMixingNoiseRatio);var R=t.shuffle==null||t.shuffle;if(t.getDataset){var D=t.datasetBatchSize==null?32:t.datasetBatchSize,N=t.datasetValidationSplit==null?.15:t.datasetValidationSplit;At.assert(N>0&&N<1,function(){return"Invalid dataset validation split: "+N});var O=g.map(function(W,Z){return[W,y[Z]]});At.shuffle(O),g=O.map(function(W){return W[0]});var k=O.map(function(W){return W[1]}),z=J8(g,k,N),F=z.trainXs,B=z.trainYs,V=z.valXs,G=z.valYs,Q=Ac(F).map(function(W){return ds(W,[i,d,1])}),L=Ac(B).map(function(W){return Ai(Ua([W],a.length),[0])}),X=s1({xs:Q,ys:L});R&&(X=X.shuffle(g.length)),X=X.batch(D).prefetch(4);var $=Ac(V).map(function(W){return ds(W,[i,d,1])}),it=Ac(G).map(function(W){return Ai(Ua([W],a.length),[0])}),tt=s1({xs:$,ys:it});return[X,tt=tt.batch(D).prefetch(4)]}if(R){var q=[];m.forEach(function(W,Z){q.push({x:W,y:y[Z]})}),At.shuffle(q),m=q.map(function(W){return W.x}),y=q.map(function(W){return W.y})}var nt=e==null?No(Ua(zn(y,"int32"),a.length),"float32"):void 0;return{xs:Lr(m),ys:nt}})},r.prototype.augmentByMixingNoise=function(e,t,n){var a,i;if(e==null||e.length===0)throw new Error("Cannot perform augmentation because data is null or empty");for(var s=e[0]instanceof Float32Array,u=this.getVocabulary(),c=[],f=[],h=0;h<t.length;++h)u[t[h]]===Wu?c.push(h):f.push(h);if(c.length===0)throw new Error("Cannot perform augmentation by mixing with noise when there is no example with label "+Wu);var d=[],m=[],g=function(w){var b=c[Q8(0,c.length)],C=s?zn(e[w]):e[w],A=s?zn(e[b]):e[b],T=ft(function(){return Gc(se(C,Jt(A,n)))});s?d.push(T.dataSync()):d.push(T),m.push(t[w])};try{for(var y=ir(f),x=y.next();!x.done;x=y.next())g(x.value)}catch(w){a={error:w}}finally{try{x&&!x.done&&(i=y.return)&&i.call(y)}finally{if(a)throw a.error}}console.log("Data augmentation: mixing noise: added "+d.length+" examples"),d.forEach(function(w){return e.push(w)}),t.push.apply(t,Dc(m))},r.prototype.getSortedUniqueNumFrames=function(){for(var e,t,n=new Set,a=this.getVocabulary(),i=0;i<a.length;++i){var s=a[i],u=this.label2Ids[s];try{for(var c=(e=void 0,ir(u)),f=c.next();!f.done;f=c.next()){var h=f.value,d=this.examples[h].spectrogram,m=d.data.length/d.frameSize;n.add(m)}}catch(y){e={error:y}}finally{try{f&&!f.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}}var g=Dc(n);return g.sort(),g},r.prototype.removeExample=function(e){if(!(e in this.examples))throw new Error("Nonexistent example UID: "+e);var t=this.examples[e].label;delete this.examples[e];var n=this.label2Ids[t].indexOf(e);this.label2Ids[t].splice(n,1),this.label2Ids[t].length===0&&delete this.label2Ids[t]},r.prototype.setExampleKeyFrameIndex=function(e,t){if(!(e in this.examples))throw new Error("Nonexistent example UID: "+e);var n=this.examples[e].spectrogram,a=n.data.length/n.frameSize;At.assert(t>=0&&t<a&&Number.isInteger(t),function(){return"Invalid keyFrameIndex: "+t+". Must be >= 0, < "+a+", and an integer."}),n.keyFrameIndex=t},r.prototype.size=function(){return Object.keys(this.examples).length},r.prototype.durationMillis=function(){var e=0;for(var t in this.examples){var n=this.examples[t].spectrogram,a=23.22|n.frameDurationMillis;e+=n.data.length/n.frameSize*a}return e},r.prototype.empty=function(){return this.size()===0},r.prototype.clear=function(){this.examples={}},r.prototype.getVocabulary=function(){var e=new Set;for(var t in this.examples){var n=this.examples[t];e.add(n.label)}var a=Dc(e);return a.sort(),a},r.prototype.serialize=function(e){var t,n,a,i,s=this.getVocabulary();At.assert(!this.empty(),function(){return"Cannot serialize empty Dataset"}),e!=null&&(Array.isArray(e)||(e=[e]),e.forEach(function(b){if(s.indexOf(b)===-1)throw new Error('Word label "'+b+'" does not exist in the vocabulary of this dataset. The vocabulary is: '+JSON.stringify(s)+".")}));var u=[],c=[];try{for(var f=ir(s),h=f.next();!h.done;h=f.next()){var d=h.value;if(e==null||e.indexOf(d)!==-1){var m=this.label2Ids[d];try{for(var g=(a=void 0,ir(m)),y=g.next();!y.done;y=g.next()){var x=y.value,w=eW(this.examples[x]);u.push(w.spec),c.push(w.data)}}catch(b){a={error:b}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}}}}catch(b){t={error:b}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}return rW({manifest:u,data:Ad(c)})},r})();function eW(r){var e=r.rawAudio!=null,t={label:r.label,spectrogramNumFrames:r.spectrogram.data.length/r.spectrogram.frameSize,spectrogramFrameSize:r.spectrogram.frameSize};r.spectrogram.keyFrameIndex!=null&&(t.spectrogramKeyFrameIndex=r.spectrogram.keyFrameIndex);var n=r.spectrogram.data.buffer.slice(0);return e&&(t.rawAudioNumSamples=r.rawAudio.data.length,t.rawAudioSampleRateHz=r.rawAudio.sampleRateHz,n=Ad([n,r.rawAudio.data.buffer])),{spec:t,data:n}}function nW(r){var e={frameSize:r.spec.spectrogramFrameSize,data:new Float32Array(r.data.slice(0,4*r.spec.spectrogramFrameSize*r.spec.spectrogramNumFrames))};r.spec.spectrogramKeyFrameIndex!=null&&(e.keyFrameIndex=r.spec.spectrogramKeyFrameIndex);var t={label:r.spec.label,spectrogram:e};return r.spec.rawAudioNumSamples!=null&&(t.rawAudio={sampleRateHz:r.spec.rawAudioSampleRateHz,data:new Float32Array(r.data.slice(4*r.spec.spectrogramFrameSize*r.spec.spectrogramNumFrames))}),t}function rW(r){var e=NT(JSON.stringify(r.manifest)),t=NT(Hp),n=new Uint32Array([tW]),a=new Uint32Array([e.byteLength]);return Ad([Ad([t,n.buffer,a.buffer]),e,r.data])}function aW(r){At.assert(r!=null,function(){return"Received null or undefined buffer"});var e=0,t=TT(r.slice(e,Hp.length));At.assert(t===Hp,function(){return"Deserialization error: Invalid descriptor"}),e+=Hp.length,e+=4;var n=new Uint32Array(r,e,1),a=e+=4;e=a+n[0];var i=TT(r.slice(a,e));return{manifest:JSON.parse(i),data:r.slice(e)}}function iW(r,e,t,n){if(At.assert(Number.isInteger(r)&&r>0,function(){return"snippetLength must be a positive integer, but got "+r}),e!=null&&At.assert(Number.isInteger(e)&&e>=0,function(){return"focusIndex must be a non-negative integer, but got "+e}),At.assert(Number.isInteger(t)&&t>0,function(){return"windowLength must be a positive integer, but got "+t}),At.assert(Number.isInteger(n)&&n>0,function(){return"windowHop must be a positive integer, but got "+n}),At.assert(t<=r,function(){return"windowLength ("+t+") exceeds snippetLength ("+r+")"}),At.assert(e<r,function(){return"focusIndex ("+e+") equals or exceeds snippetLength ("+r+")"}),t===r)return[[0,r]];var a=[];if(e==null){for(var i=0;i+t<=r;)a.push([i,i+t]),i+=n;return a}var s=Math.floor(t/2),u=e-s;for(u<0?u=0:u+t>r&&(u=r-t);!(u-n<0||e>=u-n+t);)u-=n;for(;u+t<=r&&!(e<u);)a.push([u,u+t]),u+=n;return a}function oW(r){return ft(function(){var e=r.data.length/r.frameSize,t=ta(r.data,[e,r.frameSize]);return un(t,-1)})}function sW(r){return ft(function(){return Ri(oW(r))})}var tk="0.5.4",uW="_unknown_",sb="tfjs-speech-commands-saved-model-metadata",lW="indexeddb://tfjs-speech-commands-model/",ub={localStorage:typeof window>"u"?null:window.localStorage};function cW(r){return r.split(".").slice(0,2).join(".")}var Cp=.25,ek=(function(){function r(e,t,n){this.MODEL_URL_PREFIX="https://storage.googleapis.com/tfjs-models/tfjs/speech-commands/v"+cW(tk)+"/browser_fft",this.SAMPLE_RATE_HZ=44100,this.FFT_SIZE=1024,this.DEFAULT_SUPPRESSION_TIME_MILLIS=0,this.streaming=!1,this.transferRecognizers={},At.assert(t==null&&n==null||t!=null&&n!=null,function(){return"modelURL and metadataURL must be both provided or both not provided."}),t==null?(e==null?e=r.DEFAULT_VOCABULARY_NAME:At.assert(r.VALID_VOCABULARY_NAMES.indexOf(e)!==-1,function(){return"Invalid vocabulary name: '"+e+"'"}),this.vocabulary=e,this.modelArtifactsOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/model.json",this.metadataOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/metadata.json"):(At.assert(e==null,function(){return"vocabulary name must be null or undefined when modelURL is provided"}),this.modelArtifactsOrURL=t,this.metadataOrURL=n),this.parameters={sampleRateHz:this.SAMPLE_RATE_HZ,fftSize:this.FFT_SIZE}}return r.prototype.listen=function(e,t){return rn(this,void 0,void 0,function(){var n,a,i,s,u,c=this;return an(this,function(f){switch(f.label){case 0:if(this.streaming)throw new Error("Cannot start streaming again when streaming is ongoing.");return[4,this.ensureModelLoaded()];case 1:if(f.sent(),t==null&&(t={}),n=t.probabilityThreshold==null?0:t.probabilityThreshold,t.includeEmbedding&&(n=0),At.assert(n>=0&&n<=1,function(){return"Invalid probabilityThreshold value: "+n}),a=t.invokeCallbackOnNoiseAndUnknown!=null&&t.invokeCallbackOnNoiseAndUnknown,t.includeEmbedding&&(a=!0),t.suppressionTimeMillis<0)throw new Error("suppressionTimeMillis is expected to be >= 0, but got "+t.suppressionTimeMillis);return i=t.overlapFactor==null?.5:t.overlapFactor,At.assert(i>=0&&i<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+i}),s=function(h,d){return rn(c,void 0,void 0,function(){var m,g,y,x,w,b,C,A,T,R,D;return an(this,function(N){switch(N.label){case 0:return m=Gc(h),t.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,2];case 1:return N.sent(),D=zw(this.modelWithEmbeddingOutput.predict(m),2),g=D[0],y=D[1],[3,3];case 2:g=this.model.predict(m),N.label=3;case 3:return[4,g.data()];case 4:return x=N.sent(),[4,(w=g.argMax(-1)).data()];case 5:return b=N.sent()[0],C=Math.max.apply(Math,Dc(x)),re([g,w,m]),C<n?[2,!1]:[3,6];case 6:return A=void 0,t.includeSpectrogram?(T={},[4,h.data()]):[3,8];case 7:T.data=N.sent(),T.frameSize=this.nonBatchInputShape[1],A=T,N.label=8;case 8:return R=!0,a||this.words[b]!==Wu&&this.words[b]!==uW||(R=!1),R&&e({scores:x,spectrogram:A,embedding:y}),[2,R]}})})},u=t.suppressionTimeMillis==null?this.DEFAULT_SUPPRESSION_TIME_MILLIS:t.suppressionTimeMillis,this.audioDataExtractor=new l1({sampleRateHz:this.parameters.sampleRateHz,numFramesPerSpectrogram:this.nonBatchInputShape[0],columnTruncateLength:this.nonBatchInputShape[1],suppressionTimeMillis:u,spectrogramCallback:s,overlapFactor:i}),[4,this.audioDataExtractor.start(t.audioTrackConstraints)];case 2:return f.sent(),this.streaming=!0,[2]}})})},r.prototype.ensureModelLoaded=function(){return rn(this,void 0,void 0,function(){var e,t,n,a,i=this;return an(this,function(s){switch(s.label){case 0:return this.model!=null?[2]:[4,this.ensureMetadataLoaded()];case 1:return s.sent(),typeof this.modelArtifactsOrURL!="string"?[3,3]:[4,Sd(this.modelArtifactsOrURL)];case 2:return e=s.sent(),[3,5];case 3:return[4,Sd(lr.fromMemory(this.modelArtifactsOrURL.modelTopology,this.modelArtifactsOrURL.weightSpecs,this.modelArtifactsOrURL.weightData))];case 4:e=s.sent(),s.label=5;case 5:if(e.inputs.length!==1)throw new Error("Expected model to have 1 input, but got a model with "+e.inputs.length+" inputs");if(e.inputs[0].shape.length!==4)throw new Error("Expected model to have an input shape of rank 4, but got an input shape of rank "+e.inputs[0].shape.length);if(e.inputs[0].shape[3]!==1)throw new Error("Expected model to have an input shape with 1 as the last dimension, but got input shape"+JSON.stringify(e.inputs[0].shape[3])+"}");if((t=e.outputShape).length!==2)throw new Error("Expected loaded model to have an output shape of rank 2,but received shape "+JSON.stringify(t));if(t[1]!==this.words.length)throw new Error("Mismatch between the last dimension of model's output shape ("+t[1]+") and number of words ("+this.words.length+").");return this.model=e,this.freezeModel(),this.nonBatchInputShape=e.inputs[0].shape.slice(1),this.elementsPerExample=1,e.inputs[0].shape.slice(1).forEach(function(u){return i.elementsPerExample*=u}),this.warmUpModel(),n=this.parameters.fftSize/this.parameters.sampleRateHz*1e3,a=e.inputs[0].shape[1],this.parameters.spectrogramDurationMillis=a*n,[2]}})})},r.prototype.ensureModelWithEmbeddingOutputCreated=function(){return rn(this,void 0,void 0,function(){var e,t;return an(this,function(n){switch(n.label){case 0:return this.modelWithEmbeddingOutput!=null?[2]:[4,this.ensureModelLoaded()];case 1:for(n.sent(),t=this.model.layers.length-2;t>=0;--t)if(this.model.layers[t].getClassName()==="Dense"){e=this.model.layers[t];break}if(e==null)throw new Error("Failed to find second last dense layer in the original model.");return this.modelWithEmbeddingOutput=dw({inputs:this.model.inputs,outputs:[this.model.outputs[0],e.output]}),[2]}})})},r.prototype.warmUpModel=function(){var e=this;ft(function(){for(var t=Ie([1].concat(e.nonBatchInputShape)),n=0;n<3;++n)e.model.predict(t)})},r.prototype.ensureMetadataLoaded=function(){return rn(this,void 0,void 0,function(){var e,t,n;return an(this,function(a){switch(a.label){case 0:return this.words!=null?[2]:typeof this.metadataOrURL!="string"?[3,2]:[4,W8(this.metadataOrURL)];case 1:return t=a.sent(),[3,3];case 2:t=this.metadataOrURL,a.label=3;case 3:if((e=t).wordLabels==null){if((n=e.words)==null)throw new Error('Cannot find field "words" or "wordLabels" in metadata JSON file');this.words=n}else this.words=e.wordLabels;return[2]}})})},r.prototype.stopListening=function(){return rn(this,void 0,void 0,function(){return an(this,function(e){switch(e.label){case 0:if(!this.streaming)throw new Error("Cannot stop streaming when streaming is not ongoing.");return[4,this.audioDataExtractor.stop()];case 1:return e.sent(),this.streaming=!1,[2]}})})},r.prototype.isListening=function(){return this.streaming},r.prototype.wordLabels=function(){return this.words},r.prototype.params=function(){return this.parameters},r.prototype.modelInputShape=function(){if(this.model==null)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognize(), or listen().");return this.model.inputs[0].shape},r.prototype.recognize=function(e,t){return rn(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x;return an(this,function(w){switch(w.label){case 0:return t==null&&(t={}),[4,this.ensureModelLoaded()];case 1:return w.sent(),e!=null?[3,3]:[4,this.recognizeOnline()];case 2:n=w.sent(),e=n.data,w.label=3;case 3:if(e instanceof Ee)this.checkInputTensorShape(e),i=e,a=e.shape[0];else{if(e.length%this.elementsPerExample)throw new Error("The length of the input Float32Array "+e.length+" is not divisible by the number of tensor elements per per example expected by the model "+this.elementsPerExample+".");a=e.length/this.elementsPerExample,i=ka(e,[a].concat(this.nonBatchInputShape))}return u={scores:null},t.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,5];case 4:return w.sent(),c=this.modelWithEmbeddingOutput.predict(i),s=c[0],u.embedding=c[1],[3,6];case 5:s=this.model.predict(i),w.label=6;case 6:return a!==1?[3,8]:(f=u,[4,s.data()]);case 7:return f.scores=w.sent(),[3,10];case 8:return h=Ni(s),d=h.map(function(b){return b.data()}),m=u,[4,Promise.all(d)];case 9:m.scores=w.sent(),re(h),w.label=10;case 10:return t.includeSpectrogram?(g=u,y={},e instanceof Ee?[4,e.data()]:[3,12]):[3,14];case 11:return x=w.sent(),[3,13];case 12:x=e,w.label=13;case 13:g.spectrogram=(y.data=x,y.frameSize=this.nonBatchInputShape[1],y),w.label=14;case 14:return re(s),[2,u]}})})},r.prototype.recognizeOnline=function(){return rn(this,void 0,void 0,function(){var e=this;return an(this,function(t){return[2,new Promise(function(n,a){e.audioDataExtractor=new l1({sampleRateHz:e.parameters.sampleRateHz,numFramesPerSpectrogram:e.nonBatchInputShape[0],columnTruncateLength:e.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(i){return rn(e,void 0,void 0,function(){var s,u,c;return an(this,function(f){switch(f.label){case 0:return s=Gc(i),[4,this.audioDataExtractor.stop()];case 1:return f.sent(),u=n,c={},[4,s.data()];case 2:return u.apply(void 0,[(c.data=f.sent(),c.frameSize=this.nonBatchInputShape[1],c)]),s.dispose(),[2,!1]}})})},overlapFactor:0}),e.audioDataExtractor.start()})]})})},r.prototype.createTransfer=function(e){if(this.model==null)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognizer(), or listen().");At.assert(e!=null&&typeof e=="string"&&e.length>1,function(){return"Expected the name for a transfer-learning recognized to be a non-empty string, but got "+JSON.stringify(e)}),At.assert(this.transferRecognizers[e]==null,function(){return"There is already a transfer-learning model named '"+e+"'"});var t=new fW(e,this.parameters,this.model);return this.transferRecognizers[e]=t,t},r.prototype.freezeModel=function(){var e,t;try{for(var n=ir(this.model.layers),a=n.next();!a.done;a=n.next())a.value.trainable=!1}catch(i){e={error:i}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype.checkInputTensorShape=function(e){var t=this.model.inputs[0].shape.length;if(e.shape.length!==t)throw new Error("Expected input Tensor to have rank "+t+", but got rank "+e.shape.length+" that differs ");var n=e.shape.slice(1),a=this.model.inputs[0].shape.slice(1);if(!At.arraysEqual(n,a))throw new Error("Expected input to have shape [null,"+a+"], but got shape [null,"+n+"]")},r.VALID_VOCABULARY_NAMES=["18w","directional4w"],r.DEFAULT_VOCABULARY_NAME="18w",r})(),fW=(function(r){function e(t,n,a){var i=r.call(this)||this;return i.name=t,i.parameters=n,i.baseModel=a,At.assert(t!=null&&typeof t=="string"&&t.length>0,function(){return"The name of a transfer model must be a non-empty string, but got "+JSON.stringify(t)}),i.nonBatchInputShape=i.baseModel.inputs[0].shape.slice(1),i.words=null,i.dataset=new RT,i}return q8(e,r),e.prototype.collectExample=function(t,n){return rn(this,void 0,void 0,function(){var a,i,s,u,c=this;return an(this,function(f){if(At.assert(!this.streaming,function(){return"Cannot start collection of transfer-learning example because a streaming recognition or transfer-learning example collection is ongoing"}),At.assert(t!=null&&typeof t=="string"&&t.length>0,function(){return"Must provide a non-empty string when collecting transfer-learning example"}),n==null&&(n={}),n.durationMultiplier!=null&&n.durationSec!=null)throw new Error("durationMultiplier and durationSec are mutually exclusive, but are both specified.");return n.durationSec!=null?(At.assert(n.durationSec>0,function(){return"Expected durationSec to be > 0, but got "+n.durationSec}),i=this.parameters.fftSize/this.parameters.sampleRateHz,a=Math.ceil(n.durationSec/i)):n.durationMultiplier!=null?(At.assert(n.durationMultiplier>=1,function(){return"Expected duration multiplier to be >= 1, but got "+n.durationMultiplier}),a=Math.round(this.nonBatchInputShape[0]*n.durationMultiplier)):a=this.nonBatchInputShape[0],n.snippetDurationSec!=null&&(At.assert(n.snippetDurationSec>0,function(){return"snippetDurationSec is expected to be > 0, but got "+n.snippetDurationSec}),At.assert(n.onSnippet!=null,function(){return"onSnippet must be provided if snippetDurationSec is provided."})),n.onSnippet!=null&&At.assert(n.snippetDurationSec!=null,function(){return"snippetDurationSec must be provided if onSnippet is provided."}),s=this.parameters.fftSize/this.parameters.sampleRateHz,u=s*a,this.streaming=!0,[2,new Promise(function(h){var d=n.snippetDurationSec==null?1:n.snippetDurationSec/u,m=1-d,g=Math.round(1/d),y=0,x=-1,w=[];c.audioDataExtractor=new l1({sampleRateHz:c.parameters.sampleRateHz,numFramesPerSpectrogram:a,columnTruncateLength:c.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(b,C){return rn(c,void 0,void 0,function(){var A,T,R,D,N,O,k,z,F,B,V,G,Q,L,X,$,it,tt,q,nt;return an(this,function(W){switch(W.label){case 0:return n.onSnippet!=null?[3,7]:(A=Gc(b),R=(T=this.dataset).addExample,D={label:t},N={},[4,A.data()]);case 1:return D.spectrogram=(N.data=W.sent(),N.frameSize=this.nonBatchInputShape[1],N),n.includeRawAudio?(k={},[4,C.data()]):[3,3];case 2:return k.data=W.sent(),k.sampleRateHz=this.audioDataExtractor.sampleRateHz,O=k,[3,4];case 3:O=void 0,W.label=4;case 4:return R.apply(T,[(D.rawAudio=O,D)]),A.dispose(),[4,this.audioDataExtractor.stop()];case 5:return W.sent(),this.streaming=!1,this.collateTransferWords(),z=h,F={},[4,b.data()];case 6:return z.apply(void 0,[(F.data=W.sent(),F.frameSize=this.nonBatchInputShape[1],F)]),[3,13];case 7:return[4,b.data()];case 8:for(B=W.sent(),x===-1&&(x=B.length),V=x-1;B[V]!==0&&V>=0;)V--;return G=x-V-1,x=V+1,Q=B.slice(B.length-G,B.length),w.push(Q),n.onSnippet!=null&&n.onSnippet({data:Q,frameSize:this.nonBatchInputShape[1]}),y++!==g?[3,13]:[4,this.audioDataExtractor.stop()];case 9:return W.sent(),this.streaming=!1,this.collateTransferWords(),L=H8(Y8(w)),X={data:L,frameSize:this.nonBatchInputShape[1]},it=($=this.dataset).addExample,tt={label:t,spectrogram:X},n.includeRawAudio?(nt={},[4,C.data()]):[3,11];case 10:return nt.data=W.sent(),nt.sampleRateHz=this.audioDataExtractor.sampleRateHz,q=nt,[3,12];case 11:q=void 0,W.label=12;case 12:it.apply($,[(tt.rawAudio=q,tt)]),h(X),W.label=13;case 13:return[2,!1]}})})},overlapFactor:m,includeRawAudio:n.includeRawAudio}),c.audioDataExtractor.start(n.audioTrackConstraints)})]})})},e.prototype.clearExamples=function(){var t=this;At.assert(this.words!=null&&this.words.length>0&&!this.dataset.empty(),function(){return"No transfer learning examples exist for model name "+t.name}),this.dataset.clear(),this.words=null},e.prototype.countExamples=function(){if(this.dataset.empty())throw new Error("No examples have been collected for transfer-learning model named '"+this.name+"' yet.");return this.dataset.getExampleCounts()},e.prototype.getExamples=function(t){return this.dataset.getExamples(t)},e.prototype.setExampleKeyFrameIndex=function(t,n){this.dataset.setExampleKeyFrameIndex(t,n)},e.prototype.removeExample=function(t){this.dataset.removeExample(t),this.collateTransferWords()},e.prototype.isDatasetEmpty=function(){return this.dataset.empty()},e.prototype.loadExamples=function(t,n){var a,i,s,u;n===void 0&&(n=!1);var c=new RT(t);n&&this.clearExamples();var f=c.getVocabulary();try{for(var h=ir(f),d=h.next();!d.done;d=h.next()){var m=d.value,g=c.getExamples(m);try{for(var y=(s=void 0,ir(g)),x=y.next();!x.done;x=y.next()){var w=x.value;this.dataset.addExample(w.example)}}catch(b){s={error:b}}finally{try{x&&!x.done&&(u=y.return)&&u.call(y)}finally{if(s)throw s.error}}}}catch(b){a={error:b}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}this.collateTransferWords()},e.prototype.serializeExamples=function(t){return this.dataset.serialize(t)},e.prototype.collateTransferWords=function(){this.words=this.dataset.getVocabulary()},e.prototype.collectTransferDataAsTensors=function(t,n){var a=this.nonBatchInputShape[0];t=t||Cp;var i=Math.round(t*a),s=this.dataset.getData(null,u1({numFrames:a,hopFrames:i},n));return{xs:s.xs,ys:s.ys}},e.prototype.collectTransferDataAsTfDataset=function(t,n,a,i){n===void 0&&(n=.15),a===void 0&&(a=32);var s=this.nonBatchInputShape[0];t=t||Cp;var u=Math.round(t*s);return this.dataset.getData(null,u1({numFrames:s,hopFrames:u,getDataset:!0,datasetBatchSize:a,datasetValidationSplit:n},i))},e.prototype.train=function(t){return rn(this,void 0,void 0,function(){var n,a=this;return an(this,function(i){return At.assert(this.words!=null&&this.words.length>0,function(){return"Cannot train transfer-learning model '"+a.name+"' because no transfer learning example has been collected."}),At.assert(this.words.length>1,function(){return"Cannot train transfer-learning model '"+a.name+"' because only 1 word label ('"+JSON.stringify(a.words)+"') has been collected for transfer learning. Requires at least 2."}),t.fineTuningEpochs!=null&&At.assert(t.fineTuningEpochs>=0&&Number.isInteger(t.fineTuningEpochs),function(){return"If specified, fineTuningEpochs must be a non-negative integer, but received "+t.fineTuningEpochs}),t==null&&(t={}),this.model==null&&this.createTransferModelFromBaseModel(),this.secondLastBaseDenseLayer.trainable=!1,this.model.compile({loss:"categoricalCrossentropy",optimizer:t.optimizer||"sgd",metrics:["acc"]}),n=t.fitDatasetDurationMillisThreshold==null?6e4:t.fitDatasetDurationMillisThreshold,this.dataset.durationMillis()>n?(console.log("Detected large dataset: total duration = "+this.dataset.durationMillis()+" ms > "+n+" ms. Training transfer model using fitDataset() instead of fit()"),[2,this.trainOnDataset(t)]):[2,this.trainOnTensors(t)]})})},e.prototype.trainOnDataset=function(t){return rn(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d;return an(this,function(m){switch(m.label){case 0:return At.assert(t.epochs>0,function(){return"Invalid config.epochs"}),n=t.batchSize==null?32:t.batchSize,a=t.windowHopRatio||Cp,i=zw(this.collectTransferDataAsTfDataset(a,t.validationSplit,n,{augmentByMixingNoiseRatio:t.augmentByMixingNoiseRatio}),2),s=i[0],u=i[1],c=At.now(),[4,this.model.fitDataset(s,{epochs:t.epochs,validationData:t.validationSplit>0?u:null,callbacks:t.callback==null?null:[t.callback]})];case 1:return f=m.sent(),console.log("fitDataset() took "+(At.now()-c).toFixed(2)+" ms"),t.fineTuningEpochs!=null&&t.fineTuningEpochs>0?(h=At.now(),[4,this.fineTuningUsingTfDatasets(t,s,u)]):[3,3];case 2:return d=m.sent(),console.log("fitDataset() (fine-tuning) took "+(At.now()-h).toFixed(2)+" ms"),[2,[f,d]];case 3:return[2,f]}})})},e.prototype.trainOnTensors=function(t){return rn(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m;return an(this,function(g){switch(g.label){case 0:n=t.windowHopRatio||Cp,a=this.collectTransferDataAsTensors(n,{augmentByMixingNoiseRatio:t.augmentByMixingNoiseRatio}),i=a.xs,s=a.ys,console.log("Training data: xs.shape = "+i.shape+", ys.shape = "+s.shape),g.label=1;case 1:return g.trys.push([1,,6,7]),t.validationSplit!=null?(h=Z8(i,s,t.validationSplit),u=h.trainXs,c=h.trainYs,f=[h.valXs,h.valYs]):(u=i,c=s),[4,this.model.fit(u,c,{epochs:t.epochs==null?20:t.epochs,validationData:f,batchSize:t.batchSize,callbacks:t.callback==null?null:[t.callback]})];case 2:return d=g.sent(),t.fineTuningEpochs!=null&&t.fineTuningEpochs>0?[4,this.fineTuningUsingTensors(t,u,c,f)]:[3,4];case 3:return m=g.sent(),[2,[d,m]];case 4:return[2,d];case 5:return[3,7];case 6:return re([i,s,u,c,f]),[7];case 7:return[2]}})})},e.prototype.fineTuningUsingTfDatasets=function(t,n,a){return rn(this,void 0,void 0,function(){var i,s,u;return an(this,function(c){switch(c.label){case 0:return i=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,s=t.fineTuningOptimizer==null?"sgd":t.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:s,metrics:["acc"]}),[4,this.model.fitDataset(n,{epochs:t.fineTuningEpochs,validationData:a,callbacks:t.callback==null?null:[t.callback]})];case 1:return u=c.sent(),this.secondLastBaseDenseLayer.trainable=i,[2,u]}})})},e.prototype.fineTuningUsingTensors=function(t,n,a,i){return rn(this,void 0,void 0,function(){var s,u,c;return an(this,function(f){switch(f.label){case 0:return s=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,u=t.fineTuningOptimizer==null?"sgd":t.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:u,metrics:["acc"]}),[4,this.model.fit(n,a,{epochs:t.fineTuningEpochs,validationData:i,batchSize:t.batchSize,callbacks:t.fineTuningCallback==null?null:[t.fineTuningCallback]})];case 1:return c=f.sent(),this.secondLastBaseDenseLayer.trainable=s,[2,c]}})})},e.prototype.evaluate=function(t){return rn(this,void 0,void 0,function(){var n,a=this;return an(this,function(i){return At.assert(t.wordProbThresholds!=null&&t.wordProbThresholds.length>0,function(){return"Received null or empty wordProbThresholds"}),n=0,At.assert(this.words[n]===Wu,function(){return"Cannot perform evaluation when the first tag is not "+Wu}),[2,ft(function(){for(var s=[],u=0,c=a.collectTransferDataAsTensors(t.windowHopRatio),f=c.xs,h=c.ys.argMax(-1).dataSync(),d=a.model.predict(f),m=Wa(nr(d,[0,1],[d.shape[0],d.shape[1]-1]),-1),g=d.shape[0],y=0;y<t.wordProbThresholds.length;++y){for(var x=t.wordProbThresholds[y],w=m.greater(jt(x)).dataSync(),b=0,C=0,A=0,T=0,R=0;R<g;++R)h[R]===n?(b++,w[R]&&A++):(C++,w[R]&&T++);var D=A/b,N=T/C;s.push({probThreshold:x,fpr:D,tpr:N}),console.log("ROC thresh="+x+": fpr="+D.toFixed(4)+", tpr="+N.toFixed(4)),y>0&&(u+=Math.abs(s[y-1].fpr-s[y].fpr)*(s[y-1].tpr+s[y].tpr)/2)}return{rocCurve:s,auc:u}})]})})},e.prototype.createTransferModelFromBaseModel=function(){var t=this;At.assert(this.words!=null,function(){return"No word example is available for tranfer-learning model of name "+t.name});for(var n=this.baseModel.layers,a=n.length-2;a>=0&&n[a].getClassName().toLowerCase()!=="dense";)a--;if(a<0)throw new Error("Cannot find a hidden dense layer in the base model.");this.secondLastBaseDenseLayer=n[a];var i=this.secondLastBaseDenseLayer.output;this.transferHead=XD(),this.transferHead.add(u3.dense({units:this.words.length,activation:"softmax",inputShape:i.shape.slice(1),name:"NewHeadDense"}));var s=this.transferHead.apply(i);this.model=dw({inputs:this.baseModel.inputs,outputs:s})},e.prototype.modelInputShape=function(){return this.baseModel.inputs[0].shape},e.prototype.getMetadata=function(){return{tfjsSpeechCommandsVersion:tk,modelName:this.name,timeStamp:new Date().toISOString(),wordLabels:this.wordLabels()}},e.prototype.save=function(t){return rn(this,void 0,void 0,function(){var n,a,i;return an(this,function(s){return n=t!=null,t=t||_T(this.name),n||(a=ub.localStorage.getItem(sb),(i=a==null?{}:JSON.parse(a))[this.name]=this.getMetadata(),ub.localStorage.setItem(sb,JSON.stringify(i))),console.log("Saving model to "+t),[2,this.model.save(t)]})})},e.prototype.load=function(t){return rn(this,void 0,void 0,function(){var n,a,i;return an(this,function(s){switch(s.label){case 0:if(n=t!=null,t=t||_T(this.name),!n){if((a=JSON.parse(ub.localStorage.getItem(sb)))==null||a[this.name]==null)throw new Error("Cannot find metadata for transfer model named "+this.name+'"');this.words=a[this.name].wordLabels,console.log("Loaded word list for model named "+this.name+": "+this.words)}return i=this,[4,Sd(t)];case 1:return i.model=s.sent(),console.log("Loaded model from "+t+":"),this.model.summary(),[2]}})})},e.prototype.createTransfer=function(t){throw new Error("Creating transfer-learned recognizer from a transfer-learned recognizer is not supported.")},e})(ek);function _T(r){return""+lW+r}function hW(r,e,t,n){if(At.assert(n==null,function(){return"customModelURL and customMetadataURL must be both provided or both not provided."}),r==="BROWSER_FFT")return new ek(e,t,n)}function pW(){const[r,e]=ht.useState(null),[t,n]=ht.useState(null),[a,i]=ht.useState(!0),[s,u]=ht.useState(!1),[c,f]=ht.useState(!1),[h,d]=ht.useState([{id:"_background_noise_",name:"Background Noise",samples:[]},{id:"1",name:"Class 1",samples:[]}]),[m,g]=ht.useState(0),[y,x]=ht.useState([]);ht.useRef(null),ht.useRef(),ht.useEffect(()=>{async function N(){i(!0);try{const O=hW("BROWSER_FFT");await O.ensureModelLoaded(),e(O);const k=O.createTransfer("teachable-audio");n(k)}catch(O){console.error("Audio init error",O)}finally{i(!1)}}return N(),()=>{}},[]);const w=()=>{const N=Date.now().toString();d([...h,{id:N,name:`Class ${h.length}`,samples:[]}])},b=N=>{N!=="_background_noise_"&&d(h.filter(O=>O.id!==N))},C=(N,O)=>{d(h.map(k=>k.id===N?{...k,name:O}:k))},A=async N=>{if(!t)return;const O=h.find(z=>z.id===N);if(!O)return;N==="_background_noise_"||O.name;const k=O.id;try{const z=await t.collectExample(k);d(F=>F.map(B=>B.id===N?{...B,samples:[...B.samples,{timestamp:Date.now()}]}:B))}catch(z){console.error("Collection error",z)}},T=async()=>{if(t){u(!0),g(0);try{await t.train({epochs:25,callback:{onEpochEnd:(N,O)=>{g(Math.round((N+1)/25*100))}}})}catch(N){console.error("Training error",N)}finally{u(!1),R()}}},R=async()=>{t&&(t.isListening()&&await t.stopListening(),await t.listen(N=>{const O=N.scores,z=t.wordLabels().map((F,B)=>{const V=O[B];return{className:(h.find(Q=>Q.id===F)||{name:F}).name,probability:V,id:F}}).sort((F,B)=>B.probability-F.probability);x(z)},{includeSpectrogram:!0,probabilityThreshold:.75}),f(!0))};return{classes:h,isModelLoading:a,isTraining:s,isListening:c,trainingProgress:m,predictions:y,addClass:w,removeClass:b,updateClassName:C,recordSample:A,trainModel:T,startListening:R,stopListening:async()=>{t&&t.isListening()&&await t.stopListening(),f(!1)}}}function dW(){const{classes:r,isModelLoading:e,isTraining:t,isListening:n,trainingProgress:a,predictions:i,addClass:s,removeClass:u,updateClassName:c,recordSample:f,trainModel:h}=pW(),d=m=>{f(m)};return J.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:J.jsxs("div",{className:"max-w-[1600px] mx-auto",children:[J.jsxs("header",{className:"flex items-center justify-between mb-8",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx(nl,{to:"/",className:"p-2 hover:bg-zinc-800 rounded-full transition-colors",children:J.jsx(x1,{className:"w-6 h-6"})}),J.jsxs("div",{className:"flex flex-col",children:[J.jsx("h1",{className:"text-2xl font-bold",children:"Audio Project"}),J.jsx("span",{className:"text-zinc-400 text-sm",children:"Train a model to recognize sounds"})]})]}),t&&J.jsxs("div",{className:"flex items-center gap-4 bg-zinc-900 px-4 py-2 rounded-full border border-zinc-800",children:[J.jsx("span",{className:"animate-pulse text-purple-400 font-medium",children:"Training Model..."}),J.jsx("div",{className:"w-32 h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:"h-full bg-purple-500 transition-all duration-300",style:{width:`${a}%`}})}),J.jsxs("span",{className:"text-sm font-mono",children:[a,"%"]})]})]}),e?J.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:J.jsx(Ow,{text:"Loading audio model (this may take a moment)..."})}):J.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[J.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[r.filter(m=>m.id==="_background_noise_").map(m=>J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[J.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[J.jsx("div",{className:"p-2 bg-zinc-800 rounded-lg",children:J.jsx(Ty,{className:"w-5 h-5 text-zinc-400"})}),J.jsx("h3",{className:"font-semibold text-lg",children:"Background Noise"})]}),J.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:"Record silence or room noise to help the model distinguish signals."}),J.jsx("div",{className:"grid grid-cols-6 gap-2 mb-4",children:m.samples.map((g,y)=>J.jsx("div",{className:"h-8 bg-zinc-800 rounded flex items-center justify-center text-xs text-zinc-600",children:J.jsx(Ty,{className:"w-3 h-3"})},y))}),J.jsxs("button",{onClick:()=>d(m.id),className:"w-full py-3 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg flex items-center justify-center gap-2 font-medium transition-colors",children:[J.jsx(xb,{className:"w-4 h-4"}),"Record 1s Noise"]})]},m.id)),r.filter(m=>m.id!=="_background_noise_").map(m=>J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("input",{type:"text",value:m.name,onChange:g=>c(m.id,g.target.value),className:"bg-transparent text-lg font-semibold text-white focus:outline-none focus:ring-2 focus:ring-purple-500 rounded px-2 py-1 flex-1 mr-2"}),J.jsx("button",{onClick:()=>u(m.id),className:"text-zinc-500 hover:text-red-500",children:J.jsx(td,{className:"w-5 h-5 rotate-45"})})]}),J.jsx("div",{className:"grid grid-cols-6 gap-2 mb-4 h-24 overflow-y-auto content-start",children:m.samples.map((g,y)=>J.jsx("div",{className:"h-8 bg-purple-500/20 border border-purple-500/30 rounded flex items-center justify-center text-xs text-purple-400",children:J.jsx(Ty,{className:"w-3 h-3"})},y))}),J.jsxs("button",{onClick:()=>d(m.id),className:"w-full py-3 bg-purple-600 hover:bg-purple-500 text-white rounded-lg flex items-center justify-center gap-2 font-medium transition-colors",children:[J.jsx(xb,{className:"w-4 h-4"}),"Record 1s Sample"]})]},m.id)),J.jsxs("button",{onClick:s,className:"w-full py-4 border-2 border-dashed border-zinc-800 rounded-xl text-zinc-500 hover:text-white hover:border-zinc-700 hover:bg-zinc-900 transition-all flex items-center justify-center gap-2",children:[J.jsx(td,{className:"w-5 h-5"}),"Add Class"]})]}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full flex flex-col items-center text-center",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Training"}),J.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6",children:[J.jsx("div",{className:"p-4 bg-zinc-950 rounded-lg border border-zinc-900 w-full max-w-xs",children:J.jsxs("div",{className:"space-y-4 text-left text-sm text-zinc-400",children:[J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Epochs"}),J.jsx("span",{className:"text-white",children:"25"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Sample Duration"}),J.jsx("span",{className:"text-white",children:"1s"})]})]})}),J.jsx(Hc,{onClick:h,disabled:t,variant:"primary",className:"w-full max-w-xs py-3 text-lg !bg-purple-600 hover:!bg-purple-500 !shadow-purple-500/30",children:t?"Training...":"Train API"})]})]})}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full sticky top-6",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Preview"}),J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"h-32 bg-black rounded-lg border border-zinc-800 flex items-center justify-center",children:n?J.jsx("div",{className:"flex gap-1 items-end h-16",children:[...Array(20)].map((m,g)=>J.jsx("div",{className:"w-1 bg-purple-500 animate-pulse",style:{height:`${Math.random()*100}%`,animationDelay:`${g*.05}s`}},g))}):J.jsx("p",{className:"text-zinc-500",children:"Train to start listening"})}),J.jsx("div",{className:"space-y-3",children:i.map((m,g)=>J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex justify-between text-sm",children:[J.jsx("span",{className:"font-medium text-white",children:m.className}),J.jsxs("span",{className:"text-zinc-400",children:[(m.probability*100).toFixed(0),"%"]})]}),J.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:`h-full transition-all duration-100 ${m.probability>.8?"bg-green-500":"bg-purple-500"}`,style:{width:`${m.probability*100}%`}})})]},g))})]})]})})]})]})})}var ar={},Zr={};var nk=function(r,e){return(nk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(r,e)};function rk(r,e){function t(){this.constructor=r}nk(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var c1=function(){return(c1=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)};function yo(r,e,t,n){return new(t||(t=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(h){i(h)}}function u(f){try{c(n.throw(f))}catch(h){i(h)}}function c(f){f.done?a(f.value):new t(function(h){h(f.value)}).then(s,u)}c((n=n.apply(r,[])).next())})}function bo(r,e){var t,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(a=2&h[0]?n.return:h[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,h[1])).done)return a;switch(n=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,n=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){s.label=h[1];break}if(h[0]===6&&s.label<a[1]){s.label=a[1],a=h;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(h);break}a[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(r,s)}catch(d){h=[6,d],n=0}finally{t=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([c,f])}}}var ak=(function(){function r(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;At.assert(n[1]===-1&&n[2]===-1,function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"})}return r.prototype.predict=function(e){var t=this;return ft(function(){var n=t.preprocessInput(No(e,"float32")),a=Qn(n,0),i=t.model.predict(a).map(function(u){return Ai(u,[0])}),s=t.nameOutputResults(i);return{heatmapScores:ol(s.heatmap),offsets:s.offsets,displacementFwd:s.displacementFwd,displacementBwd:s.displacementBwd}})},r.prototype.dispose=function(){this.model.dispose()},r})(),ik=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return rk(e,r),e.prototype.preprocessInput=function(t){return ft(function(){return gn(Sn(t,127.5),1)})},e.prototype.nameOutputResults=function(t){return{offsets:t[0],heatmap:t[1],displacementFwd:t[2],displacementBwd:t[3]}},e})(ak);function lb(r){return Math.floor(r/2)}var mW=(function(){function r(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return r.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},r.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},r.prototype.empty=function(){return this.numberOfElements===-1},r.prototype.size=function(){return this.numberOfElements+1},r.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},r.prototype.max=function(){return this.priorityQueue[0]},r.prototype.swim=function(e){for(;e>0&&this.less(lb(e),e);)this.exchange(e,lb(e)),e=lb(e)},r.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},r.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},r.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},r.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},r})();function vW(r,e,t,n,a,i){for(var s=i.shape,u=s[0],c=s[1],f=!0,h=Math.max(t-a,0),d=Math.min(t+a+1,u),m=h;m<d;++m){for(var g=Math.max(n-a,0),y=Math.min(n+a+1,c),x=g;x<y;++x)if(i.get(m,x,r)>e){f=!1;break}if(!f)break}return f}function gW(r,e,t){for(var n=t.shape,a=n[0],i=n[1],s=n[2],u=new mW(a*i*s,function(m){return m.score}),c=0;c<a;++c)for(var f=0;f<i;++f)for(var h=0;h<s;++h){var d=t.get(c,f,h);d<r||vW(h,d,c,f,e,t)&&u.enqueue({score:d,part:{heatmapY:c,heatmapX:f,id:h}})}return u}var vl=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],Nd=vl.length,Xc=vl.reduce(function(r,e,t){return r[e]=t,r},{}),yW=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]],ok=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],bW=yW.map(function(r){var e=r[0],t=r[1];return[Xc[e],Xc[t]]}),xW=["left_face","right_face","right_upper_leg_front","right_lower_leg_back","right_upper_leg_back","left_lower_leg_front","left_upper_leg_front","left_upper_leg_back","left_lower_leg_back","right_feet","right_lower_leg_front","left_feet","torso_front","torso_back","right_upper_arm_front","right_upper_arm_back","right_lower_arm_back","left_lower_arm_front","left_upper_arm_front","left_upper_arm_back","left_lower_arm_back","right_hand","right_lower_arm_front","left_hand"];function sk(r,e,t,n){return{y:n.get(r,e,t),x:n.get(r,e,t+Nd)}}function uk(r,e,t){var n=sk(r.heatmapY,r.heatmapX,r.id,t),a=n.y,i=n.x;return{x:r.heatmapX*e+i,y:r.heatmapY*e+a}}function OT(r,e,t){return r<e?e:r>t?t:r}function wW(r,e,t,n){var a=t-r,i=n-e;return a*a+i*i}function DT(r,e){return{x:r.x+e.x,y:r.y+e.y}}var lk=ok.map(function(r){var e=r[0],t=r[1];return[Xc[e],Xc[t]]}),cb=lk.map(function(r){return r[1]}),IT=lk.map(function(r){return r[0]});function SW(r,e,t){var n=t.shape[2]/2;return{y:t.get(e.y,e.x,r),x:t.get(e.y,e.x,n+r)}}function fb(r,e,t,n){return{y:OT(Math.round(r.y/e),0,t-1),x:OT(Math.round(r.x/e),0,n-1)}}function kT(r,e,t,n,a,i,s,u){u===void 0&&(u=2);for(var c=n.shape,f=c[0],h=c[1],d=SW(r,fb(e.position,i,f,h),s),m=DT(e.position,d),g=0;g<u;g++){var y=fb(m,i,f,h),x=sk(y.y,y.x,t,a);m=DT({x:y.x*i,y:y.y*i},{x:x.x,y:x.y})}var w=fb(m,i,f,h),b=n.get(w.y,w.x,t);return{position:m,part:vl[t],score:b}}function EW(r,e,t,n,a,i){var s=e.shape[2],u=cb.length,c=new Array(s),f=r.part,h=r.score,d=uk(f,n,t);c[f.id]={score:h,part:vl[f.id],position:d};for(var m=u-1;m>=0;--m){var g=cb[m],y=IT[m];c[g]&&!c[y]&&(c[y]=kT(m,c[g],y,e,t,n,i))}for(m=0;m<u;++m)g=IT[m],y=cb[m],c[g]&&!c[y]&&(c[y]=kT(m,c[g],y,e,t,n,a));return c}function ck(r,e,t,n){var a=t.x,i=t.y;return r.some(function(s){var u=s.keypoints[n].position;return wW(i,a,u.y,u.x)<=e})}function CW(r,e,t){return t.reduce(function(n,a,i){var s=a.position,u=a.score;return ck(r,e,s,i)||(n+=u),n},0)/t.length}var AW=1;function fk(r,e,t,n,a,i,s,u){s===void 0&&(s=.5),u===void 0&&(u=20);for(var c=[],f=gW(s,AW,r),h=u*u;c.length<i&&!f.empty();){var d=f.dequeue();if(!ck(c,h,uk(d.part,a,e),d.part.id)){var m=EW(d,r,e,a,t,n),g=CW(c,h,m);c.push({keypoints:m,score:g})}}return c}function NW(r,e){return ft(function(){var t=Sn(r,jt(e,"int32"));return gn(r,Jt(t,jt(e,"int32")))})}function TW(r){var e=r.shape,t=e[0],n=e[1],a=e[2];return ft(function(){var i=Ms(r,[t*n,a]),s=Ri(i,0),u=Qn(Sn(s,jt(n,"int32")),1),c=Qn(NW(s,n),1);return Vn([u,c],1)})}function RW(r,e){for(var t=e.shape[0],n=new Float32Array(t),a=0;a<t;a++){var i=e.get(a,0),s=e.get(a,1);n[a]=r.get(i,s,a)}return n}function _W(r,e,t,n){return{y:n.get(r,e,t),x:n.get(r,e,t+Nd)}}function OW(r,e){for(var t=[],n=0;n<Nd;n++){var a=_W(r.get(n,0).valueOf(),r.get(n,1).valueOf(),n,e),i=a.x,s=a.y;t.push(s),t.push(i)}return ta(t,[Nd,2])}function DW(r,e,t){return ft(function(){var n=OW(r,t);return se(No(Jt(r.toTensor(),jt(e,"int32")),"float32"),n)})}function hk(r,e,t){return yo(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m;return bo(this,function(g){switch(g.label){case 0:return n=0,a=TW(r),[4,Promise.all([r.buffer(),e.buffer(),a.buffer()])];case 1:return i=g.sent(),s=i[0],u=i[1],c=i[2],[4,(f=DW(c,t,u)).buffer()];case 2:return h=g.sent(),d=Array.from(RW(s,c)),m=d.map(function(y,x){return n+=y,{position:{y:h.get(x,0),x:h.get(x,1)},part:vl[x],score:y}}),a.dispose(),f.dispose(),[2,{keypoints:m,score:n/m.length}]}})})}var MT="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",zT="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function IW(r,e){var t="model-stride"+r+".json";return e===4?zT+"float/"+t:zT+"quant"+e+"/"+t}function kW(r,e,t){var n={1:"100",.75:"075",.5:"050"},a="model-stride"+r+".json";return t===4?MT+"float/"+n[e]+"/"+a:MT+"quant"+t+"/"+n[e]+"/"+a}var MW=[-123.15,-115.9,-103.06],zW=(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return rk(e,r),e.prototype.preprocessInput=function(t){return se(t,MW)},e.prototype.nameOutputResults=function(t){var n=t[0],a=t[1];return{offsets:t[2],heatmap:t[3],displacementFwd:n,displacementBwd:a}},e})(ak);function FW(r,e,t){return r<t||e<t}function BW(r,e){return bW.reduce(function(t,n){var a=n[0],i=n[1];return FW(r[a].score,r[i].score,e)||t.push([r[a],r[i]]),t},[])}var FT=Number.NEGATIVE_INFINITY,BT=Number.POSITIVE_INFINITY;function pk(r){return r.reduce(function(e,t){var n=e.maxX,a=e.maxY,i=e.minX,s=e.minY,u=t.position,c=u.x,f=u.y;return{maxX:Math.max(n,c),maxY:Math.max(a,f),minX:Math.min(i,c),minY:Math.min(s,f)}},{maxX:FT,maxY:FT,minX:BT,minY:BT})}function LW(r){var e=pk(r),t=e.minX,n=e.minY,a=e.maxX,i=e.maxY;return[{x:t,y:n},{x:a,y:n},{x:a,y:i},{x:t,y:i}]}function UW(r){return yo(this,void 0,void 0,function(){return bo(this,function(e){return[2,Promise.all(r.map(function(t){return t.buffer()}))]})})}function dk(r,e,t,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),{score:r.score,keypoints:r.keypoints.map(function(i){var s=i.score,u=i.part,c=i.position;return{score:s,part:u,position:{x:c.x*t+a,y:c.y*e+n}}})}}function jW(r,e,t,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),t===1&&e===1&&n===0&&a===0?r:r.map(function(i){return dk(i,e,t,n,a)})}function PW(r,e){return{score:r.score,keypoints:r.keypoints.map(function(t){var n=t.score,a=t.part,i=t.position;return{score:n,part:a,position:{x:e-1-i.x,y:i.y}}})}}function VW(r,e){return e<=0?r:r.map(function(t){return PW(t,e)})}function Ap(r,e){return f1(r,e)?r:Math.floor(r/e)*e+1}function mk(r){At.assert(typeof r=="number"||typeof r=="object",function(){return"Invalid inputResolution "+r+". Should be a number or an object with width and height"}),typeof r=="object"&&(At.assert(typeof r.width=="number",function(){return"inputResolution.width has a value of "+r.width+" which is invalid; it must be a number"}),At.assert(typeof r.height=="number",function(){return"inputResolution.height has a value of "+r.height+" which is invalid; it must be a number"}))}function vk(r,e){return mk(r),typeof r=="object"?[Ap(r.height,e),Ap(r.width,e)]:[Ap(r,e),Ap(r,e)]}var qW=[8,16,32];function WW(r){At.assert(typeof r=="number",function(){return"outputStride is not a number"}),At.assert(qW.indexOf(r)>=0,function(){return"outputStride of "+r+" is invalid. It must be either 8, 16, or 32"})}function f1(r,e){return(r-1)%e==0}function HW(r,e){At.assert(typeof r[0]=="number"&&typeof r[1]=="number",function(){return"both resolution values must be a number but had values "+r}),At.assert(f1(r[0],e),function(){return"height of "+r[0]+" is invalid for output stride "+e+"."}),At.assert(f1(r[1],e),function(){return"width of "+r[1]+" is invalid for output stride "+e+"."})}function h1(r){return r instanceof Ee?[r.shape[0],r.shape[1]]:[r.height,r.width]}function GW(r){return r instanceof Ee?r:Vm.fromPixels(r)}function LT(r,e){var t=e[0],n=e[1],a=h1(r),i=a[0],s=a[1],u=n/t,c=[0,0,0,0],f=c[0],h=c[1],d=c[2],m=c[3];return s/i<u?(f=0,h=0,d=Math.round(.5*(u*i-s)),m=Math.round(.5*(u*i-s))):(f=Math.round(.5*(1/u*s-i)),h=Math.round(.5*(1/u*s-i)),d=0,m=0),{resized:ft(function(){var g=GW(r);return g=Vd(g,[[f,h],[d,m],[0,0]]),xi.resizeBilinear(g,[t,n])}),padding:{top:f,left:d,right:m,bottom:h}}}function p1(r,e,t,n,a){var i=e[0],s=e[1],u=t[0],c=t[1],f=jW(r,(i+n.top+n.bottom)/u,(s+n.left+n.right)/c,-n.top,-n.left);return a?VW(f,s):f}var gk={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:257},UT=["MobileNetV1","ResNet50"],jT={MobileNetV1:[8,16,32],ResNet50:[32,16]},PT={MobileNetV1:[.5,.75,1],ResNet50:[1]},VT=[1,2,4];function XW(r){if((r=r||gk).architecture==null&&(r.architecture="MobileNetV1"),UT.indexOf(r.architecture)<0)throw new Error("Invalid architecture "+r.architecture+". Should be one of "+UT);if(r.inputResolution==null&&(r.inputResolution=257),mk(r.inputResolution),r.outputStride==null&&(r.outputStride=16),jT[r.architecture].indexOf(r.outputStride)<0)throw new Error("Invalid outputStride "+r.outputStride+". Should be one of "+jT[r.architecture]+" for architecture "+r.architecture+".");if(r.multiplier==null&&(r.multiplier=1),PT[r.architecture].indexOf(r.multiplier)<0)throw new Error("Invalid multiplier "+r.multiplier+". Should be one of "+PT[r.architecture]+" for architecture "+r.architecture+".");if(r.quantBytes==null&&(r.quantBytes=4),VT.indexOf(r.quantBytes)<0)throw new Error("Invalid quantBytes "+r.quantBytes+". Should be one of "+VT+" for architecture "+r.architecture+".");if(r.architecture==="MobileNetV1"&&r.outputStride===32&&r.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return r}var qT={flipHorizontal:!1},WT={flipHorizontal:!1,maxDetections:5,scoreThreshold:.5,nmsRadius:20};function KW(r){var e=r.maxDetections,t=r.scoreThreshold,n=r.nmsRadius;if(e<=0)throw new Error("Invalid maxDetections "+e+". Should be > 0");if(t<0||t>1)throw new Error("Invalid scoreThreshold "+t+". Should be in range [0.0, 1.0]");if(n<=0)throw new Error("Invalid nmsRadius "+n+".")}var Fw=(function(){function r(e,t){WW(e.outputStride),HW(t,e.outputStride),this.baseModel=e,this.inputResolution=t}return r.prototype.estimateMultiplePoses=function(e,t){return t===void 0&&(t=WT),yo(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C,A,T,R,D,N;return bo(this,function(O){switch(O.label){case 0:return n=c1({},WT,t),KW(t),a=this.baseModel.outputStride,i=this.inputResolution,s=h1(e),u=s[0],c=s[1],f=LT(e,i),h=f.resized,d=f.padding,m=this.baseModel.predict(h),g=m.heatmapScores,y=m.offsets,x=m.displacementFwd,w=m.displacementBwd,[4,UW([g,y,x,w])];case 1:return b=O.sent(),C=b[0],A=b[1],T=b[2],R=b[3],[4,fk(C,A,T,R,a,n.maxDetections,n.scoreThreshold,n.nmsRadius)];case 2:return D=O.sent(),N=p1(D,[u,c],i,d,n.flipHorizontal),g.dispose(),y.dispose(),x.dispose(),w.dispose(),h.dispose(),[2,N]}})})},r.prototype.estimateSinglePose=function(e,t){return t===void 0&&(t=qT),yo(this,void 0,void 0,function(){var n,a,i,s,u,c,f,h,d,m,g,y,x,w,b,C;return bo(this,function(A){switch(A.label){case 0:return n=c1({},qT,t),a=this.baseModel.outputStride,i=this.inputResolution,s=h1(e),u=s[0],c=s[1],f=LT(e,i),h=f.resized,d=f.padding,m=this.baseModel.predict(h),g=m.heatmapScores,y=m.offsets,x=m.displacementFwd,w=m.displacementBwd,[4,hk(g,y,a)];case 1:return b=A.sent(),C=p1([b],[u,c],i,d,n.flipHorizontal),g.dispose(),y.dispose(),x.dispose(),w.dispose(),h.dispose(),[2,C[0]]}})})},r.prototype.estimatePoses=function(e,t){return yo(this,void 0,void 0,function(){return bo(this,function(n){switch(n.label){case 0:return t.decodingMethod!=="single-person"?[3,2]:[4,this.estimateSinglePose(e,t)];case 1:return[2,[n.sent()]];case 2:return[2,this.estimateMultiplePoses(e,t)]}})})},r.prototype.dispose=function(){this.baseModel.dispose()},r})();function YW(r){return yo(this,void 0,void 0,function(){var e,t,n,a,i,s,u;return bo(this,function(c){switch(c.label){case 0:if(e=r.outputStride,t=r.quantBytes,n=r.multiplier,$x==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return a=kW(e,n,t),[4,Nw(r.modelUrl||a)];case 1:return i=c.sent(),s=new ik(i,e),u=vk(r.inputResolution,s.outputStride),[2,new Fw(s,u)]}})})}function $W(r){return yo(this,void 0,void 0,function(){var e,t,n,a,i,s;return bo(this,function(u){switch(u.label){case 0:if(e=r.outputStride,t=r.quantBytes,$x==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return n=IW(e,t),[4,Nw(r.modelUrl||n)];case 1:return a=u.sent(),i=new zW(a,e),s=vk(r.inputResolution,i.outputStride),[2,new Fw(i,s)]}})})}function QW(r){return r===void 0&&(r=gk),yo(this,void 0,void 0,function(){return bo(this,function(e){return(r=XW(r)).architecture==="ResNet50"?[2,$W(r)]:r.architecture==="MobileNetV1"?[2,YW(r)]:[2,null]})})}var ZW="2.2.2";const JW=Object.freeze(Object.defineProperty({__proto__:null,MobileNet:ik,PoseNet:Fw,decodeMultiplePoses:fk,decodeSinglePose:hk,getAdjacentKeyPoints:BW,getBoundingBox:pk,getBoundingBoxPoints:LW,load:QW,partChannels:xW,partIds:Xc,partNames:vl,poseChain:ok,scaleAndFlipPoses:p1,scalePose:dk,version:ZW},Symbol.toStringTag,{value:"Module"})),HT=Kc(JW);var $e={};const tH=Kc($x);var hb={},GT;function eH(){return GT||(GT=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.partNames=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],r.NUM_KEYPOINTS=r.partNames.length,r.partIds=r.partNames.reduce(function(t,n,a){return t[n]=a,t},{});var e=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]];r.poseChain=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],r.connectedPartIndices=e.map(function(t){var n=t[0],a=t[1];return[r.partIds[n],r.partIds[a]]}),r.partChannels=["left_face","right_face","right_upper_leg_front","right_lower_leg_back","right_upper_leg_back","left_lower_leg_front","left_upper_leg_front","left_upper_leg_back","left_lower_leg_back","right_feet","right_lower_leg_front","left_feet","torso_front","torso_back","right_upper_arm_front","right_upper_arm_back","right_lower_arm_back","left_lower_arm_front","left_upper_arm_front","left_upper_arm_back","left_lower_arm_back","right_hand","right_lower_arm_front","left_hand"]})(hb)),hb}var XT;function yk(){if(XT)return $e;XT=1;var r=$e&&$e.__awaiter||function(F,B,V,G){return new(V||(V=Promise))(function(Q,L){function X(tt){try{it(G.next(tt))}catch(q){L(q)}}function $(tt){try{it(G.throw(tt))}catch(q){L(q)}}function it(tt){tt.done?Q(tt.value):new V(function(q){q(tt.value)}).then(X,$)}it((G=G.apply(F,B||[])).next())})},e=$e&&$e.__generator||function(F,B){var V={label:0,sent:function(){if(L[0]&1)throw L[1];return L[1]},trys:[],ops:[]},G,Q,L,X;return X={next:$(0),throw:$(1),return:$(2)},typeof Symbol=="function"&&(X[Symbol.iterator]=function(){return this}),X;function $(tt){return function(q){return it([tt,q])}}function it(tt){if(G)throw new TypeError("Generator is already executing.");for(;V;)try{if(G=1,Q&&(L=tt[0]&2?Q.return:tt[0]?Q.throw||((L=Q.return)&&L.call(Q),0):Q.next)&&!(L=L.call(Q,tt[1])).done)return L;switch(Q=0,L&&(tt=[tt[0]&2,L.value]),tt[0]){case 0:case 1:L=tt;break;case 4:return V.label++,{value:tt[1],done:!1};case 5:V.label++,Q=tt[1],tt=[0];continue;case 7:tt=V.ops.pop(),V.trys.pop();continue;default:if(L=V.trys,!(L=L.length>0&&L[L.length-1])&&(tt[0]===6||tt[0]===2)){V=0;continue}if(tt[0]===3&&(!L||tt[1]>L[0]&&tt[1]<L[3])){V.label=tt[1];break}if(tt[0]===6&&V.label<L[1]){V.label=L[1],L=tt;break}if(L&&V.label<L[2]){V.label=L[2],V.ops.push(tt);break}L[2]&&V.ops.pop(),V.trys.pop();continue}tt=B.call(F,V)}catch(q){tt=[6,q],Q=0}finally{G=L=0}if(tt[0]&5)throw tt[1];return{value:tt[0]?tt[1]:void 0,done:!0}}};Object.defineProperty($e,"__esModule",{value:!0});var t=tH,n=eH();function a(F,B,V){return F<V||B<V}function i(F,B){return n.connectedPartIndices.reduce(function(V,G){var Q=G[0],L=G[1];return a(F[Q].score,F[L].score,B)||V.push([F[Q],F[L]]),V},[])}$e.getAdjacentKeyPoints=i;var s=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;function c(F){return F.reduce(function(B,V){var G=B.maxX,Q=B.maxY,L=B.minX,X=B.minY,$=V.position,it=$.x,tt=$.y;return{maxX:Math.max(G,it),maxY:Math.max(Q,tt),minX:Math.min(L,it),minY:Math.min(X,tt)}},{maxX:s,maxY:s,minX:u,minY:u})}$e.getBoundingBox=c;function f(F){var B=c(F),V=B.minX,G=B.minY,Q=B.maxX,L=B.maxY;return[{x:V,y:G},{x:Q,y:G},{x:Q,y:L},{x:V,y:L}]}$e.getBoundingBoxPoints=f;function h(F){return r(this,void 0,void 0,function(){return e(this,function(B){return[2,Promise.all(F.map(function(V){return V.buffer()}))]})})}$e.toTensorBuffers3D=h;function d(F,B,V,G,Q){return G===void 0&&(G=0),Q===void 0&&(Q=0),{score:F.score,keypoints:F.keypoints.map(function(L){var X=L.score,$=L.part,it=L.position;return{score:X,part:$,position:{x:it.x*V+Q,y:it.y*B+G}}})}}$e.scalePose=d;function m(F,B,V,G,Q){return G===void 0&&(G=0),Q===void 0&&(Q=0),V===1&&B===1&&G===0&&Q===0?F:F.map(function(L){return d(L,B,V,G,Q)})}$e.scalePoses=m;function g(F,B){return{score:F.score,keypoints:F.keypoints.map(function(V){var G=V.score,Q=V.part,L=V.position;return{score:G,part:Q,position:{x:B-1-L.x,y:L.y}}})}}$e.flipPoseHorizontal=g;function y(F,B){return B<=0?F:F.map(function(V){return g(V,B)})}$e.flipPosesHorizontal=y;function x(F,B){return T(F,B)?F:Math.floor(F/B)*B+1}$e.toValidInputResolution=x;function w(F){t.util.assert(typeof F=="number"||typeof F=="object",function(){return"Invalid inputResolution "+F+". Should be a number or an object with width and height"}),typeof F=="object"&&(t.util.assert(typeof F.width=="number",function(){return"inputResolution.width has a value of "+F.width+" which is invalid; it must be a number"}),t.util.assert(typeof F.height=="number",function(){return"inputResolution.height has a value of "+F.height+" which is invalid; it must be a number"}))}$e.validateInputResolution=w;function b(F,B){return w(F),typeof F=="object"?[x(F.height,B),x(F.width,B)]:[x(F,B),x(F,B)]}$e.getValidInputResolutionDimensions=b;var C=[8,16,32];function A(F){t.util.assert(typeof F=="number",function(){return"outputStride is not a number"}),t.util.assert(C.indexOf(F)>=0,function(){return"outputStride of "+F+" is invalid. It must be either 8, 16, or 32"})}$e.assertValidOutputStride=A;function T(F,B){return(F-1)%B===0}function R(F,B){t.util.assert(typeof F[0]=="number"&&typeof F[1]=="number",function(){return"both resolution values must be a number but had values "+F}),t.util.assert(T(F[0],B),function(){return"height of "+F[0]+" is invalid for output stride "+(B+".")}),t.util.assert(T(F[1],B),function(){return"width of "+F[1]+" is invalid for output stride "+(B+".")})}$e.assertValidResolution=R;function D(F){return F instanceof t.Tensor?[F.shape[0],F.shape[1]]:[F.height,F.width]}$e.getInputTensorDimensions=D;function N(F){return F instanceof t.Tensor?F:t.browser.fromPixels(F)}$e.toInputTensor=N;function O(F,B,V,G){return t.tidy(function(){var Q=N(F);return G?t.image.resizeBilinear(t.reverse(Q,1),[B,V]):t.image.resizeBilinear(Q,[B,V])})}$e.toResizedInputTensor=O;function k(F,B){var V=B[0],G=B[1],Q=D(F),L=Q[0],X=Q[1],$=G/V,it=X/L,tt=[0,0,0,0],q=tt[0],nt=tt[1],W=tt[2],Z=tt[3];it<$?(q=0,nt=0,W=Math.round(.5*($*L-X)),Z=Math.round(.5*($*L-X))):(q=Math.round(.5*(1/$*X-L)),nt=Math.round(.5*(1/$*X-L)),W=0,Z=0);var ot=t.tidy(function(){var xt=N(F);return xt=t.pad3d(xt,[[q,nt],[W,Z],[0,0]]),t.image.resizeBilinear(xt,[V,G])});return{resized:ot,padding:{top:q,left:W,right:Z,bottom:nt}}}$e.padAndResizeTo=k;function z(F,B,V,G,Q){var L=B[0],X=B[1],$=V[0],it=V[1],tt=(L+G.top+G.bottom)/$,q=(X+G.left+G.right)/it,nt=m(F,tt,q,-G.top,-G.left);return Q?y(nt,X):nt}return $e.scaleAndFlipPoses=z,$e}var Np={},KT;function bk(){if(KT)return Np;KT=1;Object.defineProperty(Np,"__esModule",{value:!0});var r="0.8.6";return Np.version=r,Np}var YT;function xk(){if(YT)return Zr;YT=1;var r=Zr&&Zr.__awaiter||function(b,C,A,T){function R(D){return D instanceof A?D:new A(function(N){N(D)})}return new(A||(A=Promise))(function(D,N){function O(F){try{z(T.next(F))}catch(B){N(B)}}function k(F){try{z(T.throw(F))}catch(B){N(B)}}function z(F){F.done?D(F.value):R(F.value).then(O,k)}z((T=T.apply(b,C||[])).next())})},e=Zr&&Zr.__generator||function(b,C){var A={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},T,R,D,N;return N={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function O(z){return function(F){return k([z,F])}}function k(z){if(T)throw new TypeError("Generator is already executing.");for(;A;)try{if(T=1,R&&(D=z[0]&2?R.return:z[0]?R.throw||((D=R.return)&&D.call(R),0):R.next)&&!(D=D.call(R,z[1])).done)return D;switch(R=0,D&&(z=[z[0]&2,D.value]),z[0]){case 0:case 1:D=z;break;case 4:return A.label++,{value:z[1],done:!1};case 5:A.label++,R=z[1],z=[0];continue;case 7:z=A.ops.pop(),A.trys.pop();continue;default:if(D=A.trys,!(D=D.length>0&&D[D.length-1])&&(z[0]===6||z[0]===2)){A=0;continue}if(z[0]===3&&(!D||z[1]>D[0]&&z[1]<D[3])){A.label=z[1];break}if(z[0]===6&&A.label<D[1]){A.label=D[1],D=z;break}if(D&&A.label<D[2]){A.label=D[2],A.ops.push(z);break}D[2]&&A.ops.pop(),A.trys.pop();continue}z=C.call(b,A)}catch(F){z=[6,F],R=0}finally{T=D=0}if(z[0]&5)throw z[1];return{value:z[0]?z[1]:void 0,done:!0}}};Object.defineProperty(Zr,"__esModule",{value:!0});var t=Eo,n=HT,a=yk(),i=bk(),s=HT,u=3,c=function(b){return b.packageVersion=b.packageVersion||i.version,b.packageName="@teachablemachine/pose",b.timeStamp=b.timeStamp||new Date().toISOString(),b.userMetadata=b.userMetadata||{},b.modelName=b.modelName||"untitled",b.labels=b.labels||[],b.modelSettings=d(b.modelSettings),b},f=function(b){return!!b&&Array.isArray(b.labels)},h=function(b){return r(void 0,void 0,void 0,function(){var C,A;return e(this,function(T){switch(T.label){case 0:return typeof b!="string"?[3,3]:[4,fetch(b)];case 1:return A=T.sent(),[4,A.json()];case 2:return C=T.sent(),[3,4];case 3:if(f(b))C=b;else throw new Error("Invalid Metadata provided");T.label=4;case 4:return[2,c(C)]}})})},d=function(b){return b===void 0&&(b={}),b.posenet||(b.posenet={}),b.posenet.architecture=b.posenet.architecture||"MobileNetV1",b.posenet.outputStride=b.posenet.outputStride||16,b.posenet.inputResolution=b.posenet.inputResolution||257,b.posenet.multiplier=b.posenet.multiplier||.75,b};function m(b,C,A){return A===void 0&&(A=3),r(this,void 0,void 0,function(){var T;return e(this,function(R){switch(R.label){case 0:return[4,C.data()];case 1:return T=R.sent(),[2,t.tidy(function(){A=Math.min(A,T.length);for(var D=[],N=0;N<T.length;N++)D.push({value:T[N],index:N});D.sort(function(F,B){return B.value-F.value});for(var O=new Float32Array(A),k=new Int32Array(A),N=0;N<A;N++)O[N]=D[N].value,k[N]=D[N].index;for(var z=[],N=0;N<k.length;N++)z.push({className:b[k[N]],probability:O[N]});return z})]}})})}Zr.getTopKClasses=m;var g=(function(){function b(C,A,T){this.model=C,this.posenetModel=A,this._metadata=c(T)}return b.prototype.getMetadata=function(){return this._metadata},b.prototype.getClassLabels=function(){return this._metadata.labels},b.prototype.getTotalClasses=function(){var C=this.model.output,A=C.shape[1];return A},b.prototype.estimatePose=function(C,A){return A===void 0&&(A=!1),r(this,void 0,void 0,function(){var T,R,D,N,O,k,z,F;return e(this,function(B){switch(B.label){case 0:return[4,this.estimatePoseOutputs(C)];case 1:return T=B.sent(),R=T.heatmapScores,D=T.offsets,N=T.displacementFwd,O=T.displacementBwd,k=T.padding,z=this.poseOutputsToAray(R,D,N,O),[4,this.poseOutputsToKeypoints(C,R,D,N,O,k,A)];case 2:return F=B.sent(),[2,{pose:F,posenetOutput:z}]}})})},b.prototype.estimatePoseOutputs=function(C){return r(this,void 0,void 0,function(){var A,T,R,D,N,O,k,z,F;return e(this,function(B){switch(B.label){case 0:return A=this.posenetModel.inputResolution,T=a.padAndResizeTo(C,A),R=T.resized,D=T.padding,[4,this.posenetModel.baseModel.predict(R)];case 1:return N=B.sent(),O=N.heatmapScores,k=N.offsets,z=N.displacementFwd,F=N.displacementBwd,R.dispose(),[2,{heatmapScores:O,offsets:k,displacementFwd:z,displacementBwd:F,padding:D}]}})})},b.prototype.poseOutputsToAray=function(C,A,T,R){var D=2,N=t.concat([C,A],D),O=N.dataSync();return N.dispose(),O},b.prototype.poseOutputsToKeypoints=function(C,A,T,R,D,N,O){return O===void 0&&(O=!1),r(this,void 0,void 0,function(){var k,z,F,B,V,G,Q,L,X,$,it,tt,q;return e(this,function(nt){switch(nt.label){case 0:return k={maxDetections:u,scoreThreshold:.5,nmsRadius:20},z=a.getInputTensorDimensions(C),F=z[0],B=z[1],V=this.posenetModel.baseModel.outputStride,G=this.posenetModel.inputResolution,[4,a.toTensorBuffers3D([A,T,R,D])];case 1:return Q=nt.sent(),L=Q[0],X=Q[1],$=Q[2],it=Q[3],[4,s.decodeMultiplePoses(L,X,$,it,V,k.maxDetections,k.scoreThreshold,k.nmsRadius)];case 2:return tt=nt.sent(),q=a.scaleAndFlipPoses(tt,[F,B],G,N,O),A.dispose(),T.dispose(),R.dispose(),D.dispose(),[2,q[0]]}})})},b.prototype.predict=function(C){return r(this,void 0,void 0,function(){var A,T,R,D,N;return e(this,function(O){switch(O.label){case 0:return A=t.tensor([C]),T=this.model.predict(A),[4,T.data()];case 1:for(R=O.sent(),D=[],N=0;N<R.length;N++)D.push({className:this._metadata.labels[N],probability:R[N]});return A.dispose(),T.dispose(),[2,D]}})})},b.prototype.predictTopK=function(C,A){return A===void 0&&(A=u),r(this,void 0,void 0,function(){var T,R,D;return e(this,function(N){switch(N.label){case 0:return T=t.tensor([C]),R=this.model.predict(T),[4,m(this._metadata.labels,R,A)];case 1:return D=N.sent(),T.dispose(),R.dispose(),[2,D]}})})},b.prototype.dispose=function(){this.posenetModel.dispose()},b})();Zr.CustomPoseNet=g;function y(b){return b===void 0&&(b={}),r(this,void 0,void 0,function(){var C;return e(this,function(A){switch(A.label){case 0:return b=d(b),[4,n.load({architecture:b.posenet.architecture,outputStride:b.posenet.outputStride,inputResolution:b.posenet.inputResolution,multiplier:b.posenet.multiplier})];case 1:return C=A.sent(),[2,C]}})})}Zr.loadPoseNet=y;function x(b,C){return r(this,void 0,void 0,function(){var A,T,R,D;return e(this,function(N){switch(N.label){case 0:return[4,t.loadLayersModel(b)];case 1:return A=N.sent(),C?[4,h(C)]:[3,3];case 2:return R=N.sent(),[3,4];case 3:R=null,N.label=4;case 4:return T=R,[4,y(T.modelSettings)];case 5:return D=N.sent(),[2,new g(A,D,T)]}})})}Zr.load=x;function w(b,C,A){return r(this,void 0,void 0,function(){var T,R,D,N,O;return e(this,function(k){switch(k.label){case 0:return[4,t.loadLayersModel(t.io.browserFiles([b,C]))];case 1:return T=k.sent(),[4,new Response(A).json()];case 2:return R=k.sent(),A?[4,h(R)]:[3,4];case 3:return N=k.sent(),[3,5];case 4:N=null,k.label=5;case 5:return D=N,[4,y(D.modelSettings)];case 6:return O=k.sent(),[2,new g(T,O,D)]}})})}return Zr.loadFromFiles=w,Zr}var ua={},Gp={exports:{}},nH=Gp.exports,$T;function rH(){return $T||($T=1,(function(r){(function(e,t,n){function a(c){var f=this,h=u();f.next=function(){var d=2091639*f.s0+f.c*23283064365386963e-26;return f.s0=f.s1,f.s1=f.s2,f.s2=d-(f.c=d|0)},f.c=1,f.s0=h(" "),f.s1=h(" "),f.s2=h(" "),f.s0-=h(c),f.s0<0&&(f.s0+=1),f.s1-=h(c),f.s1<0&&(f.s1+=1),f.s2-=h(c),f.s2<0&&(f.s2+=1),h=null}function i(c,f){return f.c=c.c,f.s0=c.s0,f.s1=c.s1,f.s2=c.s2,f}function s(c,f){var h=new a(c),d=f&&f.state,m=h.next;return m.int32=function(){return h.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,d&&(typeof d=="object"&&i(d,h),m.state=function(){return i(h,{})}),m}function u(){var c=4022871197,f=function(h){h=String(h);for(var d=0;d<h.length;d++){c+=h.charCodeAt(d);var m=.02519603282416938*c;c=m>>>0,m-=c,m*=c,c=m>>>0,m-=c,c+=m*4294967296}return(c>>>0)*23283064365386963e-26};return f}t&&t.exports?t.exports=s:this.alea=s})(nH,r)})(Gp)),Gp.exports}var Xp={exports:{}},aH=Xp.exports,QT;function iH(){return QT||(QT=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var d=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^d^d>>>8},u===(u|0)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=f.charCodeAt(h)|0,c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(aH,r)})(Xp)),Xp.exports}var Kp={exports:{}},oH=Kp.exports,ZT;function sH(){return ZT||(ZT=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(d^d<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,u===(u|0)?c.x=u:f+=u;for(var h=0;h<f.length+64;h++)c.x^=f.charCodeAt(h)|0,h==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c.v=u.v,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(oH,r)})(Kp)),Kp.exports}var Yp={exports:{}},uH=Yp.exports,JT;function lH(){return JT||(JT=1,(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var h=c.x,d=c.i,m,g;return m=h[d],m^=m>>>7,g=m^m<<24,m=h[d+1&7],g^=m^m>>>10,m=h[d+3&7],g^=m^m>>>3,m=h[d+4&7],g^=m^m<<7,m=h[d+7&7],m=m^m<<13,g^=m^m<<9,h[d]=g,c.i=d+1&7,g};function f(h,d){var m,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,m=0;m<d.length;++m)g[m&7]=g[m&7]<<15^d.charCodeAt(m)+g[m+1&7]<<13;for(;g.length<8;)g.push(0);for(m=0;m<8&&g[m]===0;++m);for(m==8?g[7]=-1:g[m],h.x=g,h.i=0,m=256;m>0;--m)h.next()}f(c,u)}function i(u,c){return c.x=u.x.slice(),c.i=u.i,c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(h.x&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(uH,r)})(Yp)),Yp.exports}var $p={exports:{}},cH=$p.exports,tR;function fH(){return tR||(tR=1,(function(r){(function(e,t,n){function a(u){var c=this;c.next=function(){var h=c.w,d=c.X,m=c.i,g,y;return c.w=h=h+1640531527|0,y=d[m+34&127],g=d[m=m+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[m]=y^g,c.i=m,y+(h^h>>>16)|0};function f(h,d){var m,g,y,x,w,b=[],C=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,C=Math.max(C,d.length)),y=0,x=-32;x<C;++x)d&&(g^=d.charCodeAt((x+32)%d.length)),x===0&&(w=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(w=w+1640531527|0,m=b[x&127]^=g+w,y=m==0?y+1:0);for(y>=128&&(b[(d&&d.length||0)&127]=-1),y=127,x=512;x>0;--x)g=b[y+34&127],m=b[y=y+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,b[y]=g^m;h.w=w,h.X=b,h.i=y}f(c,u)}function i(u,c){return c.i=u.i,c.w=u.w,c.X=u.X.slice(),c}function s(u,c){u==null&&(u=+new Date);var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(h.X&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(cH,r)})($p)),$p.exports}var Qp={exports:{}},hH=Qp.exports,eR;function pH(){return eR||(eR=1,(function(r){(function(e,t,n){function a(u){var c=this,f="";c.next=function(){var d=c.b,m=c.c,g=c.d,y=c.a;return d=d<<25^d>>>7^m,m=m-g|0,g=g<<24^g>>>8^y,y=y-d|0,c.b=d=d<<20^d>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^y,c.a=y-d|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,u===Math.floor(u)?(c.a=u/4294967296|0,c.b=u|0):f+=u;for(var h=0;h<f.length+20;h++)c.b^=f.charCodeAt(h)|0,c.next()}function i(u,c){return c.a=u.a,c.b=u.b,c.c=u.c,c.d=u.d,c}function s(u,c){var f=new a(u),h=c&&c.state,d=function(){return(f.next()>>>0)/4294967296};return d.double=function(){do var m=f.next()>>>11,g=(f.next()>>>0)/4294967296,y=(m+g)/(1<<21);while(y===0);return y},d.int32=f.next,d.quick=d,h&&(typeof h=="object"&&i(h,f),d.state=function(){return i(f,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(hH,r)})(Qp)),Qp.exports}var Zp={exports:{}},dH=Zp.exports,nR;function mH(){return nR||(nR=1,(function(r){(function(e,t,n){var a=256,i=6,s=52,u="random",c=n.pow(a,i),f=n.pow(2,s),h=f*2,d=a-1,m;function g(T,R,D){var N=[];R=R==!0?{entropy:!0}:R||{};var O=b(w(R.entropy?[T,A(t)]:T??C(),3),N),k=new y(N),z=function(){for(var F=k.g(i),B=c,V=0;F<f;)F=(F+V)*a,B*=a,V=k.g(1);for(;F>=h;)F/=2,B/=2,V>>>=1;return(F+V)/B};return z.int32=function(){return k.g(4)|0},z.quick=function(){return k.g(4)/4294967296},z.double=z,b(A(k.S),t),(R.pass||D||function(F,B,V,G){return G&&(G.S&&x(G,k),F.state=function(){return x(k,{})}),V?(n[u]=F,B):F})(z,O,"global"in R?R.global:this==n,R.state)}function y(T){var R,D=T.length,N=this,O=0,k=N.i=N.j=0,z=N.S=[];for(D||(T=[D++]);O<a;)z[O]=O++;for(O=0;O<a;O++)z[O]=z[k=d&k+T[O%D]+(R=z[O])],z[k]=R;(N.g=function(F){for(var B,V=0,G=N.i,Q=N.j,L=N.S;F--;)B=L[G=d&G+1],V=V*a+L[d&(L[G]=L[Q=d&Q+B])+(L[Q]=B)];return N.i=G,N.j=Q,V})(a)}function x(T,R){return R.i=T.i,R.j=T.j,R.S=T.S.slice(),R}function w(T,R){var D=[],N=typeof T,O;if(R&&N=="object")for(O in T)try{D.push(w(T[O],R-1))}catch{}return D.length?D:N=="string"?T:T+"\0"}function b(T,R){for(var D=T+"",N,O=0;O<D.length;)R[d&O]=d&(N^=R[d&O]*19)+D.charCodeAt(O++);return A(R)}function C(){try{var T;return m&&(T=m.randomBytes)?T=T(a):(T=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(T)),A(T)}catch{var R=e.navigator,D=R&&R.plugins;return[+new Date,e,D,e.screen,A(t)]}}function A(T){return String.fromCharCode.apply(0,T)}if(b(n.random(),t),r.exports){r.exports=g;try{m=j3}catch{}}else n["seed"+u]=g})(typeof self<"u"?self:dH,[],Math)})(Zp)),Zp.exports}var pb,rR;function vH(){if(rR)return pb;rR=1;var r=rH(),e=iH(),t=sH(),n=lH(),a=fH(),i=pH(),s=mH();return s.alea=r,s.xor128=e,s.xorwow=t,s.xorshift7=n,s.xor4096=a,s.tychei=i,pb=s,pb}var aR;function gH(){if(aR)return ua;aR=1;var r=ua&&ua.__extends||(function(){var m=function(g,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,w){x.__proto__=w}||function(x,w){for(var b in w)w.hasOwnProperty(b)&&(x[b]=w[b])},m(g,y)};return function(g,y){m(g,y);function x(){this.constructor=g}g.prototype=y===null?Object.create(y):(x.prototype=y.prototype,new x)}})(),e=ua&&ua.__awaiter||function(m,g,y,x){function w(b){return b instanceof y?b:new y(function(C){C(b)})}return new(y||(y=Promise))(function(b,C){function A(D){try{R(x.next(D))}catch(N){C(N)}}function T(D){try{R(x.throw(D))}catch(N){C(N)}}function R(D){D.done?b(D.value):w(D.value).then(A,T)}R((x=x.apply(m,g||[])).next())})},t=ua&&ua.__generator||function(m,g){var y={label:0,sent:function(){if(b[0]&1)throw b[1];return b[1]},trys:[],ops:[]},x,w,b,C;return C={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function A(R){return function(D){return T([R,D])}}function T(R){if(x)throw new TypeError("Generator is already executing.");for(;y;)try{if(x=1,w&&(b=R[0]&2?w.return:R[0]?w.throw||((b=w.return)&&b.call(w),0):w.next)&&!(b=b.call(w,R[1])).done)return b;switch(w=0,b&&(R=[R[0]&2,b.value]),R[0]){case 0:case 1:b=R;break;case 4:return y.label++,{value:R[1],done:!1};case 5:y.label++,w=R[1],R=[0];continue;case 7:R=y.ops.pop(),y.trys.pop();continue;default:if(b=y.trys,!(b=b.length>0&&b[b.length-1])&&(R[0]===6||R[0]===2)){y=0;continue}if(R[0]===3&&(!b||R[1]>b[0]&&R[1]<b[3])){y.label=R[1];break}if(R[0]===6&&y.label<b[1]){y.label=b[1],b=R;break}if(b&&y.label<b[2]){y.label=b[2],y.ops.push(R);break}b[2]&&y.ops.pop(),y.trys.pop();continue}R=g.call(m,y)}catch(D){R=[6,D],w=0}finally{x=b=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}};Object.defineProperty(ua,"__esModule",{value:!0});var n=Eo,a=Eo,i=xk(),s=vH(),u=.15;function c(m,g){var y=new Array(g).fill(0);return y[m]=1,y}function f(m,g){for(var y,x=m.length,w=m.slice(),b=x-1;b>0;b-=1){var C=void 0;g?C=Math.floor(g()*(b+1)):C=Math.floor(Math.random()*(b+1)),y=[w[C],w[b]],w[b]=y[0],w[C]=y[1]}return w}var h=(function(m){r(g,m);function g(y,x,w){var b=m.call(this,y,x,w)||this;return b.model=y,b.posenetModel=x,b.examples=[],b}return Object.defineProperty(g.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!0,configurable:!0}),g.prototype.addExample=function(y,x){return e(this,void 0,void 0,function(){return t(this,function(w){return this.examples[y].push(x),[2]})})},g.prototype.predict=function(y){return e(this,void 0,void 0,function(){return t(this,function(x){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,m.prototype.predict.call(this,y)]})})},g.prototype.predictTopK=function(y,x){return x===void 0&&(x=3),e(this,void 0,void 0,function(){return t(this,function(w){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,m.prototype.predictTopK.call(this,y,x)]})})},g.prototype.prepare=function(){for(var y in this.examples)if(y.length===0)throw new Error("Add some examples before training");var x=this.convertToTfDataset();this.trainDataset=x.trainDataset,this.validationDataset=x.validationDataset},g.prototype.convertToTfDataset=function(){for(var y=0;y<this.examples.length;y++)this.examples[y]=f(this.examples[y],this.seed);for(var x=[],w=[],b=function(N){var O=c(N,C.numClasses),k=C.examples[N].length,z=Math.ceil(u*k),F=k-z,B=C.examples[N].slice(0,F).map(function(G){return{data:G,label:O}}),V=C.examples[N].slice(F).map(function(G){return{data:G,label:O}});x=x.concat(B),w=w.concat(V)},C=this,y=0;y<this.examples.length;y++)b(y);x=f(x,this.seed),w=f(w,this.seed);var A=n.data.array(x.map(function(N){return N.data})),T=n.data.array(w.map(function(N){return N.data})),R=n.data.array(x.map(function(N){return N.label})),D=n.data.array(w.map(function(N){return N.label}));return{trainDataset:n.data.zip({xs:A,ys:R}),validationDataset:n.data.zip({xs:T,ys:D})}},g.prototype.save=function(y,x){return e(this,void 0,void 0,function(){return t(this,function(w){return[2,this.model.save(y,x)]})})},g.prototype.train=function(y,x){return x===void 0&&(x={}),e(this,void 0,void 0,function(){var w,b,C,A,T,R,D,N=this;return t(this,function(O){switch(O.label){case 0:if(w=x.onTrainEnd||(function(){}),x.onTrainEnd=function(k){N.__stopTrainingResolve&&(N.__stopTrainingResolve(),N.__stopTrainingResolve=null),w(k)},this.isPrepared||this.prepare(),b=this.getLabels().length,a.util.assert(b===this.numClasses,function(){return"Can not train, has "+b+" labels and "+N.numClasses+" classes"}),C=this.examples[0][1].length,this.seed?A=n.initializers.varianceScaling({seed:3.14}):A=n.initializers.varianceScaling({}),this.model=n.sequential({layers:[n.layers.dense({inputShape:[C],units:y.denseUnits,activation:"relu",kernelInitializer:A,useBias:!0}),n.layers.dropout({rate:.5}),n.layers.dense({units:this.numClasses,kernelInitializer:A,useBias:!1,activation:"softmax"})]}),T=n.train.rmsprop(y.learningRate),this.model.compile({optimizer:T,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(y.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return R=this.trainDataset.batch(y.batchSize),D=this.validationDataset.batch(y.batchSize),[4,this.model.fitDataset(R,{epochs:y.epochs,validationData:D,callbacks:x})];case 1:return O.sent(),T.dispose(),[2,this.model]}})})},g.prototype.prepareDataset=function(){for(var y=0;y<this.numClasses;y++)this.examples[y]=[]},g.prototype.stopTraining=function(){var y=this,x=new Promise(function(w,b){y.model.stopTraining=!0,y.__stopTrainingResolve=w});return x},g.prototype.dispose=function(){this.model.dispose(),m.prototype.dispose.call(this)},g.prototype.setLabel=function(y,x){this._metadata.labels[y]=x},g.prototype.setLabels=function(y){this._metadata.labels=y,this.prepareDataset()},g.prototype.getLabel=function(y){return this._metadata.labels[y]},g.prototype.getLabels=function(){return this._metadata.labels},g.prototype.setName=function(y){this._metadata.modelName=y},g.prototype.getName=function(){return this._metadata.modelName},g.prototype.calculateAccuracyPerClass=function(){return e(this,void 0,void 0,function(){var y,x,w,b,C,A,T,R,D,N,Q,O,k,z,F,B,V,G,Q,L=this;return t(this,function(X){switch(X.label){case 0:return y=this.validationDataset.mapAsync(function($){return e(L,void 0,void 0,function(){return t(this,function(it){return[2,$.xs]})})}),x=this.validationDataset.mapAsync(function($){return e(L,void 0,void 0,function(){return t(this,function(it){return[2,$.ys]})})}),w=Math.min(x.size,32),b=Math.ceil(x.size/w),C=y.batch(w),A=x.batch(w),[4,C.iterator()];case 1:return T=X.sent(),[4,A.iterator()];case 2:R=X.sent(),D=[],N=[],Q=0,X.label=3;case 3:return Q<b?[4,T.next()]:[3,7];case 4:return O=X.sent(),k=this.model.predict(O.value),z=k.argMax(1),D.push(z),[4,R.next()];case 5:F=X.sent(),B=F.value.argMax(1),N.push(B),O.value.dispose(),k.dispose(),F.value.dispose(),X.label=6;case 6:return Q++,[3,3];case 7:if(V=n.concat(N),G=n.concat(D),b!==1)for(Q=0;Q<D.length;Q++)D[Q].dispose(),N[Q].dispose();return[2,{reference:V,predictions:G}]}})})},g.prototype.setSeed=function(y){this.seed=s(y)},g})(i.CustomPoseNet);ua.TeachablePoseNet=h;function d(m){return e(this,void 0,void 0,function(){var g;return t(this,function(y){switch(y.label){case 0:return[4,i.loadPoseNet(m.modelSettings)];case 1:return g=y.sent(),[2,new h(n.sequential(),g,m)]}})})}return ua.createTeachable=d,ua}var Oa={},yc={},iR;function wk(){if(iR)return yc;iR=1;Object.defineProperty(yc,"__esModule",{value:!0});var r=function(){return document.createElement("canvas")};function e(n,a,i){n===void 0&&(n=200),a===void 0&&(a=200),i===void 0&&(i=!1);var s=document.createElement("canvas");if(s.width=n,s.height=a,i){var u=s.getContext("2d");u.translate(n,0),u.scale(-1,1)}return s}yc.createCanvas=e;function t(n,a,i,s){i===void 0&&(i=!1),s===void 0&&(s=r());var u=n.width,c=n.height;n instanceof HTMLVideoElement&&(u=n.videoWidth,c=n.videoHeight);var f=Math.min(u,c),h=a/f,d=Math.ceil(u*h),m=Math.ceil(c*h),g=d-a,y=m-a;s.width=s.height=a;var x=s.getContext("2d");return x.drawImage(n,~~(g/2)*-1,~~(y/2)*-1,d,m),i&&(x.scale(-1,1),x.drawImage(s,a*-1,0)),s}return yc.cropTo=t,yc}var oR;function yH(){if(oR)return Oa;oR=1;var r=Oa&&Oa.__decorate||function(c,f,h,d){var m=arguments.length,g=m<3?f:d===null?d=Object.getOwnPropertyDescriptor(f,h):d,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,f,h,d);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(g=(m<3?y(g):m>3?y(f,h,g):y(f,h))||g);return m>3&&g&&Object.defineProperty(f,h,g),g},e=Oa&&Oa.__awaiter||function(c,f,h,d){function m(g){return g instanceof h?g:new h(function(y){y(g)})}return new(h||(h=Promise))(function(g,y){function x(C){try{b(d.next(C))}catch(A){y(A)}}function w(C){try{b(d.throw(C))}catch(A){y(A)}}function b(C){C.done?g(C.value):m(C.value).then(x,w)}b((d=d.apply(c,f||[])).next())})},t=Oa&&Oa.__generator||function(c,f){var h={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,m,g,y;return y={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function x(b){return function(C){return w([b,C])}}function w(b){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,m&&(g=b[0]&2?m.return:b[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,b[1])).done)return g;switch(m=0,g&&(b=[b[0]&2,g.value]),b[0]){case 0:case 1:g=b;break;case 4:return h.label++,{value:b[1],done:!1};case 5:h.label++,m=b[1],b=[0];continue;case 7:b=h.ops.pop(),h.trys.pop();continue;default:if(g=h.trys,!(g=g.length>0&&g[g.length-1])&&(b[0]===6||b[0]===2)){h=0;continue}if(b[0]===3&&(!g||b[1]>g[0]&&b[1]<g[3])){h.label=b[1];break}if(b[0]===6&&h.label<g[1]){h.label=g[1],g=b;break}if(g&&h.label<g[2]){h.label=g[2],h.ops.push(b);break}g[2]&&h.ops.pop(),h.trys.pop();continue}b=f.call(c,h)}catch(C){b=[6,C],m=0}finally{d=g=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(Oa,"__esModule",{value:!0});var n=V3,a=wk(),i={facingMode:"user",frameRate:24},s=function(c){return c.facingMode=c.facingMode||i.facingMode,c.frameRate=c.frameRate||i.frameRate,c.aspectRatio=c.aspectRatio||i.aspectRatio,c},u=(function(){function c(f,h,d){f===void 0&&(f=400),h===void 0&&(h=400),d===void 0&&(d=!1),this.width=f,this.height=h,this.flip=d}return c.prototype.getWebcam=function(f){if(f===void 0&&(f={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");f.width=640;var h=s(f),d=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:h}).then(function(m){return d.srcObject=m,d.addEventListener("loadedmetadata",function(g){var y=d.videoWidth,x=d.videoHeight;d.width=y,d.height=x}),d},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},c.prototype.setup=function(f){return f===void 0&&(f={}),e(this,void 0,void 0,function(){var h;return t(this,function(d){switch(d.label){case 0:return this.webcam?[3,2]:(h=this,[4,this.getWebcam(f)]);case 1:h.webcam=d.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),d.label=2;case 2:return[2]}})})},c.prototype.play=function(){var f=this.webcam.play();return f},c.prototype.pause=function(){this.webcam.pause()},c.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},c.prototype.update=function(){this.renderCameraToCanvas()},c.prototype.stopStreamedVideo=function(f){var h=f.srcObject,d=h.getTracks();d.forEach(function(m){m.stop()}),f.srcObject=null},c.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var f=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var h=a.cropTo(this.webcam,this.width,this.flip);f.drawImage(h,0,0)}}},r([n.default],c.prototype,"getWebcam",null),r([n.default],c.prototype,"setup",null),r([n.default],c.prototype,"play",null),r([n.default],c.prototype,"pause",null),r([n.default],c.prototype,"stop",null),r([n.default],c.prototype,"update",null),r([n.default],c.prototype,"stopStreamedVideo",null),r([n.default],c.prototype,"renderCameraToCanvas",null),c})();return Oa.Webcam=u,Oa}var so={},sR;function bH(){if(sR)return so;sR=1;Object.defineProperty(so,"__esModule",{value:!0});var r=yk(),e="aqua",t="aqua",n=4,a=2;function i(h,d,m,g,y,x,w){g===void 0&&(g=n),y===void 0&&(y=e),x===void 0&&(x=t),w===void 0&&(w=1);for(var b=0;b<h.length;b++){var C=h[b];if(!(C.score<d)){var A=C.position,T=A.y,R=A.x;s(m,T*w,R*w,g,y,x)}}}so.drawKeypoints=i;function s(h,d,m,g,y,x){h.fillStyle=y,h.strokeStyle=x,h.beginPath(),h.arc(m,d,g,0,2*Math.PI),h.fill(),h.stroke()}so.drawPoint=s;function u(h){return[h.y,h.x]}so.toTuple=u;function c(h,d,m,g,y,x){g===void 0&&(g=a),y===void 0&&(y=t),x===void 0&&(x=1);var w=r.getAdjacentKeyPoints(h,d);w.forEach(function(b){f(u(b[0].position),u(b[1].position),m,g,y,x)})}so.drawSkeleton=c;function f(h,d,m,g,y,x){var w=h[0],b=h[1],C=d[0],A=d[1];m.beginPath(),m.moveTo(b*x,w*x),m.lineTo(A*x,C*x),m.lineWidth=g,m.strokeStyle=y,m.stroke()}return so.drawSegment=f,so}var uR;function xH(){if(uR)return ar;uR=1;Object.defineProperty(ar,"__esModule",{value:!0});var r=xk();ar.CustomPoseNet=r.CustomPoseNet,ar.load=r.load,ar.loadFromFiles=r.loadFromFiles;var e=gH();ar.TeachablePoseNet=e.TeachablePoseNet,ar.createTeachable=e.createTeachable;var t=yH();ar.Webcam=t.Webcam;var n=wk();ar.createCanvas=n.createCanvas;var a=bH();ar.drawKeypoints=a.drawKeypoints,ar.drawSkeleton=a.drawSkeleton,ar.drawPoint=a.drawPoint,ar.drawSegment=a.drawSegment;var i=bk();return ar.version=i.version,ar}var Iu=xH();const db=200,mb=200,wH=!0;function SH(){const[r,e]=ht.useState(null),[t,n]=ht.useState(null),[a,i]=ht.useState(!0),[s,u]=ht.useState(!1),[c,f]=ht.useState([{id:"0",name:"Pose 1",samples:[]},{id:"1",name:"Pose 2",samples:[]}]),[h,d]=ht.useState(0),[m,g]=ht.useState([]),[y,x]=ht.useState(null),w=ht.useRef(),b=ht.useRef(null);return ht.useEffect(()=>{let N=null,O=!0;async function k(){i(!0);try{if(N=new Iu.Webcam(db,mb,wH),await N.setup(),O)if(await N.play(),N.canvas){n(N);const z=await Iu.createTeachable({});z.setLabels(["Pose 1","Pose 2"]),e(z)}else throw new Error("Webcam canvas not initialized correctly");else N.stop()}catch(z){console.error("Pose init error",z),x(z.message||"Failed to initialize Pose model")}finally{O&&i(!1)}}return k(),()=>{if(O=!1,N&&N.canvas)try{N.stop()}catch(z){console.warn("Failed to stop webcam",z)}w.current&&cancelAnimationFrame(w.current)}},[]),ht.useEffect(()=>{if(!t||!r)return;const N=async()=>{w.current&&cancelAnimationFrame(w.current),t.update();const{pose:O,posenetOutput:k}=await r.estimatePose(t.canvas);if(!s)try{const z=await r.predict(k);g(z)}catch(z){console.warn("Prediction error:",z)}if(b.current){const z=b.current.getContext("2d");z.clearRect(0,0,db,mb),z.drawImage(t.canvas,0,0),O&&(Iu.drawKeypoints(O.keypoints,.5,z),Iu.drawSkeleton(O.keypoints,.5,z))}w.current=requestAnimationFrame(N)};return N(),()=>{w.current&&cancelAnimationFrame(w.current)}},[t,r,s]),{webcam:t,canvasRef:b,classes:c,isModelLoading:a,isTraining:s,trainingProgress:h,predictions:m,lastError:y,addClass:()=>{const N=c.length.toString();f([...c,{id:N,name:`Pose ${c.length+1}`,samples:[]}])},removeClass:N=>{f(c.filter(O=>O.id!==N))},updateClassName:(N,O)=>{f(c.map(k=>k.id===N?{...k,name:O}:k))},addSample:async N=>{if(!t||!r){x("Webcam or Model not ready");return}x(null);try{const{pose:O,posenetOutput:k}=await r.estimatePose(t.canvas);if(!O||O.score<.2){x("Pose not detected! Make sure your upper body and shoulders are visible.");return}const z=c.findIndex(G=>G.id===N);if(z===-1)return;const F=document.createElement("canvas");F.width=db,F.height=mb;const B=F.getContext("2d");B.drawImage(t.canvas,0,0),O&&(Iu.drawKeypoints(O.keypoints,.5,B),Iu.drawSkeleton(O.keypoints,.5,B));const V=F.toDataURL();f(G=>G.map(Q=>Q.id===N?{...Q,samples:[...Q.samples,V]}:Q)),r.examples[z]||(r.examples[z]=[]),await r.addExample(z,k)}catch(O){console.error("Error adding sample",O),x(O.message||"Failed to add pose sample")}},trainModel:async()=>{if(r){u(!0),d(0),x(null);try{c.forEach((N,O)=>{r.setLabel(O,N.name)}),await r.train({denseUnits:100,epochs:50,learningRate:.001,batchSize:16},{onEpochEnd:(N,O)=>{d(Math.round((N+1)/50*100))}}),console.log("Training complete!")}catch(N){console.error("Training CRITICAL error:",N),x("Training failed: "+(N.message||"Unknown error"))}finally{u(!1)}}}}}function EH(){const{canvasRef:r,classes:e,isModelLoading:t,isTraining:n,trainingProgress:a,predictions:i,lastError:s,addClass:u,removeClass:c,updateClassName:f,addSample:h,trainModel:d}=SH();return J.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:J.jsxs("div",{className:"max-w-[1600px] mx-auto",children:[J.jsxs("header",{className:"flex items-center justify-between mb-8",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx(nl,{to:"/",className:"p-2 hover:bg-zinc-800 rounded-full transition-colors",children:J.jsx(x1,{className:"w-6 h-6"})}),J.jsxs("div",{className:"flex flex-col",children:[J.jsx("h1",{className:"text-2xl font-bold",children:"Pose Project"}),J.jsx("span",{className:"text-zinc-400 text-sm",children:"Train a model to recognize poses"})]})]}),n&&J.jsxs("div",{className:"flex items-center gap-4 bg-zinc-900 px-4 py-2 rounded-full border border-zinc-800",children:[J.jsx("span",{className:"animate-pulse text-pink-400 font-medium",children:"Training Model..."}),J.jsx("div",{className:"w-32 h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:"h-full bg-pink-500 transition-all duration-300",style:{width:`${a}%`}})}),J.jsxs("span",{className:"text-sm font-mono",children:[a,"%"]})]})]}),s&&J.jsxs("div",{className:"mb-6 bg-red-500/10 border border-red-500/50 text-red-400 p-4 rounded-xl flex items-center justify-between",children:[J.jsxs("span",{children:["Error: ",s]}),J.jsx("button",{onClick:()=>window.location.reload(),className:"underline text-sm hover:text-white",children:"Reload"})]}),t?J.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:J.jsx(Ow,{text:"Initializing PoseNet..."})}):J.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[J.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[e.map(m=>J.jsx("div",{children:J.jsx(q3,{classData:m,onRename:f,onRemove:c,onRecordStart:()=>h(m.id),onRecordStop:()=>{}})},m.id)),J.jsxs("button",{onClick:u,className:"w-full py-4 border-2 border-dashed border-zinc-800 rounded-xl text-zinc-500 hover:text-white hover:border-zinc-700 hover:bg-zinc-900 transition-all flex items-center justify-center gap-2",children:[J.jsx(td,{className:"w-5 h-5"}),"Add Class"]})]}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full flex flex-col items-center text-center",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Training"}),J.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6",children:[J.jsx("div",{className:"p-4 bg-zinc-950 rounded-lg border border-zinc-900 w-full max-w-xs",children:J.jsxs("div",{className:"space-y-4 text-left text-sm text-zinc-400",children:[J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Epochs"}),J.jsx("span",{className:"text-white",children:"50"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Batch Size"}),J.jsx("span",{className:"text-white",children:"16"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{children:"Learning Rate"}),J.jsx("span",{className:"text-white",children:"0.001"})]})]})}),J.jsx(Hc,{onClick:d,disabled:n||e.some(m=>m.samples.length===0),className:"w-full max-w-xs py-3 text-lg !bg-pink-600 hover:!bg-pink-500 !shadow-pink-500/30",children:n?"Training...":"Train Model"}),e.some(m=>m.samples.length===0)&&J.jsx("p",{className:"text-orange-500 text-sm",children:"Add samples to all classes first"})]})]})}),J.jsx("div",{className:"col-span-12 lg:col-span-4",children:J.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 h-full sticky top-6",children:[J.jsx("h2",{className:"text-xl font-bold mb-6",children:"Preview"}),J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"aspect-square bg-black rounded-lg overflow-hidden border border-zinc-800 relative flex items-center justify-center",children:[J.jsx("canvas",{ref:r,width:200,height:200,className:"w-full h-full object-contain"}),!i.length&&!n&&J.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm pointer-events-none",children:J.jsx("p",{className:"text-zinc-400",children:"Train model to start predicting"})})]}),J.jsx("div",{className:"space-y-3",children:i.map((m,g)=>J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex justify-between text-sm",children:[J.jsx("span",{className:"font-medium text-white",children:m.className}),J.jsxs("span",{className:"text-zinc-400",children:[(m.probability*100).toFixed(0),"%"]})]}),J.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:J.jsx("div",{className:`h-full transition-all duration-100 ${m.probability>.8?"bg-green-500":"bg-pink-500"}`,style:{width:`${m.probability*100}%`}})})]},g))})]})]})})]})]})})}class CH extends qz.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),console.error("Uncaught error:",e,t)}handleReload=()=>{window.location.reload()};render(){return this.state.hasError?J.jsx("div",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-6 text-center",children:J.jsxs("div",{className:"bg-zinc-900 border border-red-500/50 p-8 rounded-2xl max-w-2xl w-full shadow-2xl shadow-red-900/20",children:[J.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Something went wrong"}),J.jsx("p",{className:"text-zinc-300 mb-6 text-lg",children:"The application encountered an unexpected error."}),this.state.error&&J.jsxs("div",{className:"bg-black/50 p-4 rounded-lg mb-6 text-left overflow-auto max-h-60 border border-zinc-800",children:[J.jsx("code",{className:"text-red-400 font-mono text-sm",children:this.state.error.toString()}),this.state.errorInfo&&J.jsx("pre",{className:"text-zinc-500 text-xs mt-2 overflow-x-auto",children:this.state.errorInfo.componentStack})]}),J.jsxs("div",{className:"flex justify-center gap-4",children:[J.jsx(Hc,{onClick:()=>this.setState({hasError:!1}),variant:"secondary",children:"Try again"}),J.jsx(Hc,{onClick:this.handleReload,variant:"danger",children:"Reload Page"})]})]})}):this.props.children}}function AH(){return J.jsx(CH,{children:J.jsx(yF,{children:J.jsxs(K4,{children:[J.jsx(bc,{path:"/",element:J.jsx(GF,{})}),J.jsx(bc,{path:"/image",element:J.jsx(a8,{})}),J.jsx(bc,{path:"/audio",element:J.jsx(dW,{})}),J.jsx(bc,{path:"/pose",element:J.jsx(EH,{})})]})})})}$z.createRoot(document.getElementById("root")).render(J.jsx(ht.StrictMode,{children:J.jsx(AH,{})}));
